   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.6 (r4159) - 21 Sep 2011 10:11
   !
   !  Differentiation of getcostfuncmat in forward (tangent) mode:
   !   variations   of useful results: costfuncmat
   !   with respect to varying inputs: pinf liftdirection dragdirection
   !                surfaceref alpha beta
   SUBROUTINE GETCOSTFUNCMAT_D(alpha, alphad, beta, betad, liftindex)
   USE FLOWVARREFSTATE
   USE COSTFUNCTIONS
   USE INPUTPHYSICS
   USE CONSTANTS
   IMPLICIT NONE
   !
   !     ******************************************************************
   !     *                                                                *
   !     * Compute the cost function vector needed to calculate           *
   !     * dIdw, dIdx and dIda.                                            *
   !     *                                                                *
   !     ******************************************************************
   !
   !Subroutine Vars Input/Ouput
   REAL(kind=realtype), INTENT(IN) :: alpha, beta
   REAL(kind=realtype), INTENT(IN) :: alphad, betad
   INTEGER(kind=inttype), INTENT(IN) :: liftindex
   ! Working vars
   REAL(kind=realtype) :: fact
   REAL(kind=realtype) :: factd
   CALL ADJUSTINFLOWANGLE_D(alpha, alphad, beta, betad, liftindex)
   factd = -(two*gammainf*machcoef**2*lref**2*(pinfd*surfaceref+pinf*&
   &    surfacerefd)/(gammainf*pinf*machcoef**2*surfaceref*lref**2)**2)
   fact = two/(gammainf*pinf*machcoef**2*surfaceref*lref**2)
   costfuncmat = zero
   costfuncmatd = 0.0
   ! Just set the ones we know
   costfuncmatd(:, costfunclift) = (/liftdirectiond(1), liftdirectiond(2)&
   &    , liftdirectiond(3), 0.0, 0.0, 0.0/)
   costfuncmat(:, costfunclift) = (/liftdirection(1), liftdirection(2), &
   &    liftdirection(3), zero, zero, zero/)
   costfuncmatd(:, costfuncdrag) = (/dragdirectiond(1), dragdirectiond(2)&
   &    , dragdirectiond(3), 0.0, 0.0, 0.0/)
   costfuncmat(:, costfuncdrag) = (/dragdirection(1), dragdirection(2), &
   &    dragdirection(3), zero, zero, zero/)
   costfuncmatd(:, costfuncliftcoef) = (/liftdirectiond(1)*fact+&
   &    liftdirection(1)*factd, liftdirectiond(2)*fact+liftdirection(2)*&
   &    factd, liftdirectiond(3)*fact+liftdirection(3)*factd, 0.0, 0.0, 0.0&
   &    /)
   costfuncmat(:, costfuncliftcoef) = (/liftdirection(1)*fact, &
   &    liftdirection(2)*fact, liftdirection(3)*fact, zero, zero, zero/)
   costfuncmatd(:, costfuncdragcoef) = (/dragdirectiond(1)*fact+&
   &    dragdirection(1)*factd, dragdirectiond(2)*fact+dragdirection(2)*&
   &    factd, dragdirectiond(3)*fact+dragdirection(3)*factd, 0.0, 0.0, 0.0&
   &    /)
   costfuncmat(:, costfuncdragcoef) = (/dragdirection(1)*fact, &
   &    dragdirection(2)*fact, dragdirection(3)*fact, zero, zero, zero/)
   costfuncmatd(:, costfuncforcex) = 0.0
   costfuncmat(:, costfuncforcex) = (/one, zero, zero, zero, zero, zero/)
   costfuncmatd(:, costfuncforcey) = 0.0
   costfuncmat(:, costfuncforcey) = (/zero, one, zero, zero, zero, zero/)
   costfuncmatd(:, costfuncforcez) = 0.0
   costfuncmat(:, costfuncforcez) = (/zero, zero, one, zero, zero, zero/)
   costfuncmatd(:, costfuncforcexcoef) = (/factd, 0.0, 0.0, 0.0, 0.0, 0.0&
   &    /)
   costfuncmat(:, costfuncforcexcoef) = (/fact, zero, zero, zero, zero, &
   &    zero/)
   costfuncmatd(:, costfuncforceycoef) = (/0.0, factd, 0.0, 0.0, 0.0, 0.0&
   &    /)
   costfuncmat(:, costfuncforceycoef) = (/zero, fact, zero, zero, zero, &
   &    zero/)
   costfuncmatd(:, costfuncforcezcoef) = (/0.0, 0.0, factd, 0.0, 0.0, 0.0&
   &    /)
   costfuncmat(:, costfuncforcezcoef) = (/zero, zero, fact, zero, zero, &
   &    zero/)
   costfuncmatd(:, costfuncmomx) = 0.0
   costfuncmat(:, costfuncmomx) = (/zero, zero, zero, one, zero, zero/)
   costfuncmatd(:, costfuncmomy) = 0.0
   costfuncmat(:, costfuncmomy) = (/zero, zero, zero, zero, one, zero/)
   costfuncmatd(:, costfuncmomz) = 0.0
   costfuncmat(:, costfuncmomz) = (/zero, zero, zero, zero, zero, one/)
   costfuncmatd(:, costfuncmomxcoef) = (/0.0, 0.0, 0.0, factd, 0.0, 0.0/)
   costfuncmat(:, costfuncmomxcoef) = (/zero, zero, zero, fact, zero, &
   &    zero/)
   costfuncmatd(:, costfuncmomycoef) = (/0.0, 0.0, 0.0, 0.0, factd, 0.0/)
   costfuncmat(:, costfuncmomycoef) = (/zero, zero, zero, zero, fact, &
   &    zero/)
   costfuncmatd(:, costfuncmomzcoef) = (/0.0, 0.0, 0.0, 0.0, 0.0, factd/)
   costfuncmat(:, costfuncmomzcoef) = (/zero, zero, zero, zero, zero, &
   &    fact/)
   END SUBROUTINE GETCOSTFUNCMAT_D
