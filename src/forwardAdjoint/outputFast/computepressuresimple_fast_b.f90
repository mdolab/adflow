   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53
   !
   !  Differentiation of computepressuresimple in reverse (adjoint) mode (with options i4 dr8 r8 noISIZE):
   !   gradient     of useful results: *p *w
   !   with respect to varying inputs: *w
   !   Plus diff mem management of: p:in w:in
   ! Compute the pressure on a block with the pointers already set. This
   ! routine is used by the forward mode AD code only. 
   SUBROUTINE COMPUTEPRESSURESIMPLE_FAST_B()
   USE BLOCKPOINTERS
   USE FLOWVARREFSTATE
   USE INPUTPHYSICS
   IMPLICIT NONE
   ! Local Variables
   INTEGER(kind=inttype) :: i, j, k, ii
   REAL(kind=realtype) :: gm1, v2
   REAL(kind=realtype) :: v2d
   INTRINSIC MOD
   INTRINSIC MAX
   REAL(kind=realtype) :: tempd
   ! Compute the pressures
   gm1 = gammaconstant - one
   DO ii=0,(ib+1)*(jb+1)*(kb+1)-1
   i = MOD(ii, ib + 1)
   j = MOD(ii/(ib+1), jb + 1)
   k = ii/((ib+1)*(jb+1))
   v2 = w(i, j, k, ivx)**2 + w(i, j, k, ivy)**2 + w(i, j, k, ivz)**2
   p(i, j, k) = gm1*(w(i, j, k, irhoe)-half*w(i, j, k, irho)*v2)
   IF (p(i, j, k) .LT. 1.e-4_realType*pinfcorr) pd(i, j, k) = 0.0_8
   tempd = gm1*pd(i, j, k)
   wd(i, j, k, irhoe) = wd(i, j, k, irhoe) + tempd
   wd(i, j, k, irho) = wd(i, j, k, irho) - half*v2*tempd
   v2d = -(half*w(i, j, k, irho)*tempd)
   pd(i, j, k) = 0.0_8
   wd(i, j, k, ivx) = wd(i, j, k, ivx) + 2*w(i, j, k, ivx)*v2d
   wd(i, j, k, ivy) = wd(i, j, k, ivy) + 2*w(i, j, k, ivy)*v2d
   wd(i, j, k, ivz) = wd(i, j, k, ivz) + 2*w(i, j, k, ivz)*v2d
   END DO
   END SUBROUTINE COMPUTEPRESSURESIMPLE_FAST_B
