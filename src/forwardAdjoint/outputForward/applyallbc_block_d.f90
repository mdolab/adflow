   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.7 (r4786) - 21 Feb 2013 15:53
   !
   !  Differentiation of applyallbc_block in forward (tangent) mode (with options i4 dr8 r8):
   !   variations   of useful results: *rev *bvtj1 *bvtj2 *p *gamma
   !                *bmtk1 *w *bmtk2 *rlv *bvtk1 *bvtk2 *bmti1 *bmti2
   !                *bvti1 *bvti2 *bmtj1 *bmtj2 (global)pointref[1:3]
   !   with respect to varying inputs: *rev *p *s *w *rlv *si *sj
   !                *sk *(*bcdata.norm) *(*bcdata.rface) winf pinfcorr
   !                rgas (global)pointref[1:3]
   !   Plus diff mem management of: rev:in bvtj1:in bvtj2:in p:in
   !                gamma:in bmtk1:in w:in bmtk2:in rlv:in bvtk1:in
   !                bvtk2:in bmti1:in bmti2:in si:in sj:in sk:in bvti1:in
   !                bvti2:in bmtj1:in bmtj2:in bcdata:in *bcdata.norm:in
   !                *bcdata.rface:in
   SUBROUTINE APPLYALLBC_BLOCK_D(secondhalo)
   USE FLOWVARREFSTATE
   USE BLOCKPOINTERS_D
   USE INPUTTIMESPECTRAL
   USE INPUTDISCRETIZATION
   USE ITERATION
   IMPLICIT NONE
   ! Domain-interface boundary conditions,
   ! when coupled with other solvers.
   ! Apply BC's for a single block
   !
   !      Subroutine arguments.
   !
   LOGICAL, INTENT(IN) :: secondhalo
   !
   !      Local variables.
   !
   INTEGER(kind=inttype) :: nn, sps
   LOGICAL :: correctfork
   !
   ! Determine whether or not the total energy must be corrected
   ! for the presence of the turbulent kinetic energy.
   IF (kpresent) THEN
   IF (currentlevel .LE. groundlevel .OR. turbcoupled) THEN
   correctfork = .true.
   ELSE
   correctfork = .false.
   END IF
   ELSE
   correctfork = .false.
   END IF
   ! Apply all the boundary conditions. The order is important.
   ! The symmetry boundary conditions.
   CALL BCSYMM_D(secondhalo)
   !call bcEulerWall(secondHalo, correctForK)
   ! The viscous wall boundary conditions.
   CALL BCNSWALLADIABATIC_D(secondhalo, correctfork)
   CALL BCNSWALLISOTHERMAL_D(secondhalo, correctfork)
   ! The farfield is a special case, because the treatment
   ! differs when preconditioning is used. Make that distinction
   ! and call the appropriate routine.
   SELECT CASE  (precond) 
   CASE (noprecond) 
   CALL BCFARFIELD_D(secondhalo, correctfork)
   CASE (turkel) 
   CALL TERMINATE('applyAllBC', &
   &                'Farfield Turkel preconditioner not implemented')
   CASE (choimerkle) 
   CALL TERMINATE('applyAllBC', &
   &               'Farfield Choi and Merkle preconditioner not implemented'&
   &               )
   END SELECT
   ! Subsonic outflow and bleed outflow boundaries.
   ! Inviscid wall boundary conditions.
   CALL BCEULERWALL_D(secondhalo, correctfork)
   END SUBROUTINE APPLYALLBC_BLOCK_D
