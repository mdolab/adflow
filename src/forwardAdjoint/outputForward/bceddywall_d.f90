   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53
   !
   !  Differentiation of bceddywall in forward (tangent) mode (with options i4 dr8 r8):
   !   variations   of useful results: *rev
   !   with respect to varying inputs: *rev
   !   Plus diff mem management of: rev:in bcdata:in
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          bcEddyWall.f90                                  *
   !      * Author:        Georgi Kalitzin, Edwin van der Weide            *
   !      * Starting date: 06-11-2003                                      *
   !      * Last modified: 04-11-2005                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE BCEDDYWALL_D(nn)
   !
   !      ******************************************************************
   !      *                                                                *
   !      * bcEddyWall sets the eddy viscosity in the halo cells of        *
   !      * viscous subface nn of the block given in blockPointers.        *
   !      * As the eddy viscosity is zero at the wall, the value in the    *
   !      * halo is simply the negative value of the first interior cell.  *
   !      *                                                                *
   !      ******************************************************************
   !
   USE BLOCKPOINTERS_D
   USE BCTYPES
   IMPLICIT NONE
   !
   !      Subroutine arguments.
   !
   INTEGER(kind=inttype), INTENT(IN) :: nn
   !
   !      Local variables.
   !
   INTEGER(kind=inttype) :: i, j
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Begin execution                                                *
   !      *                                                                *
   !      ******************************************************************
   !
   ! Determine the face id on which the subface is located and
   ! loop over the faces of the subface and set the eddy viscosity
   ! in the halo cells.
   SELECT CASE  (bcfaceid(nn)) 
   CASE (imin) 
   DO j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
   DO i=bcdata(nn)%icbeg,bcdata(nn)%icend
   revd(1, i, j) = -revd(2, i, j)
   rev(1, i, j) = -rev(2, i, j)
   END DO
   END DO
   CASE (imax) 
   DO j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
   DO i=bcdata(nn)%icbeg,bcdata(nn)%icend
   revd(ie, i, j) = -revd(il, i, j)
   rev(ie, i, j) = -rev(il, i, j)
   END DO
   END DO
   CASE (jmin) 
   DO j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
   DO i=bcdata(nn)%icbeg,bcdata(nn)%icend
   revd(i, 1, j) = -revd(i, 2, j)
   rev(i, 1, j) = -rev(i, 2, j)
   END DO
   END DO
   CASE (jmax) 
   DO j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
   DO i=bcdata(nn)%icbeg,bcdata(nn)%icend
   revd(i, je, j) = -revd(i, jl, j)
   rev(i, je, j) = -rev(i, jl, j)
   END DO
   END DO
   CASE (kmin) 
   DO j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
   DO i=bcdata(nn)%icbeg,bcdata(nn)%icend
   revd(i, j, 1) = -revd(i, j, 2)
   rev(i, j, 1) = -rev(i, j, 2)
   END DO
   END DO
   CASE (kmax) 
   DO j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
   DO i=bcdata(nn)%icbeg,bcdata(nn)%icend
   revd(i, j, ke) = -revd(i, j, kl)
   rev(i, j, ke) = -rev(i, j, kl)
   END DO
   END DO
   END SELECT
   END SUBROUTINE BCEDDYWALL_D
