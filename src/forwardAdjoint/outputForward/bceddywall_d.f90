!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of bceddywall in forward (tangent) mode (with options i4 dr8 r8):
!   variations   of useful results: *rev
!   with respect to varying inputs: *rev
!   plus diff mem management of: rev:in bcdata:in
!
!      ******************************************************************
!      *                                                                *
!      * file:          bceddywall.f90                                  *
!      * author:        georgi kalitzin, edwin van der weide            *
!      * starting date: 06-11-2003                                      *
!      * last modified: 04-11-2005                                      *
!      *                                                                *
!      ******************************************************************
!
subroutine bceddywall_d(nn)
!
!      ******************************************************************
!      *                                                                *
!      * bceddywall sets the eddy viscosity in the halo cells of        *
!      * viscous subface nn of the block given in blockpointers.        *
!      * as the eddy viscosity is zero at the wall, the value in the    *
!      * halo is simply the negative value of the first interior cell.  *
!      *                                                                *
!      ******************************************************************
!
  use blockpointers
  use bctypes
  implicit none
!
!      subroutine arguments.
!
  integer(kind=inttype), intent(in) :: nn
!
!      local variables.
!
  integer(kind=inttype) :: i, j
!
!      ******************************************************************
!      *                                                                *
!      * begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! determine the face id on which the subface is located and
! loop over the faces of the subface and set the eddy viscosity
! in the halo cells.
  select case  (bcfaceid(nn)) 
  case (imin) 
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        revd(1, i, j) = -revd(2, i, j)
        rev(1, i, j) = -rev(2, i, j)
      end do
    end do
  case (imax) 
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        revd(ie, i, j) = -revd(il, i, j)
        rev(ie, i, j) = -rev(il, i, j)
      end do
    end do
  case (jmin) 
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        revd(i, 1, j) = -revd(i, 2, j)
        rev(i, 1, j) = -rev(i, 2, j)
      end do
    end do
  case (jmax) 
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        revd(i, je, j) = -revd(i, jl, j)
        rev(i, je, j) = -rev(i, jl, j)
      end do
    end do
  case (kmin) 
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        revd(i, j, 1) = -revd(i, j, 2)
        rev(i, j, 1) = -rev(i, j, 2)
      end do
    end do
  case (kmax) 
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        revd(i, j, ke) = -revd(i, j, kl)
        rev(i, j, ke) = -rev(i, j, kl)
      end do
    end do
  end select
end subroutine bceddywall_d
