!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of computeleastsquaresregression in forward (tangent) mode (with options i4 dr8 r8):
!   variations   of useful results: m b
!   with respect to varying inputs: y
!
!      ******************************************************************
!      *                                                                *
!      * file:          computeleastsquaresregression.f90               *
!      * author:        c.a.(sandy) mader                               *
!      * starting date: 10-14-2009                                      *
!      * last modified: 10-14-2009                                      *
!      *                                                                *
!      ******************************************************************
!
subroutine computeleastsquaresregression_d(y, yd, x, npts, m, md, b, bd)
!
!      ******************************************************************
!      *                                                                *
!      * computes the slope of best fit for a set of x,y data of length *
!      * npts                                                           *
!      *                                                                *
!      ******************************************************************
!
  use precision
  implicit none
!subroutine arguments 
  integer(kind=inttype) :: npts
  real(kind=realtype), dimension(npts) :: x, y
  real(kind=realtype), dimension(npts) :: yd
  real(kind=realtype) :: m, b
  real(kind=realtype) :: md, bd
!local variables
  real(kind=realtype) :: sumx, sumy, sumx2, sumxy
  real(kind=realtype) :: sumyd, sumxyd
  integer(kind=inttype) :: i
!begin execution
  sumx = 0.0
  sumy = 0.0
  sumx2 = 0.0
  sumxy = 0.0
  sumyd = 0.0_8
  sumxyd = 0.0_8
  do i=1,npts
    sumx = sumx + x(i)
    sumyd = sumyd + yd(i)
    sumy = sumy + y(i)
    sumx2 = sumx2 + x(i)*x(i)
    sumxyd = sumxyd + x(i)*yd(i)
    sumxy = sumxy + x(i)*y(i)
  end do
  md = (npts*sumxyd-sumx*sumyd)/(npts*sumx2-sumx**2)
  m = (npts*sumxy-sumy*sumx)/(npts*sumx2-sumx**2)
  bd = (sumx2*sumyd-sumx*sumxyd)/(npts*sumx2-sumx**2)
  b = (sumy*sumx2-sumx*sumxy)/(npts*sumx2-sumx**2)
end subroutine computeleastsquaresregression_d
