   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53
   !
   !  Differentiation of computerootbendingmoment in forward (tangent) mode (with options i4 dr8 r8):
   !   variations   of useful results: bendingmoment
   !   with respect to varying inputs: lengthref pointref cf cm
   !
   !****************************************************
   !
   !   Filename: rootBendingMomentAnalysis.f90
   !   Author: C.A.(Sandy) Mader
   !   Date Started: July 10, 2011
   !   Date Modified: July 10,2011
   !
   !****************************************************
   SUBROUTINE COMPUTEROOTBENDINGMOMENT_D(cf, cfd, cm, cmd, liftindex, &
   & bendingmoment, bendingmomentd)
   !*******************************************************
   !                                                      *
   ! Compute a normalized bending moment coefficient from *
   ! the force and moment coefficient. At the moment this *
   ! Routine only works for a half body. Additional logic *
   ! would be needed for a full body.                     *
   !                                                      *
   !*******************************************************
   USE INPUTPHYSICS
   USE COSTFUNCTIONS
   USE COMMUNICATION
   USE INPUTITERATION
   IMPLICIT NONE
   !input/output variables
   REAL(kind=realtype), DIMENSION(3), INTENT(IN) :: cf, cm
   REAL(kind=realtype), DIMENSION(3), INTENT(IN) :: cfd, cmd
   INTEGER(kind=inttype), INTENT(IN) :: liftindex
   REAL(kind=realtype), INTENT(OUT) :: bendingmoment
   REAL(kind=realtype), INTENT(OUT) :: bendingmomentd
   !Subroutine Variables
   REAL(kind=realtype) :: elasticmomentx, elasticmomenty, elasticmomentz
   REAL(kind=realtype) :: elasticmomentxd, elasticmomentyd, &
   & elasticmomentzd
   INTRINSIC SQRT
   REAL(kind=realtype) :: arg1
   REAL(kind=realtype) :: arg1d
   bendingmoment = zero
   IF (liftindex .EQ. 2) THEN
   !z out wing sum momentx,momentz
   elasticmomentxd = cmd(1) + ((cfd(2)*(pointrefec(3)-pointref(3))-cf(2&
   &     )*pointrefd(3))*lengthref-cf(2)*(pointrefec(3)-pointref(3))*&
   &     lengthrefd)/lengthref**2 - ((cfd(3)*(pointrefec(2)-pointref(2))-cf&
   &     (3)*pointrefd(2))*lengthref-cf(3)*(pointrefec(2)-pointref(2))*&
   &     lengthrefd)/lengthref**2
   elasticmomentx = cm(1) + cf(2)*(pointrefec(3)-pointref(3))/lengthref&
   &     - cf(3)*(pointrefec(2)-pointref(2))/lengthref
   elasticmomentzd = cmd(3) - ((cfd(2)*(pointrefec(1)-pointref(1))-cf(2&
   &     )*pointrefd(1))*lengthref-cf(2)*(pointrefec(1)-pointref(1))*&
   &     lengthrefd)/lengthref**2 + ((cfd(1)*(pointrefec(2)-pointref(2))-cf&
   &     (1)*pointrefd(2))*lengthref-cf(1)*(pointrefec(2)-pointref(2))*&
   &     lengthrefd)/lengthref**2
   elasticmomentz = cm(3) - cf(2)*(pointrefec(1)-pointref(1))/lengthref&
   &     + cf(1)*(pointrefec(2)-pointref(2))/lengthref
   arg1d = 2*elasticmomentx*elasticmomentxd + 2*elasticmomentz*&
   &     elasticmomentzd
   arg1 = elasticmomentx**2 + elasticmomentz**2
   IF (arg1 .EQ. 0.0_8) THEN
   bendingmomentd = 0.0_8
   ELSE
   bendingmomentd = arg1d/(2.0*SQRT(arg1))
   END IF
   bendingmoment = SQRT(arg1)
   ELSE IF (liftindex .EQ. 3) THEN
   !y out wing sum momentx,momenty
   elasticmomentxd = cmd(1) + ((cfd(3)*(pointrefec(2)-pointref(2))-cf(3&
   &     )*pointrefd(2))*lengthref-cf(3)*(pointrefec(2)-pointref(2))*&
   &     lengthrefd)/lengthref**2 + ((cfd(3)*(pointrefec(3)-pointref(3))-cf&
   &     (3)*pointrefd(3))*lengthref-cf(3)*(pointrefec(3)-pointref(3))*&
   &     lengthrefd)/lengthref**2
   elasticmomentx = cm(1) + cf(3)*(pointrefec(2)-pointref(2))/lengthref&
   &     + cf(3)*(pointrefec(3)-pointref(3))/lengthref
   elasticmomentyd = cmd(2) + ((cfd(3)*(pointrefec(1)-pointref(1))-cf(3&
   &     )*pointrefd(1))*lengthref-cf(3)*(pointrefec(1)-pointref(1))*&
   &     lengthrefd)/lengthref**2 + ((cfd(1)*(pointrefec(3)-pointref(3))-cf&
   &     (1)*pointrefd(3))*lengthref-cf(1)*(pointrefec(3)-pointref(3))*&
   &     lengthrefd)/lengthref**2
   elasticmomenty = cm(2) + cf(3)*(pointrefec(1)-pointref(1))/lengthref&
   &     + cf(1)*(pointrefec(3)-pointref(3))/lengthref
   arg1d = 2*elasticmomentx*elasticmomentxd + 2*elasticmomenty*&
   &     elasticmomentyd
   arg1 = elasticmomentx**2 + elasticmomenty**2
   IF (arg1 .EQ. 0.0_8) THEN
   bendingmomentd = 0.0_8
   ELSE
   bendingmomentd = arg1d/(2.0*SQRT(arg1))
   END IF
   bendingmoment = SQRT(arg1)
   ELSE
   bendingmomentd = 0.0_8
   END IF
   END SUBROUTINE COMPUTEROOTBENDINGMOMENT_D
