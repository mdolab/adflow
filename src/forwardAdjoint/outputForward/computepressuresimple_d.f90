!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of computepressuresimple in forward (tangent) mode (with options i4 dr8 r8):
!   variations   of useful results: *p
!   with respect to varying inputs: pinfcorr *w
!   plus diff mem management of: p:in w:in
! compute the pressure on a block with the pointers already set. this
! routine is used by the forward mode ad code only. 
subroutine computepressuresimple_d()
  use blockpointers
  use flowvarrefstate
  use inputphysics
  implicit none
! local variables
  integer(kind=inttype) :: i, j, k, ii
  real(kind=realtype) :: gm1, v2
  real(kind=realtype) :: v2d
  intrinsic max
! compute the pressures
  gm1 = gammaconstant - one
  pd = 0.0_8
  do k=0,kb
    do j=0,jb
      do i=0,ib
        v2d = 2*w(i, j, k, ivx)*wd(i, j, k, ivx) + 2*w(i, j, k, ivy)*wd(&
&         i, j, k, ivy) + 2*w(i, j, k, ivz)*wd(i, j, k, ivz)
        v2 = w(i, j, k, ivx)**2 + w(i, j, k, ivy)**2 + w(i, j, k, ivz)**&
&         2
        pd(i, j, k) = gm1*(wd(i, j, k, irhoe)-half*(wd(i, j, k, irho)*v2&
&         +w(i, j, k, irho)*v2d))
        p(i, j, k) = gm1*(w(i, j, k, irhoe)-half*w(i, j, k, irho)*v2)
        if (p(i, j, k) .lt. 1.e-4_realtype*pinfcorr) then
          pd(i, j, k) = 1.e-4_realtype*pinfcorrd
          p(i, j, k) = 1.e-4_realtype*pinfcorr
        else
          p(i, j, k) = p(i, j, k)
        end if
      end do
    end do
  end do
end subroutine computepressuresimple_d
