   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53
   !
   !  Differentiation of computepressuresimple in forward (tangent) mode (with options i4 dr8 r8):
   !   variations   of useful results: *p
   !   with respect to varying inputs: pinfcorr *w
   !   Plus diff mem management of: p:in w:in
   ! Compute the pressure on a block with the pointers already set. This
   ! routine is used by the forward mode AD code only. 
   SUBROUTINE COMPUTEPRESSURESIMPLE_D()
   USE BLOCKPOINTERS
   USE FLOWVARREFSTATE
   USE INPUTPHYSICS
   IMPLICIT NONE
   ! Local Variables
   INTEGER(kind=inttype) :: i, j, k, ii
   REAL(kind=realtype) :: gm1, v2
   REAL(kind=realtype) :: v2d
   INTRINSIC MAX
   ! Compute the pressures
   gm1 = gammaconstant - one
   pd = 0.0_8
   DO k=0,kb
   DO j=0,jb
   DO i=0,ib
   v2d = 2*w(i, j, k, ivx)*wd(i, j, k, ivx) + 2*w(i, j, k, ivy)*wd(&
   &         i, j, k, ivy) + 2*w(i, j, k, ivz)*wd(i, j, k, ivz)
   v2 = w(i, j, k, ivx)**2 + w(i, j, k, ivy)**2 + w(i, j, k, ivz)**&
   &         2
   pd(i, j, k) = gm1*(wd(i, j, k, irhoe)-half*(wd(i, j, k, irho)*v2&
   &         +w(i, j, k, irho)*v2d))
   p(i, j, k) = gm1*(w(i, j, k, irhoe)-half*w(i, j, k, irho)*v2)
   IF (p(i, j, k) .LT. 1.e-4_realType*pinfcorr) THEN
   pd(i, j, k) = 1.e-4_realType*pinfcorrd
   p(i, j, k) = 1.e-4_realType*pinfcorr
   ELSE
   p(i, j, k) = p(i, j, k)
   END IF
   END DO
   END DO
   END DO
   END SUBROUTINE COMPUTEPRESSURESIMPLE_D
