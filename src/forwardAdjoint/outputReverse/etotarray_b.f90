!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of etotarray in reverse (adjoint) mode (with options i4 dr8 r8 noisize):
!   gradient     of useful results: p etot rho (global)tref (global)rgas
!   with respect to varying inputs: k p u v w etot rho (global)tref
!                (global)rgas
!      ==================================================================
subroutine etotarray_b(rho, rhod, u, ud, v, vd, w, wd, p, pd, k, kd, &
& etot, etotd, correctfork, kk)
!
!      ******************************************************************
!      *                                                                *
!      * etotarray computes the total energy from the given density,    *
!      * velocity and presssure for the given kk elements of the arrays.*
!      * first the internal energy per unit mass is computed and after  *
!      * that the kinetic energy is added as well the conversion to     *
!      * energy per unit volume.                                        *
!      *                                                                *
!      ******************************************************************
!
  use constants
  implicit none
  integer(kind=inttype), intent(in) :: kk
!
!      subroutine arguments.
!
  real(kind=realtype), dimension(kk), intent(in) :: rho, p, k
  real(kind=realtype), dimension(kk) :: rhod, pd, kd
  real(kind=realtype), dimension(kk), intent(in) :: u, v, w
  real(kind=realtype), dimension(kk) :: ud, vd, wd
  real(kind=realtype), dimension(kk) :: etot
  real(kind=realtype), dimension(kk) :: etotd
  logical, intent(in) :: correctfork
!
!      local variables.
!
  integer(kind=inttype) :: i
  real(kind=realtype) :: tempd
!
!      ******************************************************************
!      *                                                                *
!      * begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! compute the internal energy for unit mass.
  call pushreal8array(etot, kk)
  call eintarray(rho, p, k, etot, correctfork, kk)
  ud = 0.0_8
  vd = 0.0_8
  wd = 0.0_8
  do i=kk,1,-1
    tempd = rho(i)*half*etotd(i)
    rhod(i) = rhod(i) + (etot(i)+half*(u(i)**2+v(i)**2+w(i)**2))*etotd(i&
&     )
    ud(i) = ud(i) + 2*u(i)*tempd
    vd(i) = vd(i) + 2*v(i)*tempd
    wd(i) = wd(i) + 2*w(i)*tempd
    etotd(i) = rho(i)*etotd(i)
  end do
  call popreal8array(etot, kk)
  call eintarray_b(rho, rhod, p, pd, k, kd, etot, etotd, correctfork, kk&
&           )
end subroutine etotarray_b
