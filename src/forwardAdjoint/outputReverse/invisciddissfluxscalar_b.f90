   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53
   !
   !  Differentiation of invisciddissfluxscalar in reverse (adjoint) mode (with options i4 dr8 r8 noISIZE):
   !   gradient     of useful results: *w
   !   with respect to varying inputs: *p *w
   !   Plus diff mem management of: p:in w:in
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          inviscidDissFluxScalar.f90                      *
   !      * Author:        Edwin van der Weide                             *
   !      * Starting date: 03-24-2003                                      *
   !      * Last modified: 10-29-2007                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE INVISCIDDISSFLUXSCALAR_B()
   !
   !      ******************************************************************
   !      *                                                                *
   !      * inviscidDissFluxScalar computes the scalar artificial          *
   !      * dissipation, see AIAA paper 81-1259, for a given block.        *
   !      * Therefore it is assumed that the pointers in  blockPointers    *
   !      * already point to the correct block.                            *
   !      *                                                                *
   !      ******************************************************************
   !
   USE BLOCKPOINTERS_B
   USE CGNSGRID
   USE CONSTANTS
   USE FLOWVARREFSTATE
   USE INPUTDISCRETIZATION
   USE INPUTPHYSICS
   USE ITERATION
   IMPLICIT NONE
   !
   !      Local parameter.
   !
   REAL(kind=realtype), PARAMETER :: dssmax=0.25_realType
   !
   !      Local variables.
   !
   INTEGER(kind=inttype) :: i, j, k, ind
   REAL(kind=realtype) :: sslim, rhoi
   REAL(kind=realtype) :: rhoib
   REAL(kind=realtype) :: sfil, fis2, fis4
   REAL(kind=realtype) :: ppor, rrad, dis2, dis4
   REAL(kind=realtype) :: dss1, dss2, ddw, fs
   REAL(kind=realtype), DIMENSION(0:ib, 0:jb, 0:kb) :: ss
   INTRINSIC ABS
   INTRINSIC MAX
   INTRINSIC MIN
   REAL(kind=realtype) :: DIM
   REAL(kind=realtype) :: arg1
   REAL(kind=realtype) :: tmp
   REAL(kind=realtype) :: tmp0
   REAL(kind=realtype) :: tmp1
   REAL(kind=realtype) :: tmp2
   REAL(kind=realtype) :: tmp3
   REAL(kind=realtype) :: tmp4
   REAL(kind=realtype) :: tmp5
   REAL(kind=realtype) :: tmp6
   REAL(kind=realtype) :: tmp7
   REAL(kind=realtype) :: tmp8
   REAL(kind=realtype) :: tmp9
   REAL(kind=realtype) :: tmp10
   REAL(kind=realtype) :: tmp11
   REAL(kind=realtype) :: tmp12
   REAL(kind=realtype) :: tmp13
   REAL(kind=realtype) :: tmp14
   REAL(kind=realtype) :: tmp15
   REAL(kind=realtype) :: tmp16
   REAL(kind=realtype) :: tmp17
   REAL(kind=realtype) :: tmp18
   REAL(kind=realtype) :: tmp19
   REAL(kind=realtype) :: tmp20
   REAL(kind=realtype) :: tmp21
   REAL(kind=realtype) :: tmp22
   REAL(kind=realtype) :: tmp23
   REAL(kind=realtype) :: tmp24
   REAL(kind=realtype) :: tmp25
   REAL(kind=realtype) :: temp3
   REAL(kind=realtype) :: temp2
   REAL(kind=realtype) :: temp1
   REAL(kind=realtype) :: temp0
   REAL(kind=realtype) :: min6
   REAL(kind=realtype) :: min5
   REAL(kind=realtype) :: min4
   REAL(kind=realtype) :: min3
   REAL(kind=realtype) :: min2
   REAL(kind=realtype) :: min1
   REAL(kind=realtype) :: tmpb9
   REAL(kind=realtype) :: tmpb25
   REAL(kind=realtype) :: tmpb8
   REAL(kind=realtype) :: tmpb24
   REAL(kind=realtype) :: tmpb7
   REAL(kind=realtype) :: tmpb23
   REAL(kind=realtype) :: tmpb6
   REAL(kind=realtype) :: tmpb22
   REAL(kind=realtype) :: tmpb5
   REAL(kind=realtype) :: tmpb21
   REAL(kind=realtype) :: tmpb4
   REAL(kind=realtype) :: tmpb20
   REAL(kind=realtype) :: tmpb3
   REAL(kind=realtype) :: tmpb
   REAL(kind=realtype) :: tmpb2
   REAL(kind=realtype) :: x6
   REAL(kind=realtype) :: tmpb1
   REAL(kind=realtype) :: x5
   REAL(kind=realtype) :: tmpb0
   REAL(kind=realtype) :: x4
   REAL(kind=realtype) :: x3
   REAL(kind=realtype) :: x2
   REAL(kind=realtype) :: x1
   REAL(kind=realtype) :: tmpb19
   REAL(kind=realtype) :: tmpb18
   REAL(kind=realtype) :: tmpb17
   REAL(kind=realtype) :: tmpb16
   REAL(kind=realtype) :: tmpb15
   REAL(kind=realtype) :: tmpb14
   REAL(kind=realtype) :: tmpb13
   REAL(kind=realtype) :: tmpb12
   REAL(kind=realtype) :: tmpb11
   REAL(kind=realtype) :: tmpb10
   REAL(kind=realtype) :: abs0
   REAL(kind=realtype) :: temp
   REAL(kind=realtype) :: y6
   REAL(kind=realtype) :: y5
   REAL(kind=realtype) :: y4
   REAL(kind=realtype) :: temp7
   REAL(kind=realtype) :: y3
   REAL(kind=realtype) :: temp6
   REAL(kind=realtype) :: y2
   REAL(kind=realtype) :: temp5
   REAL(kind=realtype) :: y1
   REAL(kind=realtype) :: temp4
   IF (rfil .GE. 0.) THEN
   abs0 = rfil
   ELSE
   abs0 = -rfil
   END IF
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Begin execution                                                *
   !      *                                                                *
   !      ******************************************************************
   !
   ! Check if rFil == 0. If so, the dissipative flux needs not to
   ! be computed.
   IF (abs0 .LT. thresholdreal) THEN
   pb = 0.0_8
   ELSE
   ! Replace the total energy by rho times the total enthalpy.
   ! In this way the numerical solution is total enthalpy preserving
   ! for the steady Euler equations. Also replace the velocities by
   ! the momentum. Only done for the entries used in the
   ! discretization, i.e. ignore the corner halo's.
   DO k=0,kb
   DO j=2,jl
   DO i=2,il
   tmp = w(i, j, k, irho)*w(i, j, k, ivx)
   CALL PUSHREAL8(w(i, j, k, ivx))
   w(i, j, k, ivx) = tmp
   tmp0 = w(i, j, k, irho)*w(i, j, k, ivy)
   CALL PUSHREAL8(w(i, j, k, ivy))
   w(i, j, k, ivy) = tmp0
   tmp1 = w(i, j, k, irho)*w(i, j, k, ivz)
   CALL PUSHREAL8(w(i, j, k, ivz))
   w(i, j, k, ivz) = tmp1
   CALL PUSHREAL8(w(i, j, k, irhoe))
   w(i, j, k, irhoe) = w(i, j, k, irhoe) + p(i, j, k)
   END DO
   END DO
   END DO
   DO k=2,kl
   DO j=2,jl
   tmp2 = w(0, j, k, irho)*w(0, j, k, ivx)
   CALL PUSHREAL8(w(0, j, k, ivx))
   w(0, j, k, ivx) = tmp2
   tmp3 = w(0, j, k, irho)*w(0, j, k, ivy)
   CALL PUSHREAL8(w(0, j, k, ivy))
   w(0, j, k, ivy) = tmp3
   tmp4 = w(0, j, k, irho)*w(0, j, k, ivz)
   CALL PUSHREAL8(w(0, j, k, ivz))
   w(0, j, k, ivz) = tmp4
   CALL PUSHREAL8(w(0, j, k, irhoe))
   w(0, j, k, irhoe) = w(0, j, k, irhoe) + p(0, j, k)
   tmp5 = w(1, j, k, irho)*w(1, j, k, ivx)
   CALL PUSHREAL8(w(1, j, k, ivx))
   w(1, j, k, ivx) = tmp5
   tmp6 = w(1, j, k, irho)*w(1, j, k, ivy)
   CALL PUSHREAL8(w(1, j, k, ivy))
   w(1, j, k, ivy) = tmp6
   tmp7 = w(1, j, k, irho)*w(1, j, k, ivz)
   CALL PUSHREAL8(w(1, j, k, ivz))
   w(1, j, k, ivz) = tmp7
   CALL PUSHREAL8(w(1, j, k, irhoe))
   w(1, j, k, irhoe) = w(1, j, k, irhoe) + p(1, j, k)
   tmp8 = w(ie, j, k, irho)*w(ie, j, k, ivx)
   CALL PUSHREAL8(w(ie, j, k, ivx))
   w(ie, j, k, ivx) = tmp8
   tmp9 = w(ie, j, k, irho)*w(ie, j, k, ivy)
   CALL PUSHREAL8(w(ie, j, k, ivy))
   w(ie, j, k, ivy) = tmp9
   tmp10 = w(ie, j, k, irho)*w(ie, j, k, ivz)
   CALL PUSHREAL8(w(ie, j, k, ivz))
   w(ie, j, k, ivz) = tmp10
   CALL PUSHREAL8(w(ie, j, k, irhoe))
   w(ie, j, k, irhoe) = w(ie, j, k, irhoe) + p(ie, j, k)
   tmp11 = w(ib, j, k, irho)*w(ib, j, k, ivx)
   CALL PUSHREAL8(w(ib, j, k, ivx))
   w(ib, j, k, ivx) = tmp11
   tmp12 = w(ib, j, k, irho)*w(ib, j, k, ivy)
   CALL PUSHREAL8(w(ib, j, k, ivy))
   w(ib, j, k, ivy) = tmp12
   tmp13 = w(ib, j, k, irho)*w(ib, j, k, ivz)
   CALL PUSHREAL8(w(ib, j, k, ivz))
   w(ib, j, k, ivz) = tmp13
   CALL PUSHREAL8(w(ib, j, k, irhoe))
   w(ib, j, k, irhoe) = w(ib, j, k, irhoe) + p(ib, j, k)
   END DO
   END DO
   DO k=2,kl
   DO i=2,il
   tmp14 = w(i, 0, k, irho)*w(i, 0, k, ivx)
   CALL PUSHREAL8(w(i, 0, k, ivx))
   w(i, 0, k, ivx) = tmp14
   tmp15 = w(i, 0, k, irho)*w(i, 0, k, ivy)
   CALL PUSHREAL8(w(i, 0, k, ivy))
   w(i, 0, k, ivy) = tmp15
   tmp16 = w(i, 0, k, irho)*w(i, 0, k, ivz)
   CALL PUSHREAL8(w(i, 0, k, ivz))
   w(i, 0, k, ivz) = tmp16
   CALL PUSHREAL8(w(i, 0, k, irhoe))
   w(i, 0, k, irhoe) = w(i, 0, k, irhoe) + p(i, 0, k)
   tmp17 = w(i, 1, k, irho)*w(i, 1, k, ivx)
   CALL PUSHREAL8(w(i, 1, k, ivx))
   w(i, 1, k, ivx) = tmp17
   tmp18 = w(i, 1, k, irho)*w(i, 1, k, ivy)
   CALL PUSHREAL8(w(i, 1, k, ivy))
   w(i, 1, k, ivy) = tmp18
   tmp19 = w(i, 1, k, irho)*w(i, 1, k, ivz)
   CALL PUSHREAL8(w(i, 1, k, ivz))
   w(i, 1, k, ivz) = tmp19
   CALL PUSHREAL8(w(i, 1, k, irhoe))
   w(i, 1, k, irhoe) = w(i, 1, k, irhoe) + p(i, 1, k)
   tmp20 = w(i, je, k, irho)*w(i, je, k, ivx)
   CALL PUSHREAL8(w(i, je, k, ivx))
   w(i, je, k, ivx) = tmp20
   tmp21 = w(i, je, k, irho)*w(i, je, k, ivy)
   CALL PUSHREAL8(w(i, je, k, ivy))
   w(i, je, k, ivy) = tmp21
   tmp22 = w(i, je, k, irho)*w(i, je, k, ivz)
   CALL PUSHREAL8(w(i, je, k, ivz))
   w(i, je, k, ivz) = tmp22
   CALL PUSHREAL8(w(i, je, k, irhoe))
   w(i, je, k, irhoe) = w(i, je, k, irhoe) + p(i, je, k)
   tmp23 = w(i, jb, k, irho)*w(i, jb, k, ivx)
   CALL PUSHREAL8(w(i, jb, k, ivx))
   w(i, jb, k, ivx) = tmp23
   tmp24 = w(i, jb, k, irho)*w(i, jb, k, ivy)
   CALL PUSHREAL8(w(i, jb, k, ivy))
   w(i, jb, k, ivy) = tmp24
   tmp25 = w(i, jb, k, irho)*w(i, jb, k, ivz)
   CALL PUSHREAL8(w(i, jb, k, ivz))
   w(i, jb, k, ivz) = tmp25
   CALL PUSHREAL8(w(i, jb, k, irhoe))
   w(i, jb, k, irhoe) = w(i, jb, k, irhoe) + p(i, jb, k)
   END DO
   END DO
   ! Replace rho times the total enthalpy by the total energy and
   ! store the velocities again instead of the momentum. Only for
   ! those entries that have been altered, i.e. ignore the
   ! corner halo's.
   DO k=0,kb
   DO j=2,jl
   DO i=2,il
   CALL PUSHREAL8(rhoi)
   rhoi = one/w(i, j, k, irho)
   CALL PUSHREAL8(w(i, j, k, ivx))
   w(i, j, k, ivx) = w(i, j, k, ivx)*rhoi
   CALL PUSHREAL8(w(i, j, k, ivy))
   w(i, j, k, ivy) = w(i, j, k, ivy)*rhoi
   CALL PUSHREAL8(w(i, j, k, ivz))
   w(i, j, k, ivz) = w(i, j, k, ivz)*rhoi
   CALL PUSHREAL8(w(i, j, k, irhoe))
   w(i, j, k, irhoe) = w(i, j, k, irhoe) - p(i, j, k)
   END DO
   END DO
   END DO
   DO k=2,kl
   DO j=2,jl
   CALL PUSHREAL8(rhoi)
   rhoi = one/w(0, j, k, irho)
   CALL PUSHREAL8(w(0, j, k, ivx))
   w(0, j, k, ivx) = w(0, j, k, ivx)*rhoi
   CALL PUSHREAL8(w(0, j, k, ivy))
   w(0, j, k, ivy) = w(0, j, k, ivy)*rhoi
   CALL PUSHREAL8(w(0, j, k, ivz))
   w(0, j, k, ivz) = w(0, j, k, ivz)*rhoi
   CALL PUSHREAL8(w(0, j, k, irhoe))
   w(0, j, k, irhoe) = w(0, j, k, irhoe) - p(0, j, k)
   CALL PUSHREAL8(rhoi)
   rhoi = one/w(1, j, k, irho)
   CALL PUSHREAL8(w(1, j, k, ivx))
   w(1, j, k, ivx) = w(1, j, k, ivx)*rhoi
   CALL PUSHREAL8(w(1, j, k, ivy))
   w(1, j, k, ivy) = w(1, j, k, ivy)*rhoi
   CALL PUSHREAL8(w(1, j, k, ivz))
   w(1, j, k, ivz) = w(1, j, k, ivz)*rhoi
   CALL PUSHREAL8(w(1, j, k, irhoe))
   w(1, j, k, irhoe) = w(1, j, k, irhoe) - p(1, j, k)
   CALL PUSHREAL8(rhoi)
   rhoi = one/w(ie, j, k, irho)
   CALL PUSHREAL8(w(ie, j, k, ivx))
   w(ie, j, k, ivx) = w(ie, j, k, ivx)*rhoi
   CALL PUSHREAL8(w(ie, j, k, ivy))
   w(ie, j, k, ivy) = w(ie, j, k, ivy)*rhoi
   CALL PUSHREAL8(w(ie, j, k, ivz))
   w(ie, j, k, ivz) = w(ie, j, k, ivz)*rhoi
   CALL PUSHREAL8(w(ie, j, k, irhoe))
   w(ie, j, k, irhoe) = w(ie, j, k, irhoe) - p(ie, j, k)
   CALL PUSHREAL8(rhoi)
   rhoi = one/w(ib, j, k, irho)
   CALL PUSHREAL8(w(ib, j, k, ivx))
   w(ib, j, k, ivx) = w(ib, j, k, ivx)*rhoi
   CALL PUSHREAL8(w(ib, j, k, ivy))
   w(ib, j, k, ivy) = w(ib, j, k, ivy)*rhoi
   CALL PUSHREAL8(w(ib, j, k, ivz))
   w(ib, j, k, ivz) = w(ib, j, k, ivz)*rhoi
   CALL PUSHREAL8(w(ib, j, k, irhoe))
   w(ib, j, k, irhoe) = w(ib, j, k, irhoe) - p(ib, j, k)
   END DO
   END DO
   DO k=2,kl
   DO i=2,il
   CALL PUSHREAL8(rhoi)
   rhoi = one/w(i, 0, k, irho)
   CALL PUSHREAL8(w(i, 0, k, ivx))
   w(i, 0, k, ivx) = w(i, 0, k, ivx)*rhoi
   CALL PUSHREAL8(w(i, 0, k, ivy))
   w(i, 0, k, ivy) = w(i, 0, k, ivy)*rhoi
   CALL PUSHREAL8(w(i, 0, k, ivz))
   w(i, 0, k, ivz) = w(i, 0, k, ivz)*rhoi
   CALL PUSHREAL8(w(i, 0, k, irhoe))
   w(i, 0, k, irhoe) = w(i, 0, k, irhoe) - p(i, 0, k)
   CALL PUSHREAL8(rhoi)
   rhoi = one/w(i, 1, k, irho)
   CALL PUSHREAL8(w(i, 1, k, ivx))
   w(i, 1, k, ivx) = w(i, 1, k, ivx)*rhoi
   CALL PUSHREAL8(w(i, 1, k, ivy))
   w(i, 1, k, ivy) = w(i, 1, k, ivy)*rhoi
   CALL PUSHREAL8(w(i, 1, k, ivz))
   w(i, 1, k, ivz) = w(i, 1, k, ivz)*rhoi
   CALL PUSHREAL8(w(i, 1, k, irhoe))
   w(i, 1, k, irhoe) = w(i, 1, k, irhoe) - p(i, 1, k)
   CALL PUSHREAL8(rhoi)
   rhoi = one/w(i, je, k, irho)
   CALL PUSHREAL8(w(i, je, k, ivx))
   w(i, je, k, ivx) = w(i, je, k, ivx)*rhoi
   CALL PUSHREAL8(w(i, je, k, ivy))
   w(i, je, k, ivy) = w(i, je, k, ivy)*rhoi
   CALL PUSHREAL8(w(i, je, k, ivz))
   w(i, je, k, ivz) = w(i, je, k, ivz)*rhoi
   CALL PUSHREAL8(w(i, je, k, irhoe))
   w(i, je, k, irhoe) = w(i, je, k, irhoe) - p(i, je, k)
   CALL PUSHREAL8(rhoi)
   rhoi = one/w(i, jb, k, irho)
   CALL PUSHREAL8(w(i, jb, k, ivx))
   w(i, jb, k, ivx) = w(i, jb, k, ivx)*rhoi
   CALL PUSHREAL8(w(i, jb, k, ivy))
   w(i, jb, k, ivy) = w(i, jb, k, ivy)*rhoi
   CALL PUSHREAL8(w(i, jb, k, ivz))
   w(i, jb, k, ivz) = w(i, jb, k, ivz)*rhoi
   CALL PUSHREAL8(w(i, jb, k, irhoe))
   w(i, jb, k, irhoe) = w(i, jb, k, irhoe) - p(i, jb, k)
   END DO
   END DO
   pb = 0.0_8
   DO k=kl,2,-1
   DO i=il,2,-1
   CALL POPREAL8(w(i, jb, k, irhoe))
   pb(i, jb, k) = pb(i, jb, k) - wb(i, jb, k, irhoe)
   CALL POPREAL8(w(i, jb, k, ivz))
   rhoib = w(i, jb, k, ivz)*wb(i, jb, k, ivz)
   wb(i, jb, k, ivz) = rhoi*wb(i, jb, k, ivz)
   CALL POPREAL8(w(i, jb, k, ivy))
   rhoib = rhoib + w(i, jb, k, ivy)*wb(i, jb, k, ivy)
   wb(i, jb, k, ivy) = rhoi*wb(i, jb, k, ivy)
   CALL POPREAL8(w(i, jb, k, ivx))
   rhoib = rhoib + w(i, jb, k, ivx)*wb(i, jb, k, ivx)
   wb(i, jb, k, ivx) = rhoi*wb(i, jb, k, ivx)
   CALL POPREAL8(rhoi)
   temp7 = w(i, jb, k, irho)
   wb(i, jb, k, irho) = wb(i, jb, k, irho) - one*rhoib/temp7**2
   CALL POPREAL8(w(i, je, k, irhoe))
   pb(i, je, k) = pb(i, je, k) - wb(i, je, k, irhoe)
   CALL POPREAL8(w(i, je, k, ivz))
   rhoib = w(i, je, k, ivz)*wb(i, je, k, ivz)
   wb(i, je, k, ivz) = rhoi*wb(i, je, k, ivz)
   CALL POPREAL8(w(i, je, k, ivy))
   rhoib = rhoib + w(i, je, k, ivy)*wb(i, je, k, ivy)
   wb(i, je, k, ivy) = rhoi*wb(i, je, k, ivy)
   CALL POPREAL8(w(i, je, k, ivx))
   rhoib = rhoib + w(i, je, k, ivx)*wb(i, je, k, ivx)
   wb(i, je, k, ivx) = rhoi*wb(i, je, k, ivx)
   CALL POPREAL8(rhoi)
   temp6 = w(i, je, k, irho)
   wb(i, je, k, irho) = wb(i, je, k, irho) - one*rhoib/temp6**2
   CALL POPREAL8(w(i, 1, k, irhoe))
   pb(i, 1, k) = pb(i, 1, k) - wb(i, 1, k, irhoe)
   CALL POPREAL8(w(i, 1, k, ivz))
   rhoib = w(i, 1, k, ivz)*wb(i, 1, k, ivz)
   wb(i, 1, k, ivz) = rhoi*wb(i, 1, k, ivz)
   CALL POPREAL8(w(i, 1, k, ivy))
   rhoib = rhoib + w(i, 1, k, ivy)*wb(i, 1, k, ivy)
   wb(i, 1, k, ivy) = rhoi*wb(i, 1, k, ivy)
   CALL POPREAL8(w(i, 1, k, ivx))
   rhoib = rhoib + w(i, 1, k, ivx)*wb(i, 1, k, ivx)
   wb(i, 1, k, ivx) = rhoi*wb(i, 1, k, ivx)
   CALL POPREAL8(rhoi)
   temp5 = w(i, 1, k, irho)
   wb(i, 1, k, irho) = wb(i, 1, k, irho) - one*rhoib/temp5**2
   CALL POPREAL8(w(i, 0, k, irhoe))
   pb(i, 0, k) = pb(i, 0, k) - wb(i, 0, k, irhoe)
   CALL POPREAL8(w(i, 0, k, ivz))
   rhoib = w(i, 0, k, ivz)*wb(i, 0, k, ivz)
   wb(i, 0, k, ivz) = rhoi*wb(i, 0, k, ivz)
   CALL POPREAL8(w(i, 0, k, ivy))
   rhoib = rhoib + w(i, 0, k, ivy)*wb(i, 0, k, ivy)
   wb(i, 0, k, ivy) = rhoi*wb(i, 0, k, ivy)
   CALL POPREAL8(w(i, 0, k, ivx))
   rhoib = rhoib + w(i, 0, k, ivx)*wb(i, 0, k, ivx)
   wb(i, 0, k, ivx) = rhoi*wb(i, 0, k, ivx)
   CALL POPREAL8(rhoi)
   temp4 = w(i, 0, k, irho)
   wb(i, 0, k, irho) = wb(i, 0, k, irho) - one*rhoib/temp4**2
   END DO
   END DO
   DO k=kl,2,-1
   DO j=jl,2,-1
   CALL POPREAL8(w(ib, j, k, irhoe))
   pb(ib, j, k) = pb(ib, j, k) - wb(ib, j, k, irhoe)
   CALL POPREAL8(w(ib, j, k, ivz))
   rhoib = w(ib, j, k, ivz)*wb(ib, j, k, ivz)
   wb(ib, j, k, ivz) = rhoi*wb(ib, j, k, ivz)
   CALL POPREAL8(w(ib, j, k, ivy))
   rhoib = rhoib + w(ib, j, k, ivy)*wb(ib, j, k, ivy)
   wb(ib, j, k, ivy) = rhoi*wb(ib, j, k, ivy)
   CALL POPREAL8(w(ib, j, k, ivx))
   rhoib = rhoib + w(ib, j, k, ivx)*wb(ib, j, k, ivx)
   wb(ib, j, k, ivx) = rhoi*wb(ib, j, k, ivx)
   CALL POPREAL8(rhoi)
   temp3 = w(ib, j, k, irho)
   wb(ib, j, k, irho) = wb(ib, j, k, irho) - one*rhoib/temp3**2
   CALL POPREAL8(w(ie, j, k, irhoe))
   pb(ie, j, k) = pb(ie, j, k) - wb(ie, j, k, irhoe)
   CALL POPREAL8(w(ie, j, k, ivz))
   rhoib = w(ie, j, k, ivz)*wb(ie, j, k, ivz)
   wb(ie, j, k, ivz) = rhoi*wb(ie, j, k, ivz)
   CALL POPREAL8(w(ie, j, k, ivy))
   rhoib = rhoib + w(ie, j, k, ivy)*wb(ie, j, k, ivy)
   wb(ie, j, k, ivy) = rhoi*wb(ie, j, k, ivy)
   CALL POPREAL8(w(ie, j, k, ivx))
   rhoib = rhoib + w(ie, j, k, ivx)*wb(ie, j, k, ivx)
   wb(ie, j, k, ivx) = rhoi*wb(ie, j, k, ivx)
   CALL POPREAL8(rhoi)
   temp2 = w(ie, j, k, irho)
   wb(ie, j, k, irho) = wb(ie, j, k, irho) - one*rhoib/temp2**2
   CALL POPREAL8(w(1, j, k, irhoe))
   pb(1, j, k) = pb(1, j, k) - wb(1, j, k, irhoe)
   CALL POPREAL8(w(1, j, k, ivz))
   rhoib = w(1, j, k, ivz)*wb(1, j, k, ivz)
   wb(1, j, k, ivz) = rhoi*wb(1, j, k, ivz)
   CALL POPREAL8(w(1, j, k, ivy))
   rhoib = rhoib + w(1, j, k, ivy)*wb(1, j, k, ivy)
   wb(1, j, k, ivy) = rhoi*wb(1, j, k, ivy)
   CALL POPREAL8(w(1, j, k, ivx))
   rhoib = rhoib + w(1, j, k, ivx)*wb(1, j, k, ivx)
   wb(1, j, k, ivx) = rhoi*wb(1, j, k, ivx)
   CALL POPREAL8(rhoi)
   temp1 = w(1, j, k, irho)
   wb(1, j, k, irho) = wb(1, j, k, irho) - one*rhoib/temp1**2
   CALL POPREAL8(w(0, j, k, irhoe))
   pb(0, j, k) = pb(0, j, k) - wb(0, j, k, irhoe)
   CALL POPREAL8(w(0, j, k, ivz))
   rhoib = w(0, j, k, ivz)*wb(0, j, k, ivz)
   wb(0, j, k, ivz) = rhoi*wb(0, j, k, ivz)
   CALL POPREAL8(w(0, j, k, ivy))
   rhoib = rhoib + w(0, j, k, ivy)*wb(0, j, k, ivy)
   wb(0, j, k, ivy) = rhoi*wb(0, j, k, ivy)
   CALL POPREAL8(w(0, j, k, ivx))
   rhoib = rhoib + w(0, j, k, ivx)*wb(0, j, k, ivx)
   wb(0, j, k, ivx) = rhoi*wb(0, j, k, ivx)
   CALL POPREAL8(rhoi)
   temp0 = w(0, j, k, irho)
   wb(0, j, k, irho) = wb(0, j, k, irho) - one*rhoib/temp0**2
   END DO
   END DO
   DO k=kb,0,-1
   DO j=jl,2,-1
   DO i=il,2,-1
   CALL POPREAL8(w(i, j, k, irhoe))
   pb(i, j, k) = pb(i, j, k) - wb(i, j, k, irhoe)
   CALL POPREAL8(w(i, j, k, ivz))
   rhoib = w(i, j, k, ivz)*wb(i, j, k, ivz)
   wb(i, j, k, ivz) = rhoi*wb(i, j, k, ivz)
   CALL POPREAL8(w(i, j, k, ivy))
   rhoib = rhoib + w(i, j, k, ivy)*wb(i, j, k, ivy)
   wb(i, j, k, ivy) = rhoi*wb(i, j, k, ivy)
   CALL POPREAL8(w(i, j, k, ivx))
   rhoib = rhoib + w(i, j, k, ivx)*wb(i, j, k, ivx)
   wb(i, j, k, ivx) = rhoi*wb(i, j, k, ivx)
   CALL POPREAL8(rhoi)
   temp = w(i, j, k, irho)
   wb(i, j, k, irho) = wb(i, j, k, irho) - one*rhoib/temp**2
   END DO
   END DO
   END DO
   DO k=kl,2,-1
   DO i=il,2,-1
   CALL POPREAL8(w(i, jb, k, irhoe))
   pb(i, jb, k) = pb(i, jb, k) + wb(i, jb, k, irhoe)
   CALL POPREAL8(w(i, jb, k, ivz))
   tmpb14 = wb(i, jb, k, ivz)
   wb(i, jb, k, ivz) = 0.0_8
   wb(i, jb, k, irho) = wb(i, jb, k, irho) + w(i, jb, k, ivz)*&
   &         tmpb14
   wb(i, jb, k, ivz) = wb(i, jb, k, ivz) + w(i, jb, k, irho)*tmpb14
   CALL POPREAL8(w(i, jb, k, ivy))
   tmpb15 = wb(i, jb, k, ivy)
   wb(i, jb, k, ivy) = 0.0_8
   wb(i, jb, k, irho) = wb(i, jb, k, irho) + w(i, jb, k, ivy)*&
   &         tmpb15
   wb(i, jb, k, ivy) = wb(i, jb, k, ivy) + w(i, jb, k, irho)*tmpb15
   CALL POPREAL8(w(i, jb, k, ivx))
   tmpb16 = wb(i, jb, k, ivx)
   wb(i, jb, k, ivx) = 0.0_8
   wb(i, jb, k, irho) = wb(i, jb, k, irho) + w(i, jb, k, ivx)*&
   &         tmpb16
   wb(i, jb, k, ivx) = wb(i, jb, k, ivx) + w(i, jb, k, irho)*tmpb16
   CALL POPREAL8(w(i, je, k, irhoe))
   pb(i, je, k) = pb(i, je, k) + wb(i, je, k, irhoe)
   CALL POPREAL8(w(i, je, k, ivz))
   tmpb17 = wb(i, je, k, ivz)
   wb(i, je, k, ivz) = 0.0_8
   wb(i, je, k, irho) = wb(i, je, k, irho) + w(i, je, k, ivz)*&
   &         tmpb17
   wb(i, je, k, ivz) = wb(i, je, k, ivz) + w(i, je, k, irho)*tmpb17
   CALL POPREAL8(w(i, je, k, ivy))
   tmpb18 = wb(i, je, k, ivy)
   wb(i, je, k, ivy) = 0.0_8
   wb(i, je, k, irho) = wb(i, je, k, irho) + w(i, je, k, ivy)*&
   &         tmpb18
   wb(i, je, k, ivy) = wb(i, je, k, ivy) + w(i, je, k, irho)*tmpb18
   CALL POPREAL8(w(i, je, k, ivx))
   tmpb19 = wb(i, je, k, ivx)
   wb(i, je, k, ivx) = 0.0_8
   wb(i, je, k, irho) = wb(i, je, k, irho) + w(i, je, k, ivx)*&
   &         tmpb19
   wb(i, je, k, ivx) = wb(i, je, k, ivx) + w(i, je, k, irho)*tmpb19
   CALL POPREAL8(w(i, 1, k, irhoe))
   pb(i, 1, k) = pb(i, 1, k) + wb(i, 1, k, irhoe)
   CALL POPREAL8(w(i, 1, k, ivz))
   tmpb20 = wb(i, 1, k, ivz)
   wb(i, 1, k, ivz) = 0.0_8
   wb(i, 1, k, irho) = wb(i, 1, k, irho) + w(i, 1, k, ivz)*tmpb20
   wb(i, 1, k, ivz) = wb(i, 1, k, ivz) + w(i, 1, k, irho)*tmpb20
   CALL POPREAL8(w(i, 1, k, ivy))
   tmpb21 = wb(i, 1, k, ivy)
   wb(i, 1, k, ivy) = 0.0_8
   wb(i, 1, k, irho) = wb(i, 1, k, irho) + w(i, 1, k, ivy)*tmpb21
   wb(i, 1, k, ivy) = wb(i, 1, k, ivy) + w(i, 1, k, irho)*tmpb21
   CALL POPREAL8(w(i, 1, k, ivx))
   tmpb22 = wb(i, 1, k, ivx)
   wb(i, 1, k, ivx) = 0.0_8
   wb(i, 1, k, irho) = wb(i, 1, k, irho) + w(i, 1, k, ivx)*tmpb22
   wb(i, 1, k, ivx) = wb(i, 1, k, ivx) + w(i, 1, k, irho)*tmpb22
   CALL POPREAL8(w(i, 0, k, irhoe))
   pb(i, 0, k) = pb(i, 0, k) + wb(i, 0, k, irhoe)
   CALL POPREAL8(w(i, 0, k, ivz))
   tmpb23 = wb(i, 0, k, ivz)
   wb(i, 0, k, ivz) = 0.0_8
   wb(i, 0, k, irho) = wb(i, 0, k, irho) + w(i, 0, k, ivz)*tmpb23
   wb(i, 0, k, ivz) = wb(i, 0, k, ivz) + w(i, 0, k, irho)*tmpb23
   CALL POPREAL8(w(i, 0, k, ivy))
   tmpb24 = wb(i, 0, k, ivy)
   wb(i, 0, k, ivy) = 0.0_8
   wb(i, 0, k, irho) = wb(i, 0, k, irho) + w(i, 0, k, ivy)*tmpb24
   wb(i, 0, k, ivy) = wb(i, 0, k, ivy) + w(i, 0, k, irho)*tmpb24
   CALL POPREAL8(w(i, 0, k, ivx))
   tmpb25 = wb(i, 0, k, ivx)
   wb(i, 0, k, ivx) = 0.0_8
   wb(i, 0, k, irho) = wb(i, 0, k, irho) + w(i, 0, k, ivx)*tmpb25
   wb(i, 0, k, ivx) = wb(i, 0, k, ivx) + w(i, 0, k, irho)*tmpb25
   END DO
   END DO
   DO k=kl,2,-1
   DO j=jl,2,-1
   CALL POPREAL8(w(ib, j, k, irhoe))
   pb(ib, j, k) = pb(ib, j, k) + wb(ib, j, k, irhoe)
   CALL POPREAL8(w(ib, j, k, ivz))
   tmpb2 = wb(ib, j, k, ivz)
   wb(ib, j, k, ivz) = 0.0_8
   wb(ib, j, k, irho) = wb(ib, j, k, irho) + w(ib, j, k, ivz)*tmpb2
   wb(ib, j, k, ivz) = wb(ib, j, k, ivz) + w(ib, j, k, irho)*tmpb2
   CALL POPREAL8(w(ib, j, k, ivy))
   tmpb3 = wb(ib, j, k, ivy)
   wb(ib, j, k, ivy) = 0.0_8
   wb(ib, j, k, irho) = wb(ib, j, k, irho) + w(ib, j, k, ivy)*tmpb3
   wb(ib, j, k, ivy) = wb(ib, j, k, ivy) + w(ib, j, k, irho)*tmpb3
   CALL POPREAL8(w(ib, j, k, ivx))
   tmpb4 = wb(ib, j, k, ivx)
   wb(ib, j, k, ivx) = 0.0_8
   wb(ib, j, k, irho) = wb(ib, j, k, irho) + w(ib, j, k, ivx)*tmpb4
   wb(ib, j, k, ivx) = wb(ib, j, k, ivx) + w(ib, j, k, irho)*tmpb4
   CALL POPREAL8(w(ie, j, k, irhoe))
   pb(ie, j, k) = pb(ie, j, k) + wb(ie, j, k, irhoe)
   CALL POPREAL8(w(ie, j, k, ivz))
   tmpb5 = wb(ie, j, k, ivz)
   wb(ie, j, k, ivz) = 0.0_8
   wb(ie, j, k, irho) = wb(ie, j, k, irho) + w(ie, j, k, ivz)*tmpb5
   wb(ie, j, k, ivz) = wb(ie, j, k, ivz) + w(ie, j, k, irho)*tmpb5
   CALL POPREAL8(w(ie, j, k, ivy))
   tmpb6 = wb(ie, j, k, ivy)
   wb(ie, j, k, ivy) = 0.0_8
   wb(ie, j, k, irho) = wb(ie, j, k, irho) + w(ie, j, k, ivy)*tmpb6
   wb(ie, j, k, ivy) = wb(ie, j, k, ivy) + w(ie, j, k, irho)*tmpb6
   CALL POPREAL8(w(ie, j, k, ivx))
   tmpb7 = wb(ie, j, k, ivx)
   wb(ie, j, k, ivx) = 0.0_8
   wb(ie, j, k, irho) = wb(ie, j, k, irho) + w(ie, j, k, ivx)*tmpb7
   wb(ie, j, k, ivx) = wb(ie, j, k, ivx) + w(ie, j, k, irho)*tmpb7
   CALL POPREAL8(w(1, j, k, irhoe))
   pb(1, j, k) = pb(1, j, k) + wb(1, j, k, irhoe)
   CALL POPREAL8(w(1, j, k, ivz))
   tmpb8 = wb(1, j, k, ivz)
   wb(1, j, k, ivz) = 0.0_8
   wb(1, j, k, irho) = wb(1, j, k, irho) + w(1, j, k, ivz)*tmpb8
   wb(1, j, k, ivz) = wb(1, j, k, ivz) + w(1, j, k, irho)*tmpb8
   CALL POPREAL8(w(1, j, k, ivy))
   tmpb9 = wb(1, j, k, ivy)
   wb(1, j, k, ivy) = 0.0_8
   wb(1, j, k, irho) = wb(1, j, k, irho) + w(1, j, k, ivy)*tmpb9
   wb(1, j, k, ivy) = wb(1, j, k, ivy) + w(1, j, k, irho)*tmpb9
   CALL POPREAL8(w(1, j, k, ivx))
   tmpb10 = wb(1, j, k, ivx)
   wb(1, j, k, ivx) = 0.0_8
   wb(1, j, k, irho) = wb(1, j, k, irho) + w(1, j, k, ivx)*tmpb10
   wb(1, j, k, ivx) = wb(1, j, k, ivx) + w(1, j, k, irho)*tmpb10
   CALL POPREAL8(w(0, j, k, irhoe))
   pb(0, j, k) = pb(0, j, k) + wb(0, j, k, irhoe)
   CALL POPREAL8(w(0, j, k, ivz))
   tmpb11 = wb(0, j, k, ivz)
   wb(0, j, k, ivz) = 0.0_8
   wb(0, j, k, irho) = wb(0, j, k, irho) + w(0, j, k, ivz)*tmpb11
   wb(0, j, k, ivz) = wb(0, j, k, ivz) + w(0, j, k, irho)*tmpb11
   CALL POPREAL8(w(0, j, k, ivy))
   tmpb12 = wb(0, j, k, ivy)
   wb(0, j, k, ivy) = 0.0_8
   wb(0, j, k, irho) = wb(0, j, k, irho) + w(0, j, k, ivy)*tmpb12
   wb(0, j, k, ivy) = wb(0, j, k, ivy) + w(0, j, k, irho)*tmpb12
   CALL POPREAL8(w(0, j, k, ivx))
   tmpb13 = wb(0, j, k, ivx)
   wb(0, j, k, ivx) = 0.0_8
   wb(0, j, k, irho) = wb(0, j, k, irho) + w(0, j, k, ivx)*tmpb13
   wb(0, j, k, ivx) = wb(0, j, k, ivx) + w(0, j, k, irho)*tmpb13
   END DO
   END DO
   DO k=kb,0,-1
   DO j=jl,2,-1
   DO i=il,2,-1
   CALL POPREAL8(w(i, j, k, irhoe))
   pb(i, j, k) = pb(i, j, k) + wb(i, j, k, irhoe)
   CALL POPREAL8(w(i, j, k, ivz))
   tmpb = wb(i, j, k, ivz)
   wb(i, j, k, ivz) = 0.0_8
   wb(i, j, k, irho) = wb(i, j, k, irho) + w(i, j, k, ivz)*tmpb
   wb(i, j, k, ivz) = wb(i, j, k, ivz) + w(i, j, k, irho)*tmpb
   CALL POPREAL8(w(i, j, k, ivy))
   tmpb0 = wb(i, j, k, ivy)
   wb(i, j, k, ivy) = 0.0_8
   wb(i, j, k, irho) = wb(i, j, k, irho) + w(i, j, k, ivy)*tmpb0
   wb(i, j, k, ivy) = wb(i, j, k, ivy) + w(i, j, k, irho)*tmpb0
   CALL POPREAL8(w(i, j, k, ivx))
   tmpb1 = wb(i, j, k, ivx)
   wb(i, j, k, ivx) = 0.0_8
   wb(i, j, k, irho) = wb(i, j, k, irho) + w(i, j, k, ivx)*tmpb1
   wb(i, j, k, ivx) = wb(i, j, k, ivx) + w(i, j, k, irho)*tmpb1
   END DO
   END DO
   END DO
   END IF
   END SUBROUTINE INVISCIDDISSFLUXSCALAR_B
