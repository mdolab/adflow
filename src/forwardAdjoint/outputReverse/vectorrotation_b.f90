   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53
   !
   !  Differentiation of vectorrotation in reverse (adjoint) mode (with options i4 dr8 r8 noISIZE):
   !   gradient     of useful results: xp yp angle zp
   !   with respect to varying inputs: x y z angle
   !
   !     ******************************************************************
   !     *                                                                *
   !     * File:          vectorRotation.f90                              *
   !     * Author:        Andre C. Marta                                  *
   !     * Starting date: 06-23-2006                                      *
   !     * Last modified: 07-28-2006                                      *
   !     *                                                                *
   !     ******************************************************************
   !
   SUBROUTINE VECTORROTATION_B(xp, xpd, yp, ypd, zp, zpd, iaxis, angle, &
   & angled, x, xd, y, yd, z, zd)
   !
   !     ****************************************************************
   !     *                                                              *
   !     * vectorRotation rotates a given vector with respect to a      *
   !     * specified axis by a given angle.                             *
   !     *                                                              *
   !     *    input arguments:                                          *
   !     *       iaxis      = rotation axis (1-x, 2-y, 3-z)             *
   !     *       angle      = rotation angle (measured ccw in radians)  *
   !     *       x, y, z    = coordinates in original system            *
   !     *    output arguments:                                         *
   !     *       xp, yp, zp = coordinates in rotated system             *
   !     *                                                              *
   !     ****************************************************************
   !
   USE PRECISION
   IMPLICIT NONE
   !
   !     Subroutine arguments.
   !
   INTEGER(kind=inttype), INTENT(IN) :: iaxis
   REAL(kind=realtype), INTENT(IN) :: angle, x, y, z
   REAL(kind=realtype) :: angled, xd, yd, zd
   REAL(kind=realtype) :: xp, yp, zp
   REAL(kind=realtype) :: xpd, ypd, zpd
   INTRINSIC COS
   INTRINSIC SIN
   !
   !     ******************************************************************
   !     *                                                                *
   !     * Begin execution                                                *
   !     *                                                                *
   !     ******************************************************************
   !
   ! rotation about specified axis by specified angle
   SELECT CASE  (iaxis) 
   CASE (1) 
   xd = xpd
   angled = angled + (z*COS(angle)-y*SIN(angle))*ypd + (-(z*SIN(angle))&
   &     -y*COS(angle))*zpd
   yd = COS(angle)*ypd - SIN(angle)*zpd
   zd = SIN(angle)*ypd + COS(angle)*zpd
   CASE (2) 
   angled = angled + (-(z*COS(angle))-x*SIN(angle))*xpd + (x*COS(angle)&
   &     -z*SIN(angle))*zpd
   xd = COS(angle)*xpd + SIN(angle)*zpd
   yd = ypd
   zd = COS(angle)*zpd - SIN(angle)*xpd
   CASE (3) 
   xd = COS(angle)*xpd - SIN(angle)*ypd
   yd = COS(angle)*ypd + SIN(angle)*xpd
   zd = zpd
   angled = angled + (y*COS(angle)-x*SIN(angle))*xpd + (-(x*COS(angle))&
   &     -y*SIN(angle))*ypd
   CASE DEFAULT
   STOP
   END SELECT
   END SUBROUTINE VECTORROTATION_B
