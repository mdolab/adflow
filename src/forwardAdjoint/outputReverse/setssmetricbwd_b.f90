!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of setssmetricbwd in reverse (adjoint) mode (with options i4 dr8 r8 noisize):
!   gradient     of useful results: *si *sj *sk ss
!   with respect to varying inputs: *si *sj *sk ss
!   plus diff mem management of: si:in sj:in sk:in
!
!      ******************************************************************
!      *                                                                *
!      * file:          setssmetircbwd.f90                              *
!      * author:        peter zhoujie lyu                               *
!      * starting date: 11-03-2014                                      *
!      * last modified: 11-03-2014                                      *
!      *                                                                *
!      ******************************************************************
subroutine setssmetricbwd_b(nn, ss, ssd)
  use bctypes
  use blockpointers
  use flowvarrefstate
  implicit none
!
!      subroutine arguments.
!
  integer(kind=inttype), intent(in) :: nn
  real(kind=realtype), dimension(imaxdim, jmaxdim, 3) :: ss
  real(kind=realtype), dimension(imaxdim, jmaxdim, 3) :: ssd
!
!      ******************************************************************
!      *                                                                *
!      * begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! determine the face id on which the subface is located and set
! the pointers accordinly.
  select case  (bcfaceid(nn)) 
  case (imin) 
    sid(1, 1:je, 1:ke, :) = sid(1, 1:je, 1:ke, :) + ssd(1:je, 1:ke, :)
    ssd(1:je, 1:ke, :) = 0.0_8
  case (imax) 
    sid(il, 1:je, 1:ke, :) = sid(il, 1:je, 1:ke, :) + ssd(1:je, 1:ke, :)
    ssd(1:je, 1:ke, :) = 0.0_8
  case (jmin) 
    sjd(1:ie, 1, 1:ke, :) = sjd(1:ie, 1, 1:ke, :) + ssd(1:ie, 1:ke, :)
    ssd(1:ie, 1:ke, :) = 0.0_8
  case (jmax) 
    sjd(1:ie, jl, 1:ke, :) = sjd(1:ie, jl, 1:ke, :) + ssd(1:ie, 1:ke, :)
    ssd(1:ie, 1:ke, :) = 0.0_8
  case (kmin) 
    skd(1:ie, 1:je, 1, :) = skd(1:ie, 1:je, 1, :) + ssd(1:ie, 1:je, :)
    ssd(1:ie, 1:je, :) = 0.0_8
  case (kmax) 
    skd(1:ie, 1:je, kl, :) = skd(1:ie, 1:je, kl, :) + ssd(1:ie, 1:je, :)
    ssd(1:ie, 1:je, :) = 0.0_8
  end select
end subroutine setssmetricbwd_b
