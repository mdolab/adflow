!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of computeleastsquaresregression in reverse (adjoint) mode (with options i4 dr8 r8 noisize):
!   gradient     of useful results: m y b
!   with respect to varying inputs: y
!
!      ******************************************************************
!      *                                                                *
!      * file:          computeleastsquaresregression.f90               *
!      * author:        c.a.(sandy) mader                               *
!      * starting date: 10-14-2009                                      *
!      * last modified: 10-14-2009                                      *
!      *                                                                *
!      ******************************************************************
!
subroutine computeleastsquaresregression_b(y, yd, x, npts, m, md, b, bd)
!
!      ******************************************************************
!      *                                                                *
!      * computes the slope of best fit for a set of x,y data of length *
!      * npts                                                           *
!      *                                                                *
!      ******************************************************************
!
  use precision
  implicit none
!subroutine arguments 
  integer(kind=inttype) :: npts
  real(kind=realtype), dimension(npts) :: x, y
  real(kind=realtype), dimension(npts) :: yd
  real(kind=realtype) :: m, b
  real(kind=realtype) :: md, bd
!local variables
  real(kind=realtype) :: sumx, sumy, sumx2, sumxy
  real(kind=realtype) :: sumyd, sumxyd
  integer(kind=inttype) :: i
  real(kind=realtype) :: tempd
  real(kind=realtype) :: tempd0
!begin execution
  sumx = 0.0
  sumx2 = 0.0
  do i=1,npts
    sumx = sumx + x(i)
    sumx2 = sumx2 + x(i)*x(i)
  end do
  tempd0 = md/(npts*sumx2-sumx**2)
  tempd = bd/(npts*sumx2-sumx**2)
  sumyd = sumx2*tempd - sumx*tempd0
  sumxyd = npts*tempd0 - sumx*tempd
  do i=npts,1,-1
    yd(i) = yd(i) + sumyd + x(i)*sumxyd
  end do
end subroutine computeleastsquaresregression_b
