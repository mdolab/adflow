   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53
   !
   !  Differentiation of unsteadyturbspectral_block in reverse (adjoint) mode (with options i4 dr8 r8 noISIZE):
   !   gradient     of useful results: *(flowdoms.w) *dw
   !   with respect to varying inputs: *(flowdoms.w) *dw
   !   Plus diff mem management of: flowdoms.w:in dw:in
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          unsteadyTurbSpectral.f90                        *
   !      * Author:        Edwin van der Weide                             *
   !      * Starting date: 08-22-2004                                      *
   !      * Last modified: 06-28-2005                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE UNSTEADYTURBSPECTRAL_BLOCK_B(ntu1, ntu2, nn, sps)
   !
   !      ******************************************************************
   !      *                                                                *
   !      * unsteadyTurbSpectral determines the spectral time derivative   *
   !      * for all owned cells. This routine is called before the actual  *
   !      * solve routines, such that the treatment is identical for all   *
   !      * spectral solutions. The results is stored in the corresponding *
   !      * entry in dw.                                                   *
   !      *                                                                *
   !      ******************************************************************
   !
   USE BLOCKPOINTERS_B
   USE INPUTPHYSICS
   USE INPUTTIMESPECTRAL
   USE ITERATION
   IMPLICIT NONE
   !
   !      Subroutine arguments.
   !
   INTEGER(kind=inttype), INTENT(IN) :: ntu1, ntu2, nn, sps
   !
   !      Local variables.
   !
   INTEGER(kind=inttype) :: ii, mm, i, j, k
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Begin execution                                                *
   !      *                                                                *
   !      ******************************************************************
   ! Return immediately if not the time spectral equations are to
   ! be solved.
   IF (equationmode .EQ. timespectral) THEN
   DO ii=ntu2,ntu1,-1
   DO mm=ntimeintervalsspectral,1,-1
   DO k=kl,2,-1
   DO j=jl,2,-1
   DO i=il,2,-1
   flowdomsb(nn, currentlevel, mm)%w(i, j, k, ii) = flowdomsb&
   &               (nn, currentlevel, mm)%w(i, j, k, ii) + dscalar(&
   &               sectionid, sps, mm)*dwb(i, j, k, ii)
   END DO
   END DO
   END DO
   END DO
   DO k=kl,2,-1
   DO j=jl,2,-1
   DO i=il,2,-1
   dwb(i, j, k, ii) = 0.0_8
   END DO
   END DO
   END DO
   END DO
   END IF
   END SUBROUTINE UNSTEADYTURBSPECTRAL_BLOCK_B
