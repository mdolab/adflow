   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53
   !
   !  Differentiation of bcturbtreatment in reverse (adjoint) mode (with options i4 dr8 r8 noISIZE):
   !   gradient     of useful results: *bvtj1 *bvtj2 *bmtk1 *w *bmtk2
   !                *rlv *bvtk1 *bvtk2 *bmti1 *bmti2 *bvti1 *bvti2
   !                *bmtj1 *bmtj2
   !   with respect to varying inputs: *w *rlv
   !   Plus diff mem management of: bvtj1:in bvtj2:in bmtk1:in w:in
   !                bmtk2:in rlv:in bvtk1:in bvtk2:in bmti1:in bmti2:in
   !                bvti1:in bvti2:in bmtj1:in bmtj2:in
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          bcTurbTreatment.f90                             *
   !      * Author:        Georgi Kalitzin, Edwin van der Weide            *
   !      *                Seonghyeon Hahn                                 *
   !      * Starting date: 06-13-2003                                      *
   !      * Last modified: 08-12-2005                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE BCTURBTREATMENT_B()
   !
   !      ******************************************************************
   !      *                                                                *
   !      * bcTurbTreatment sets the arrays bmti1, bvti1, etc, such that   *
   !      * the physical boundary conditions are treated correctly.        *
   !      * It is assumed that the variables in blockPointers already      *
   !      * point to the correct block.                                    *
   !      *                                                                *
   !      * The turbulent variable in the halo is computed as follows:     *
   !      * wHalo = -bmt*wInternal + bvt for every block facer. As it is   *
   !      * possible to have a coupling in the boundary conditions bmt     *
   !      * actually are matrices. If there is no coupling between the     *
   !      * boundary conditions of the turbulence equations bmt is a       *
   !      * diagonal matrix.                                               *
   !      *                                                                *
   !      ******************************************************************
   !
   USE BCTYPES
   USE BLOCKPOINTERS_B
   USE FLOWVARREFSTATE
   IMPLICIT NONE
   !
   !      Local variable.
   !
   INTEGER(kind=inttype) :: nn, i, j, k, l, m
   INTEGER :: branch
   ! Loop over the boundary condition subfaces of this block.
   bocos:DO nn=1,nbocos
   ! Determine the kind of boundary condition for this subface.
   SELECT CASE  (bctype(nn)) 
   CASE (nswalladiabatic, nswallisothermal) 
   CALL PUSHCONTROL2B(3)
   CASE (symm, symmpolar, eulerwall) 
   CALL PUSHCONTROL2B(2)
   CASE (farfield) 
   CALL PUSHCONTROL2B(1)
   CASE DEFAULT
   CALL PUSHCONTROL2B(0)
   END SELECT
   END DO bocos
   DO nn=nbocos,1,-1
   CALL POPCONTROL2B(branch)
   IF (branch .LT. 2) THEN
   IF (branch .NE. 0) CALL BCTURBFARFIELD_B(nn)
   ELSE IF (branch .EQ. 2) THEN
   CALL BCTURBSYMM_B(nn)
   ELSE
   CALL BCTURBWALL_B(nn)
   END IF
   END DO
   END SUBROUTINE BCTURBTREATMENT_B
