   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53
   !
   !  Differentiation of bcturbtreatment in reverse (adjoint) mode (with options i4 dr8 r8 noISIZE):
   !   gradient     of useful results: *bvtj1 *bvtj2 *w *rlv *bvtk1
   !                *bvtk2 *d2wall *bvti1 *bvti2 winf
   !   with respect to varying inputs: *bvtj1 *bvtj2 *w *rlv *bvtk1
   !                *bvtk2 *d2wall *bvti1 *bvti2 winf
   !   Plus diff mem management of: bvtj1:in bvtj2:in w:in rlv:in
   !                bvtk1:in bvtk2:in d2wall:in bvti1:in bvti2:in
   !                bcdata:in
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          bcTurbTreatment.f90                             *
   !      * Author:        Georgi Kalitzin, Edwin van der Weide            *
   !      *                Seonghyeon Hahn                                 *
   !      * Starting date: 06-13-2003                                      *
   !      * Last modified: 08-12-2005                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE BCTURBTREATMENT_B()
   !
   !      ******************************************************************
   !      *                                                                *
   !      * bcTurbTreatment sets the arrays bmti1, bvti1, etc, such that   *
   !      * the physical boundary conditions are treated correctly.        *
   !      * It is assumed that the variables in blockPointers already      *
   !      * point to the correct block.                                    *
   !      *                                                                *
   !      * The turbulent variable in the halo is computed as follows:     *
   !      * wHalo = -bmt*wInternal + bvt for every block facer. As it is   *
   !      * possible to have a coupling in the boundary conditions bmt     *
   !      * actually are matrices. If there is no coupling between the     *
   !      * boundary conditions of the turbulence equations bmt is a       *
   !      * diagonal matrix.                                               *
   !      *                                                                *
   !      ******************************************************************
   !
   USE BCTYPES
   USE BLOCKPOINTERS
   USE FLOWVARREFSTATE
   IMPLICIT NONE
   !
   !      Local variable.
   !
   INTEGER(kind=inttype) :: nn, i, j, k, l, m
   INTEGER :: branch
   ! Loop over the boundary condition subfaces of this block.
   bocos:DO nn=1,nbocos
   ! Determine the kind of boundary condition for this subface.
   SELECT CASE  (bctype(nn)) 
   CASE (nswalladiabatic, nswallisothermal) 
   CALL PUSHCONTROL2B(2)
   CASE (symm, symmpolar, eulerwall) 
   CALL PUSHCONTROL2B(1)
   CASE (farfield) 
   CALL PUSHCONTROL2B(0)
   CASE DEFAULT
   CALL PUSHCONTROL2B(1)
   END SELECT
   END DO bocos
   DO nn=nbocos,1,-1
   CALL POPCONTROL2B(branch)
   IF (branch .EQ. 0) THEN
   CALL BCTURBFARFIELD_B(nn)
   ELSE IF (branch .NE. 1) THEN
   CALL BCTURBWALL_B(nn)
   END IF
   END DO
   DO j=je,1,-1
   DO i=ie,1,-1
   DO l=nt2,nt1,-1
   bvtk2d(i, j, l) = 0.0_8
   bvtk1d(i, j, l) = 0.0_8
   END DO
   END DO
   END DO
   DO k=ke,1,-1
   DO i=ie,1,-1
   DO l=nt2,nt1,-1
   bvtj2d(i, k, l) = 0.0_8
   bvtj1d(i, k, l) = 0.0_8
   END DO
   END DO
   END DO
   DO k=ke,1,-1
   DO j=je,1,-1
   DO l=nt2,nt1,-1
   bvti2d(j, k, l) = 0.0_8
   bvti1d(j, k, l) = 0.0_8
   END DO
   END DO
   END DO
   END SUBROUTINE BCTURBTREATMENT_B
