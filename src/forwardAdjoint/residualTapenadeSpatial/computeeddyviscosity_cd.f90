!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!
!      ******************************************************************
!      *                                                                *
!      * File:          computeEddyViscosity.f90                        *
!      * Author:        Georgi Kalitzin, Edwin van der Weide            *
!      * Starting date: 03-10-2003                                      *
!      * Last modified: 06-12-2005                                      *
!      *                                                                *
!      ******************************************************************
!
SUBROUTINE COMPUTEEDDYVISCOSITY_CD()
  USE INPUTPHYSICS_SPATIAL_D
  USE ITERATION_SPATIAL_D
  USE BLOCKPOINTERS_SPATIAL_D
  USE FLOWVARREFSTATE_SPATIAL_D
  IMPLICIT NONE
!
!      ******************************************************************
!      *                                                                *
!      * computeEddyViscosity computes the eddy viscosity in the        *
!      * owned cell centers of the given block. It is assumed that the  *
!      * pointes already point to the correct block before entering     *
!      * this subroutine.                                               *
!      *                                                                *
!      ******************************************************************
!
!
!      Local variables.
!
  LOGICAL :: returnimmediately
!
!      ******************************************************************
!      *                                                                *
!      * Begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! Check if an immediate return can be made.
  IF (eddymodel) THEN
    IF (currentlevel .LE. groundlevel .OR. turbcoupled) THEN
      returnimmediately = .false.
    ELSE
      returnimmediately = .true.
    END IF
  ELSE
    returnimmediately = .true.
  END IF
  IF (returnimmediately) THEN
    RETURN
  ELSE
! Determine the turbulence model and call the appropriate
! routine to compute the eddy viscosity.
    SELECT CASE  (turbmodel) 
    CASE (baldwinlomax) 
      CALL BLEDDYVISCOSITY_CD()
    CASE (spalartallmaras, spalartallmarasedwards) 
      CALL SAEDDYVISCOSITY_CD()
    CASE (komegawilcox, komegamodified) 
      CALL KWEDDYVISCOSITY_CD()
    CASE (mentersst) 
      CALL SSTEDDYVISCOSITY_CD()
    CASE (ktau) 
      CALL KTEDDYVISCOSITY_CD()
    CASE (v2f) 
      CALL VFEDDYVISCOSITY_CD()
    CASE DEFAULT
      CALL TERMINATE_CD('computeEddyViscosity', &
&                  'Turbulence model not implemented yet')
    END SELECT
  END IF
END SUBROUTINE COMPUTEEDDYVISCOSITY_CD
