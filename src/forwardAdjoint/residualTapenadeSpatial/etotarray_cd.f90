!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!      ==================================================================
SUBROUTINE ETOTARRAY_CD(rho, u, v, w, p, k, etot, correctfork, kk)
  USE CONSTANTS_SPATIAL_D
  IMPLICIT NONE
!
!      ******************************************************************
!      *                                                                *
!      * EtotArray computes the total energy from the given density,    *
!      * velocity and presssure for the given kk elements of the arrays.*
!      * First the internal energy per unit mass is computed and after  *
!      * that the kinetic energy is added as well the conversion to     *
!      * energy per unit volume.                                        *
!      *                                                                *
!      ******************************************************************
!
!
!      Subroutine arguments.
!
  REAL(kind=realtype), DIMENSION(*), INTENT(IN) :: rho, p, k
  REAL(kind=realtype), DIMENSION(*), INTENT(IN) :: u, v, w
  REAL(kind=realtype), DIMENSION(*), INTENT(OUT) :: etot
  LOGICAL, INTENT(IN) :: correctfork
  INTEGER(kind=inttype), INTENT(IN) :: kk
!
!      Local variables.
!
  INTEGER(kind=inttype) :: i
!
!      ******************************************************************
!      *                                                                *
!      * Begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! Compute the internal energy for unit mass.
  CALL EINTARRAY_CD(rho, p, k, etot, correctfork, kk)
! Add the kinetic energy.
  DO i=1,kk
    etot(i) = rho(i)*(etot(i)+half*(u(i)*u(i)+v(i)*v(i)+w(i)*w(i)))
  END DO
END SUBROUTINE ETOTARRAY_CD
