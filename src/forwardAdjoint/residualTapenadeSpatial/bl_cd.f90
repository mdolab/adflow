!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!
!      ******************************************************************
!      *                                                                *
!      * File:          bl.f90                                          *
!      * Author:        Edwin van der Weide                             *
!      * Starting date: 10-27-2004                                      *
!      * Last modified: 04-12-2005                                      *
!      *                                                                *
!      ******************************************************************
!
SUBROUTINE BL_CD(resonly)
  USE ITERATION_SPATIAL_D
  USE INPUTTIMESPECTRAL_SPATIAL_D
  USE BLOCKPOINTERS_SPATIAL_D
  IMPLICIT NONE
!
!      ******************************************************************
!      *                                                                *
!      * bl is a sort of dummy routine to be consistent with the other  *
!      * turbulence models. It perfroms the loop over the numer of      *
!      * local blocks and computes the eddy viscosity.                  *
!      *                                                                *
!      ******************************************************************
!
!
!      Subroutine argument.
!
  LOGICAL, INTENT(IN) :: resonly
!
!      Local variables.
!
  INTEGER(kind=inttype) :: nn, sps
  EXTERNAL SETPOINTERS
!
!      ******************************************************************
!      *                                                                *
!      * Begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! Return immediately if only the residual needs to be computed.
! Baldwin-lomax is an algebraic model and therefore it does not
! have a residual.
  IF (resonly) THEN
    RETURN
  ELSE
! Loop over the number of spectral modes and local blocks and
! compute the eddy viscosity.
    DO sps=1,ntimeintervalsspectral
      DO nn=1,ndom
! Set the pointers for this block and compute the eddy
! viscosity.
        CALL SETPOINTERS(nn, currentlevel, sps)
        CALL BLEDDYVISCOSITY_CD()
      END DO
    END DO
  END IF
END SUBROUTINE BL_CD
