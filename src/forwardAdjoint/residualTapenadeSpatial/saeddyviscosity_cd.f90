!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!      ==================================================================
SUBROUTINE SAEDDYVISCOSITY_CD()
  USE PARAMTURB_SPATIAL_D
  USE CONSTANTS_SPATIAL_D
  USE BLOCKPOINTERS_SPATIAL_D
  IMPLICIT NONE
!
!      ******************************************************************
!      *                                                                *
!      * saEddyViscosity computes the eddy-viscosity according to the   *
!      * Spalart-Allmaras model for the block given in blockPointers.   *
!      * This routine for both the original version as well as the      *
!      * modified version according to Edwards.                         *
!      *                                                                *
!      ******************************************************************
!
!
!      Local variables.
!
  INTEGER(kind=inttype) :: i, j, k
  REAL(kind=realtype) :: chi, chi3, fv1, rnusa, cv13
!
!      ******************************************************************
!      *                                                                *
!      * Begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! Store the cv1^3; cv1 is a constant of the Spalart-Allmaras model.
  cv13 = rsacv1**3
! Loop over the cells of this block and compute the eddy viscosity.
! Do not include halo's.
  DO k=2,kl
    DO j=2,jl
      DO i=2,il
        rnusa = w(i, j, k, itu1)*w(i, j, k, irho)
        chi = rnusa/rlv(i, j, k)
        chi3 = chi**3
        fv1 = chi3/(chi3+cv13)
        rev(i, j, k) = fv1*rnusa
      END DO
    END DO
  END DO
END SUBROUTINE SAEDDYVISCOSITY_CD
