<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="extrapolate2ndhalo_spatial_d"></a><a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!  Differentiation of extrapolate2ndhalo in forward (tangent) mode:</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!   variations   of useful results: *p *gamma *w</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!   with respect to varying inputs: *p *gamma *w</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!      * File:          extrapolate2ndHalo.f90                          *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!      * Starting date: 03-10-2003                                      *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!      * Last modified: 06-12-2005                                      *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">EXTRAPOLATE2NDHALO_SPATIAL_D</code>(<code class="vardecl">nn</code>, <code class="vardecl">correctfork</code>)</a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">USE </code><code class="funcname">BCTYPES_SPATIAL_D</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
<a name="extrapolate2ndhalo_spatial_di0"></a>  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!      * extrapolate2ndHalo determines the states of the second layer   *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!      * halo cells for the given subface of the block. It is assumed   *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!      * that the pointers in blockPointers are already set to the      *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!      * correct block on the correct grid level.                       *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a name="extrapolate2ndhalo_spatial_di1"></a><a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="comment">!</code></a>
<a name="extrapolate2ndhalo_spatial_di2"></a>  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi0" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi1" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">correctfork</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi2" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi2" target="origFile"><code class="comment">!      Local parameter.</code></a>
<a name="extrapolate2ndhalo_spatial_di3"></a><a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi2" target="origFile"><code class="comment">!</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">factor</code>=<code class="constant">0.5_realType</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi3" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi3" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="extrapolate2ndhalo_spatial_di4"></a><a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi3" target="origFile"><code class="comment">!</code></a>
<a name="extrapolate2ndhalo_spatial_di5"></a>  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi3" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">l</code>, <code class="vardecl">idim</code>, <code class="vardecl">ddim</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi4" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">3</code>, <code class="constant">2</code><code class="typename">) </code>:: <code class="vardecl">crange</code></a>
<a name="extrapolate2ndhalo_spatial_di6"></a>  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi5" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww0</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">ww0d</code>, <code class="vardecl">ww1d</code>, <code class="vardecl">ww2d</code></a>
<a name="extrapolate2ndhalo_spatial_di7"></a>  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi6" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp0</code>, <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
<a name="extrapolate2ndhalo_spatial_di8"></a>  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">pp0d</code>, <code class="vardecl">pp1d</code>, <code class="vardecl">pp2d</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi7" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv0</code>, <code class="vardecl">rlv1</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhaloi8" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev0</code>, <code class="vardecl">rev1</code></a>
<a name="setbcpointers_spatial_d"></a>  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">INTERFACE </code></a>
      <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code>(<code class="vardecl">nn</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww1d</code>, <code class="vardecl">ww2</code>, <code class="vardecl">ww2d</code>, <code class="vardecl">pp1</code>, <code class="label">&</code></a>
<a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="label">&        </code><code class="vardecl">pp1d</code>, <code class="vardecl">pp2</code>, <code class="vardecl">pp2d</code>, <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code>, <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code>, <code class="vardecl">offset</code>)</a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">offset</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">ww1d</code>, <code class="vardecl">ww2d</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">pp1d</code>, <code class="vardecl">pp2d</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
      <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">END INTERFACE</code></a>
<a name="setbcpointers_cd0"></a>
  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">INTERFACE </code></a>
      <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD0</code>(<code class="vardecl">nn</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code>, <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code>, <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code>, <code class="label">&</code></a>
<a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="label">&        </code><code class="vardecl">rev1</code>, <code class="vardecl">rev2</code>, <code class="vardecl">offset</code>)</a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">offset</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
        <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
      <a href="extrapolate2ndhalo_p.html#setbcpointers" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD0</code></a>
<a name="setbcpointers_cd0i9"></a>  <a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">END INTERFACE</code></a>

<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">!</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">! Nullify the pointers and set them to the correct subface.</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">! They are nullified first, because some compilers require that.</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">! Note that rlv0 and rev0 are used here as dummies.</code></a>
<a name="p24"></a><a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="comment">!nullify(ww1, ww2, pp1, pp2, rlv1, rlv0, rev1, rev0)</code></a>
<a name="setbcpointers_cd0i10"></a>  <a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="keyword">CALL </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code>(nn, ww1, ww1d, ww2, ww2d, pp1, pp1d, pp2<code class="label">&</code></a>
<a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="label">&                         </code>, pp2d, rlv1, rlv0, rev1, rev0, </a><a href="msg.html#p24" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="extrapolate2ndhalo_p.html#i9" target="origFile"><code class="constant">0_intType</code>)</a>
<a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="comment">! Set a couple of additional variables needed for the</code></a>
<a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="comment">! extrapolation. This depends on the block face on which the</code></a>
<a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="comment">! subface is located.</code></a>
  <a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
  <a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="keyword">CASE </code>(imin) </a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0d => wd(<code class="constant">0</code>, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0 => w(<code class="constant">0</code>, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
<a name="setbcpointers_cd0i13"></a>    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0d => pd(<code class="constant">0</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0 => p(<code class="constant">0</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i13" target="origFile"><code class="keyword">IF</code> (viscous) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i15"></a>      <a href="extrapolate2ndhalo_p.html#i13" target="origFile">rlv0 => rlv(<code class="constant">0</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i13" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i15" target="origFile"><code class="keyword">IF</code> (eddymodel) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i17"></a>      <a href="extrapolate2ndhalo_p.html#i15" target="origFile">rev0 => rev(<code class="constant">0</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
<a name="setbcpointers_cd0i18"></a>    <a href="extrapolate2ndhalo_p.html#i15" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i17" target="origFile">idim = <code class="constant">1</code></a>
    <a href="extrapolate2ndhalo_p.html#i18" target="origFile">ddim = <code class="constant">0</code></a>
  <a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="keyword">CASE </code>(imax) </a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0d => wd(ib, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0 => w(ib, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
<a name="setbcpointers_cd0i21"></a>    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0d => pd(ib, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0 => p(ib, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i21" target="origFile"><code class="keyword">IF</code> (viscous) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i23"></a>      <a href="extrapolate2ndhalo_p.html#i21" target="origFile">rlv0 => rlv(ib, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i21" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i23" target="origFile"><code class="keyword">IF</code> (eddymodel) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i25"></a>      <a href="extrapolate2ndhalo_p.html#i23" target="origFile">rev0 => rev(ib, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
<a name="setbcpointers_cd0i26"></a>    <a href="extrapolate2ndhalo_p.html#i23" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i25" target="origFile">idim = <code class="constant">1</code></a>
    <a href="extrapolate2ndhalo_p.html#i26" target="origFile">ddim = ib</a>
  <a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0d => wd(<code class="constant">1</code>:, <code class="constant">0</code>, <code class="constant">1</code>:, :)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0 => w(<code class="constant">1</code>:, <code class="constant">0</code>, <code class="constant">1</code>:, :)</a>
<a name="setbcpointers_cd0i29"></a>    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0d => pd(<code class="constant">1</code>:, <code class="constant">0</code>, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0 => p(<code class="constant">1</code>:, <code class="constant">0</code>, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i29" target="origFile"><code class="keyword">IF</code> (viscous) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i31"></a>      <a href="extrapolate2ndhalo_p.html#i29" target="origFile">rlv0 => rlv(<code class="constant">1</code>:, <code class="constant">0</code>, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i29" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i31" target="origFile"><code class="keyword">IF</code> (eddymodel) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i33"></a>      <a href="extrapolate2ndhalo_p.html#i31" target="origFile">rev0 => rev(<code class="constant">1</code>:, <code class="constant">0</code>, <code class="constant">1</code>:)</a>
<a name="setbcpointers_cd0i34"></a>    <a href="extrapolate2ndhalo_p.html#i31" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i33" target="origFile">idim = <code class="constant">2</code></a>
    <a href="extrapolate2ndhalo_p.html#i34" target="origFile">ddim = <code class="constant">0</code></a>
  <a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0d => wd(<code class="constant">1</code>:, jb, <code class="constant">1</code>:, :)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0 => w(<code class="constant">1</code>:, jb, <code class="constant">1</code>:, :)</a>
<a name="setbcpointers_cd0i37"></a>    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0d => pd(<code class="constant">1</code>:, jb, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0 => p(<code class="constant">1</code>:, jb, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i37" target="origFile"><code class="keyword">IF</code> (viscous) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i39"></a>      <a href="extrapolate2ndhalo_p.html#i37" target="origFile">rlv0 => rlv(<code class="constant">1</code>:, jb, <code class="constant">1</code>:)</a>
    <a href="extrapolate2ndhalo_p.html#i37" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i39" target="origFile"><code class="keyword">IF</code> (eddymodel) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i41"></a>      <a href="extrapolate2ndhalo_p.html#i39" target="origFile">rev0 => rev(<code class="constant">1</code>:, jb, <code class="constant">1</code>:)</a>
<a name="setbcpointers_cd0i42"></a>    <a href="extrapolate2ndhalo_p.html#i39" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i41" target="origFile">idim = <code class="constant">2</code></a>
    <a href="extrapolate2ndhalo_p.html#i42" target="origFile">ddim = jb</a>
  <a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0d => wd(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">0</code>, :)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0 => w(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">0</code>, :)</a>
<a name="setbcpointers_cd0i45"></a>    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0d => pd(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">0</code>)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">0</code>)</a>
    <a href="extrapolate2ndhalo_p.html#i45" target="origFile"><code class="keyword">IF</code> (viscous) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i47"></a>      <a href="extrapolate2ndhalo_p.html#i45" target="origFile">rlv0 => rlv(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">0</code>)</a>
    <a href="extrapolate2ndhalo_p.html#i45" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i47" target="origFile"><code class="keyword">IF</code> (eddymodel) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i49"></a>      <a href="extrapolate2ndhalo_p.html#i47" target="origFile">rev0 => rev(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">0</code>)</a>
<a name="setbcpointers_cd0i50"></a>    <a href="extrapolate2ndhalo_p.html#i47" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i49" target="origFile">idim = <code class="constant">3</code></a>
    <a href="extrapolate2ndhalo_p.html#i50" target="origFile">ddim = <code class="constant">0</code></a>
  <a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0d => wd(<code class="constant">1</code>:, <code class="constant">1</code>:, kb, :)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">ww0 => w(<code class="constant">1</code>:, <code class="constant">1</code>:, kb, :)</a>
<a name="setbcpointers_cd0i53"></a>    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0d => pd(<code class="constant">1</code>:, <code class="constant">1</code>:, kb)</a>
    <a href="extrapolate2ndhalo_p.html#i10" target="origFile">pp0 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, kb)</a>
    <a href="extrapolate2ndhalo_p.html#i53" target="origFile"><code class="keyword">IF</code> (viscous) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i55"></a>      <a href="extrapolate2ndhalo_p.html#i53" target="origFile">rlv0 => rlv(<code class="constant">1</code>:, <code class="constant">1</code>:, kb)</a>
    <a href="extrapolate2ndhalo_p.html#i53" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i55" target="origFile"><code class="keyword">IF</code> (eddymodel) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i57"></a>      <a href="extrapolate2ndhalo_p.html#i55" target="origFile">rev0 => rev(<code class="constant">1</code>:, <code class="constant">1</code>:, kb)</a>
<a name="setbcpointers_cd0i58"></a>    <a href="extrapolate2ndhalo_p.html#i55" target="origFile"><code class="keyword">END IF</code></a>
    <a href="extrapolate2ndhalo_p.html#i57" target="origFile">idim = <code class="constant">3</code></a>
<a name="setbcpointers_cd0i59"></a>    <a href="extrapolate2ndhalo_p.html#i58" target="origFile">ddim = kb</a>
  <a href="extrapolate2ndhalo_p.html#i10" target="origFile"><code class="keyword">END SELECT</code></a>
<a name="setbcpointers_cd0i60"></a><a href="extrapolate2ndhalo_p.html#i59" target="origFile"><code class="comment">! Loop over the generic subface to set the state in the halo's.</code></a>
<a name="setbcpointers_cd0i61"></a>  <a href="extrapolate2ndhalo_p.html#i59" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
    <a href="extrapolate2ndhalo_p.html#i60" target="origFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
<a href="extrapolate2ndhalo_p.html#i61" target="origFile"><code class="comment">! Extrapolate the density, momentum and pressure.</code></a>
<a href="extrapolate2ndhalo_p.html#i61" target="origFile"><code class="comment">! Make sure that a certain threshold is kept.</code></a>
<a name="setbcpointers_cd0i62"></a>      <a href="extrapolate2ndhalo_p.html#i61" target="origFile">ww0d(i, j, irho) = two*ww1d(i, j, irho) - ww2d(i, j, irho)</a>
<a name="setbcpointers_cd0i64"></a>      <a href="extrapolate2ndhalo_p.html#i61" target="origFile">ww0(i, j, irho) = two*ww1(i, j, irho) - ww2(i, j, irho)</a>
      <a href="extrapolate2ndhalo_p.html#i62" target="origFile"><code class="keyword">IF</code> (factor*ww1(i, j, irho) .LT. ww0(i, j, irho)) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i63"></a>        <a href="extrapolate2ndhalo_p.html#i64" target="origFile">ww0(i, j, irho) = ww0(i, j, irho)</a>
      <a href="extrapolate2ndhalo_p.html#i62" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="extrapolate2ndhalo_p.html#i63" target="origFile">ww0d(i, j, irho) = factor*ww1d(i, j, irho)</a>
<a name="setbcpointers_cd0i65"></a>        <a href="extrapolate2ndhalo_p.html#i63" target="origFile">ww0(i, j, irho) = factor*ww1(i, j, irho)</a>
      <a href="extrapolate2ndhalo_p.html#i62" target="origFile"><code class="keyword">END IF</code></a>
<a name="setbcpointers_cd0i66"></a>      <a href="extrapolate2ndhalo_p.html#i65" target="origFile">ww0d(i, j, ivx) = two*ww1d(i, j, ivx) - ww2d(i, j, ivx)</a>
      <a href="extrapolate2ndhalo_p.html#i65" target="origFile">ww0(i, j, ivx) = two*ww1(i, j, ivx) - ww2(i, j, ivx)</a>
<a name="setbcpointers_cd0i67"></a>      <a href="extrapolate2ndhalo_p.html#i66" target="origFile">ww0d(i, j, ivy) = two*ww1d(i, j, ivy) - ww2d(i, j, ivy)</a>
      <a href="extrapolate2ndhalo_p.html#i66" target="origFile">ww0(i, j, ivy) = two*ww1(i, j, ivy) - ww2(i, j, ivy)</a>
<a name="setbcpointers_cd0i68"></a>      <a href="extrapolate2ndhalo_p.html#i67" target="origFile">ww0d(i, j, ivz) = two*ww1d(i, j, ivz) - ww2d(i, j, ivz)</a>
<a name="setbcpointers_cd0i70"></a>      <a href="extrapolate2ndhalo_p.html#i67" target="origFile">ww0(i, j, ivz) = two*ww1(i, j, ivz) - ww2(i, j, ivz)</a>
      <a href="extrapolate2ndhalo_p.html#i68" target="origFile"><code class="keyword">IF</code> (factor*pp1(i, j) .LT. two*pp1(i, j) - pp2(i, j)) <code class="keyword">THEN</code></a>
        <a href="extrapolate2ndhalo_p.html#i70" target="origFile">pp0d(i, j) = two*pp1d(i, j) - pp2d(i, j)</a>
<a name="setbcpointers_cd0i69"></a>        <a href="extrapolate2ndhalo_p.html#i70" target="origFile">pp0(i, j) = two*pp1(i, j) - pp2(i, j)</a>
      <a href="extrapolate2ndhalo_p.html#i68" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="extrapolate2ndhalo_p.html#i69" target="origFile">pp0d(i, j) = factor*pp1d(i, j)</a>
<a name="setbcpointers_cd0i71"></a>        <a href="extrapolate2ndhalo_p.html#i69" target="origFile">pp0(i, j) = factor*pp1(i, j)</a>
      <a href="extrapolate2ndhalo_p.html#i68" target="origFile"><code class="keyword">END IF</code></a>
<a href="extrapolate2ndhalo_p.html#i71" target="origFile"><code class="comment">! Extrapolate the turbulent variables. Use constant</code></a>
<a name="setbcpointers_cd0i72"></a><a href="extrapolate2ndhalo_p.html#i71" target="origFile"><code class="comment">! extrapolation.</code></a>
      <a href="extrapolate2ndhalo_p.html#i71" target="origFile"><code class="keyword">DO </code>l=nt1mg,nt2mg</a>
        <a href="extrapolate2ndhalo_p.html#i72" target="origFile">ww0d(i, j, l) = ww1d(i, j, l)</a>
<a name="setbcpointers_cd0i73"></a>        <a href="extrapolate2ndhalo_p.html#i72" target="origFile">ww0(i, j, l) = ww1(i, j, l)</a>
      <a href="extrapolate2ndhalo_p.html#i71" target="origFile"><code class="keyword">END DO</code></a>
<a name="setbcpointers_cd0i74"></a><a href="extrapolate2ndhalo_p.html#i73" target="origFile"><code class="comment">! The laminar and eddy viscosity, if present. These values</code></a>
<a name="setbcpointers_cd0i76"></a><a name="setbcpointers_cd0i75"></a><a href="extrapolate2ndhalo_p.html#i73" target="origFile"><code class="comment">! are simply taken constant. Their values do not matter.</code></a>
      <a href="extrapolate2ndhalo_p.html#i73" target="origFile"><code class="keyword">IF</code> (viscous) </a><a href="extrapolate2ndhalo_p.html#i74" target="origFile">rlv0(i, j) = rlv1(i, j)</a>
      <a href="extrapolate2ndhalo_p.html#i75" target="origFile"><code class="keyword">IF</code> (eddymodel) </a><a href="extrapolate2ndhalo_p.html#i76" target="origFile">rev0(i, j) = rev1(i, j)</a>
<a name="setbcpointers_cd0i77"></a>    <a href="extrapolate2ndhalo_p.html#i60" target="origFile"><code class="keyword">END DO</code></a>
  <a href="extrapolate2ndhalo_p.html#i59" target="origFile"><code class="keyword">END DO</code></a>
<a name="setbcpointers_cd0i78"></a><a href="extrapolate2ndhalo_p.html#i77" target="origFile"><code class="comment">! Set the range for the halo cells for the energy computation.</code></a>
<a name="setbcpointers_cd0i79"></a>  <a href="extrapolate2ndhalo_p.html#i77" target="origFile">crange(<code class="constant">1</code>, <code class="constant">1</code>) = icbeg(nn)</a>
<a name="setbcpointers_cd0i80"></a>  <a href="extrapolate2ndhalo_p.html#i78" target="origFile">crange(<code class="constant">1</code>, <code class="constant">2</code>) = icend(nn)</a>
<a name="setbcpointers_cd0i81"></a>  <a href="extrapolate2ndhalo_p.html#i79" target="origFile">crange(<code class="constant">2</code>, <code class="constant">1</code>) = jcbeg(nn)</a>
<a name="setbcpointers_cd0i82"></a>  <a href="extrapolate2ndhalo_p.html#i80" target="origFile">crange(<code class="constant">2</code>, <code class="constant">2</code>) = jcend(nn)</a>
<a name="setbcpointers_cd0i83"></a>  <a href="extrapolate2ndhalo_p.html#i81" target="origFile">crange(<code class="constant">3</code>, <code class="constant">1</code>) = kcbeg(nn)</a>
<a name="setbcpointers_cd0i84"></a>  <a href="extrapolate2ndhalo_p.html#i82" target="origFile">crange(<code class="constant">3</code>, <code class="constant">2</code>) = kcend(nn)</a>
<a name="setbcpointers_cd0i85"></a>  <a href="extrapolate2ndhalo_p.html#i83" target="origFile">crange(idim, <code class="constant">1</code>) = ddim</a>
  <a href="extrapolate2ndhalo_p.html#i84" target="origFile">crange(idim, <code class="constant">2</code>) = ddim</a>
<a href="extrapolate2ndhalo_p.html#i85" target="origFile"><code class="comment">! Compute the energy for this halo range.</code></a>
  <a href="extrapolate2ndhalo_p.html#i85" target="origFile"><code class="keyword">CALL </code><code class="funcname">COMPUTEETOT_SPATIAL_D</code>(crange(<code class="constant">1</code>, <code class="constant">1</code>), crange(<code class="constant">1</code>, <code class="constant">2</code>), crange(<code class="constant">2</code>, <code class="constant">1</code>), <code class="label">&</code></a>
<a href="extrapolate2ndhalo_p.html#i85" target="origFile"><code class="label">&                       </code>crange(<code class="constant">2</code>, <code class="constant">2</code>), crange(<code class="constant">3</code>, <code class="constant">1</code>), crange(<code class="constant">3</code>, <code class="constant">2</code>), <code class="label">&</code></a>
<a href="extrapolate2ndhalo_p.html#i85" target="origFile"><code class="label">&                       </code>correctfork)</a>
<a href="extrapolate2ndhalo_p.html#extrapolate2ndhalo" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">EXTRAPOLATE2NDHALO_SPATIAL_D</code></a>
</pre>
</body>
