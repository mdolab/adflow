<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="invisciddissfluxmatrix_spatial_d"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!  Differentiation of invisciddissfluxmatrix in forward (tangent) mode:</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!   variations   of useful results: *fw</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!   with respect to varying inputs: *p *gamma *w *si *sj *sk</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * File:          inviscidDissFluxMatrix.f90                      *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Starting date: 03-25-2003                                      *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Last modified: 10-29-2007                                      *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">INVISCIDDISSFLUXMATRIX_SPATIAL_D</code>()</a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">CGNSGRID_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTDISCRETIZATION_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
<a name="invisciddissfluxmatrix_spatial_di0"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      * inviscidDissFluxMatrix computes the matrix artificial          *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      * dissipation term. Instead of the spectral radius, as used in   *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      * the scalar dissipation scheme, the absolute value of the flux  *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      * jacobian is used. This leads to a less diffusive and           *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      * consequently more accurate scheme. It is assumed that the      *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      * pointers in blockPointers already point to the correct block.  *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!      Local parameters.</code></a>
<a name="invisciddissfluxmatrix_spatial_di1"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="comment">!</code></a>
<a name="invisciddissfluxmatrix_spatial_di2"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi0" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">dpmax</code>=<code class="constant">0.25_realType</code></a>
<a name="invisciddissfluxmatrix_spatial_di3"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi1" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">epsacoustic</code>=<code class="constant">0.25_realType</code></a>
<a name="invisciddissfluxmatrix_spatial_di4"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">epsshear</code>=<code class="constant">0.025_realType</code></a>
<a name="invisciddissfluxmatrix_spatial_di5"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi3" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">omega</code>=<code class="constant">0.5_realType</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi4" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">oneminomega</code>=<code class="vardecl">one</code>-<code class="vardecl">omega</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi5" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi5" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="invisciddissfluxmatrix_spatial_di6"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi5" target="origFile"><code class="comment">!</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi5" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">ind</code></a>
<a name="invisciddissfluxmatrix_spatial_di7"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi6" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">plim</code>, <code class="vardecl">sface</code></a>
<a name="invisciddissfluxmatrix_spatial_di8"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sfaced</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi7" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sfil</code>, <code class="vardecl">fis2</code>, <code class="vardecl">fis4</code></a>
<a name="invisciddissfluxmatrix_spatial_di9"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi8" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">gammaavg</code>, <code class="vardecl">gm1</code>, <code class="vardecl">ovgm1</code>, <code class="vardecl">gm53</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">gammaavgd</code>, <code class="vardecl">gm1d</code>, <code class="vardecl">ovgm1d</code>, <code class="vardecl">gm53d</code></a>
<a name="invisciddissfluxmatrix_spatial_di10"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi9" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ppor</code>, <code class="vardecl">rrad</code>, <code class="vardecl">dis2</code>, <code class="vardecl">dis4</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rradd</code>, <code class="vardecl">dis2d</code>, <code class="vardecl">dis4d</code></a>
<a name="invisciddissfluxmatrix_spatial_di11"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi10" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dp1</code>, <code class="vardecl">dp2</code>, <code class="vardecl">ddw</code>, <code class="vardecl">tmp</code>, <code class="vardecl">fs</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dp1d</code>, <code class="vardecl">dp2d</code>, <code class="vardecl">ddwd</code>, <code class="vardecl">tmpd</code>, <code class="vardecl">fsd</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi11" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dr</code>, <code class="vardecl">dru</code>, <code class="vardecl">drv</code>, <code class="vardecl">drw</code>, <code class="vardecl">dre</code>, <code class="vardecl">drk</code>, <code class="vardecl">sx</code>, <code class="vardecl">sy</code>, <code class="vardecl">sz</code></a>
<a name="invisciddissfluxmatrix_spatial_di12"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">drd</code>, <code class="vardecl">drud</code>, <code class="vardecl">drvd</code>, <code class="vardecl">drwd</code>, <code class="vardecl">dred</code>, <code class="vardecl">drkd</code>, <code class="vardecl">sxd</code>, <code class="vardecl">syd</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&  </code><code class="vardecl">szd</code></a>
<a name="invisciddissfluxmatrix_spatial_di13"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi12" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">uavg</code>, <code class="vardecl">vavg</code>, <code class="vardecl">wavg</code>, <code class="vardecl">a2avg</code>, <code class="vardecl">aavg</code>, <code class="vardecl">havg</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">uavgd</code>, <code class="vardecl">vavgd</code>, <code class="vardecl">wavgd</code>, <code class="vardecl">a2avgd</code>, <code class="vardecl">aavgd</code>, <code class="vardecl">havgd</code></a>
<a name="invisciddissfluxmatrix_spatial_di14"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi13" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">alphaavg</code>, <code class="vardecl">unavg</code>, <code class="vardecl">ovaavg</code>, <code class="vardecl">ova2avg</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">alphaavgd</code>, <code class="vardecl">unavgd</code>, <code class="vardecl">ovaavgd</code>, <code class="vardecl">ova2avgd</code></a>
<a name="invisciddissfluxmatrix_spatial_di15"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi14" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">kavg</code>, <code class="vardecl">lam1</code>, <code class="vardecl">lam2</code>, <code class="vardecl">lam3</code>, <code class="vardecl">area</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">kavgd</code>, <code class="vardecl">lam1d</code>, <code class="vardecl">lam2d</code>, <code class="vardecl">lam3d</code>, <code class="vardecl">aread</code></a>
<a name="invisciddissfluxmatrix_spatial_di16"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi15" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abv1</code>, <code class="vardecl">abv2</code>, <code class="vardecl">abv3</code>, <code class="vardecl">abv4</code>, <code class="vardecl">abv5</code>, <code class="vardecl">abv6</code>, <code class="vardecl">abv7</code></a>
<a name="invisciddissfluxmatrix_spatial_di17"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abv1d</code>, <code class="vardecl">abv2d</code>, <code class="vardecl">abv3d</code>, <code class="vardecl">abv4d</code>, <code class="vardecl">abv5d</code>, <code class="vardecl">abv6d</code>, <code class="vardecl">abv7d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi16" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">correctfork</code></a>
<a name="invisciddissfluxmatrix_spatial_di18"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi17" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="funcname">DIM_CD</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="funcname">DIM_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi18" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x6d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs1d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max2d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">min3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">min2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">min1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs4d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs11d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs7d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x6</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x5</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">min1d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x4</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x5d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y3d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max1d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs3d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs10d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs6d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs12</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs11</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs10</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs9d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">min3d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x4d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y2d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs9</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs8</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs7</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs6</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs5</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs4</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs2d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max3d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs5d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs12d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs8d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">min2d</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x3d</code></a>
<a name="invisciddissfluxmatrix_spatial_di19"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y1d</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="comment">!</code></a>
<a name="p10"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="comment">! Check if rFil == 0. If so, the dissipative flux needs not to</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="comment">! be computed.</code></a>
<a name="invisciddissfluxmatrix_spatial_di20"></a>  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p10" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile">rfil .EQ. zero) <code class="keyword">THEN</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile">fwd = <code class="constant">0.0</code></a>
<a name="invisciddissfluxmatrix_spatial_di21"></a>    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi20" target="origFile"><code class="keyword">RETURN</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="keyword">ELSE</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi21" target="origFile"><code class="comment">! Set the value of plim. To be fully consistent this must have</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi21" target="origFile"><code class="comment">! the dimension of a pressure. Therefore a fraction of pInfCorr</code></a>
<a name="invisciddissfluxmatrix_spatial_di22"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi21" target="origFile"><code class="comment">! is used.</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi21" target="origFile">plim = <code class="constant">0.001_realType</code>*pinfcorr</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi22" target="origFile"><code class="comment">! Determine whether or not the total energy must be corrected</code></a>
<a name="invisciddissfluxmatrix_spatial_di23"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi22" target="origFile"><code class="comment">! for the presence of the turbulent kinetic energy.</code></a>
<a name="invisciddissfluxmatrix_spatial_di24"></a>    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi22" target="origFile"><code class="keyword">IF</code> (kpresent) <code class="keyword">THEN</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi23" target="origFile"><code class="keyword">IF</code> (currentlevel .EQ. groundlevel .OR. turbcoupled) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrix_spatial_di25"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi24" target="origFile">correctfork = <code class="constant">.true.</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi23" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi25" target="origFile">correctfork = <code class="constant">.false.</code></a>
<a name="invisciddissfluxmatrix_spatial_di26"></a>      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi23" target="origFile"><code class="keyword">END IF</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi22" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di27"></a>      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi26" target="origFile">correctfork = <code class="constant">.false.</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi22" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi27" target="origFile"><code class="comment">! Initialize sface to zero. This value will be used if the</code></a>
<a name="invisciddissfluxmatrix_spatial_di28"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi27" target="origFile"><code class="comment">! block is not moving.</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi27" target="origFile">sface = zero</a>
<a name="invisciddissfluxmatrix_spatial_di29"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi28" target="origFile"><code class="comment">! Set a couple of constants for the scheme.</code></a>
<a name="invisciddissfluxmatrix_spatial_di30"></a>    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi28" target="origFile">fis2 = rfil*vis2</a>
<a name="invisciddissfluxmatrix_spatial_di31"></a>    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi29" target="origFile">fis4 = rfil*vis4</a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi30" target="origFile">sfil = one - rfil</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi31" target="origFile"><code class="comment">! Initialize the dissipative residual to a certain times,</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi31" target="origFile"><code class="comment">! possibly zero, the previously stored value. Owned cells</code></a>
<a name="invisciddissfluxmatrix_spatial_di32"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi31" target="origFile"><code class="comment">! only, because the halo values do not matter.</code></a>
<a name="invisciddissfluxmatrix_spatial_di33"></a>    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi31" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="invisciddissfluxmatrix_spatial_di34"></a>      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi32" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi33" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="invisciddissfluxmatrix_spatial_di35"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi34" target="origFile">fwd(i, j, k, irho) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi34" target="origFile">fw(i, j, k, irho) = sfil*fw(i, j, k, irho)</a>
<a name="invisciddissfluxmatrix_spatial_di36"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi35" target="origFile">fwd(i, j, k, imx) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi35" target="origFile">fw(i, j, k, imx) = sfil*fw(i, j, k, imx)</a>
<a name="invisciddissfluxmatrix_spatial_di37"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi36" target="origFile">fwd(i, j, k, imy) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi36" target="origFile">fw(i, j, k, imy) = sfil*fw(i, j, k, imy)</a>
<a name="invisciddissfluxmatrix_spatial_di38"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi37" target="origFile">fwd(i, j, k, imz) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi37" target="origFile">fw(i, j, k, imz) = sfil*fw(i, j, k, imz)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi38" target="origFile">fwd(i, j, k, irhoe) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi38" target="origFile">fw(i, j, k, irhoe) = sfil*fw(i, j, k, irhoe)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi33" target="origFile"><code class="keyword">END DO</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi32" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi31" target="origFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxmatrix_spatial_di39"></a>    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile">fwd = <code class="constant">0.0</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile">sfaced = <code class="constant">0.0</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi39" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi39" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi39" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi39" target="origFile"><code class="comment">!      * Dissipative fluxes in the i-direction.                         *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi39" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi39" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a name="invisciddissfluxmatrix_spatial_di40"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi39" target="origFile"><code class="comment">!</code></a>
<a name="invisciddissfluxmatrix_spatial_di41"></a>    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi39" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="invisciddissfluxmatrix_spatial_di43"></a>      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi40" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi41" target="origFile"><code class="keyword">IF</code> (p(<code class="constant">2</code>, j, k) - p(<code class="constant">1</code>, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi43" target="origFile">abs1d = pd(<code class="constant">2</code>, j, k) - pd(<code class="constant">1</code>, j, k)</a>
<a name="invisciddissfluxmatrix_spatial_di42"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi43" target="origFile">abs1 = p(<code class="constant">2</code>, j, k) - p(<code class="constant">1</code>, j, k)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi41" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi42" target="origFile">abs1d = -(pd(<code class="constant">2</code>, j, k)-pd(<code class="constant">1</code>, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di44"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi42" target="origFile">abs1 = -(p(<code class="constant">2</code>, j, k)-p(<code class="constant">1</code>, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di46"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi41" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi44" target="origFile"><code class="keyword">IF</code> (p(<code class="constant">1</code>, j, k) - p(<code class="constant">0</code>, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi46" target="origFile">abs7d = pd(<code class="constant">1</code>, j, k) - pd(<code class="constant">0</code>, j, k)</a>
<a name="invisciddissfluxmatrix_spatial_di45"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi46" target="origFile">abs7 = p(<code class="constant">1</code>, j, k) - p(<code class="constant">0</code>, j, k)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi44" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi45" target="origFile">abs7d = -(pd(<code class="constant">1</code>, j, k)-pd(<code class="constant">0</code>, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di47"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi45" target="origFile">abs7 = -(p(<code class="constant">1</code>, j, k)-p(<code class="constant">0</code>, j, k))</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi44" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi47" target="origFile">x1d = ((pd(<code class="constant">2</code>, j, k)-two*pd(<code class="constant">1</code>, j, k)+pd(<code class="constant">0</code>, j, k))*(omega*(p(<code class="constant">2</code>, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi47" target="origFile"><code class="label">&          </code>, k)+two*p(<code class="constant">1</code>, j, k)+p(<code class="constant">0</code>, j, k))+oneminomega*(abs1+abs7)+plim)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi47" target="origFile"><code class="label">&          </code>(p(<code class="constant">2</code>, j, k)-two*p(<code class="constant">1</code>, j, k)+p(<code class="constant">0</code>, j, k))*(omega*(pd(<code class="constant">2</code>, j, k)+two<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi47" target="origFile"><code class="label">&          </code>*pd(<code class="constant">1</code>, j, k)+pd(<code class="constant">0</code>, j, k))+oneminomega*(abs1d+abs7d)))/(omega*(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi47" target="origFile"><code class="label">&          </code>p(<code class="constant">2</code>, j, k)+two*p(<code class="constant">1</code>, j, k)+p(<code class="constant">0</code>, j, k))+oneminomega*(abs1+abs7)+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi47" target="origFile"><code class="label">&          </code>plim)**<code class="constant">2</code></a>
<a name="invisciddissfluxmatrix_spatial_di48"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi47" target="origFile">x1 = (p(<code class="constant">2</code>, j, k)-two*p(<code class="constant">1</code>, j, k)+p(<code class="constant">0</code>, j, k))/(omega*(p(<code class="constant">2</code>, j, k)+<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di49"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi47" target="origFile"><code class="label">&          </code>two*p(<code class="constant">1</code>, j, k)+p(<code class="constant">0</code>, j, k))+oneminomega*(abs1+abs7)+plim)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi48" target="origFile"><code class="keyword">IF</code> (x1 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi49" target="origFile">dp1d = x1d</a>
<a name="invisciddissfluxmatrix_spatial_di50"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi49" target="origFile">dp1 = x1</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi48" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi50" target="origFile">dp1d = -x1d</a>
<a name="invisciddissfluxmatrix_spatial_di51"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi50" target="origFile">dp1 = -x1</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi48" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di52"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi51" target="origFile"><code class="comment">! Loop in i-direction.</code></a>
<a name="invisciddissfluxmatrix_spatial_di54"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi51" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi52" target="origFile"><code class="keyword">IF</code> (p(i+<code class="constant">2</code>, j, k) - p(i+<code class="constant">1</code>, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi54" target="origFile">abs2d = pd(i+<code class="constant">2</code>, j, k) - pd(i+<code class="constant">1</code>, j, k)</a>
<a name="invisciddissfluxmatrix_spatial_di53"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi54" target="origFile">abs2 = p(i+<code class="constant">2</code>, j, k) - p(i+<code class="constant">1</code>, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi52" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi53" target="origFile">abs2d = -(pd(i+<code class="constant">2</code>, j, k)-pd(i+<code class="constant">1</code>, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di55"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi53" target="origFile">abs2 = -(p(i+<code class="constant">2</code>, j, k)-p(i+<code class="constant">1</code>, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di57"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi52" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi55" target="origFile"><code class="keyword">IF</code> (p(i+<code class="constant">1</code>, j, k) - p(i, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi57" target="origFile">abs8d = pd(i+<code class="constant">1</code>, j, k) - pd(i, j, k)</a>
<a name="invisciddissfluxmatrix_spatial_di56"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi57" target="origFile">abs8 = p(i+<code class="constant">1</code>, j, k) - p(i, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi55" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi56" target="origFile">abs8d = -(pd(i+<code class="constant">1</code>, j, k)-pd(i, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di58"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi56" target="origFile">abs8 = -(p(i+<code class="constant">1</code>, j, k)-p(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi55" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi58" target="origFile">x2d = ((pd(i+<code class="constant">2</code>, j, k)-two*pd(i+<code class="constant">1</code>, j, k)+pd(i, j, k))*(omega*(p<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi58" target="origFile"><code class="label">&            </code>(i+<code class="constant">2</code>, j, k)+two*p(i+<code class="constant">1</code>, j, k)+p(i, j, k))+oneminomega*(abs2+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi58" target="origFile"><code class="label">&            </code>abs8)+plim)-(p(i+<code class="constant">2</code>, j, k)-two*p(i+<code class="constant">1</code>, j, k)+p(i, j, k))*(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi58" target="origFile"><code class="label">&            </code>omega*(pd(i+<code class="constant">2</code>, j, k)+two*pd(i+<code class="constant">1</code>, j, k)+pd(i, j, k))+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi58" target="origFile"><code class="label">&            </code>oneminomega*(abs2d+abs8d)))/(omega*(p(i+<code class="constant">2</code>, j, k)+two*p(i+<code class="constant">1</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi58" target="origFile"><code class="label">&            </code>j, k)+p(i, j, k))+oneminomega*(abs2+abs8)+plim)**<code class="constant">2</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi58" target="origFile">x2 = (p(i+<code class="constant">2</code>, j, k)-two*p(i+<code class="constant">1</code>, j, k)+p(i, j, k))/(omega*(p(i+<code class="constant">2</code><code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di59"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi58" target="origFile"><code class="label">&            </code>, j, k)+two*p(i+<code class="constant">1</code>, j, k)+p(i, j, k))+oneminomega*(abs2+abs8)<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di60"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi58" target="origFile"><code class="label">&            </code>+plim)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi59" target="origFile"><code class="keyword">IF</code> (x2 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi60" target="origFile">dp2d = x2d</a>
<a name="invisciddissfluxmatrix_spatial_di61"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi60" target="origFile">dp2 = x2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi59" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi61" target="origFile">dp2d = -x2d</a>
<a name="invisciddissfluxmatrix_spatial_di62"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi61" target="origFile">dp2 = -x2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi59" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di64"></a><a name="invisciddissfluxmatrix_spatial_di63"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi62" target="origFile"><code class="comment">! Compute the dissipation coefficients for this face.</code></a>
<a name="invisciddissfluxmatrix_spatial_di65"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi62" target="origFile">ppor = zero</a>
<a name="invisciddissfluxmatrix_spatial_di67"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi63" target="origFile"><code class="keyword">IF</code> (pori(i, j, k) .EQ. normalflux) </a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi64" target="origFile">ppor = one</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi65" target="origFile"><code class="keyword">IF</code> (dp1 .LT. dp2) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi67" target="origFile">y1d = dp2d</a>
<a name="invisciddissfluxmatrix_spatial_di66"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi67" target="origFile">y1 = dp2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi65" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi66" target="origFile">y1d = dp1d</a>
<a name="invisciddissfluxmatrix_spatial_di68"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi66" target="origFile">y1 = dp1</a>
<a name="invisciddissfluxmatrix_spatial_di69"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi65" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi68" target="origFile"><code class="keyword">IF</code> (dpmax .GT. y1) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi69" target="origFile">min1d = y1d</a>
<a name="invisciddissfluxmatrix_spatial_di70"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi69" target="origFile">min1 = y1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi68" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi70" target="origFile">min1 = dpmax</a>
<a name="invisciddissfluxmatrix_spatial_di71"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi68" target="origFile">min1d = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi68" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di72"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi71" target="origFile">dis2d = ppor*fis2*min1d</a>
<a name="invisciddissfluxmatrix_spatial_di73"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi71" target="origFile">dis2 = ppor*fis2*min1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi72" target="origFile">dis4d = <code class="funcname">DIM_SPATIAL_D</code>(ppor*fis4, <code class="constant">0.0</code>, dis2, dis2d, dis4)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi73" target="origFile"><code class="comment">! Construct the vector of the first and third differences</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi73" target="origFile"><code class="comment">! multiplied by the appropriate constants.</code></a>
<a name="invisciddissfluxmatrix_spatial_di74"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi73" target="origFile">ddwd = wd(i+<code class="constant">1</code>, j, k, irho) - wd(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi73" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho) - w(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi74" target="origFile">drd = dis2d*ddw + dis2*ddwd - dis4d*(w(i+<code class="constant">2</code>, j, k, irho)-w(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi74" target="origFile"><code class="label">&            </code>, j, k, irho)-three*ddw) - dis4*(wd(i+<code class="constant">2</code>, j, k, irho)-wd(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi74" target="origFile"><code class="label">&            </code>, j, k, irho)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di75"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi74" target="origFile">dr = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)-w(i-<code class="constant">1</code>, j, k, irho)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi74" target="origFile"><code class="label">&            </code>three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi75" target="origFile">ddwd = wd(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivx) + w(i+<code class="constant">1</code>, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi75" target="origFile"><code class="label">&            </code>irho)*wd(i+<code class="constant">1</code>, j, k, ivx) - wd(i, j, k, irho)*w(i, j, k, ivx)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi75" target="origFile"><code class="label">&            </code>- w(i, j, k, irho)*wd(i, j, k, ivx)</a>
<a name="invisciddissfluxmatrix_spatial_di76"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi75" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivx) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi75" target="origFile"><code class="label">&            </code>w(i, j, k, ivx)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi76" target="origFile">drud = dis2d*ddw + dis2*ddwd - dis4d*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code><code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi76" target="origFile"><code class="label">&            </code>, j, k, ivx)-w(i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, ivx)-three*ddw)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi76" target="origFile"><code class="label">&            </code>- dis4*(wd(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, ivx)+w(i+<code class="constant">2</code>, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi76" target="origFile"><code class="label">&            </code>irho)*wd(i+<code class="constant">2</code>, j, k, ivx)-wd(i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi76" target="origFile"><code class="label">&            </code>ivx)-w(i-<code class="constant">1</code>, j, k, irho)*wd(i-<code class="constant">1</code>, j, k, ivx)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di77"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi76" target="origFile">dru = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, ivx)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi76" target="origFile"><code class="label">&            </code>i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, ivx)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi77" target="origFile">ddwd = wd(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivy) + w(i+<code class="constant">1</code>, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi77" target="origFile"><code class="label">&            </code>irho)*wd(i+<code class="constant">1</code>, j, k, ivy) - wd(i, j, k, irho)*w(i, j, k, ivy)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi77" target="origFile"><code class="label">&            </code>- w(i, j, k, irho)*wd(i, j, k, ivy)</a>
<a name="invisciddissfluxmatrix_spatial_di78"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi77" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivy) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi77" target="origFile"><code class="label">&            </code>w(i, j, k, ivy)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi78" target="origFile">drvd = dis2d*ddw + dis2*ddwd - dis4d*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code><code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi78" target="origFile"><code class="label">&            </code>, j, k, ivy)-w(i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, ivy)-three*ddw)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi78" target="origFile"><code class="label">&            </code>- dis4*(wd(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, ivy)+w(i+<code class="constant">2</code>, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi78" target="origFile"><code class="label">&            </code>irho)*wd(i+<code class="constant">2</code>, j, k, ivy)-wd(i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi78" target="origFile"><code class="label">&            </code>ivy)-w(i-<code class="constant">1</code>, j, k, irho)*wd(i-<code class="constant">1</code>, j, k, ivy)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di79"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi78" target="origFile">drv = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, ivy)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi78" target="origFile"><code class="label">&            </code>i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, ivy)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi79" target="origFile">ddwd = wd(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivz) + w(i+<code class="constant">1</code>, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi79" target="origFile"><code class="label">&            </code>irho)*wd(i+<code class="constant">1</code>, j, k, ivz) - wd(i, j, k, irho)*w(i, j, k, ivz)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi79" target="origFile"><code class="label">&            </code>- w(i, j, k, irho)*wd(i, j, k, ivz)</a>
<a name="invisciddissfluxmatrix_spatial_di80"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi79" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivz) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi79" target="origFile"><code class="label">&            </code>w(i, j, k, ivz)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi80" target="origFile">drwd = dis2d*ddw + dis2*ddwd - dis4d*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code><code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi80" target="origFile"><code class="label">&            </code>, j, k, ivz)-w(i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, ivz)-three*ddw)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi80" target="origFile"><code class="label">&            </code>- dis4*(wd(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, ivz)+w(i+<code class="constant">2</code>, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi80" target="origFile"><code class="label">&            </code>irho)*wd(i+<code class="constant">2</code>, j, k, ivz)-wd(i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi80" target="origFile"><code class="label">&            </code>ivz)-w(i-<code class="constant">1</code>, j, k, irho)*wd(i-<code class="constant">1</code>, j, k, ivz)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di81"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi80" target="origFile">drw = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, ivz)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi80" target="origFile"><code class="label">&            </code>i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, ivz)-three*ddw)</a>
<a name="invisciddissfluxmatrix_spatial_di82"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi81" target="origFile">ddwd = wd(i+<code class="constant">1</code>, j, k, irhoe) - wd(i, j, k, irhoe)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi81" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irhoe) - w(i, j, k, irhoe)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi82" target="origFile">dred = dis2d*ddw + dis2*ddwd - dis4d*(w(i+<code class="constant">2</code>, j, k, irhoe)-w(i-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi82" target="origFile"><code class="label">&            </code><code class="constant">1</code>, j, k, irhoe)-three*ddw) - dis4*(wd(i+<code class="constant">2</code>, j, k, irhoe)-wd(i<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi82" target="origFile"><code class="label">&            </code>-<code class="constant">1</code>, j, k, irhoe)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di83"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi82" target="origFile">dre = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irhoe)-w(i-<code class="constant">1</code>, j, k, irhoe)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi82" target="origFile"><code class="label">&            </code>-three*ddw)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi83" target="origFile"><code class="comment">! In case a k-equation is present, compute the difference</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi83" target="origFile"><code class="comment">! of rhok and store the average value of k. If not present,</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi83" target="origFile"><code class="comment">! set both these values to zero, such that later on no</code></a>
<a name="invisciddissfluxmatrix_spatial_di86"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi83" target="origFile"><code class="comment">! decision needs to be made anymore.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi83" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi86" target="origFile">ddwd = wd(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, itu1) + w(i+<code class="constant">1</code>, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi86" target="origFile"><code class="label">&              </code>, irho)*wd(i+<code class="constant">1</code>, j, k, itu1) - wd(i, j, k, irho)*w(i, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi86" target="origFile"><code class="label">&              </code>, itu1) - w(i, j, k, irho)*wd(i, j, k, itu1)</a>
<a name="invisciddissfluxmatrix_spatial_di87"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi86" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, itu1) - w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi86" target="origFile"><code class="label">&              </code>irho)*w(i, j, k, itu1)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi87" target="origFile">drkd = dis2d*ddw + dis2*ddwd - dis4d*(w(i+<code class="constant">2</code>, j, k, irho)*w(i<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi87" target="origFile"><code class="label">&              </code>+<code class="constant">2</code>, j, k, itu1)-w(i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, itu1)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi87" target="origFile"><code class="label">&              </code>three*ddw) - dis4*(wd(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, itu1)+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi87" target="origFile"><code class="label">&              </code>w(i+<code class="constant">2</code>, j, k, irho)*wd(i+<code class="constant">2</code>, j, k, itu1)-wd(i-<code class="constant">1</code>, j, k, irho)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi87" target="origFile"><code class="label">&              </code>*w(i-<code class="constant">1</code>, j, k, itu1)-w(i-<code class="constant">1</code>, j, k, irho)*wd(i-<code class="constant">1</code>, j, k, itu1)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi87" target="origFile"><code class="label">&              </code>-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di88"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi87" target="origFile">drk = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, itu1)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi87" target="origFile"><code class="label">&              </code>-w(i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, itu1)-three*ddw)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi88" target="origFile">kavgd = half*(wd(i, j, k, itu1)+wd(i+<code class="constant">1</code>, j, k, itu1))</a>
<a name="invisciddissfluxmatrix_spatial_di84"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi88" target="origFile">kavg = half*(w(i, j, k, itu1)+w(i+<code class="constant">1</code>, j, k, itu1))</a>
<a name="invisciddissfluxmatrix_spatial_di85"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi83" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi84" target="origFile">drk = zero</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi85" target="origFile">kavg = zero</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi83" target="origFile">kavgd = <code class="constant">0.0</code></a>
<a name="invisciddissfluxmatrix_spatial_di89"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi83" target="origFile">drkd = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi83" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi89" target="origFile"><code class="comment">! Compute the average value of gamma and compute some</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi89" target="origFile"><code class="comment">! expressions in which it occurs.</code></a>
<a name="invisciddissfluxmatrix_spatial_di90"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi89" target="origFile">gammaavgd = half*(gammad(i+<code class="constant">1</code>, j, k)+gammad(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi89" target="origFile">gammaavg = half*(gamma(i+<code class="constant">1</code>, j, k)+gamma(i, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di91"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi90" target="origFile">gm1d = gammaavgd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi90" target="origFile">gm1 = gammaavg - one</a>
<a name="invisciddissfluxmatrix_spatial_di92"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi91" target="origFile">ovgm1d = -(one*gm1d/gm1**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi91" target="origFile">ovgm1 = one/gm1</a>
<a name="invisciddissfluxmatrix_spatial_di93"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi92" target="origFile">gm53d = gammaavgd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi92" target="origFile">gm53 = gammaavg - five*third</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi93" target="origFile"><code class="comment">! Compute the average state at the interface.</code></a>
<a name="invisciddissfluxmatrix_spatial_di94"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi93" target="origFile">uavgd = half*(wd(i+<code class="constant">1</code>, j, k, ivx)+wd(i, j, k, ivx))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi93" target="origFile">uavg = half*(w(i+<code class="constant">1</code>, j, k, ivx)+w(i, j, k, ivx))</a>
<a name="invisciddissfluxmatrix_spatial_di95"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi94" target="origFile">vavgd = half*(wd(i+<code class="constant">1</code>, j, k, ivy)+wd(i, j, k, ivy))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi94" target="origFile">vavg = half*(w(i+<code class="constant">1</code>, j, k, ivy)+w(i, j, k, ivy))</a>
<a name="invisciddissfluxmatrix_spatial_di96"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi95" target="origFile">wavgd = half*(wd(i+<code class="constant">1</code>, j, k, ivz)+wd(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi95" target="origFile">wavg = half*(w(i+<code class="constant">1</code>, j, k, ivz)+w(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi96" target="origFile">a2avgd = half*(((gammad(i+<code class="constant">1</code>, j, k)*p(i+<code class="constant">1</code>, j, k)+gamma(i+<code class="constant">1</code>, j, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi96" target="origFile"><code class="label">&            </code>k)*pd(i+<code class="constant">1</code>, j, k))*w(i+<code class="constant">1</code>, j, k, irho)-gamma(i+<code class="constant">1</code>, j, k)*p(i+<code class="constant">1</code><code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi96" target="origFile"><code class="label">&            </code>, j, k)*wd(i+<code class="constant">1</code>, j, k, irho))/w(i+<code class="constant">1</code>, j, k, irho)**<code class="constant">2</code>+((gammad(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi96" target="origFile"><code class="label">&            </code>i, j, k)*p(i, j, k)+gamma(i, j, k)*pd(i, j, k))*w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi96" target="origFile"><code class="label">&            </code>irho)-gamma(i, j, k)*p(i, j, k)*wd(i, j, k, irho))/w(i, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi96" target="origFile"><code class="label">&            </code>, irho)**<code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di97"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi96" target="origFile">a2avg = half*(gamma(i+<code class="constant">1</code>, j, k)*p(i+<code class="constant">1</code>, j, k)/w(i+<code class="constant">1</code>, j, k, irho)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi96" target="origFile"><code class="label">&            </code>+gamma(i, j, k)*p(i, j, k)/w(i, j, k, irho))</a>
<a name="invisciddissfluxmatrix_spatial_di98"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi97" target="origFile">sxd = sid(i, j, k, <code class="constant">1</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi97" target="origFile">sx = si(i, j, k, <code class="constant">1</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di99"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi98" target="origFile">syd = sid(i, j, k, <code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi98" target="origFile">sy = si(i, j, k, <code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di100"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi99" target="origFile">szd = sid(i, j, k, <code class="constant">3</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi99" target="origFile">sz = si(i, j, k, <code class="constant">3</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di101"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi100" target="origFile">arg1d = <code class="constant">2</code>*sx*sxd + <code class="constant">2</code>*sy*syd + <code class="constant">2</code>*sz*szd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi100" target="origFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi101" target="origFile"><code class="keyword">IF</code> (arg1 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi101" target="origFile">aread = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi101" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi101" target="origFile">aread = arg1d/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg1))</a>
<a name="invisciddissfluxmatrix_spatial_di102"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi101" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di104"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi101" target="origFile">area = <code class="funcname">SQRT</code>(arg1)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi102" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi104" target="origFile">max1d = aread</a>
<a name="invisciddissfluxmatrix_spatial_di103"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi104" target="origFile">max1 = area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi102" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi103" target="origFile">max1 = <code class="constant">1.e-25_realType</code></a>
<a name="invisciddissfluxmatrix_spatial_di105"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi102" target="origFile">max1d = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi102" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di106"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi105" target="origFile">tmpd = -(one*max1d/max1**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi105" target="origFile">tmp = one/max1</a>
<a name="invisciddissfluxmatrix_spatial_di107"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi106" target="origFile">sxd = sxd*tmp + sx*tmpd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi106" target="origFile">sx = sx*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di108"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi107" target="origFile">syd = syd*tmp + sy*tmpd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi107" target="origFile">sy = sy*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di109"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi108" target="origFile">szd = szd*tmp + sz*tmpd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi108" target="origFile">sz = sz*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di110"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi109" target="origFile">alphaavgd = half*(<code class="constant">2</code>*uavg*uavgd+<code class="constant">2</code>*vavg*vavgd+<code class="constant">2</code>*wavg*wavgd)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi109" target="origFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi110" target="origFile">havgd = alphaavgd + ovgm1d*(a2avg-gm53*kavg) + ovgm1*(a2avgd-<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di111"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi110" target="origFile"><code class="label">&            </code>gm53d*kavg-gm53*kavgd)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi110" target="origFile">havg = alphaavg + ovgm1*(a2avg-gm53*kavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi111" target="origFile"><code class="keyword">IF</code> (a2avg .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi111" target="origFile">aavgd = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi111" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi111" target="origFile">aavgd = a2avgd/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(a2avg))</a>
<a name="invisciddissfluxmatrix_spatial_di112"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi111" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi111" target="origFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi112" target="origFile">unavgd = uavgd*sx + uavg*sxd + vavgd*sy + vavg*syd + wavgd*sz <code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di113"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi112" target="origFile"><code class="label">&            </code>+ wavg*szd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi112" target="origFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
<a name="invisciddissfluxmatrix_spatial_di114"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi113" target="origFile">ovaavgd = -(one*aavgd/aavg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi113" target="origFile">ovaavg = one/aavg</a>
<a name="invisciddissfluxmatrix_spatial_di115"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi114" target="origFile">ova2avgd = -(one*a2avgd/a2avg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi114" target="origFile">ova2avg = one/a2avg</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi115" target="origFile"><code class="comment">! The mesh velocity if the face is moving. It must be</code></a>
<a name="invisciddissfluxmatrix_spatial_di116"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi115" target="origFile"><code class="comment">! divided by the area to obtain a true velocity.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi115" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi116" target="origFile">sfaced = sfacei(i, j, k)*tmpd</a>
<a name="invisciddissfluxmatrix_spatial_di117"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi116" target="origFile">sface = sfacei(i, j, k)*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di119"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi115" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi117" target="origFile"><code class="keyword">IF</code> (unavg - sface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi119" target="origFile">lam1d = unavgd - sfaced + aavgd</a>
<a name="invisciddissfluxmatrix_spatial_di118"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi119" target="origFile">lam1 = unavg - sface + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi117" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi118" target="origFile">lam1d = -(unavgd-sfaced+aavgd)</a>
<a name="invisciddissfluxmatrix_spatial_di120"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi118" target="origFile">lam1 = -(unavg-sface+aavg)</a>
<a name="invisciddissfluxmatrix_spatial_di122"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi117" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi120" target="origFile"><code class="keyword">IF</code> (unavg - sface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi122" target="origFile">lam2d = unavgd - sfaced - aavgd</a>
<a name="invisciddissfluxmatrix_spatial_di121"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi122" target="origFile">lam2 = unavg - sface - aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi120" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi121" target="origFile">lam2d = -(unavgd-sfaced-aavgd)</a>
<a name="invisciddissfluxmatrix_spatial_di123"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi121" target="origFile">lam2 = -(unavg-sface-aavg)</a>
<a name="invisciddissfluxmatrix_spatial_di125"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi120" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi123" target="origFile"><code class="keyword">IF</code> (unavg - sface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi125" target="origFile">lam3d = unavgd - sfaced</a>
<a name="invisciddissfluxmatrix_spatial_di124"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi125" target="origFile">lam3 = unavg - sface</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi123" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi124" target="origFile">lam3d = -(unavgd-sfaced)</a>
<a name="invisciddissfluxmatrix_spatial_di126"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi124" target="origFile">lam3 = -(unavg-sface)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi123" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di127"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi126" target="origFile">rradd = lam3d + aavgd</a>
<a name="invisciddissfluxmatrix_spatial_di129"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi126" target="origFile">rrad = lam3 + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi127" target="origFile"><code class="keyword">IF</code> (lam1 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi129" target="origFile">lam1d = epsacoustic*rradd</a>
<a name="invisciddissfluxmatrix_spatial_di128"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi129" target="origFile">lam1 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi127" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di130"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi128" target="origFile">lam1 = lam1</a>
<a name="invisciddissfluxmatrix_spatial_di132"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi127" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi130" target="origFile"><code class="keyword">IF</code> (lam2 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi132" target="origFile">lam2d = epsacoustic*rradd</a>
<a name="invisciddissfluxmatrix_spatial_di131"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi132" target="origFile">lam2 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi130" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di133"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi131" target="origFile">lam2 = lam2</a>
<a name="invisciddissfluxmatrix_spatial_di135"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi130" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi133" target="origFile"><code class="keyword">IF</code> (lam3 .LT. epsshear*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi135" target="origFile">lam3d = epsshear*rradd</a>
<a name="invisciddissfluxmatrix_spatial_di134"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi135" target="origFile">lam3 = epsshear*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi133" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di136"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi134" target="origFile">lam3 = lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi133" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi136" target="origFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi136" target="origFile"><code class="comment">! the correct values for the dissipation term.</code></a>
<a name="invisciddissfluxmatrix_spatial_di137"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi136" target="origFile">lam1d = lam1d*area + lam1*aread</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi136" target="origFile">lam1 = lam1*area</a>
<a name="invisciddissfluxmatrix_spatial_di138"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi137" target="origFile">lam2d = lam2d*area + lam2*aread</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi137" target="origFile">lam2 = lam2*area</a>
<a name="invisciddissfluxmatrix_spatial_di139"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi138" target="origFile">lam3d = lam3d*area + lam3*aread</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi138" target="origFile">lam3 = lam3*area</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi139" target="origFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi139" target="origFile"><code class="comment">! dissipation terms.</code></a>
<a name="invisciddissfluxmatrix_spatial_di140"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi139" target="origFile">abv1d = half*(lam1d+lam2d)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi139" target="origFile">abv1 = half*(lam1+lam2)</a>
<a name="invisciddissfluxmatrix_spatial_di141"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi140" target="origFile">abv2d = half*(lam1d-lam2d)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi140" target="origFile">abv2 = half*(lam1-lam2)</a>
<a name="invisciddissfluxmatrix_spatial_di142"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi141" target="origFile">abv3d = abv1d - lam3d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi141" target="origFile">abv3 = abv1 - lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi142" target="origFile">abv4d = gm1d*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) + <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi142" target="origFile"><code class="label">&            </code>gm1*(alphaavgd*dr+alphaavg*drd-uavgd*dru-uavg*drud-vavgd*drv<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi142" target="origFile"><code class="label">&            </code>-vavg*drvd-wavgd*drw-wavg*drwd+dred) - gm53d*drk - gm53*drkd</a>
<a name="invisciddissfluxmatrix_spatial_di143"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi142" target="origFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi142" target="origFile"><code class="label">&            </code>*drk</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi143" target="origFile">abv5d = sxd*dru + sx*drud + syd*drv + sy*drvd + szd*drw + sz*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di144"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi143" target="origFile"><code class="label">&            </code>drwd - unavgd*dr - unavg*drd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi143" target="origFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi144" target="origFile">abv6d = (abv3d*abv4+abv3*abv4d)*ova2avg + abv3*abv4*ova2avgd +<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di145"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi144" target="origFile"><code class="label">&            </code>(abv2d*abv5+abv2*abv5d)*ovaavg + abv2*abv5*ovaavgd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi144" target="origFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi145" target="origFile">abv7d = (abv2d*abv4+abv2*abv4d)*ovaavg + abv2*abv4*ovaavgd + <code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di146"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi145" target="origFile"><code class="label">&            </code>abv3d*abv5 + abv3*abv5d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi145" target="origFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi146" target="origFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi146" target="origFile"><code class="comment">! Density.</code></a>
<a name="invisciddissfluxmatrix_spatial_di147"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi146" target="origFile">fsd = lam3d*dr + lam3*drd + abv6d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi146" target="origFile">fs = lam3*dr + abv6</a>
<a name="invisciddissfluxmatrix_spatial_di148"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi147" target="origFile">fwd(i+<code class="constant">1</code>, j, k, irho) = fwd(i+<code class="constant">1</code>, j, k, irho) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi147" target="origFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di149"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi148" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) - fsd</a>
<a name="invisciddissfluxmatrix_spatial_di150"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi148" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi149" target="origFile">ind = indfamilyi(i, j, k)</a>
<a name="invisciddissfluxmatrix_spatial_di151"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi150" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(ind<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi150" target="origFile"><code class="label">&            </code>, spectralsol) - factfamilyi(i, j, k)*fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi151" target="origFile"><code class="comment">! X-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi151" target="origFile">fsd = lam3d*dru + lam3*drud + uavgd*abv6 + uavg*abv6d + sxd*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di152"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi151" target="origFile"><code class="label">&            </code>abv7 + sx*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi151" target="origFile">fs = lam3*dru + uavg*abv6 + sx*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di153"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi152" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imx) = fwd(i+<code class="constant">1</code>, j, k, imx) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi152" target="origFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di154"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi153" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi153" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi154" target="origFile"><code class="comment">! Y-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi154" target="origFile">fsd = lam3d*drv + lam3*drvd + vavgd*abv6 + vavg*abv6d + syd*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di155"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi154" target="origFile"><code class="label">&            </code>abv7 + sy*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi154" target="origFile">fs = lam3*drv + vavg*abv6 + sy*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di156"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi155" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imy) = fwd(i+<code class="constant">1</code>, j, k, imy) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi155" target="origFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di157"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi156" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi156" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi157" target="origFile"><code class="comment">! Z-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi157" target="origFile">fsd = lam3d*drw + lam3*drwd + wavgd*abv6 + wavg*abv6d + szd*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di158"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi157" target="origFile"><code class="label">&            </code>abv7 + sz*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi157" target="origFile">fs = lam3*drw + wavg*abv6 + sz*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di159"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi158" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imz) = fwd(i+<code class="constant">1</code>, j, k, imz) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi158" target="origFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di160"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi159" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi159" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi160" target="origFile"><code class="comment">! Energy.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi160" target="origFile">fsd = lam3d*dre + lam3*dred + havgd*abv6 + havg*abv6d + unavgd<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di161"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi160" target="origFile"><code class="label">&            </code>*abv7 + unavg*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi160" target="origFile">fs = lam3*dre + havg*abv6 + unavg*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di162"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi161" target="origFile">fwd(i+<code class="constant">1</code>, j, k, irhoe) = fwd(i+<code class="constant">1</code>, j, k, irhoe) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi161" target="origFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di163"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi162" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi162" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi163" target="origFile"><code class="comment">! Set dp1 to dp2 for the next face.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi163" target="origFile">dp1d = dp2d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi163" target="origFile">dp1 = dp2</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi51" target="origFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxmatrix_spatial_di164"></a>      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi40" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi39" target="origFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi164" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi164" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi164" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi164" target="origFile"><code class="comment">!      * Dissipative fluxes in the j-direction.                         *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi164" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi164" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a name="invisciddissfluxmatrix_spatial_di165"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi164" target="origFile"><code class="comment">!</code></a>
<a name="invisciddissfluxmatrix_spatial_di166"></a>    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi164" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="invisciddissfluxmatrix_spatial_di168"></a>      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi165" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi166" target="origFile"><code class="keyword">IF</code> (p(i, <code class="constant">2</code>, k) - p(i, <code class="constant">1</code>, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi168" target="origFile">abs3d = pd(i, <code class="constant">2</code>, k) - pd(i, <code class="constant">1</code>, k)</a>
<a name="invisciddissfluxmatrix_spatial_di167"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi168" target="origFile">abs3 = p(i, <code class="constant">2</code>, k) - p(i, <code class="constant">1</code>, k)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi166" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi167" target="origFile">abs3d = -(pd(i, <code class="constant">2</code>, k)-pd(i, <code class="constant">1</code>, k))</a>
<a name="invisciddissfluxmatrix_spatial_di169"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi167" target="origFile">abs3 = -(p(i, <code class="constant">2</code>, k)-p(i, <code class="constant">1</code>, k))</a>
<a name="invisciddissfluxmatrix_spatial_di171"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi166" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi169" target="origFile"><code class="keyword">IF</code> (p(i, <code class="constant">1</code>, k) - p(i, <code class="constant">0</code>, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi171" target="origFile">abs9d = pd(i, <code class="constant">1</code>, k) - pd(i, <code class="constant">0</code>, k)</a>
<a name="invisciddissfluxmatrix_spatial_di170"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi171" target="origFile">abs9 = p(i, <code class="constant">1</code>, k) - p(i, <code class="constant">0</code>, k)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi169" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi170" target="origFile">abs9d = -(pd(i, <code class="constant">1</code>, k)-pd(i, <code class="constant">0</code>, k))</a>
<a name="invisciddissfluxmatrix_spatial_di172"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi170" target="origFile">abs9 = -(p(i, <code class="constant">1</code>, k)-p(i, <code class="constant">0</code>, k))</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi169" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi172" target="origFile">x3d = ((pd(i, <code class="constant">2</code>, k)-two*pd(i, <code class="constant">1</code>, k)+pd(i, <code class="constant">0</code>, k))*(omega*(p(i, <code class="constant">2</code><code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi172" target="origFile"><code class="label">&          </code>, k)+two*p(i, <code class="constant">1</code>, k)+p(i, <code class="constant">0</code>, k))+oneminomega*(abs3+abs9)+plim)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi172" target="origFile"><code class="label">&          </code>(p(i, <code class="constant">2</code>, k)-two*p(i, <code class="constant">1</code>, k)+p(i, <code class="constant">0</code>, k))*(omega*(pd(i, <code class="constant">2</code>, k)+two<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi172" target="origFile"><code class="label">&          </code>*pd(i, <code class="constant">1</code>, k)+pd(i, <code class="constant">0</code>, k))+oneminomega*(abs3d+abs9d)))/(omega*(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi172" target="origFile"><code class="label">&          </code>p(i, <code class="constant">2</code>, k)+two*p(i, <code class="constant">1</code>, k)+p(i, <code class="constant">0</code>, k))+oneminomega*(abs3+abs9)+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi172" target="origFile"><code class="label">&          </code>plim)**<code class="constant">2</code></a>
<a name="invisciddissfluxmatrix_spatial_di173"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi172" target="origFile">x3 = (p(i, <code class="constant">2</code>, k)-two*p(i, <code class="constant">1</code>, k)+p(i, <code class="constant">0</code>, k))/(omega*(p(i, <code class="constant">2</code>, k)+<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di174"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi172" target="origFile"><code class="label">&          </code>two*p(i, <code class="constant">1</code>, k)+p(i, <code class="constant">0</code>, k))+oneminomega*(abs3+abs9)+plim)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi173" target="origFile"><code class="keyword">IF</code> (x3 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi174" target="origFile">dp1d = x3d</a>
<a name="invisciddissfluxmatrix_spatial_di175"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi174" target="origFile">dp1 = x3</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi173" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi175" target="origFile">dp1d = -x3d</a>
<a name="invisciddissfluxmatrix_spatial_di176"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi175" target="origFile">dp1 = -x3</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi173" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di177"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi176" target="origFile"><code class="comment">! Loop in j-direction.</code></a>
<a name="invisciddissfluxmatrix_spatial_di179"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi176" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi177" target="origFile"><code class="keyword">IF</code> (p(i, j+<code class="constant">2</code>, k) - p(i, j+<code class="constant">1</code>, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi179" target="origFile">abs4d = pd(i, j+<code class="constant">2</code>, k) - pd(i, j+<code class="constant">1</code>, k)</a>
<a name="invisciddissfluxmatrix_spatial_di178"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi179" target="origFile">abs4 = p(i, j+<code class="constant">2</code>, k) - p(i, j+<code class="constant">1</code>, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi177" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi178" target="origFile">abs4d = -(pd(i, j+<code class="constant">2</code>, k)-pd(i, j+<code class="constant">1</code>, k))</a>
<a name="invisciddissfluxmatrix_spatial_di180"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi178" target="origFile">abs4 = -(p(i, j+<code class="constant">2</code>, k)-p(i, j+<code class="constant">1</code>, k))</a>
<a name="invisciddissfluxmatrix_spatial_di182"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi177" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi180" target="origFile"><code class="keyword">IF</code> (p(i, j+<code class="constant">1</code>, k) - p(i, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi182" target="origFile">abs10d = pd(i, j+<code class="constant">1</code>, k) - pd(i, j, k)</a>
<a name="invisciddissfluxmatrix_spatial_di181"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi182" target="origFile">abs10 = p(i, j+<code class="constant">1</code>, k) - p(i, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi180" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi181" target="origFile">abs10d = -(pd(i, j+<code class="constant">1</code>, k)-pd(i, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di183"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi181" target="origFile">abs10 = -(p(i, j+<code class="constant">1</code>, k)-p(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi180" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi183" target="origFile">x4d = ((pd(i, j+<code class="constant">2</code>, k)-two*pd(i, j+<code class="constant">1</code>, k)+pd(i, j, k))*(omega*(p<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi183" target="origFile"><code class="label">&            </code>(i, j+<code class="constant">2</code>, k)+two*p(i, j+<code class="constant">1</code>, k)+p(i, j, k))+oneminomega*(abs4+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi183" target="origFile"><code class="label">&            </code>abs10)+plim)-(p(i, j+<code class="constant">2</code>, k)-two*p(i, j+<code class="constant">1</code>, k)+p(i, j, k))*(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi183" target="origFile"><code class="label">&            </code>omega*(pd(i, j+<code class="constant">2</code>, k)+two*pd(i, j+<code class="constant">1</code>, k)+pd(i, j, k))+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi183" target="origFile"><code class="label">&            </code>oneminomega*(abs4d+abs10d)))/(omega*(p(i, j+<code class="constant">2</code>, k)+two*p(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi183" target="origFile"><code class="label">&            </code>+<code class="constant">1</code>, k)+p(i, j, k))+oneminomega*(abs4+abs10)+plim)**<code class="constant">2</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi183" target="origFile">x4 = (p(i, j+<code class="constant">2</code>, k)-two*p(i, j+<code class="constant">1</code>, k)+p(i, j, k))/(omega*(p(i, j<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di184"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi183" target="origFile"><code class="label">&            </code>+<code class="constant">2</code>, k)+two*p(i, j+<code class="constant">1</code>, k)+p(i, j, k))+oneminomega*(abs4+abs10)<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di185"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi183" target="origFile"><code class="label">&            </code>+plim)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi184" target="origFile"><code class="keyword">IF</code> (x4 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi185" target="origFile">dp2d = x4d</a>
<a name="invisciddissfluxmatrix_spatial_di186"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi185" target="origFile">dp2 = x4</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi184" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi186" target="origFile">dp2d = -x4d</a>
<a name="invisciddissfluxmatrix_spatial_di187"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi186" target="origFile">dp2 = -x4</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi184" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di189"></a><a name="invisciddissfluxmatrix_spatial_di188"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi187" target="origFile"><code class="comment">! Compute the dissipation coefficients for this face.</code></a>
<a name="invisciddissfluxmatrix_spatial_di190"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi187" target="origFile">ppor = zero</a>
<a name="invisciddissfluxmatrix_spatial_di192"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi188" target="origFile"><code class="keyword">IF</code> (porj(i, j, k) .EQ. normalflux) </a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi189" target="origFile">ppor = one</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi190" target="origFile"><code class="keyword">IF</code> (dp1 .LT. dp2) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi192" target="origFile">y2d = dp2d</a>
<a name="invisciddissfluxmatrix_spatial_di191"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi192" target="origFile">y2 = dp2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi190" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi191" target="origFile">y2d = dp1d</a>
<a name="invisciddissfluxmatrix_spatial_di193"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi191" target="origFile">y2 = dp1</a>
<a name="invisciddissfluxmatrix_spatial_di194"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi190" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi193" target="origFile"><code class="keyword">IF</code> (dpmax .GT. y2) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi194" target="origFile">min2d = y2d</a>
<a name="invisciddissfluxmatrix_spatial_di195"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi194" target="origFile">min2 = y2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi193" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi195" target="origFile">min2 = dpmax</a>
<a name="invisciddissfluxmatrix_spatial_di196"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi193" target="origFile">min2d = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi193" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di197"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi196" target="origFile">dis2d = ppor*fis2*min2d</a>
<a name="invisciddissfluxmatrix_spatial_di198"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi196" target="origFile">dis2 = ppor*fis2*min2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi197" target="origFile">dis4d = <code class="funcname">DIM_SPATIAL_D</code>(ppor*fis4, <code class="constant">0.0</code>, dis2, dis2d, dis4)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi198" target="origFile"><code class="comment">! Construct the vector of the first and third differences</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi198" target="origFile"><code class="comment">! multiplied by the appropriate constants.</code></a>
<a name="invisciddissfluxmatrix_spatial_di199"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi198" target="origFile">ddwd = wd(i, j+<code class="constant">1</code>, k, irho) - wd(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi198" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho) - w(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi199" target="origFile">drd = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j+<code class="constant">2</code>, k, irho)-w(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi199" target="origFile"><code class="label">&            </code>-<code class="constant">1</code>, k, irho)-three*ddw) - dis4*(wd(i, j+<code class="constant">2</code>, k, irho)-wd(i, j-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi199" target="origFile"><code class="label">&            </code><code class="constant">1</code>, k, irho)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di200"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi199" target="origFile">dr = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)-w(i, j-<code class="constant">1</code>, k, irho)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi199" target="origFile"><code class="label">&            </code>three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi200" target="origFile">ddwd = wd(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivx) + w(i, j+<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi200" target="origFile"><code class="label">&            </code>irho)*wd(i, j+<code class="constant">1</code>, k, ivx) - wd(i, j, k, irho)*w(i, j, k, ivx)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi200" target="origFile"><code class="label">&            </code>- w(i, j, k, irho)*wd(i, j, k, ivx)</a>
<a name="invisciddissfluxmatrix_spatial_di201"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi200" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivx) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi200" target="origFile"><code class="label">&            </code>w(i, j, k, ivx)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi201" target="origFile">drud = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi201" target="origFile"><code class="label">&            </code>j+<code class="constant">2</code>, k, ivx)-w(i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, ivx)-three*ddw)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi201" target="origFile"><code class="label">&            </code>- dis4*(wd(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, ivx)+w(i, j+<code class="constant">2</code>, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi201" target="origFile"><code class="label">&            </code>irho)*wd(i, j+<code class="constant">2</code>, k, ivx)-wd(i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi201" target="origFile"><code class="label">&            </code>ivx)-w(i, j-<code class="constant">1</code>, k, irho)*wd(i, j-<code class="constant">1</code>, k, ivx)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di202"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi201" target="origFile">dru = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, ivx)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi201" target="origFile"><code class="label">&            </code>i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, ivx)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi202" target="origFile">ddwd = wd(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivy) + w(i, j+<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi202" target="origFile"><code class="label">&            </code>irho)*wd(i, j+<code class="constant">1</code>, k, ivy) - wd(i, j, k, irho)*w(i, j, k, ivy)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi202" target="origFile"><code class="label">&            </code>- w(i, j, k, irho)*wd(i, j, k, ivy)</a>
<a name="invisciddissfluxmatrix_spatial_di203"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi202" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivy) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi202" target="origFile"><code class="label">&            </code>w(i, j, k, ivy)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi203" target="origFile">drvd = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi203" target="origFile"><code class="label">&            </code>j+<code class="constant">2</code>, k, ivy)-w(i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, ivy)-three*ddw)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi203" target="origFile"><code class="label">&            </code>- dis4*(wd(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, ivy)+w(i, j+<code class="constant">2</code>, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi203" target="origFile"><code class="label">&            </code>irho)*wd(i, j+<code class="constant">2</code>, k, ivy)-wd(i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi203" target="origFile"><code class="label">&            </code>ivy)-w(i, j-<code class="constant">1</code>, k, irho)*wd(i, j-<code class="constant">1</code>, k, ivy)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di204"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi203" target="origFile">drv = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, ivy)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi203" target="origFile"><code class="label">&            </code>i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, ivy)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi204" target="origFile">ddwd = wd(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivz) + w(i, j+<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi204" target="origFile"><code class="label">&            </code>irho)*wd(i, j+<code class="constant">1</code>, k, ivz) - wd(i, j, k, irho)*w(i, j, k, ivz)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi204" target="origFile"><code class="label">&            </code>- w(i, j, k, irho)*wd(i, j, k, ivz)</a>
<a name="invisciddissfluxmatrix_spatial_di205"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi204" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivz) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi204" target="origFile"><code class="label">&            </code>w(i, j, k, ivz)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi205" target="origFile">drwd = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi205" target="origFile"><code class="label">&            </code>j+<code class="constant">2</code>, k, ivz)-w(i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, ivz)-three*ddw)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi205" target="origFile"><code class="label">&            </code>- dis4*(wd(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, ivz)+w(i, j+<code class="constant">2</code>, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi205" target="origFile"><code class="label">&            </code>irho)*wd(i, j+<code class="constant">2</code>, k, ivz)-wd(i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi205" target="origFile"><code class="label">&            </code>ivz)-w(i, j-<code class="constant">1</code>, k, irho)*wd(i, j-<code class="constant">1</code>, k, ivz)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di206"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi205" target="origFile">drw = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, ivz)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi205" target="origFile"><code class="label">&            </code>i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, ivz)-three*ddw)</a>
<a name="invisciddissfluxmatrix_spatial_di207"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi206" target="origFile">ddwd = wd(i, j+<code class="constant">1</code>, k, irhoe) - wd(i, j, k, irhoe)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi206" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irhoe) - w(i, j, k, irhoe)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi207" target="origFile">dred = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j+<code class="constant">2</code>, k, irhoe)-w(i<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi207" target="origFile"><code class="label">&            </code>, j-<code class="constant">1</code>, k, irhoe)-three*ddw) - dis4*(wd(i, j+<code class="constant">2</code>, k, irhoe)-wd(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi207" target="origFile"><code class="label">&            </code>i, j-<code class="constant">1</code>, k, irhoe)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di208"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi207" target="origFile">dre = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irhoe)-w(i, j-<code class="constant">1</code>, k, irhoe)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi207" target="origFile"><code class="label">&            </code>-three*ddw)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi208" target="origFile"><code class="comment">! In case a k-equation is present, compute the difference</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi208" target="origFile"><code class="comment">! of rhok and store the average value of k. If not present,</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi208" target="origFile"><code class="comment">! set both these values to zero, such that later on no</code></a>
<a name="invisciddissfluxmatrix_spatial_di211"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi208" target="origFile"><code class="comment">! decision needs to be made anymore.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi208" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi211" target="origFile">ddwd = wd(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, itu1) + w(i, j+<code class="constant">1</code>, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi211" target="origFile"><code class="label">&              </code>, irho)*wd(i, j+<code class="constant">1</code>, k, itu1) - wd(i, j, k, irho)*w(i, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi211" target="origFile"><code class="label">&              </code>, itu1) - w(i, j, k, irho)*wd(i, j, k, itu1)</a>
<a name="invisciddissfluxmatrix_spatial_di212"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi211" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, itu1) - w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi211" target="origFile"><code class="label">&              </code>irho)*w(i, j, k, itu1)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi212" target="origFile">drkd = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j+<code class="constant">2</code>, k, irho)*w(i<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi212" target="origFile"><code class="label">&              </code>, j+<code class="constant">2</code>, k, itu1)-w(i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, itu1)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi212" target="origFile"><code class="label">&              </code>three*ddw) - dis4*(wd(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, itu1)+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi212" target="origFile"><code class="label">&              </code>w(i, j+<code class="constant">2</code>, k, irho)*wd(i, j+<code class="constant">2</code>, k, itu1)-wd(i, j-<code class="constant">1</code>, k, irho)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi212" target="origFile"><code class="label">&              </code>*w(i, j-<code class="constant">1</code>, k, itu1)-w(i, j-<code class="constant">1</code>, k, irho)*wd(i, j-<code class="constant">1</code>, k, itu1)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi212" target="origFile"><code class="label">&              </code>-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di213"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi212" target="origFile">drk = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, itu1)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi212" target="origFile"><code class="label">&              </code>-w(i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, itu1)-three*ddw)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi213" target="origFile">kavgd = half*(wd(i, j, k, itu1)+wd(i, j+<code class="constant">1</code>, k, itu1))</a>
<a name="invisciddissfluxmatrix_spatial_di209"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi213" target="origFile">kavg = half*(w(i, j, k, itu1)+w(i, j+<code class="constant">1</code>, k, itu1))</a>
<a name="invisciddissfluxmatrix_spatial_di210"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi208" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi209" target="origFile">drk = zero</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi210" target="origFile">kavg = zero</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi208" target="origFile">kavgd = <code class="constant">0.0</code></a>
<a name="invisciddissfluxmatrix_spatial_di214"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi208" target="origFile">drkd = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi208" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi214" target="origFile"><code class="comment">! Compute the average value of gamma and compute some</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi214" target="origFile"><code class="comment">! expressions in which it occurs.</code></a>
<a name="invisciddissfluxmatrix_spatial_di215"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi214" target="origFile">gammaavgd = half*(gammad(i, j+<code class="constant">1</code>, k)+gammad(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi214" target="origFile">gammaavg = half*(gamma(i, j+<code class="constant">1</code>, k)+gamma(i, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di216"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi215" target="origFile">gm1d = gammaavgd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi215" target="origFile">gm1 = gammaavg - one</a>
<a name="invisciddissfluxmatrix_spatial_di217"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi216" target="origFile">ovgm1d = -(one*gm1d/gm1**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi216" target="origFile">ovgm1 = one/gm1</a>
<a name="invisciddissfluxmatrix_spatial_di218"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi217" target="origFile">gm53d = gammaavgd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi217" target="origFile">gm53 = gammaavg - five*third</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi218" target="origFile"><code class="comment">! Compute the average state at the interface.</code></a>
<a name="invisciddissfluxmatrix_spatial_di219"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi218" target="origFile">uavgd = half*(wd(i, j+<code class="constant">1</code>, k, ivx)+wd(i, j, k, ivx))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi218" target="origFile">uavg = half*(w(i, j+<code class="constant">1</code>, k, ivx)+w(i, j, k, ivx))</a>
<a name="invisciddissfluxmatrix_spatial_di220"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi219" target="origFile">vavgd = half*(wd(i, j+<code class="constant">1</code>, k, ivy)+wd(i, j, k, ivy))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi219" target="origFile">vavg = half*(w(i, j+<code class="constant">1</code>, k, ivy)+w(i, j, k, ivy))</a>
<a name="invisciddissfluxmatrix_spatial_di221"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi220" target="origFile">wavgd = half*(wd(i, j+<code class="constant">1</code>, k, ivz)+wd(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi220" target="origFile">wavg = half*(w(i, j+<code class="constant">1</code>, k, ivz)+w(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi221" target="origFile">a2avgd = half*(((gammad(i, j+<code class="constant">1</code>, k)*p(i, j+<code class="constant">1</code>, k)+gamma(i, j+<code class="constant">1</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi221" target="origFile"><code class="label">&            </code>k)*pd(i, j+<code class="constant">1</code>, k))*w(i, j+<code class="constant">1</code>, k, irho)-gamma(i, j+<code class="constant">1</code>, k)*p(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi221" target="origFile"><code class="label">&            </code>+<code class="constant">1</code>, k)*wd(i, j+<code class="constant">1</code>, k, irho))/w(i, j+<code class="constant">1</code>, k, irho)**<code class="constant">2</code>+((gammad(i<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi221" target="origFile"><code class="label">&            </code>, j, k)*p(i, j, k)+gamma(i, j, k)*pd(i, j, k))*w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi221" target="origFile"><code class="label">&            </code>irho)-gamma(i, j, k)*p(i, j, k)*wd(i, j, k, irho))/w(i, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi221" target="origFile"><code class="label">&            </code>, irho)**<code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di222"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi221" target="origFile">a2avg = half*(gamma(i, j+<code class="constant">1</code>, k)*p(i, j+<code class="constant">1</code>, k)/w(i, j+<code class="constant">1</code>, k, irho)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi221" target="origFile"><code class="label">&            </code>+gamma(i, j, k)*p(i, j, k)/w(i, j, k, irho))</a>
<a name="invisciddissfluxmatrix_spatial_di223"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi222" target="origFile">sxd = sjd(i, j, k, <code class="constant">1</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi222" target="origFile">sx = sj(i, j, k, <code class="constant">1</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di224"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi223" target="origFile">syd = sjd(i, j, k, <code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi223" target="origFile">sy = sj(i, j, k, <code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di225"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi224" target="origFile">szd = sjd(i, j, k, <code class="constant">3</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi224" target="origFile">sz = sj(i, j, k, <code class="constant">3</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di226"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi225" target="origFile">arg1d = <code class="constant">2</code>*sx*sxd + <code class="constant">2</code>*sy*syd + <code class="constant">2</code>*sz*szd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi225" target="origFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi226" target="origFile"><code class="keyword">IF</code> (arg1 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi226" target="origFile">aread = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi226" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi226" target="origFile">aread = arg1d/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg1))</a>
<a name="invisciddissfluxmatrix_spatial_di227"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi226" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di229"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi226" target="origFile">area = <code class="funcname">SQRT</code>(arg1)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi227" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi229" target="origFile">max2d = aread</a>
<a name="invisciddissfluxmatrix_spatial_di228"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi229" target="origFile">max2 = area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi227" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi228" target="origFile">max2 = <code class="constant">1.e-25_realType</code></a>
<a name="invisciddissfluxmatrix_spatial_di230"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi227" target="origFile">max2d = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi227" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di231"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi230" target="origFile">tmpd = -(one*max2d/max2**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi230" target="origFile">tmp = one/max2</a>
<a name="invisciddissfluxmatrix_spatial_di232"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi231" target="origFile">sxd = sxd*tmp + sx*tmpd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi231" target="origFile">sx = sx*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di233"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi232" target="origFile">syd = syd*tmp + sy*tmpd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi232" target="origFile">sy = sy*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di234"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi233" target="origFile">szd = szd*tmp + sz*tmpd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi233" target="origFile">sz = sz*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di235"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi234" target="origFile">alphaavgd = half*(<code class="constant">2</code>*uavg*uavgd+<code class="constant">2</code>*vavg*vavgd+<code class="constant">2</code>*wavg*wavgd)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi234" target="origFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi235" target="origFile">havgd = alphaavgd + ovgm1d*(a2avg-gm53*kavg) + ovgm1*(a2avgd-<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di236"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi235" target="origFile"><code class="label">&            </code>gm53d*kavg-gm53*kavgd)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi235" target="origFile">havg = alphaavg + ovgm1*(a2avg-gm53*kavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi236" target="origFile"><code class="keyword">IF</code> (a2avg .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi236" target="origFile">aavgd = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi236" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi236" target="origFile">aavgd = a2avgd/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(a2avg))</a>
<a name="invisciddissfluxmatrix_spatial_di237"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi236" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi236" target="origFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi237" target="origFile">unavgd = uavgd*sx + uavg*sxd + vavgd*sy + vavg*syd + wavgd*sz <code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di238"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi237" target="origFile"><code class="label">&            </code>+ wavg*szd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi237" target="origFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
<a name="invisciddissfluxmatrix_spatial_di239"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi238" target="origFile">ovaavgd = -(one*aavgd/aavg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi238" target="origFile">ovaavg = one/aavg</a>
<a name="invisciddissfluxmatrix_spatial_di240"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi239" target="origFile">ova2avgd = -(one*a2avgd/a2avg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi239" target="origFile">ova2avg = one/a2avg</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi240" target="origFile"><code class="comment">! The mesh velocity if the face is moving. It must be</code></a>
<a name="invisciddissfluxmatrix_spatial_di241"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi240" target="origFile"><code class="comment">! divided by the area to obtain a true velocity.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi240" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi241" target="origFile">sfaced = sfacej(i, j, k)*tmpd</a>
<a name="invisciddissfluxmatrix_spatial_di242"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi241" target="origFile">sface = sfacej(i, j, k)*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di244"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi240" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi242" target="origFile"><code class="keyword">IF</code> (unavg - sface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi244" target="origFile">lam1d = unavgd - sfaced + aavgd</a>
<a name="invisciddissfluxmatrix_spatial_di243"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi244" target="origFile">lam1 = unavg - sface + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi242" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi243" target="origFile">lam1d = -(unavgd-sfaced+aavgd)</a>
<a name="invisciddissfluxmatrix_spatial_di245"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi243" target="origFile">lam1 = -(unavg-sface+aavg)</a>
<a name="invisciddissfluxmatrix_spatial_di247"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi242" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi245" target="origFile"><code class="keyword">IF</code> (unavg - sface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi247" target="origFile">lam2d = unavgd - sfaced - aavgd</a>
<a name="invisciddissfluxmatrix_spatial_di246"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi247" target="origFile">lam2 = unavg - sface - aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi245" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi246" target="origFile">lam2d = -(unavgd-sfaced-aavgd)</a>
<a name="invisciddissfluxmatrix_spatial_di248"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi246" target="origFile">lam2 = -(unavg-sface-aavg)</a>
<a name="invisciddissfluxmatrix_spatial_di250"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi245" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi248" target="origFile"><code class="keyword">IF</code> (unavg - sface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi250" target="origFile">lam3d = unavgd - sfaced</a>
<a name="invisciddissfluxmatrix_spatial_di249"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi250" target="origFile">lam3 = unavg - sface</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi248" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi249" target="origFile">lam3d = -(unavgd-sfaced)</a>
<a name="invisciddissfluxmatrix_spatial_di251"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi249" target="origFile">lam3 = -(unavg-sface)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi248" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di252"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi251" target="origFile">rradd = lam3d + aavgd</a>
<a name="invisciddissfluxmatrix_spatial_di254"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi251" target="origFile">rrad = lam3 + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi252" target="origFile"><code class="keyword">IF</code> (lam1 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi254" target="origFile">lam1d = epsacoustic*rradd</a>
<a name="invisciddissfluxmatrix_spatial_di253"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi254" target="origFile">lam1 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi252" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di255"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi253" target="origFile">lam1 = lam1</a>
<a name="invisciddissfluxmatrix_spatial_di257"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi252" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi255" target="origFile"><code class="keyword">IF</code> (lam2 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi257" target="origFile">lam2d = epsacoustic*rradd</a>
<a name="invisciddissfluxmatrix_spatial_di256"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi257" target="origFile">lam2 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi255" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di258"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi256" target="origFile">lam2 = lam2</a>
<a name="invisciddissfluxmatrix_spatial_di260"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi255" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi258" target="origFile"><code class="keyword">IF</code> (lam3 .LT. epsshear*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi260" target="origFile">lam3d = epsshear*rradd</a>
<a name="invisciddissfluxmatrix_spatial_di259"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi260" target="origFile">lam3 = epsshear*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi258" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di261"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi259" target="origFile">lam3 = lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi258" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi261" target="origFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi261" target="origFile"><code class="comment">! the correct values for the dissipation term.</code></a>
<a name="invisciddissfluxmatrix_spatial_di262"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi261" target="origFile">lam1d = lam1d*area + lam1*aread</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi261" target="origFile">lam1 = lam1*area</a>
<a name="invisciddissfluxmatrix_spatial_di263"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi262" target="origFile">lam2d = lam2d*area + lam2*aread</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi262" target="origFile">lam2 = lam2*area</a>
<a name="invisciddissfluxmatrix_spatial_di264"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi263" target="origFile">lam3d = lam3d*area + lam3*aread</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi263" target="origFile">lam3 = lam3*area</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi264" target="origFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi264" target="origFile"><code class="comment">! dissipation terms.</code></a>
<a name="invisciddissfluxmatrix_spatial_di265"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi264" target="origFile">abv1d = half*(lam1d+lam2d)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi264" target="origFile">abv1 = half*(lam1+lam2)</a>
<a name="invisciddissfluxmatrix_spatial_di266"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi265" target="origFile">abv2d = half*(lam1d-lam2d)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi265" target="origFile">abv2 = half*(lam1-lam2)</a>
<a name="invisciddissfluxmatrix_spatial_di267"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi266" target="origFile">abv3d = abv1d - lam3d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi266" target="origFile">abv3 = abv1 - lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi267" target="origFile">abv4d = gm1d*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) + <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi267" target="origFile"><code class="label">&            </code>gm1*(alphaavgd*dr+alphaavg*drd-uavgd*dru-uavg*drud-vavgd*drv<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi267" target="origFile"><code class="label">&            </code>-vavg*drvd-wavgd*drw-wavg*drwd+dred) - gm53d*drk - gm53*drkd</a>
<a name="invisciddissfluxmatrix_spatial_di268"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi267" target="origFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi267" target="origFile"><code class="label">&            </code>*drk</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi268" target="origFile">abv5d = sxd*dru + sx*drud + syd*drv + sy*drvd + szd*drw + sz*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di269"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi268" target="origFile"><code class="label">&            </code>drwd - unavgd*dr - unavg*drd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi268" target="origFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi269" target="origFile">abv6d = (abv3d*abv4+abv3*abv4d)*ova2avg + abv3*abv4*ova2avgd +<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di270"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi269" target="origFile"><code class="label">&            </code>(abv2d*abv5+abv2*abv5d)*ovaavg + abv2*abv5*ovaavgd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi269" target="origFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi270" target="origFile">abv7d = (abv2d*abv4+abv2*abv4d)*ovaavg + abv2*abv4*ovaavgd + <code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di271"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi270" target="origFile"><code class="label">&            </code>abv3d*abv5 + abv3*abv5d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi270" target="origFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi271" target="origFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi271" target="origFile"><code class="comment">! Density.</code></a>
<a name="invisciddissfluxmatrix_spatial_di272"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi271" target="origFile">fsd = lam3d*dr + lam3*drd + abv6d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi271" target="origFile">fs = lam3*dr + abv6</a>
<a name="invisciddissfluxmatrix_spatial_di273"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi272" target="origFile">fwd(i, j+<code class="constant">1</code>, k, irho) = fwd(i, j+<code class="constant">1</code>, k, irho) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi272" target="origFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di274"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi273" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) - fsd</a>
<a name="invisciddissfluxmatrix_spatial_di275"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi273" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi274" target="origFile">ind = indfamilyj(i, j, k)</a>
<a name="invisciddissfluxmatrix_spatial_di276"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi275" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(ind<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi275" target="origFile"><code class="label">&            </code>, spectralsol) - factfamilyj(i, j, k)*fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi276" target="origFile"><code class="comment">! X-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi276" target="origFile">fsd = lam3d*dru + lam3*drud + uavgd*abv6 + uavg*abv6d + sxd*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di277"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi276" target="origFile"><code class="label">&            </code>abv7 + sx*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi276" target="origFile">fs = lam3*dru + uavg*abv6 + sx*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di278"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi277" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imx) = fwd(i, j+<code class="constant">1</code>, k, imx) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi277" target="origFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di279"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi278" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi278" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi279" target="origFile"><code class="comment">! Y-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi279" target="origFile">fsd = lam3d*drv + lam3*drvd + vavgd*abv6 + vavg*abv6d + syd*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di280"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi279" target="origFile"><code class="label">&            </code>abv7 + sy*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi279" target="origFile">fs = lam3*drv + vavg*abv6 + sy*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di281"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi280" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imy) = fwd(i, j+<code class="constant">1</code>, k, imy) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi280" target="origFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di282"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi281" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi281" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi282" target="origFile"><code class="comment">! Z-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi282" target="origFile">fsd = lam3d*drw + lam3*drwd + wavgd*abv6 + wavg*abv6d + szd*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di283"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi282" target="origFile"><code class="label">&            </code>abv7 + sz*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi282" target="origFile">fs = lam3*drw + wavg*abv6 + sz*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di284"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi283" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imz) = fwd(i, j+<code class="constant">1</code>, k, imz) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi283" target="origFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di285"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi284" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi284" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi285" target="origFile"><code class="comment">! Energy.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi285" target="origFile">fsd = lam3d*dre + lam3*dred + havgd*abv6 + havg*abv6d + unavgd<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di286"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi285" target="origFile"><code class="label">&            </code>*abv7 + unavg*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi285" target="origFile">fs = lam3*dre + havg*abv6 + unavg*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di287"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi286" target="origFile">fwd(i, j+<code class="constant">1</code>, k, irhoe) = fwd(i, j+<code class="constant">1</code>, k, irhoe) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi286" target="origFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di288"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi287" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi287" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi288" target="origFile"><code class="comment">! Set dp1 to dp2 for the next face.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi288" target="origFile">dp1d = dp2d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi288" target="origFile">dp1 = dp2</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi176" target="origFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxmatrix_spatial_di289"></a>      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi165" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi164" target="origFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi289" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi289" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi289" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi289" target="origFile"><code class="comment">!      * Dissipative fluxes in the k-direction.                         *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi289" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi289" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a name="invisciddissfluxmatrix_spatial_di290"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi289" target="origFile"><code class="comment">!</code></a>
<a name="invisciddissfluxmatrix_spatial_di291"></a>    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi289" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
<a name="invisciddissfluxmatrix_spatial_di293"></a>      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi290" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi291" target="origFile"><code class="keyword">IF</code> (p(i, j, <code class="constant">2</code>) - p(i, j, <code class="constant">1</code>) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi293" target="origFile">abs5d = pd(i, j, <code class="constant">2</code>) - pd(i, j, <code class="constant">1</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di292"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi293" target="origFile">abs5 = p(i, j, <code class="constant">2</code>) - p(i, j, <code class="constant">1</code>)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi291" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi292" target="origFile">abs5d = -(pd(i, j, <code class="constant">2</code>)-pd(i, j, <code class="constant">1</code>))</a>
<a name="invisciddissfluxmatrix_spatial_di294"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi292" target="origFile">abs5 = -(p(i, j, <code class="constant">2</code>)-p(i, j, <code class="constant">1</code>))</a>
<a name="invisciddissfluxmatrix_spatial_di296"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi291" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi294" target="origFile"><code class="keyword">IF</code> (p(i, j, <code class="constant">1</code>) - p(i, j, <code class="constant">0</code>) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi296" target="origFile">abs11d = pd(i, j, <code class="constant">1</code>) - pd(i, j, <code class="constant">0</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di295"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi296" target="origFile">abs11 = p(i, j, <code class="constant">1</code>) - p(i, j, <code class="constant">0</code>)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi294" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi295" target="origFile">abs11d = -(pd(i, j, <code class="constant">1</code>)-pd(i, j, <code class="constant">0</code>))</a>
<a name="invisciddissfluxmatrix_spatial_di297"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi295" target="origFile">abs11 = -(p(i, j, <code class="constant">1</code>)-p(i, j, <code class="constant">0</code>))</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi294" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi297" target="origFile">x5d = ((pd(i, j, <code class="constant">2</code>)-two*pd(i, j, <code class="constant">1</code>)+pd(i, j, <code class="constant">0</code>))*(omega*(p(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi297" target="origFile"><code class="label">&          </code>, <code class="constant">2</code>)+two*p(i, j, <code class="constant">1</code>)+p(i, j, <code class="constant">0</code>))+oneminomega*(abs5+abs11)+plim)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi297" target="origFile"><code class="label">&          </code>-(p(i, j, <code class="constant">2</code>)-two*p(i, j, <code class="constant">1</code>)+p(i, j, <code class="constant">0</code>))*(omega*(pd(i, j, <code class="constant">2</code>)+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi297" target="origFile"><code class="label">&          </code>two*pd(i, j, <code class="constant">1</code>)+pd(i, j, <code class="constant">0</code>))+oneminomega*(abs5d+abs11d)))/(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi297" target="origFile"><code class="label">&          </code>omega*(p(i, j, <code class="constant">2</code>)+two*p(i, j, <code class="constant">1</code>)+p(i, j, <code class="constant">0</code>))+oneminomega*(abs5<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi297" target="origFile"><code class="label">&          </code>+abs11)+plim)**<code class="constant">2</code></a>
<a name="invisciddissfluxmatrix_spatial_di298"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi297" target="origFile">x5 = (p(i, j, <code class="constant">2</code>)-two*p(i, j, <code class="constant">1</code>)+p(i, j, <code class="constant">0</code>))/(omega*(p(i, j, <code class="constant">2</code>)+<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di299"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi297" target="origFile"><code class="label">&          </code>two*p(i, j, <code class="constant">1</code>)+p(i, j, <code class="constant">0</code>))+oneminomega*(abs5+abs11)+plim)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi298" target="origFile"><code class="keyword">IF</code> (x5 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi299" target="origFile">dp1d = x5d</a>
<a name="invisciddissfluxmatrix_spatial_di300"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi299" target="origFile">dp1 = x5</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi298" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi300" target="origFile">dp1d = -x5d</a>
<a name="invisciddissfluxmatrix_spatial_di301"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi300" target="origFile">dp1 = -x5</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi298" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di302"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi301" target="origFile"><code class="comment">! Loop in k-direction.</code></a>
<a name="invisciddissfluxmatrix_spatial_di304"></a>        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi301" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi302" target="origFile"><code class="keyword">IF</code> (p(i, j, k+<code class="constant">2</code>) - p(i, j, k+<code class="constant">1</code>) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi304" target="origFile">abs6d = pd(i, j, k+<code class="constant">2</code>) - pd(i, j, k+<code class="constant">1</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di303"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi304" target="origFile">abs6 = p(i, j, k+<code class="constant">2</code>) - p(i, j, k+<code class="constant">1</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi302" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi303" target="origFile">abs6d = -(pd(i, j, k+<code class="constant">2</code>)-pd(i, j, k+<code class="constant">1</code>))</a>
<a name="invisciddissfluxmatrix_spatial_di305"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi303" target="origFile">abs6 = -(p(i, j, k+<code class="constant">2</code>)-p(i, j, k+<code class="constant">1</code>))</a>
<a name="invisciddissfluxmatrix_spatial_di307"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi302" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi305" target="origFile"><code class="keyword">IF</code> (p(i, j, k+<code class="constant">1</code>) - p(i, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi307" target="origFile">abs12d = pd(i, j, k+<code class="constant">1</code>) - pd(i, j, k)</a>
<a name="invisciddissfluxmatrix_spatial_di306"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi307" target="origFile">abs12 = p(i, j, k+<code class="constant">1</code>) - p(i, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi305" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi306" target="origFile">abs12d = -(pd(i, j, k+<code class="constant">1</code>)-pd(i, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di308"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi306" target="origFile">abs12 = -(p(i, j, k+<code class="constant">1</code>)-p(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi305" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi308" target="origFile">x6d = ((pd(i, j, k+<code class="constant">2</code>)-two*pd(i, j, k+<code class="constant">1</code>)+pd(i, j, k))*(omega*(p<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi308" target="origFile"><code class="label">&            </code>(i, j, k+<code class="constant">2</code>)+two*p(i, j, k+<code class="constant">1</code>)+p(i, j, k))+oneminomega*(abs6+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi308" target="origFile"><code class="label">&            </code>abs12)+plim)-(p(i, j, k+<code class="constant">2</code>)-two*p(i, j, k+<code class="constant">1</code>)+p(i, j, k))*(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi308" target="origFile"><code class="label">&            </code>omega*(pd(i, j, k+<code class="constant">2</code>)+two*pd(i, j, k+<code class="constant">1</code>)+pd(i, j, k))+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi308" target="origFile"><code class="label">&            </code>oneminomega*(abs6d+abs12d)))/(omega*(p(i, j, k+<code class="constant">2</code>)+two*p(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi308" target="origFile"><code class="label">&            </code>, k+<code class="constant">1</code>)+p(i, j, k))+oneminomega*(abs6+abs12)+plim)**<code class="constant">2</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi308" target="origFile">x6 = (p(i, j, k+<code class="constant">2</code>)-two*p(i, j, k+<code class="constant">1</code>)+p(i, j, k))/(omega*(p(i, j<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di309"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi308" target="origFile"><code class="label">&            </code>, k+<code class="constant">2</code>)+two*p(i, j, k+<code class="constant">1</code>)+p(i, j, k))+oneminomega*(abs6+abs12)<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di310"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi308" target="origFile"><code class="label">&            </code>+plim)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi309" target="origFile"><code class="keyword">IF</code> (x6 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi310" target="origFile">dp2d = x6d</a>
<a name="invisciddissfluxmatrix_spatial_di311"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi310" target="origFile">dp2 = x6</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi309" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi311" target="origFile">dp2d = -x6d</a>
<a name="invisciddissfluxmatrix_spatial_di312"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi311" target="origFile">dp2 = -x6</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi309" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di314"></a><a name="invisciddissfluxmatrix_spatial_di313"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi312" target="origFile"><code class="comment">! Compute the dissipation coefficients for this face.</code></a>
<a name="invisciddissfluxmatrix_spatial_di315"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi312" target="origFile">ppor = zero</a>
<a name="invisciddissfluxmatrix_spatial_di317"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi313" target="origFile"><code class="keyword">IF</code> (pork(i, j, k) .EQ. normalflux) </a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi314" target="origFile">ppor = one</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi315" target="origFile"><code class="keyword">IF</code> (dp1 .LT. dp2) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi317" target="origFile">y3d = dp2d</a>
<a name="invisciddissfluxmatrix_spatial_di316"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi317" target="origFile">y3 = dp2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi315" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi316" target="origFile">y3d = dp1d</a>
<a name="invisciddissfluxmatrix_spatial_di318"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi316" target="origFile">y3 = dp1</a>
<a name="invisciddissfluxmatrix_spatial_di319"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi315" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi318" target="origFile"><code class="keyword">IF</code> (dpmax .GT. y3) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi319" target="origFile">min3d = y3d</a>
<a name="invisciddissfluxmatrix_spatial_di320"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi319" target="origFile">min3 = y3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi318" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi320" target="origFile">min3 = dpmax</a>
<a name="invisciddissfluxmatrix_spatial_di321"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi318" target="origFile">min3d = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi318" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di322"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi321" target="origFile">dis2d = ppor*fis2*min3d</a>
<a name="invisciddissfluxmatrix_spatial_di323"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi321" target="origFile">dis2 = ppor*fis2*min3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi322" target="origFile">dis4d = <code class="funcname">DIM_SPATIAL_D</code>(ppor*fis4, <code class="constant">0.0</code>, dis2, dis2d, dis4)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi323" target="origFile"><code class="comment">! Construct the vector of the first and third differences</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi323" target="origFile"><code class="comment">! multiplied by the appropriate constants.</code></a>
<a name="invisciddissfluxmatrix_spatial_di324"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi323" target="origFile">ddwd = wd(i, j, k+<code class="constant">1</code>, irho) - wd(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi323" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho) - w(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi324" target="origFile">drd = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j, k+<code class="constant">2</code>, irho)-w(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi324" target="origFile"><code class="label">&            </code>, k-<code class="constant">1</code>, irho)-three*ddw) - dis4*(wd(i, j, k+<code class="constant">2</code>, irho)-wd(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi324" target="origFile"><code class="label">&            </code>, k-<code class="constant">1</code>, irho)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di325"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi324" target="origFile">dr = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)-w(i, j, k-<code class="constant">1</code>, irho)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi324" target="origFile"><code class="label">&            </code>three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi325" target="origFile">ddwd = wd(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivx) + w(i, j, k+<code class="constant">1</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi325" target="origFile"><code class="label">&            </code>irho)*wd(i, j, k+<code class="constant">1</code>, ivx) - wd(i, j, k, irho)*w(i, j, k, ivx)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi325" target="origFile"><code class="label">&            </code>- w(i, j, k, irho)*wd(i, j, k, ivx)</a>
<a name="invisciddissfluxmatrix_spatial_di326"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi325" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivx) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi325" target="origFile"><code class="label">&            </code>w(i, j, k, ivx)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi326" target="origFile">drud = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi326" target="origFile"><code class="label">&            </code>j, k+<code class="constant">2</code>, ivx)-w(i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, ivx)-three*ddw)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi326" target="origFile"><code class="label">&            </code>- dis4*(wd(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, ivx)+w(i, j, k+<code class="constant">2</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi326" target="origFile"><code class="label">&            </code>irho)*wd(i, j, k+<code class="constant">2</code>, ivx)-wd(i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi326" target="origFile"><code class="label">&            </code>ivx)-w(i, j, k-<code class="constant">1</code>, irho)*wd(i, j, k-<code class="constant">1</code>, ivx)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di327"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi326" target="origFile">dru = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, ivx)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi326" target="origFile"><code class="label">&            </code>i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, ivx)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi327" target="origFile">ddwd = wd(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivy) + w(i, j, k+<code class="constant">1</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi327" target="origFile"><code class="label">&            </code>irho)*wd(i, j, k+<code class="constant">1</code>, ivy) - wd(i, j, k, irho)*w(i, j, k, ivy)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi327" target="origFile"><code class="label">&            </code>- w(i, j, k, irho)*wd(i, j, k, ivy)</a>
<a name="invisciddissfluxmatrix_spatial_di328"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi327" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivy) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi327" target="origFile"><code class="label">&            </code>w(i, j, k, ivy)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi328" target="origFile">drvd = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi328" target="origFile"><code class="label">&            </code>j, k+<code class="constant">2</code>, ivy)-w(i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, ivy)-three*ddw)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi328" target="origFile"><code class="label">&            </code>- dis4*(wd(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, ivy)+w(i, j, k+<code class="constant">2</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi328" target="origFile"><code class="label">&            </code>irho)*wd(i, j, k+<code class="constant">2</code>, ivy)-wd(i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi328" target="origFile"><code class="label">&            </code>ivy)-w(i, j, k-<code class="constant">1</code>, irho)*wd(i, j, k-<code class="constant">1</code>, ivy)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di329"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi328" target="origFile">drv = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, ivy)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi328" target="origFile"><code class="label">&            </code>i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, ivy)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi329" target="origFile">ddwd = wd(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivz) + w(i, j, k+<code class="constant">1</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi329" target="origFile"><code class="label">&            </code>irho)*wd(i, j, k+<code class="constant">1</code>, ivz) - wd(i, j, k, irho)*w(i, j, k, ivz)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi329" target="origFile"><code class="label">&            </code>- w(i, j, k, irho)*wd(i, j, k, ivz)</a>
<a name="invisciddissfluxmatrix_spatial_di330"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi329" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivz) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi329" target="origFile"><code class="label">&            </code>w(i, j, k, ivz)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi330" target="origFile">drwd = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi330" target="origFile"><code class="label">&            </code>j, k+<code class="constant">2</code>, ivz)-w(i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, ivz)-three*ddw)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi330" target="origFile"><code class="label">&            </code>- dis4*(wd(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, ivz)+w(i, j, k+<code class="constant">2</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi330" target="origFile"><code class="label">&            </code>irho)*wd(i, j, k+<code class="constant">2</code>, ivz)-wd(i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi330" target="origFile"><code class="label">&            </code>ivz)-w(i, j, k-<code class="constant">1</code>, irho)*wd(i, j, k-<code class="constant">1</code>, ivz)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di331"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi330" target="origFile">drw = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, ivz)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi330" target="origFile"><code class="label">&            </code>i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, ivz)-three*ddw)</a>
<a name="invisciddissfluxmatrix_spatial_di332"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi331" target="origFile">ddwd = wd(i, j, k+<code class="constant">1</code>, irhoe) - wd(i, j, k, irhoe)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi331" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irhoe) - w(i, j, k, irhoe)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi332" target="origFile">dred = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j, k+<code class="constant">2</code>, irhoe)-w(i<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi332" target="origFile"><code class="label">&            </code>, j, k-<code class="constant">1</code>, irhoe)-three*ddw) - dis4*(wd(i, j, k+<code class="constant">2</code>, irhoe)-wd(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi332" target="origFile"><code class="label">&            </code>i, j, k-<code class="constant">1</code>, irhoe)-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di333"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi332" target="origFile">dre = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irhoe)-w(i, j, k-<code class="constant">1</code>, irhoe)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi332" target="origFile"><code class="label">&            </code>-three*ddw)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi333" target="origFile"><code class="comment">! In case a k-equation is present, compute the difference</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi333" target="origFile"><code class="comment">! of rhok and store the average value of k. If not present,</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi333" target="origFile"><code class="comment">! set both these values to zero, such that later on no</code></a>
<a name="invisciddissfluxmatrix_spatial_di336"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi333" target="origFile"><code class="comment">! decision needs to be made anymore.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi333" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi336" target="origFile">ddwd = wd(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, itu1) + w(i, j, k+<code class="constant">1</code><code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi336" target="origFile"><code class="label">&              </code>, irho)*wd(i, j, k+<code class="constant">1</code>, itu1) - wd(i, j, k, irho)*w(i, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi336" target="origFile"><code class="label">&              </code>, itu1) - w(i, j, k, irho)*wd(i, j, k, itu1)</a>
<a name="invisciddissfluxmatrix_spatial_di337"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi336" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, itu1) - w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi336" target="origFile"><code class="label">&              </code>irho)*w(i, j, k, itu1)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi337" target="origFile">drkd = dis2d*ddw + dis2*ddwd - dis4d*(w(i, j, k+<code class="constant">2</code>, irho)*w(i<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi337" target="origFile"><code class="label">&              </code>, j, k+<code class="constant">2</code>, itu1)-w(i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, itu1)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi337" target="origFile"><code class="label">&              </code>three*ddw) - dis4*(wd(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, itu1)+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi337" target="origFile"><code class="label">&              </code>w(i, j, k+<code class="constant">2</code>, irho)*wd(i, j, k+<code class="constant">2</code>, itu1)-wd(i, j, k-<code class="constant">1</code>, irho)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi337" target="origFile"><code class="label">&              </code>*w(i, j, k-<code class="constant">1</code>, itu1)-w(i, j, k-<code class="constant">1</code>, irho)*wd(i, j, k-<code class="constant">1</code>, itu1)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi337" target="origFile"><code class="label">&              </code>-three*ddwd)</a>
<a name="invisciddissfluxmatrix_spatial_di338"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi337" target="origFile">drk = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, itu1)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi337" target="origFile"><code class="label">&              </code>-w(i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, itu1)-three*ddw)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi338" target="origFile">kavgd = half*(wd(i, j, k+<code class="constant">1</code>, itu1)+wd(i, j, k, itu1))</a>
<a name="invisciddissfluxmatrix_spatial_di334"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi338" target="origFile">kavg = half*(w(i, j, k+<code class="constant">1</code>, itu1)+w(i, j, k, itu1))</a>
<a name="invisciddissfluxmatrix_spatial_di335"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi333" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi334" target="origFile">drk = zero</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi335" target="origFile">kavg = zero</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi333" target="origFile">kavgd = <code class="constant">0.0</code></a>
<a name="invisciddissfluxmatrix_spatial_di339"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi333" target="origFile">drkd = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi333" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi339" target="origFile"><code class="comment">! Compute the average value of gamma and compute some</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi339" target="origFile"><code class="comment">! expressions in which it occurs.</code></a>
<a name="invisciddissfluxmatrix_spatial_di340"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi339" target="origFile">gammaavgd = half*(gammad(i, j, k+<code class="constant">1</code>)+gammad(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi339" target="origFile">gammaavg = half*(gamma(i, j, k+<code class="constant">1</code>)+gamma(i, j, k))</a>
<a name="invisciddissfluxmatrix_spatial_di341"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi340" target="origFile">gm1d = gammaavgd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi340" target="origFile">gm1 = gammaavg - one</a>
<a name="invisciddissfluxmatrix_spatial_di342"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi341" target="origFile">ovgm1d = -(one*gm1d/gm1**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi341" target="origFile">ovgm1 = one/gm1</a>
<a name="invisciddissfluxmatrix_spatial_di343"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi342" target="origFile">gm53d = gammaavgd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi342" target="origFile">gm53 = gammaavg - five*third</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi343" target="origFile"><code class="comment">! Compute the average state at the interface.</code></a>
<a name="invisciddissfluxmatrix_spatial_di344"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi343" target="origFile">uavgd = half*(wd(i, j, k+<code class="constant">1</code>, ivx)+wd(i, j, k, ivx))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi343" target="origFile">uavg = half*(w(i, j, k+<code class="constant">1</code>, ivx)+w(i, j, k, ivx))</a>
<a name="invisciddissfluxmatrix_spatial_di345"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi344" target="origFile">vavgd = half*(wd(i, j, k+<code class="constant">1</code>, ivy)+wd(i, j, k, ivy))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi344" target="origFile">vavg = half*(w(i, j, k+<code class="constant">1</code>, ivy)+w(i, j, k, ivy))</a>
<a name="invisciddissfluxmatrix_spatial_di346"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi345" target="origFile">wavgd = half*(wd(i, j, k+<code class="constant">1</code>, ivz)+wd(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi345" target="origFile">wavg = half*(w(i, j, k+<code class="constant">1</code>, ivz)+w(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi346" target="origFile">a2avgd = half*(((gammad(i, j, k+<code class="constant">1</code>)*p(i, j, k+<code class="constant">1</code>)+gamma(i, j, k+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi346" target="origFile"><code class="label">&            </code><code class="constant">1</code>)*pd(i, j, k+<code class="constant">1</code>))*w(i, j, k+<code class="constant">1</code>, irho)-gamma(i, j, k+<code class="constant">1</code>)*p(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi346" target="origFile"><code class="label">&            </code>, k+<code class="constant">1</code>)*wd(i, j, k+<code class="constant">1</code>, irho))/w(i, j, k+<code class="constant">1</code>, irho)**<code class="constant">2</code>+((gammad(i<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi346" target="origFile"><code class="label">&            </code>, j, k)*p(i, j, k)+gamma(i, j, k)*pd(i, j, k))*w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi346" target="origFile"><code class="label">&            </code>irho)-gamma(i, j, k)*p(i, j, k)*wd(i, j, k, irho))/w(i, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi346" target="origFile"><code class="label">&            </code>, irho)**<code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di347"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi346" target="origFile">a2avg = half*(gamma(i, j, k+<code class="constant">1</code>)*p(i, j, k+<code class="constant">1</code>)/w(i, j, k+<code class="constant">1</code>, irho)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi346" target="origFile"><code class="label">&            </code>+gamma(i, j, k)*p(i, j, k)/w(i, j, k, irho))</a>
<a name="invisciddissfluxmatrix_spatial_di348"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi347" target="origFile">sxd = skd(i, j, k, <code class="constant">1</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi347" target="origFile">sx = sk(i, j, k, <code class="constant">1</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di349"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi348" target="origFile">syd = skd(i, j, k, <code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi348" target="origFile">sy = sk(i, j, k, <code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di350"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi349" target="origFile">szd = skd(i, j, k, <code class="constant">3</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi349" target="origFile">sz = sk(i, j, k, <code class="constant">3</code>)</a>
<a name="invisciddissfluxmatrix_spatial_di351"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi350" target="origFile">arg1d = <code class="constant">2</code>*sx*sxd + <code class="constant">2</code>*sy*syd + <code class="constant">2</code>*sz*szd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi350" target="origFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi351" target="origFile"><code class="keyword">IF</code> (arg1 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi351" target="origFile">aread = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi351" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi351" target="origFile">aread = arg1d/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg1))</a>
<a name="invisciddissfluxmatrix_spatial_di352"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi351" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di354"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi351" target="origFile">area = <code class="funcname">SQRT</code>(arg1)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi352" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi354" target="origFile">max3d = aread</a>
<a name="invisciddissfluxmatrix_spatial_di353"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi354" target="origFile">max3 = area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi352" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi353" target="origFile">max3 = <code class="constant">1.e-25_realType</code></a>
<a name="invisciddissfluxmatrix_spatial_di355"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi352" target="origFile">max3d = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi352" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di356"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi355" target="origFile">tmpd = -(one*max3d/max3**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi355" target="origFile">tmp = one/max3</a>
<a name="invisciddissfluxmatrix_spatial_di357"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi356" target="origFile">sxd = sxd*tmp + sx*tmpd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi356" target="origFile">sx = sx*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di358"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi357" target="origFile">syd = syd*tmp + sy*tmpd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi357" target="origFile">sy = sy*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di359"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi358" target="origFile">szd = szd*tmp + sz*tmpd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi358" target="origFile">sz = sz*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di360"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi359" target="origFile">alphaavgd = half*(<code class="constant">2</code>*uavg*uavgd+<code class="constant">2</code>*vavg*vavgd+<code class="constant">2</code>*wavg*wavgd)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi359" target="origFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi360" target="origFile">havgd = alphaavgd + ovgm1d*(a2avg-gm53*kavg) + ovgm1*(a2avgd-<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di361"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi360" target="origFile"><code class="label">&            </code>gm53d*kavg-gm53*kavgd)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi360" target="origFile">havg = alphaavg + ovgm1*(a2avg-gm53*kavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi361" target="origFile"><code class="keyword">IF</code> (a2avg .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi361" target="origFile">aavgd = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi361" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi361" target="origFile">aavgd = a2avgd/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(a2avg))</a>
<a name="invisciddissfluxmatrix_spatial_di362"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi361" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi361" target="origFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi362" target="origFile">unavgd = uavgd*sx + uavg*sxd + vavgd*sy + vavg*syd + wavgd*sz <code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di363"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi362" target="origFile"><code class="label">&            </code>+ wavg*szd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi362" target="origFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
<a name="invisciddissfluxmatrix_spatial_di364"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi363" target="origFile">ovaavgd = -(one*aavgd/aavg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi363" target="origFile">ovaavg = one/aavg</a>
<a name="invisciddissfluxmatrix_spatial_di365"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi364" target="origFile">ova2avgd = -(one*a2avgd/a2avg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi364" target="origFile">ova2avg = one/a2avg</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi365" target="origFile"><code class="comment">! The mesh velocity if the face is moving. It must be</code></a>
<a name="invisciddissfluxmatrix_spatial_di366"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi365" target="origFile"><code class="comment">! divided by the area to obtain a true velocity.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi365" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi366" target="origFile">sfaced = sfacek(i, j, k)*tmpd</a>
<a name="invisciddissfluxmatrix_spatial_di367"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi366" target="origFile">sface = sfacek(i, j, k)*tmp</a>
<a name="invisciddissfluxmatrix_spatial_di369"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi365" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi367" target="origFile"><code class="keyword">IF</code> (unavg - sface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi369" target="origFile">lam1d = unavgd - sfaced + aavgd</a>
<a name="invisciddissfluxmatrix_spatial_di368"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi369" target="origFile">lam1 = unavg - sface + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi367" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi368" target="origFile">lam1d = -(unavgd-sfaced+aavgd)</a>
<a name="invisciddissfluxmatrix_spatial_di370"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi368" target="origFile">lam1 = -(unavg-sface+aavg)</a>
<a name="invisciddissfluxmatrix_spatial_di372"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi367" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi370" target="origFile"><code class="keyword">IF</code> (unavg - sface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi372" target="origFile">lam2d = unavgd - sfaced - aavgd</a>
<a name="invisciddissfluxmatrix_spatial_di371"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi372" target="origFile">lam2 = unavg - sface - aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi370" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi371" target="origFile">lam2d = -(unavgd-sfaced-aavgd)</a>
<a name="invisciddissfluxmatrix_spatial_di373"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi371" target="origFile">lam2 = -(unavg-sface-aavg)</a>
<a name="invisciddissfluxmatrix_spatial_di375"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi370" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi373" target="origFile"><code class="keyword">IF</code> (unavg - sface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi375" target="origFile">lam3d = unavgd - sfaced</a>
<a name="invisciddissfluxmatrix_spatial_di374"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi375" target="origFile">lam3 = unavg - sface</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi373" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi374" target="origFile">lam3d = -(unavgd-sfaced)</a>
<a name="invisciddissfluxmatrix_spatial_di376"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi374" target="origFile">lam3 = -(unavg-sface)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi373" target="origFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrix_spatial_di377"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi376" target="origFile">rradd = lam3d + aavgd</a>
<a name="invisciddissfluxmatrix_spatial_di379"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi376" target="origFile">rrad = lam3 + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi377" target="origFile"><code class="keyword">IF</code> (lam1 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi379" target="origFile">lam1d = epsacoustic*rradd</a>
<a name="invisciddissfluxmatrix_spatial_di378"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi379" target="origFile">lam1 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi377" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di380"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi378" target="origFile">lam1 = lam1</a>
<a name="invisciddissfluxmatrix_spatial_di382"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi377" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi380" target="origFile"><code class="keyword">IF</code> (lam2 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi382" target="origFile">lam2d = epsacoustic*rradd</a>
<a name="invisciddissfluxmatrix_spatial_di381"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi382" target="origFile">lam2 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi380" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di383"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi381" target="origFile">lam2 = lam2</a>
<a name="invisciddissfluxmatrix_spatial_di385"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi380" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi383" target="origFile"><code class="keyword">IF</code> (lam3 .LT. epsshear*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi385" target="origFile">lam3d = epsshear*rradd</a>
<a name="invisciddissfluxmatrix_spatial_di384"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi385" target="origFile">lam3 = epsshear*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi383" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrix_spatial_di386"></a>            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi384" target="origFile">lam3 = lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi383" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi386" target="origFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi386" target="origFile"><code class="comment">! the correct values for the dissipation term.</code></a>
<a name="invisciddissfluxmatrix_spatial_di387"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi386" target="origFile">lam1d = lam1d*area + lam1*aread</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi386" target="origFile">lam1 = lam1*area</a>
<a name="invisciddissfluxmatrix_spatial_di388"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi387" target="origFile">lam2d = lam2d*area + lam2*aread</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi387" target="origFile">lam2 = lam2*area</a>
<a name="invisciddissfluxmatrix_spatial_di389"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi388" target="origFile">lam3d = lam3d*area + lam3*aread</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi388" target="origFile">lam3 = lam3*area</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi389" target="origFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi389" target="origFile"><code class="comment">! dissipation terms.</code></a>
<a name="invisciddissfluxmatrix_spatial_di390"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi389" target="origFile">abv1d = half*(lam1d+lam2d)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi389" target="origFile">abv1 = half*(lam1+lam2)</a>
<a name="invisciddissfluxmatrix_spatial_di391"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi390" target="origFile">abv2d = half*(lam1d-lam2d)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi390" target="origFile">abv2 = half*(lam1-lam2)</a>
<a name="invisciddissfluxmatrix_spatial_di392"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi391" target="origFile">abv3d = abv1d - lam3d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi391" target="origFile">abv3 = abv1 - lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi392" target="origFile">abv4d = gm1d*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) + <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi392" target="origFile"><code class="label">&            </code>gm1*(alphaavgd*dr+alphaavg*drd-uavgd*dru-uavg*drud-vavgd*drv<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi392" target="origFile"><code class="label">&            </code>-vavg*drvd-wavgd*drw-wavg*drwd+dred) - gm53d*drk - gm53*drkd</a>
<a name="invisciddissfluxmatrix_spatial_di393"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi392" target="origFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi392" target="origFile"><code class="label">&            </code>*drk</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi393" target="origFile">abv5d = sxd*dru + sx*drud + syd*drv + sy*drvd + szd*drw + sz*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di394"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi393" target="origFile"><code class="label">&            </code>drwd - unavgd*dr - unavg*drd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi393" target="origFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi394" target="origFile">abv6d = (abv3d*abv4+abv3*abv4d)*ova2avg + abv3*abv4*ova2avgd +<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di395"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi394" target="origFile"><code class="label">&            </code>(abv2d*abv5+abv2*abv5d)*ovaavg + abv2*abv5*ovaavgd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi394" target="origFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi395" target="origFile">abv7d = (abv2d*abv4+abv2*abv4d)*ovaavg + abv2*abv4*ovaavgd + <code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di396"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi395" target="origFile"><code class="label">&            </code>abv3d*abv5 + abv3*abv5d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi395" target="origFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi396" target="origFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi396" target="origFile"><code class="comment">! Density.</code></a>
<a name="invisciddissfluxmatrix_spatial_di397"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi396" target="origFile">fsd = lam3d*dr + lam3*drd + abv6d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi396" target="origFile">fs = lam3*dr + abv6</a>
<a name="invisciddissfluxmatrix_spatial_di398"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi397" target="origFile">fwd(i, j, k+<code class="constant">1</code>, irho) = fwd(i, j, k+<code class="constant">1</code>, irho) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi397" target="origFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di399"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi398" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) - fsd</a>
<a name="invisciddissfluxmatrix_spatial_di400"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi398" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi399" target="origFile">ind = indfamilyk(i, j, k)</a>
<a name="invisciddissfluxmatrix_spatial_di401"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi400" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(ind<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi400" target="origFile"><code class="label">&            </code>, spectralsol) - factfamilyk(i, j, k)*fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi401" target="origFile"><code class="comment">! X-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi401" target="origFile">fsd = lam3d*dru + lam3*drud + uavgd*abv6 + uavg*abv6d + sxd*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di402"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi401" target="origFile"><code class="label">&            </code>abv7 + sx*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi401" target="origFile">fs = lam3*dru + uavg*abv6 + sx*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di403"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi402" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imx) = fwd(i, j, k+<code class="constant">1</code>, imx) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi402" target="origFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di404"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi403" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi403" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi404" target="origFile"><code class="comment">! Y-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi404" target="origFile">fsd = lam3d*drv + lam3*drvd + vavgd*abv6 + vavg*abv6d + syd*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di405"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi404" target="origFile"><code class="label">&            </code>abv7 + sy*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi404" target="origFile">fs = lam3*drv + vavg*abv6 + sy*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di406"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi405" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imy) = fwd(i, j, k+<code class="constant">1</code>, imy) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi405" target="origFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di407"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi406" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi406" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi407" target="origFile"><code class="comment">! Z-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi407" target="origFile">fsd = lam3d*drw + lam3*drwd + wavgd*abv6 + wavg*abv6d + szd*<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di408"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi407" target="origFile"><code class="label">&            </code>abv7 + sz*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi407" target="origFile">fs = lam3*drw + wavg*abv6 + sz*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di409"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi408" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imz) = fwd(i, j, k+<code class="constant">1</code>, imz) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi408" target="origFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di410"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi409" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi409" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi410" target="origFile"><code class="comment">! Energy.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi410" target="origFile">fsd = lam3d*dre + lam3*dred + havgd*abv6 + havg*abv6d + unavgd<code class="label">&</code></a>
<a name="invisciddissfluxmatrix_spatial_di411"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi410" target="origFile"><code class="label">&            </code>*abv7 + unavg*abv7d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi410" target="origFile">fs = lam3*dre + havg*abv6 + unavg*abv7</a>
<a name="invisciddissfluxmatrix_spatial_di412"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi411" target="origFile">fwd(i, j, k+<code class="constant">1</code>, irhoe) = fwd(i, j, k+<code class="constant">1</code>, irhoe) + fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi411" target="origFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) + fs</a>
<a name="invisciddissfluxmatrix_spatial_di413"></a>          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi412" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) - fsd</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi412" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi413" target="origFile"><code class="comment">! Set dp1 to dp2 for the next face.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi413" target="origFile">dp1d = dp2d</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi413" target="origFile">dp1 = dp2</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi301" target="origFile"><code class="keyword">END DO</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi290" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi289" target="origFile"><code class="keyword">END DO</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrixi19" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">INVISCIDDISSFLUXMATRIX_SPATIAL_D</code></a>
</pre>
</body>
