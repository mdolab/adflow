<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="bceulerwall_cd"></a><a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * File:          bcEulerWall.f90                                 *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * Starting date: 03-07-2003                                      *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * Last modified: 06-12-2005                                      *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">BCEULERWALL_CD</code>(<code class="vardecl">secondhalo</code>, <code class="vardecl">correctfork</code>)</a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">BCTYPES_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTDISCRETIZATION_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * bcEulerWall applies the inviscid wall boundary condition to    *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * a block. It is assumed that the pointers in blockPointers are  *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * already set to the correct block on the correct grid level.    *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">secondhalo</code>, <code class="vardecl">correctfork</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      Local variables.</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">l</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">jm1</code>, <code class="vardecl">jp1</code>, <code class="vardecl">km1</code>, <code class="vardecl">kp1</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">walltreatment</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sixa</code>, <code class="vardecl">siya</code>, <code class="vardecl">siza</code>, <code class="vardecl">sjxa</code>, <code class="vardecl">sjya</code>, <code class="vardecl">sjza</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">skxa</code>, <code class="vardecl">skya</code>, <code class="vardecl">skza</code>, <code class="vardecl">a1</code>, <code class="vardecl">b1</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rxj</code>, <code class="vardecl">ryj</code>, <code class="vardecl">rzj</code>, <code class="vardecl">rxk</code>, <code class="vardecl">ryk</code>, <code class="vardecl">rzk</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dpj</code>, <code class="vardecl">dpk</code>, <code class="vardecl">ri</code>, <code class="vardecl">rj</code>, <code class="vardecl">rk</code>, <code class="vardecl">qj</code>, <code class="vardecl">qk</code>, <code class="vardecl">vn</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ux</code>, <code class="vardecl">uy</code>, <code class="vardecl">uz</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp3</code>, <code class="vardecl">pp4</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ssi</code>, <code class="vardecl">ssj</code>, <code class="vardecl">ssk</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">norm</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rface</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ss</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="modifier">intType</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
<a name="setbcpointers_cd0"></a>  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="modifier">intType</code><code class="typename">) </code>:: <code class="vardecl">max1</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">INTERFACE </code></a>
      <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD0</code>(<code class="vardecl">nn</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code>, <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code>, <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code>, <code class="label">&</code></a>
<a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="label">&        </code><code class="vardecl">rev1</code>, <code class="vardecl">rev2</code>, <code class="vardecl">offset</code>)</a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">offset</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
      <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD0</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END INTERFACE</code></a>

<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Make sure that on the coarser grids the constant pressure</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! boundary condition is used.</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile">walltreatment = wallbctreatment</a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (currentlevel .GT. groundlevel) walltreatment = constantpressure</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Loop over the boundary condition subfaces of this block.</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="label">bocos:</code><code class="keyword">DO </code>nn=<code class="constant">1</code>,nbocos</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Check for Euler wall boundary condition.</code></a>
    <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (bctype(nn) .EQ. eulerwall) <code class="keyword">THEN</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Set the pointers for the unit normal and the normal</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! velocity to make the code more readable.</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile">norm => bcdata(nn)%norm</a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile">rface => bcdata(nn)%rface</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Nullify the pointers and set them to the correct subface.</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! They are nullified first, because some compilers require</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! that.</code></a>
<a name="p20"></a><a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!nullify(ww1, ww2, pp1, pp2, rlv1, rlv2, rev1, rev2)</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CALL </code><code class="funcname">SETBCPOINTERS_CD0</code>(nn, ww1, ww2, pp1, pp2, rlv1, rlv2, rev1, <code class="label">&</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="label">&                       </code>rev2, </a><a href="msg.html#p20" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="constant">0_intType</code>)</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!          **************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!          *                                                            *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!          * Determine the boundary condition treatment and compute the *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!          * undivided pressure gradient accordingly. This gradient is  *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!          * temporarily stored in the halo pressure.                   *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!          *                                                            *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!          **************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">SELECT CASE </code> (walltreatment) </a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(constantpressure) </a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Constant pressure. Set the gradient to zero.</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp1(j, k) = zero</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(linextrapolpressure) </a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!===========================================================</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Linear extrapolation. First set the additional pointer</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! for pp3, depending on the block face.</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(imin) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">3</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(imax) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(nx, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">3</code>, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">1</code>:, ny, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">3</code>)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, nz)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the gradient.</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp1(j, k) = pp3(j, k) - pp2(j, k)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(quadextrapolpressure) </a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!===========================================================</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Quadratic extrapolation. First set the additional</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! pointers for pp3 and pp4, depending on the block face.</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(imin) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">3</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp4 => p(<code class="constant">4</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(imax) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(nx, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp4 => p(nx-<code class="constant">1</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">3</code>, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp4 => p(<code class="constant">1</code>:, <code class="constant">4</code>, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">1</code>:, ny, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp4 => p(<code class="constant">1</code>:, ny-<code class="constant">1</code>, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">3</code>)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp4 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">4</code>)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, nz)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp4 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, nz-<code class="constant">1</code>)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the gradient.</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp1(j, k) = two*pp3(j, k) - <code class="constant">1.5_realType</code>*pp2(j, k) - half*<code class="label">&</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="label">&              </code>pp4(j, k)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(normalmomentum) </a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!===========================================================</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Pressure gradient is computed using the normal momentum</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! equation. First set a couple of additional variables for</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! the normals, depending on the block face. Note that the</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! construction 1: should not be used in these pointers,</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! because element 0 is needed. Consequently there will be</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! an offset of 1 for these normals. This is commented in</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! the code. For moving faces also the grid velocity of</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! the 1st cell center from the wall is needed.</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(imin) </a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssi => si(<code class="constant">1</code>, :, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssj => sj(<code class="constant">2</code>, :, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssk => sk(<code class="constant">2</code>, :, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ss => s(<code class="constant">2</code>, :, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(imax) </a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssi => si(il, :, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssj => sj(il, :, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssk => sk(il, :, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ss => s(il, :, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssi => sj(:, <code class="constant">1</code>, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssj => si(:, <code class="constant">2</code>, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssk => sk(:, <code class="constant">2</code>, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ss => s(:, <code class="constant">2</code>, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssi => sj(:, jl, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssj => si(:, jl, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssk => sk(:, jl, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ss => s(:, jl, :, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssi => sk(:, :, <code class="constant">1</code>, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssj => si(:, :, <code class="constant">2</code>, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssk => sj(:, :, <code class="constant">2</code>, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ss => s(:, :, <code class="constant">2</code>, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssi => sk(:, :, kl, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssj => si(:, :, kl, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ssk => sj(:, :, kl, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ss => s(:, :, kl, :)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Loop over the faces of the generic subface.</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Store the indices k+1, k-1 a bit easier and make</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! sure that they do not exceed the range of the arrays.</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">km1 = k - <code class="constant">1</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (bcdata(nn)%jcbeg .LT. km1) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">km1 = km1</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">km1 = bcdata(nn)%jcbeg</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">kp1 = k + <code class="constant">1</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (bcdata(nn)%jcend .GT. kp1) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">kp1 = kp1</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">kp1 = bcdata(nn)%jcend</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (<code class="constant">1_intType </code>.LT. kp1 - km1) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">max1 = kp1 - km1</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">max1 = <code class="constant">1_intType</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the scaling factor for the central difference</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! in the k-direction.</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">b1 = one/max1</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! The j-loop.</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! The indices j+1 and j-1. Make sure that they</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! do not exceed the range of the arrays.</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">jm1 = j - <code class="constant">1</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (bcdata(nn)%icbeg .LT. jm1) <code class="keyword">THEN</code></a>
              <a href="bceulerwall_p.html#bceulerwall" target="origFile">jm1 = jm1</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">ELSE</code></a>
              <a href="bceulerwall_p.html#bceulerwall" target="origFile">jm1 = bcdata(nn)%icbeg</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">jp1 = j + <code class="constant">1</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (bcdata(nn)%icend .GT. jp1) <code class="keyword">THEN</code></a>
              <a href="bceulerwall_p.html#bceulerwall" target="origFile">jp1 = jp1</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">ELSE</code></a>
              <a href="bceulerwall_p.html#bceulerwall" target="origFile">jp1 = bcdata(nn)%icend</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (<code class="constant">1_intType </code>.LT. jp1 - jm1) <code class="keyword">THEN</code></a>
              <a href="bceulerwall_p.html#bceulerwall" target="origFile">max2 = jp1 - jm1</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">ELSE</code></a>
              <a href="bceulerwall_p.html#bceulerwall" target="origFile">max2 = <code class="constant">1_intType</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the scaling factor for the central</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! difference in the j-direction.</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">a1 = one/max2</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute (twice) the average normal in the generic i,</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! j and k-direction. Note that in j and k-direction</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! the average in the original indices should be taken</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! using j-1 and j (and k-1 and k). However due to the</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! usage of pointers ssj and ssk there is an offset in</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! the indices of 1 and therefore now the correct</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! average is obtained with the indices j and j+1</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! (k and k+1).</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">sixa = two*ssi(j, k, <code class="constant">1</code>)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">siya = two*ssi(j, k, <code class="constant">2</code>)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">siza = two*ssi(j, k, <code class="constant">3</code>)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">sjxa = ssj(j, k, <code class="constant">1</code>) + ssj(j+<code class="constant">1</code>, k, <code class="constant">1</code>)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">sjya = ssj(j, k, <code class="constant">2</code>) + ssj(j+<code class="constant">1</code>, k, <code class="constant">2</code>)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">sjza = ssj(j, k, <code class="constant">3</code>) + ssj(j+<code class="constant">1</code>, k, <code class="constant">3</code>)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">skxa = ssk(j, k, <code class="constant">1</code>) + ssk(j, k+<code class="constant">1</code>, <code class="constant">1</code>)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">skya = ssk(j, k, <code class="constant">2</code>) + ssk(j, k+<code class="constant">1</code>, <code class="constant">2</code>)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">skza = ssk(j, k, <code class="constant">3</code>) + ssk(j, k+<code class="constant">1</code>, <code class="constant">3</code>)</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the difference of the normal vector and</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! pressure in j and k-direction. As the indices are</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! restricted to the 1st halo-layer, the computation</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! of the internal halo values is not consistent;</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! however this is not really a problem, because these</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! values are overwritten in the communication pattern.</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">rxj = a1*(norm(jp1, k, <code class="constant">1</code>)-norm(jm1, k, <code class="constant">1</code>))</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ryj = a1*(norm(jp1, k, <code class="constant">2</code>)-norm(jm1, k, <code class="constant">2</code>))</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">rzj = a1*(norm(jp1, k, <code class="constant">3</code>)-norm(jm1, k, <code class="constant">3</code>))</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">dpj = a1*(pp2(jp1, k)-pp2(jm1, k))</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">rxk = b1*(norm(j, kp1, <code class="constant">1</code>)-norm(j, km1, <code class="constant">1</code>))</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ryk = b1*(norm(j, kp1, <code class="constant">2</code>)-norm(j, km1, <code class="constant">2</code>))</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">rzk = b1*(norm(j, kp1, <code class="constant">3</code>)-norm(j, km1, <code class="constant">3</code>))</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">dpk = b1*(pp2(j, kp1)-pp2(j, km1))</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the dot product between the unit vector</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! and the normal vectors in i, j and k-direction.</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ri = norm(j, k, <code class="constant">1</code>)*sixa + norm(j, k, <code class="constant">2</code>)*siya + norm(j, k, <code class="constant">3</code>)<code class="label">&</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="label">&              </code>*siza</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">rj = norm(j, k, <code class="constant">1</code>)*sjxa + norm(j, k, <code class="constant">2</code>)*sjya + norm(j, k, <code class="constant">3</code>)<code class="label">&</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="label">&              </code>*sjza</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">rk = norm(j, k, <code class="constant">1</code>)*skxa + norm(j, k, <code class="constant">2</code>)*skya + norm(j, k, <code class="constant">3</code>)<code class="label">&</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="label">&              </code>*skza</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Store the velocity components in ux, uy and uz and</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! subtract the mesh velocity if the face is moving.</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ux = ww2(j, k, ivx)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">uy = ww2(j, k, ivy)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">uz = ww2(j, k, ivz)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
              <a href="bceulerwall_p.html#bceulerwall" target="origFile">ux = ux - ss(j, k, <code class="constant">1</code>)</a>
              <a href="bceulerwall_p.html#bceulerwall" target="origFile">uy = uy - ss(j, k, <code class="constant">2</code>)</a>
              <a href="bceulerwall_p.html#bceulerwall" target="origFile">uz = uz - ss(j, k, <code class="constant">3</code>)</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the velocity components in j and</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! k-direction.</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">qj = ux*sjxa + uy*sjya + uz*sjza</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">qk = ux*skxa + uy*skya + uz*skza</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the pressure gradient, which is stored</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! in pp1. I'm not entirely sure whether this</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! formulation is correct for moving meshes. It could</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! be that an additional term is needed there.</code></a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp1(j, k) = ((qj*(ux*rxj+uy*ryj+uz*rzj)+qk*(ux*rxk+uy*ryk+uz<code class="label">&</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="label">&              </code>*rzk))*ww2(j, k, irho)-rj*dpj-rk*dpk)/ri</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Determine the state in the halo cell. Again loop over</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! the cell range for this subface.</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the pressure density and velocity in the</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! halo cell. Note that rface is the grid velocity</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! component in the direction of norm, i.e. outward</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! pointing.</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">pp1(j, k) = <code class="funcname">DIM_CD</code>(pp2(j, k), pp1(j, k))</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">vn = two*(rface(j, k)-ww2(j, k, ivx)*norm(j, k, <code class="constant">1</code>)-ww2(j, k, <code class="label">&</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="label">&            </code>ivy)*norm(j, k, <code class="constant">2</code>)-ww2(j, k, ivz)*norm(j, k, <code class="constant">3</code>))</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ww1(j, k, irho) = ww2(j, k, irho)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ww1(j, k, ivx) = ww2(j, k, ivx) + vn*norm(j, k, <code class="constant">1</code>)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ww1(j, k, ivy) = ww2(j, k, ivy) + vn*norm(j, k, <code class="constant">2</code>)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile">ww1(j, k, ivz) = ww2(j, k, ivz) + vn*norm(j, k, <code class="constant">3</code>)</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Just copy the turbulent variables.</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">DO </code>l=nt1mg,nt2mg</a>
            <a href="bceulerwall_p.html#bceulerwall" target="origFile">ww1(j, k, l) = ww2(j, k, l)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! The laminar and eddy viscosity, if present.</code></a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (viscous) rlv1(j, k) = rlv2(j, k)</a>
          <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (eddymodel) rev1(j, k) = rev2(j, k)</a>
        <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Compute the energy for these halo's.</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">CALL </code><code class="funcname">COMPUTEETOT_CD</code>(icbeg(nn), icend(nn), jcbeg(nn), jcend(nn), <code class="label">&</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="label">&                    </code>kcbeg(nn), kcend(nn), correctfork)</a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! Extrapolate the state vectors in case a second halo</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">! is needed.</code></a>
      <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IF</code> (secondhalo) <code class="keyword">CALL </code><code class="funcname">EXTRAPOLATE2NDHALO_CD</code>(nn, correctfork)</a>
    <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END IF</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END DO </code><code class="label">bocos</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">BCEULERWALL_CD</code></a>
</pre>
</body>
