<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="inviscidcentralflux_spatial_d"></a><a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!  Differentiation of inviscidcentralflux in forward (tangent) mode:</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!   variations   of useful results: *dw</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!   with respect to varying inputs: *p *w *vol *si *sj *sk</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      * File:          inviscidCentralFlux.f90                         *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      * Starting date: 03-24-2003                                      *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      * Last modified: 10-29-2007                                      *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">INVISCIDCENTRALFLUX_SPATIAL_D</code>()</a>
  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="keyword">USE </code><code class="funcname">CGNSGRID_SPATIAL_D</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
<a name="inviscidcentralflux_spatial_di0"></a>  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!write(14,40),i,j,k,dw(i,j,k,imx)</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!      * inviscidCentralFlux computes the Euler fluxes using a central  *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!      * discretization for a given block. Therefore it is assumed that *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!      * the pointers in block pointer already point to the correct     *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!      * block on the correct multigrid level.                          *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="inviscidcentralflux_spatial_di1"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="comment">!</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi0" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">ind</code></a>
<a name="inviscidcentralflux_spatial_di2"></a>  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi1" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">qsp</code>, <code class="vardecl">qsm</code>, <code class="vardecl">rqsp</code>, <code class="vardecl">rqsm</code>, <code class="vardecl">porvel</code>, <code class="vardecl">porflux</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">qspd</code>, <code class="vardecl">qsmd</code>, <code class="vardecl">rqspd</code>, <code class="vardecl">rqsmd</code></a>
<a name="inviscidcentralflux_spatial_di3"></a>  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">pa</code>, <code class="vardecl">fs</code>, <code class="vardecl">sface</code>, <code class="vardecl">vnp</code>, <code class="vardecl">vnm</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">pad</code>, <code class="vardecl">fsd</code>, <code class="vardecl">vnpd</code>, <code class="vardecl">vnmd</code></a>
<a name="inviscidcentralflux_spatial_di4"></a>  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi3" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">wx</code>, <code class="vardecl">wy</code>, <code class="vardecl">wz</code>, <code class="vardecl">rvol</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rvold</code></a>
<a name="inviscidcentralflux_spatial_di5"></a>  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi4" target="origFile">sface = zero</a>
  <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile">dwd = <code class="constant">0.0</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi5" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi5" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi5" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi5" target="origFile"><code class="comment">!      * Advective fluxes in the i-direction.                           *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi5" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi5" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a name="inviscidcentralflux_spatial_di6"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi5" target="origFile"><code class="comment">!</code></a>
<a name="inviscidcentralflux_spatial_di7"></a>  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi5" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidcentralflux_spatial_di8"></a>    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi6" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
      <a href="inviscidcentralflux_p.html#inviscidcentralfluxi7" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
<a name="inviscidcentralflux_spatial_di9"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi8" target="origFile"><code class="comment">! Set the dot product of the grid velocity and the</code></a>
<a name="inviscidcentralflux_spatial_di10"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi8" target="origFile"><code class="comment">! normal in i-direction for a moving face.</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi8" target="origFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi9" target="origFile">sface = sfacei(i, j, k)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi10" target="origFile"><code class="comment">! Compute the normal velocities of the left and right state.</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi10" target="origFile">vnpd = wd(i+<code class="constant">1</code>, j, k, ivx)*si(i, j, k, <code class="constant">1</code>) + w(i+<code class="constant">1</code>, j, k, ivx)*sid<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi10" target="origFile"><code class="label">&          </code>(i, j, k, <code class="constant">1</code>) + wd(i+<code class="constant">1</code>, j, k, ivy)*si(i, j, k, <code class="constant">2</code>) + w(i+<code class="constant">1</code>, j, k<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi10" target="origFile"><code class="label">&          </code>, ivy)*sid(i, j, k, <code class="constant">2</code>) + wd(i+<code class="constant">1</code>, j, k, ivz)*si(i, j, k, <code class="constant">3</code>) + w<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi10" target="origFile"><code class="label">&          </code>(i+<code class="constant">1</code>, j, k, ivz)*sid(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di11"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi10" target="origFile">vnp = w(i+<code class="constant">1</code>, j, k, ivx)*si(i, j, k, <code class="constant">1</code>) + w(i+<code class="constant">1</code>, j, k, ivy)*si(i<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi10" target="origFile"><code class="label">&          </code>, j, k, <code class="constant">2</code>) + w(i+<code class="constant">1</code>, j, k, ivz)*si(i, j, k, <code class="constant">3</code>)</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi11" target="origFile">vnmd = wd(i, j, k, ivx)*si(i, j, k, <code class="constant">1</code>) + w(i, j, k, ivx)*sid(i, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi11" target="origFile"><code class="label">&          </code>j, k, <code class="constant">1</code>) + wd(i, j, k, ivy)*si(i, j, k, <code class="constant">2</code>) + w(i, j, k, ivy)*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi11" target="origFile"><code class="label">&          </code>sid(i, j, k, <code class="constant">2</code>) + wd(i, j, k, ivz)*si(i, j, k, <code class="constant">3</code>) + w(i, j, k<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi11" target="origFile"><code class="label">&          </code>, ivz)*sid(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di12"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi11" target="origFile">vnm = w(i, j, k, ivx)*si(i, j, k, <code class="constant">1</code>) + w(i, j, k, ivy)*si(i, j, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi11" target="origFile"><code class="label">&          </code>k, <code class="constant">2</code>) + w(i, j, k, ivz)*si(i, j, k, <code class="constant">3</code>)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile"><code class="comment">! Set the values of the porosities for this face.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile"><code class="comment">! porVel defines the porosity w.r.t. velocity;</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile"><code class="comment">! porFlux defines the porosity w.r.t. the entire flux.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile"><code class="comment">! The latter is only zero for a discontinuous block</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile"><code class="comment">! boundary that must be treated conservatively.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile"><code class="comment">! The default value of porFlux is 0.5, such that the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile"><code class="comment">! correct central flux is scattered to both cells.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile"><code class="comment">! In case of a boundFlux the normal velocity is set</code></a>
<a name="inviscidcentralflux_spatial_di13"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile"><code class="comment">! to sFace.</code></a>
<a name="inviscidcentralflux_spatial_di15"></a><a name="inviscidcentralflux_spatial_di14"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi12" target="origFile">porvel = one</a>
<a name="inviscidcentralflux_spatial_di16"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi13" target="origFile">porflux = half</a>
<a name="inviscidcentralflux_spatial_di17"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi14" target="origFile"><code class="keyword">IF</code> (pori(i, j, k) .EQ. noflux) </a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi15" target="origFile">porflux = zero</a>
<a name="inviscidcentralflux_spatial_di18"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi16" target="origFile"><code class="keyword">IF</code> (pori(i, j, k) .EQ. boundflux) <code class="keyword">THEN</code></a>
<a name="inviscidcentralflux_spatial_di19"></a>          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi17" target="origFile">porvel = zero</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi18" target="origFile">vnp = sface</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi19" target="origFile">vnm = sface</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi16" target="origFile">vnmd = <code class="constant">0.0</code></a>
<a name="inviscidcentralflux_spatial_di20"></a>          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi16" target="origFile">vnpd = <code class="constant">0.0</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi16" target="origFile"><code class="keyword">END IF</code></a>
<a name="inviscidcentralflux_spatial_di21"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi20" target="origFile"><code class="comment">! Incorporate porFlux in porVel.</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi20" target="origFile">porvel = porvel*porflux</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi21" target="origFile"><code class="comment">! Compute the normal velocities relative to the grid for</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi21" target="origFile"><code class="comment">! the face as well as the mass fluxes.</code></a>
<a name="inviscidcentralflux_spatial_di22"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi21" target="origFile">qspd = porvel*vnpd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi21" target="origFile">qsp = (vnp-sface)*porvel</a>
<a name="inviscidcentralflux_spatial_di23"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi22" target="origFile">qsmd = porvel*vnmd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi22" target="origFile">qsm = (vnm-sface)*porvel</a>
<a name="inviscidcentralflux_spatial_di24"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi23" target="origFile">rqspd = qspd*w(i+<code class="constant">1</code>, j, k, irho) + qsp*wd(i+<code class="constant">1</code>, j, k, irho)</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi23" target="origFile">rqsp = qsp*w(i+<code class="constant">1</code>, j, k, irho)</a>
<a name="inviscidcentralflux_spatial_di25"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi24" target="origFile">rqsmd = qsmd*w(i, j, k, irho) + qsm*wd(i, j, k, irho)</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi24" target="origFile">rqsm = qsm*w(i, j, k, irho)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi25" target="origFile"><code class="comment">! Compute the sum of the pressure multiplied by porFlux.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi25" target="origFile"><code class="comment">! For the default value of porFlux, 0.5, this leads to</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi25" target="origFile"><code class="comment">! the average pressure.</code></a>
<a name="inviscidcentralflux_spatial_di26"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi25" target="origFile">pad = porflux*(pd(i+<code class="constant">1</code>, j, k)+pd(i, j, k))</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi25" target="origFile">pa = porflux*(p(i+<code class="constant">1</code>, j, k)+p(i, j, k))</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi26" target="origFile"><code class="comment">! Compute the fluxes and scatter them to the cells</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi26" target="origFile"><code class="comment">! i,j,k and i+1,j,k. Store the density flux in the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi26" target="origFile"><code class="comment">! mass flow of the appropriate sliding mesh interface.</code></a>
<a name="inviscidcentralflux_spatial_di27"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi26" target="origFile">fsd = rqspd + rqsmd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi26" target="origFile">fs = rqsp + rqsm</a>
<a name="inviscidcentralflux_spatial_di28"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi27" target="origFile">dwd(i+<code class="constant">1</code>, j, k, irho) = dwd(i+<code class="constant">1</code>, j, k, irho) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi27" target="origFile">dw(i+<code class="constant">1</code>, j, k, irho) = dw(i+<code class="constant">1</code>, j, k, irho) - fs</a>
<a name="inviscidcentralflux_spatial_di29"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi28" target="origFile">dwd(i, j, k, irho) = dwd(i, j, k, irho) + fsd</a>
<a name="inviscidcentralflux_spatial_di30"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi28" target="origFile">dw(i, j, k, irho) = dw(i, j, k, irho) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi29" target="origFile">ind = indfamilyi(i, j, k)</a>
<a name="inviscidcentralflux_spatial_di31"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi30" target="origFile">massflowfamilyinv(ind, spectralsol) = massflowfamilyinv(ind, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi30" target="origFile"><code class="label">&          </code>spectralsol) + factfamilyi(i, j, k)*fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi31" target="origFile">fsd = rqspd*w(i+<code class="constant">1</code>, j, k, ivx) + rqsp*wd(i+<code class="constant">1</code>, j, k, ivx) + rqsmd*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi31" target="origFile"><code class="label">&          </code>w(i, j, k, ivx) + rqsm*wd(i, j, k, ivx) + pad*si(i, j, k, <code class="constant">1</code>) +<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi31" target="origFile"><code class="label">&          </code>pa*sid(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidcentralflux_spatial_di32"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi31" target="origFile">fs = rqsp*w(i+<code class="constant">1</code>, j, k, ivx) + rqsm*w(i, j, k, ivx) + pa*si(i, j<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi31" target="origFile"><code class="label">&          </code>, k, <code class="constant">1</code>)</a>
<a name="inviscidcentralflux_spatial_di33"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi32" target="origFile">dwd(i+<code class="constant">1</code>, j, k, imx) = dwd(i+<code class="constant">1</code>, j, k, imx) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi32" target="origFile">dw(i+<code class="constant">1</code>, j, k, imx) = dw(i+<code class="constant">1</code>, j, k, imx) - fs</a>
<a name="inviscidcentralflux_spatial_di34"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi33" target="origFile">dwd(i, j, k, imx) = dwd(i, j, k, imx) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi33" target="origFile">dw(i, j, k, imx) = dw(i, j, k, imx) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi34" target="origFile">fsd = rqspd*w(i+<code class="constant">1</code>, j, k, ivy) + rqsp*wd(i+<code class="constant">1</code>, j, k, ivy) + rqsmd*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi34" target="origFile"><code class="label">&          </code>w(i, j, k, ivy) + rqsm*wd(i, j, k, ivy) + pad*si(i, j, k, <code class="constant">2</code>) +<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi34" target="origFile"><code class="label">&          </code>pa*sid(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidcentralflux_spatial_di35"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi34" target="origFile">fs = rqsp*w(i+<code class="constant">1</code>, j, k, ivy) + rqsm*w(i, j, k, ivy) + pa*si(i, j<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi34" target="origFile"><code class="label">&          </code>, k, <code class="constant">2</code>)</a>
<a name="inviscidcentralflux_spatial_di36"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi35" target="origFile">dwd(i+<code class="constant">1</code>, j, k, imy) = dwd(i+<code class="constant">1</code>, j, k, imy) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi35" target="origFile">dw(i+<code class="constant">1</code>, j, k, imy) = dw(i+<code class="constant">1</code>, j, k, imy) - fs</a>
<a name="inviscidcentralflux_spatial_di37"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi36" target="origFile">dwd(i, j, k, imy) = dwd(i, j, k, imy) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi36" target="origFile">dw(i, j, k, imy) = dw(i, j, k, imy) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi37" target="origFile">fsd = rqspd*w(i+<code class="constant">1</code>, j, k, ivz) + rqsp*wd(i+<code class="constant">1</code>, j, k, ivz) + rqsmd*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi37" target="origFile"><code class="label">&          </code>w(i, j, k, ivz) + rqsm*wd(i, j, k, ivz) + pad*si(i, j, k, <code class="constant">3</code>) +<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi37" target="origFile"><code class="label">&          </code>pa*sid(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di38"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi37" target="origFile">fs = rqsp*w(i+<code class="constant">1</code>, j, k, ivz) + rqsm*w(i, j, k, ivz) + pa*si(i, j<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi37" target="origFile"><code class="label">&          </code>, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di39"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi38" target="origFile">dwd(i+<code class="constant">1</code>, j, k, imz) = dwd(i+<code class="constant">1</code>, j, k, imz) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi38" target="origFile">dw(i+<code class="constant">1</code>, j, k, imz) = dw(i+<code class="constant">1</code>, j, k, imz) - fs</a>
<a name="inviscidcentralflux_spatial_di40"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi39" target="origFile">dwd(i, j, k, imz) = dwd(i, j, k, imz) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi39" target="origFile">dw(i, j, k, imz) = dw(i, j, k, imz) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi40" target="origFile">fsd = qspd*w(i+<code class="constant">1</code>, j, k, irhoe) + qsp*wd(i+<code class="constant">1</code>, j, k, irhoe) + qsmd<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi40" target="origFile"><code class="label">&          </code>*w(i, j, k, irhoe) + qsm*wd(i, j, k, irhoe) + porflux*(vnpd*p(<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi40" target="origFile"><code class="label">&          </code>i+<code class="constant">1</code>, j, k)+vnp*pd(i+<code class="constant">1</code>, j, k)+vnmd*p(i, j, k)+vnm*pd(i, j, k))</a>
<a name="inviscidcentralflux_spatial_di41"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi40" target="origFile">fs = qsp*w(i+<code class="constant">1</code>, j, k, irhoe) + qsm*w(i, j, k, irhoe) + porflux*(<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi40" target="origFile"><code class="label">&          </code>vnp*p(i+<code class="constant">1</code>, j, k)+vnm*p(i, j, k))</a>
<a name="inviscidcentralflux_spatial_di42"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi41" target="origFile">dwd(i+<code class="constant">1</code>, j, k, irhoe) = dwd(i+<code class="constant">1</code>, j, k, irhoe) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi41" target="origFile">dw(i+<code class="constant">1</code>, j, k, irhoe) = dw(i+<code class="constant">1</code>, j, k, irhoe) - fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi42" target="origFile">dwd(i, j, k, irhoe) = dwd(i, j, k, irhoe) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi42" target="origFile">dw(i, j, k, irhoe) = dw(i, j, k, irhoe) + fs</a>
      <a href="inviscidcentralflux_p.html#inviscidcentralfluxi7" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidcentralflux_spatial_di43"></a>    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi6" target="origFile"><code class="keyword">END DO</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi5" target="origFile"><code class="keyword">END DO</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="comment">!write(14,40),i,j,k,dw(i,j,k,irhoE)</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="comment">!      * Advective fluxes in the j-direction.                           *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a name="inviscidcentralflux_spatial_di44"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="comment">!</code></a>
<a name="inviscidcentralflux_spatial_di45"></a>  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidcentralflux_spatial_di46"></a>    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi44" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
      <a href="inviscidcentralflux_p.html#inviscidcentralfluxi45" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="inviscidcentralflux_spatial_di47"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi46" target="origFile"><code class="comment">! Set the dot product of the grid velocity and the</code></a>
<a name="inviscidcentralflux_spatial_di48"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi46" target="origFile"><code class="comment">! normal in j-direction for a moving face.</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi46" target="origFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi47" target="origFile">sface = sfacej(i, j, k)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi48" target="origFile"><code class="comment">! Compute the normal velocities of the left and right state.</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi48" target="origFile">vnpd = wd(i, j+<code class="constant">1</code>, k, ivx)*sj(i, j, k, <code class="constant">1</code>) + w(i, j+<code class="constant">1</code>, k, ivx)*sjd<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi48" target="origFile"><code class="label">&          </code>(i, j, k, <code class="constant">1</code>) + wd(i, j+<code class="constant">1</code>, k, ivy)*sj(i, j, k, <code class="constant">2</code>) + w(i, j+<code class="constant">1</code>, k<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi48" target="origFile"><code class="label">&          </code>, ivy)*sjd(i, j, k, <code class="constant">2</code>) + wd(i, j+<code class="constant">1</code>, k, ivz)*sj(i, j, k, <code class="constant">3</code>) + w<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi48" target="origFile"><code class="label">&          </code>(i, j+<code class="constant">1</code>, k, ivz)*sjd(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di49"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi48" target="origFile">vnp = w(i, j+<code class="constant">1</code>, k, ivx)*sj(i, j, k, <code class="constant">1</code>) + w(i, j+<code class="constant">1</code>, k, ivy)*sj(i<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi48" target="origFile"><code class="label">&          </code>, j, k, <code class="constant">2</code>) + w(i, j+<code class="constant">1</code>, k, ivz)*sj(i, j, k, <code class="constant">3</code>)</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi49" target="origFile">vnmd = wd(i, j, k, ivx)*sj(i, j, k, <code class="constant">1</code>) + w(i, j, k, ivx)*sjd(i, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi49" target="origFile"><code class="label">&          </code>j, k, <code class="constant">1</code>) + wd(i, j, k, ivy)*sj(i, j, k, <code class="constant">2</code>) + w(i, j, k, ivy)*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi49" target="origFile"><code class="label">&          </code>sjd(i, j, k, <code class="constant">2</code>) + wd(i, j, k, ivz)*sj(i, j, k, <code class="constant">3</code>) + w(i, j, k<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi49" target="origFile"><code class="label">&          </code>, ivz)*sjd(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di50"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi49" target="origFile">vnm = w(i, j, k, ivx)*sj(i, j, k, <code class="constant">1</code>) + w(i, j, k, ivy)*sj(i, j, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi49" target="origFile"><code class="label">&          </code>k, <code class="constant">2</code>) + w(i, j, k, ivz)*sj(i, j, k, <code class="constant">3</code>)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile"><code class="comment">! Set the values of the porosities for this face.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile"><code class="comment">! porVel defines the porosity w.r.t. velocity;</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile"><code class="comment">! porFlux defines the porosity w.r.t. the entire flux.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile"><code class="comment">! The latter is only zero for a discontinuous block</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile"><code class="comment">! boundary that must be treated conservatively.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile"><code class="comment">! The default value of porFlux is 0.5, such that the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile"><code class="comment">! correct central flux is scattered to both cells.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile"><code class="comment">! In case of a boundFlux the normal velocity is set</code></a>
<a name="inviscidcentralflux_spatial_di51"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile"><code class="comment">! to sFace.</code></a>
<a name="inviscidcentralflux_spatial_di53"></a><a name="inviscidcentralflux_spatial_di52"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi50" target="origFile">porvel = one</a>
<a name="inviscidcentralflux_spatial_di54"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi51" target="origFile">porflux = half</a>
<a name="inviscidcentralflux_spatial_di55"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi52" target="origFile"><code class="keyword">IF</code> (porj(i, j, k) .EQ. noflux) </a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi53" target="origFile">porflux = zero</a>
<a name="inviscidcentralflux_spatial_di56"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi54" target="origFile"><code class="keyword">IF</code> (porj(i, j, k) .EQ. boundflux) <code class="keyword">THEN</code></a>
<a name="inviscidcentralflux_spatial_di57"></a>          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi55" target="origFile">porvel = zero</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi56" target="origFile">vnp = sface</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi57" target="origFile">vnm = sface</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi54" target="origFile">vnmd = <code class="constant">0.0</code></a>
<a name="inviscidcentralflux_spatial_di58"></a>          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi54" target="origFile">vnpd = <code class="constant">0.0</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi54" target="origFile"><code class="keyword">END IF</code></a>
<a name="inviscidcentralflux_spatial_di59"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi58" target="origFile"><code class="comment">! Incorporate porFlux in porVel.</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi58" target="origFile">porvel = porvel*porflux</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi59" target="origFile"><code class="comment">! Compute the normal velocities for the face as well as the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi59" target="origFile"><code class="comment">! mass fluxes.</code></a>
<a name="inviscidcentralflux_spatial_di60"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi59" target="origFile">qspd = porvel*vnpd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi59" target="origFile">qsp = (vnp-sface)*porvel</a>
<a name="inviscidcentralflux_spatial_di61"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi60" target="origFile">qsmd = porvel*vnmd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi60" target="origFile">qsm = (vnm-sface)*porvel</a>
<a name="inviscidcentralflux_spatial_di62"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi61" target="origFile">rqspd = qspd*w(i, j+<code class="constant">1</code>, k, irho) + qsp*wd(i, j+<code class="constant">1</code>, k, irho)</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi61" target="origFile">rqsp = qsp*w(i, j+<code class="constant">1</code>, k, irho)</a>
<a name="inviscidcentralflux_spatial_di63"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi62" target="origFile">rqsmd = qsmd*w(i, j, k, irho) + qsm*wd(i, j, k, irho)</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi62" target="origFile">rqsm = qsm*w(i, j, k, irho)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi63" target="origFile"><code class="comment">! Compute the sum of the pressure multiplied by porFlux.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi63" target="origFile"><code class="comment">! For the default value of porFlux, 0.5, this leads to</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi63" target="origFile"><code class="comment">! the average pressure.</code></a>
<a name="inviscidcentralflux_spatial_di64"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi63" target="origFile">pad = porflux*(pd(i, j+<code class="constant">1</code>, k)+pd(i, j, k))</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi63" target="origFile">pa = porflux*(p(i, j+<code class="constant">1</code>, k)+p(i, j, k))</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi64" target="origFile"><code class="comment">! Compute the fluxes and scatter them to the cells</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi64" target="origFile"><code class="comment">! i,j,k and i,j+1,k. Store the density flux in the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi64" target="origFile"><code class="comment">! mass flow of the appropriate sliding mesh interface.</code></a>
<a name="inviscidcentralflux_spatial_di65"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi64" target="origFile">fsd = rqspd + rqsmd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi64" target="origFile">fs = rqsp + rqsm</a>
<a name="inviscidcentralflux_spatial_di66"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi65" target="origFile">dwd(i, j+<code class="constant">1</code>, k, irho) = dwd(i, j+<code class="constant">1</code>, k, irho) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi65" target="origFile">dw(i, j+<code class="constant">1</code>, k, irho) = dw(i, j+<code class="constant">1</code>, k, irho) - fs</a>
<a name="inviscidcentralflux_spatial_di67"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi66" target="origFile">dwd(i, j, k, irho) = dwd(i, j, k, irho) + fsd</a>
<a name="inviscidcentralflux_spatial_di68"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi66" target="origFile">dw(i, j, k, irho) = dw(i, j, k, irho) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi67" target="origFile">ind = indfamilyj(i, j, k)</a>
<a name="inviscidcentralflux_spatial_di69"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi68" target="origFile">massflowfamilyinv(ind, spectralsol) = massflowfamilyinv(ind, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi68" target="origFile"><code class="label">&          </code>spectralsol) + factfamilyj(i, j, k)*fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi69" target="origFile">fsd = rqspd*w(i, j+<code class="constant">1</code>, k, ivx) + rqsp*wd(i, j+<code class="constant">1</code>, k, ivx) + rqsmd*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi69" target="origFile"><code class="label">&          </code>w(i, j, k, ivx) + rqsm*wd(i, j, k, ivx) + pad*sj(i, j, k, <code class="constant">1</code>) +<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi69" target="origFile"><code class="label">&          </code>pa*sjd(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidcentralflux_spatial_di70"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi69" target="origFile">fs = rqsp*w(i, j+<code class="constant">1</code>, k, ivx) + rqsm*w(i, j, k, ivx) + pa*sj(i, j<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi69" target="origFile"><code class="label">&          </code>, k, <code class="constant">1</code>)</a>
<a name="inviscidcentralflux_spatial_di71"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi70" target="origFile">dwd(i, j+<code class="constant">1</code>, k, imx) = dwd(i, j+<code class="constant">1</code>, k, imx) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi70" target="origFile">dw(i, j+<code class="constant">1</code>, k, imx) = dw(i, j+<code class="constant">1</code>, k, imx) - fs</a>
<a name="inviscidcentralflux_spatial_di72"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi71" target="origFile">dwd(i, j, k, imx) = dwd(i, j, k, imx) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi71" target="origFile">dw(i, j, k, imx) = dw(i, j, k, imx) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi72" target="origFile">fsd = rqspd*w(i, j+<code class="constant">1</code>, k, ivy) + rqsp*wd(i, j+<code class="constant">1</code>, k, ivy) + rqsmd*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi72" target="origFile"><code class="label">&          </code>w(i, j, k, ivy) + rqsm*wd(i, j, k, ivy) + pad*sj(i, j, k, <code class="constant">2</code>) +<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi72" target="origFile"><code class="label">&          </code>pa*sjd(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidcentralflux_spatial_di73"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi72" target="origFile">fs = rqsp*w(i, j+<code class="constant">1</code>, k, ivy) + rqsm*w(i, j, k, ivy) + pa*sj(i, j<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi72" target="origFile"><code class="label">&          </code>, k, <code class="constant">2</code>)</a>
<a name="inviscidcentralflux_spatial_di74"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi73" target="origFile">dwd(i, j+<code class="constant">1</code>, k, imy) = dwd(i, j+<code class="constant">1</code>, k, imy) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi73" target="origFile">dw(i, j+<code class="constant">1</code>, k, imy) = dw(i, j+<code class="constant">1</code>, k, imy) - fs</a>
<a name="inviscidcentralflux_spatial_di75"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi74" target="origFile">dwd(i, j, k, imy) = dwd(i, j, k, imy) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi74" target="origFile">dw(i, j, k, imy) = dw(i, j, k, imy) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi75" target="origFile">fsd = rqspd*w(i, j+<code class="constant">1</code>, k, ivz) + rqsp*wd(i, j+<code class="constant">1</code>, k, ivz) + rqsmd*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi75" target="origFile"><code class="label">&          </code>w(i, j, k, ivz) + rqsm*wd(i, j, k, ivz) + pad*sj(i, j, k, <code class="constant">3</code>) +<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi75" target="origFile"><code class="label">&          </code>pa*sjd(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di76"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi75" target="origFile">fs = rqsp*w(i, j+<code class="constant">1</code>, k, ivz) + rqsm*w(i, j, k, ivz) + pa*sj(i, j<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi75" target="origFile"><code class="label">&          </code>, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di77"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi76" target="origFile">dwd(i, j+<code class="constant">1</code>, k, imz) = dwd(i, j+<code class="constant">1</code>, k, imz) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi76" target="origFile">dw(i, j+<code class="constant">1</code>, k, imz) = dw(i, j+<code class="constant">1</code>, k, imz) - fs</a>
<a name="inviscidcentralflux_spatial_di78"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi77" target="origFile">dwd(i, j, k, imz) = dwd(i, j, k, imz) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi77" target="origFile">dw(i, j, k, imz) = dw(i, j, k, imz) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi78" target="origFile">fsd = qspd*w(i, j+<code class="constant">1</code>, k, irhoe) + qsp*wd(i, j+<code class="constant">1</code>, k, irhoe) + qsmd<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi78" target="origFile"><code class="label">&          </code>*w(i, j, k, irhoe) + qsm*wd(i, j, k, irhoe) + porflux*(vnpd*p(<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi78" target="origFile"><code class="label">&          </code>i, j+<code class="constant">1</code>, k)+vnp*pd(i, j+<code class="constant">1</code>, k)+vnmd*p(i, j, k)+vnm*pd(i, j, k))</a>
<a name="inviscidcentralflux_spatial_di79"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi78" target="origFile">fs = qsp*w(i, j+<code class="constant">1</code>, k, irhoe) + qsm*w(i, j, k, irhoe) + porflux*(<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi78" target="origFile"><code class="label">&          </code>vnp*p(i, j+<code class="constant">1</code>, k)+vnm*p(i, j, k))</a>
<a name="inviscidcentralflux_spatial_di80"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi79" target="origFile">dwd(i, j+<code class="constant">1</code>, k, irhoe) = dwd(i, j+<code class="constant">1</code>, k, irhoe) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi79" target="origFile">dw(i, j+<code class="constant">1</code>, k, irhoe) = dw(i, j+<code class="constant">1</code>, k, irhoe) - fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi80" target="origFile">dwd(i, j, k, irhoe) = dwd(i, j, k, irhoe) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi80" target="origFile">dw(i, j, k, irhoe) = dw(i, j, k, irhoe) + fs</a>
      <a href="inviscidcentralflux_p.html#inviscidcentralfluxi45" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidcentralflux_spatial_di81"></a>    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi44" target="origFile"><code class="keyword">END DO</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi43" target="origFile"><code class="keyword">END DO</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi81" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi81" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi81" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi81" target="origFile"><code class="comment">!      * Advective fluxes in the k-direction.                           *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi81" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi81" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a name="inviscidcentralflux_spatial_di82"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi81" target="origFile"><code class="comment">!</code></a>
<a name="inviscidcentralflux_spatial_di83"></a>  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi81" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
<a name="inviscidcentralflux_spatial_di84"></a>    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi82" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
      <a href="inviscidcentralflux_p.html#inviscidcentralfluxi83" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="inviscidcentralflux_spatial_di85"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi84" target="origFile"><code class="comment">! Set the dot product of the grid velocity and the</code></a>
<a name="inviscidcentralflux_spatial_di86"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi84" target="origFile"><code class="comment">! normal in k-direction for a moving face.</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi84" target="origFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi85" target="origFile">sface = sfacek(i, j, k)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi86" target="origFile"><code class="comment">! Compute the normal velocities of the left and right state.</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi86" target="origFile">vnpd = wd(i, j, k+<code class="constant">1</code>, ivx)*sk(i, j, k, <code class="constant">1</code>) + w(i, j, k+<code class="constant">1</code>, ivx)*skd<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi86" target="origFile"><code class="label">&          </code>(i, j, k, <code class="constant">1</code>) + wd(i, j, k+<code class="constant">1</code>, ivy)*sk(i, j, k, <code class="constant">2</code>) + w(i, j, k+<code class="constant">1</code><code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi86" target="origFile"><code class="label">&          </code>, ivy)*skd(i, j, k, <code class="constant">2</code>) + wd(i, j, k+<code class="constant">1</code>, ivz)*sk(i, j, k, <code class="constant">3</code>) + w<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi86" target="origFile"><code class="label">&          </code>(i, j, k+<code class="constant">1</code>, ivz)*skd(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di87"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi86" target="origFile">vnp = w(i, j, k+<code class="constant">1</code>, ivx)*sk(i, j, k, <code class="constant">1</code>) + w(i, j, k+<code class="constant">1</code>, ivy)*sk(i<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi86" target="origFile"><code class="label">&          </code>, j, k, <code class="constant">2</code>) + w(i, j, k+<code class="constant">1</code>, ivz)*sk(i, j, k, <code class="constant">3</code>)</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi87" target="origFile">vnmd = wd(i, j, k, ivx)*sk(i, j, k, <code class="constant">1</code>) + w(i, j, k, ivx)*skd(i, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi87" target="origFile"><code class="label">&          </code>j, k, <code class="constant">1</code>) + wd(i, j, k, ivy)*sk(i, j, k, <code class="constant">2</code>) + w(i, j, k, ivy)*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi87" target="origFile"><code class="label">&          </code>skd(i, j, k, <code class="constant">2</code>) + wd(i, j, k, ivz)*sk(i, j, k, <code class="constant">3</code>) + w(i, j, k<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi87" target="origFile"><code class="label">&          </code>, ivz)*skd(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di88"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi87" target="origFile">vnm = w(i, j, k, ivx)*sk(i, j, k, <code class="constant">1</code>) + w(i, j, k, ivy)*sk(i, j, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi87" target="origFile"><code class="label">&          </code>k, <code class="constant">2</code>) + w(i, j, k, ivz)*sk(i, j, k, <code class="constant">3</code>)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile"><code class="comment">! Set the values of the porosities for this face.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile"><code class="comment">! porVel defines the porosity w.r.t. velocity;</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile"><code class="comment">! porFlux defines the porosity w.r.t. the entire flux.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile"><code class="comment">! The latter is only zero for a discontinuous block</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile"><code class="comment">! block boundary that must be treated conservatively.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile"><code class="comment">! The default value of porFlux is 0.5, such that the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile"><code class="comment">! correct central flux is scattered to both cells.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile"><code class="comment">! In case of a boundFlux the normal velocity is set</code></a>
<a name="inviscidcentralflux_spatial_di89"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile"><code class="comment">! to sFace.</code></a>
<a name="inviscidcentralflux_spatial_di91"></a><a name="inviscidcentralflux_spatial_di90"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi88" target="origFile">porvel = one</a>
<a name="inviscidcentralflux_spatial_di92"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi89" target="origFile">porflux = half</a>
<a name="inviscidcentralflux_spatial_di93"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi90" target="origFile"><code class="keyword">IF</code> (pork(i, j, k) .EQ. noflux) </a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi91" target="origFile">porflux = zero</a>
<a name="inviscidcentralflux_spatial_di94"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi92" target="origFile"><code class="keyword">IF</code> (pork(i, j, k) .EQ. boundflux) <code class="keyword">THEN</code></a>
<a name="inviscidcentralflux_spatial_di95"></a>          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi93" target="origFile">porvel = zero</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi94" target="origFile">vnp = sface</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi95" target="origFile">vnm = sface</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi92" target="origFile">vnmd = <code class="constant">0.0</code></a>
<a name="inviscidcentralflux_spatial_di96"></a>          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi92" target="origFile">vnpd = <code class="constant">0.0</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi92" target="origFile"><code class="keyword">END IF</code></a>
<a name="inviscidcentralflux_spatial_di97"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi96" target="origFile"><code class="comment">! Incorporate porFlux in porVel.</code></a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi96" target="origFile">porvel = porvel*porflux</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi97" target="origFile"><code class="comment">! Compute the normal velocities for the face as well as the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi97" target="origFile"><code class="comment">! mass fluxes.</code></a>
<a name="inviscidcentralflux_spatial_di98"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi97" target="origFile">qspd = porvel*vnpd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi97" target="origFile">qsp = (vnp-sface)*porvel</a>
<a name="inviscidcentralflux_spatial_di99"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi98" target="origFile">qsmd = porvel*vnmd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi98" target="origFile">qsm = (vnm-sface)*porvel</a>
<a name="inviscidcentralflux_spatial_di100"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi99" target="origFile">rqspd = qspd*w(i, j, k+<code class="constant">1</code>, irho) + qsp*wd(i, j, k+<code class="constant">1</code>, irho)</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi99" target="origFile">rqsp = qsp*w(i, j, k+<code class="constant">1</code>, irho)</a>
<a name="inviscidcentralflux_spatial_di101"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi100" target="origFile">rqsmd = qsmd*w(i, j, k, irho) + qsm*wd(i, j, k, irho)</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi100" target="origFile">rqsm = qsm*w(i, j, k, irho)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi101" target="origFile"><code class="comment">! Compute the sum of the pressure multiplied by porFlux.</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi101" target="origFile"><code class="comment">! For the default value of porFlux, 0.5, this leads to</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi101" target="origFile"><code class="comment">! the average pressure.</code></a>
<a name="inviscidcentralflux_spatial_di102"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi101" target="origFile">pad = porflux*(pd(i, j, k+<code class="constant">1</code>)+pd(i, j, k))</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi101" target="origFile">pa = porflux*(p(i, j, k+<code class="constant">1</code>)+p(i, j, k))</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi102" target="origFile"><code class="comment">! Compute the fluxes and scatter them to the cells</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi102" target="origFile"><code class="comment">! i,j,k and i,j,k+1. Store the density flux in the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi102" target="origFile"><code class="comment">! mass flow of the appropriate sliding mesh interface.</code></a>
<a name="inviscidcentralflux_spatial_di103"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi102" target="origFile">fsd = rqspd + rqsmd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi102" target="origFile">fs = rqsp + rqsm</a>
<a name="inviscidcentralflux_spatial_di104"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi103" target="origFile">dwd(i, j, k+<code class="constant">1</code>, irho) = dwd(i, j, k+<code class="constant">1</code>, irho) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi103" target="origFile">dw(i, j, k+<code class="constant">1</code>, irho) = dw(i, j, k+<code class="constant">1</code>, irho) - fs</a>
<a name="inviscidcentralflux_spatial_di105"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi104" target="origFile">dwd(i, j, k, irho) = dwd(i, j, k, irho) + fsd</a>
<a name="inviscidcentralflux_spatial_di106"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi104" target="origFile">dw(i, j, k, irho) = dw(i, j, k, irho) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi105" target="origFile">ind = indfamilyk(i, j, k)</a>
<a name="inviscidcentralflux_spatial_di107"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi106" target="origFile">massflowfamilyinv(ind, spectralsol) = massflowfamilyinv(ind, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi106" target="origFile"><code class="label">&          </code>spectralsol) + factfamilyk(i, j, k)*fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi107" target="origFile">fsd = rqspd*w(i, j, k+<code class="constant">1</code>, ivx) + rqsp*wd(i, j, k+<code class="constant">1</code>, ivx) + rqsmd*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi107" target="origFile"><code class="label">&          </code>w(i, j, k, ivx) + rqsm*wd(i, j, k, ivx) + pad*sk(i, j, k, <code class="constant">1</code>) +<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi107" target="origFile"><code class="label">&          </code>pa*skd(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidcentralflux_spatial_di108"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi107" target="origFile">fs = rqsp*w(i, j, k+<code class="constant">1</code>, ivx) + rqsm*w(i, j, k, ivx) + pa*sk(i, j<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi107" target="origFile"><code class="label">&          </code>, k, <code class="constant">1</code>)</a>
<a name="inviscidcentralflux_spatial_di109"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi108" target="origFile">dwd(i, j, k+<code class="constant">1</code>, imx) = dwd(i, j, k+<code class="constant">1</code>, imx) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi108" target="origFile">dw(i, j, k+<code class="constant">1</code>, imx) = dw(i, j, k+<code class="constant">1</code>, imx) - fs</a>
<a name="inviscidcentralflux_spatial_di110"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi109" target="origFile">dwd(i, j, k, imx) = dwd(i, j, k, imx) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi109" target="origFile">dw(i, j, k, imx) = dw(i, j, k, imx) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi110" target="origFile">fsd = rqspd*w(i, j, k+<code class="constant">1</code>, ivy) + rqsp*wd(i, j, k+<code class="constant">1</code>, ivy) + rqsmd*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi110" target="origFile"><code class="label">&          </code>w(i, j, k, ivy) + rqsm*wd(i, j, k, ivy) + pad*sk(i, j, k, <code class="constant">2</code>) +<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi110" target="origFile"><code class="label">&          </code>pa*skd(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidcentralflux_spatial_di111"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi110" target="origFile">fs = rqsp*w(i, j, k+<code class="constant">1</code>, ivy) + rqsm*w(i, j, k, ivy) + pa*sk(i, j<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi110" target="origFile"><code class="label">&          </code>, k, <code class="constant">2</code>)</a>
<a name="inviscidcentralflux_spatial_di112"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi111" target="origFile">dwd(i, j, k+<code class="constant">1</code>, imy) = dwd(i, j, k+<code class="constant">1</code>, imy) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi111" target="origFile">dw(i, j, k+<code class="constant">1</code>, imy) = dw(i, j, k+<code class="constant">1</code>, imy) - fs</a>
<a name="inviscidcentralflux_spatial_di113"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi112" target="origFile">dwd(i, j, k, imy) = dwd(i, j, k, imy) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi112" target="origFile">dw(i, j, k, imy) = dw(i, j, k, imy) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi113" target="origFile">fsd = rqspd*w(i, j, k+<code class="constant">1</code>, ivz) + rqsp*wd(i, j, k+<code class="constant">1</code>, ivz) + rqsmd*<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi113" target="origFile"><code class="label">&          </code>w(i, j, k, ivz) + rqsm*wd(i, j, k, ivz) + pad*sk(i, j, k, <code class="constant">3</code>) +<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi113" target="origFile"><code class="label">&          </code>pa*skd(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di114"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi113" target="origFile">fs = rqsp*w(i, j, k+<code class="constant">1</code>, ivz) + rqsm*w(i, j, k, ivz) + pa*sk(i, j<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi113" target="origFile"><code class="label">&          </code>, k, <code class="constant">3</code>)</a>
<a name="inviscidcentralflux_spatial_di115"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi114" target="origFile">dwd(i, j, k+<code class="constant">1</code>, imz) = dwd(i, j, k+<code class="constant">1</code>, imz) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi114" target="origFile">dw(i, j, k+<code class="constant">1</code>, imz) = dw(i, j, k+<code class="constant">1</code>, imz) - fs</a>
<a name="inviscidcentralflux_spatial_di116"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi115" target="origFile">dwd(i, j, k, imz) = dwd(i, j, k, imz) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi115" target="origFile">dw(i, j, k, imz) = dw(i, j, k, imz) + fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi116" target="origFile">fsd = qspd*w(i, j, k+<code class="constant">1</code>, irhoe) + qsp*wd(i, j, k+<code class="constant">1</code>, irhoe) + qsmd<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi116" target="origFile"><code class="label">&          </code>*w(i, j, k, irhoe) + qsm*wd(i, j, k, irhoe) + porflux*(vnpd*p(<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi116" target="origFile"><code class="label">&          </code>i, j, k+<code class="constant">1</code>)+vnp*pd(i, j, k+<code class="constant">1</code>)+vnmd*p(i, j, k)+vnm*pd(i, j, k))</a>
<a name="inviscidcentralflux_spatial_di117"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi116" target="origFile">fs = qsp*w(i, j, k+<code class="constant">1</code>, irhoe) + qsm*w(i, j, k, irhoe) + porflux*(<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi116" target="origFile"><code class="label">&          </code>vnp*p(i, j, k+<code class="constant">1</code>)+vnm*p(i, j, k))</a>
<a name="inviscidcentralflux_spatial_di118"></a>        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi117" target="origFile">dwd(i, j, k+<code class="constant">1</code>, irhoe) = dwd(i, j, k+<code class="constant">1</code>, irhoe) - fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi117" target="origFile">dw(i, j, k+<code class="constant">1</code>, irhoe) = dw(i, j, k+<code class="constant">1</code>, irhoe) - fs</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi118" target="origFile">dwd(i, j, k, irhoe) = dwd(i, j, k, irhoe) + fsd</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi118" target="origFile">dw(i, j, k, irhoe) = dw(i, j, k, irhoe) + fs</a>
      <a href="inviscidcentralflux_p.html#inviscidcentralfluxi83" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidcentralflux_spatial_di119"></a>    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi82" target="origFile"><code class="keyword">END DO</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi81" target="origFile"><code class="keyword">END DO</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi119" target="origFile"><code class="comment">!write(14,40),i,j,k,dw(i,j,k,irhoE)</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi119" target="origFile"><code class="comment">! Add the rotational source terms for a moving block in a</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi119" target="origFile"><code class="comment">! steady state computation. These source terms account for the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi119" target="origFile"><code class="comment">! centrifugal acceleration and the coriolis term. However, as</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi119" target="origFile"><code class="comment">! the the equations are solved in the inertial frame and not</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi119" target="origFile"><code class="comment">! in the moving frame, the form is different than what you</code></a>
<a name="inviscidcentralflux_spatial_di120"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi119" target="origFile"><code class="comment">! normally find in a text book.</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi119" target="origFile"><code class="keyword">IF</code> (blockismoving .AND. equationmode .EQ. steady) <code class="keyword">THEN</code></a>
<a name="inviscidcentralflux_spatial_di121"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi120" target="origFile"><code class="comment">! Compute the three nonDimensional angular velocities.</code></a>
<a name="inviscidcentralflux_spatial_di122"></a>    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi120" target="origFile">wx = timeref*cgnsdoms(nbkglobal)%rotrate(<code class="constant">1</code>)</a>
<a name="inviscidcentralflux_spatial_di123"></a>    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi121" target="origFile">wy = timeref*cgnsdoms(nbkglobal)%rotrate(<code class="constant">2</code>)</a>
    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi122" target="origFile">wz = timeref*cgnsdoms(nbkglobal)%rotrate(<code class="constant">3</code>)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi123" target="origFile"><code class="comment">! Loop over the internal cells of this block to compute the</code></a>
<a name="inviscidcentralflux_spatial_di124"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi123" target="origFile"><code class="comment">! rotational terms for the momentum equations.</code></a>
<a name="inviscidcentralflux_spatial_di125"></a>    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi123" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidcentralflux_spatial_di126"></a>      <a href="inviscidcentralflux_p.html#inviscidcentralfluxi124" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi125" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi126" target="origFile">rvold = wd(i, j, k, irho)*vol(i, j, k) + w(i, j, k, irho)*vold<code class="label">&</code></a>
<a name="inviscidcentralflux_spatial_di127"></a><a href="inviscidcentralflux_p.html#inviscidcentralfluxi126" target="origFile"><code class="label">&            </code>(i, j, k)</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi126" target="origFile">rvol = w(i, j, k, irho)*vol(i, j, k)</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi127" target="origFile">dwd(i, j, k, imx) = dwd(i, j, k, imx) + rvold*(wy*w(i, j, k, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi127" target="origFile"><code class="label">&            </code>ivz)-wz*w(i, j, k, ivy)) + rvol*(wy*wd(i, j, k, ivz)-wz*wd(i<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi127" target="origFile"><code class="label">&            </code>, j, k, ivy))</a>
<a name="inviscidcentralflux_spatial_di128"></a>          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi127" target="origFile">dw(i, j, k, imx) = dw(i, j, k, imx) + rvol*(wy*w(i, j, k, ivz)<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi127" target="origFile"><code class="label">&            </code>-wz*w(i, j, k, ivy))</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi128" target="origFile">dwd(i, j, k, imy) = dwd(i, j, k, imy) + rvold*(wz*w(i, j, k, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi128" target="origFile"><code class="label">&            </code>ivx)-wx*w(i, j, k, ivz)) + rvol*(wz*wd(i, j, k, ivx)-wx*wd(i<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi128" target="origFile"><code class="label">&            </code>, j, k, ivz))</a>
<a name="inviscidcentralflux_spatial_di129"></a>          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi128" target="origFile">dw(i, j, k, imy) = dw(i, j, k, imy) + rvol*(wz*w(i, j, k, ivx)<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi128" target="origFile"><code class="label">&            </code>-wx*w(i, j, k, ivz))</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi129" target="origFile">dwd(i, j, k, imz) = dwd(i, j, k, imz) + rvold*(wx*w(i, j, k, <code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi129" target="origFile"><code class="label">&            </code>ivy)-wy*w(i, j, k, ivx)) + rvol*(wx*wd(i, j, k, ivy)-wy*wd(i<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi129" target="origFile"><code class="label">&            </code>, j, k, ivx))</a>
          <a href="inviscidcentralflux_p.html#inviscidcentralfluxi129" target="origFile">dw(i, j, k, imz) = dw(i, j, k, imz) + rvol*(wx*w(i, j, k, ivy)<code class="label">&</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralfluxi129" target="origFile"><code class="label">&            </code>-wy*w(i, j, k, ivx))</a>
        <a href="inviscidcentralflux_p.html#inviscidcentralfluxi125" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidcentralflux_p.html#inviscidcentralfluxi124" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidcentralflux_p.html#inviscidcentralfluxi123" target="origFile"><code class="keyword">END DO</code></a>
  <a href="inviscidcentralflux_p.html#inviscidcentralfluxi119" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">! Initialize sFace to zero. This value will be used if the</code></a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="comment">! block is not moving.</code></a>
 <a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="label">40 </code><code class="keyword">FORMAT</code>(<code class="constant">1x,i4,i4,i4,e20.6</code>)</a>
<a href="inviscidcentralflux_p.html#inviscidcentralflux" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">INVISCIDCENTRALFLUX_SPATIAL_D</code></a>
</pre>
</body>
