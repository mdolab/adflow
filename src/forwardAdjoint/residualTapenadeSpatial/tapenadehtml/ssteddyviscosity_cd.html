<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="ssteddyviscosity_cd"></a><a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      ==================================================================</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SSTEDDYVISCOSITY_CD</code>()</a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">USE </code><code class="funcname">PARAMTURB_SPATIAL_D</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">USE </code><code class="funcname">TURBMOD_SPATIAL_D</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      * SSTEddyViscosity computes the eddy viscosity according to      *</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      * menter's SST variant of the k-omega turbulence model for the   *</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      * block given in blockPointers.                                  *</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      Local variables.</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">t1</code>, <code class="vardecl">t2</code>, <code class="vardecl">arg2</code>, <code class="vardecl">f2</code>, <code class="vardecl">vortmag</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">result1</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">TANH</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max1</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">!</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">! Compute the vorticity squared in the cell centers. The reason</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">! for computing the vorticity squared is that a routine exists</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">! for it; for the actual eddy viscosity computation the vorticity</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">! itself is needed.</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">prod => dw(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">1</code>:, iprod)</a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">vort => prod</a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">CALL </code><code class="funcname">PRODWMAG2_CD</code>()</a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">! Loop over the cells of this block and compute the eddy viscosity.</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">! Do not include halo's.</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
    <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
      <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">! Compute the value of the function f2, which occurs in the</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">! eddy-viscosity computation.</code></a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">result1 = <code class="funcname">SQRT</code>(w(i, j, k, itu1))</a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">t1 = two*result1/(<code class="constant">0.09_realType</code>*w(i, j, k, itu2)*d2wall(i, j, k)<code class="label">&</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="label">&          </code>)</a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">t2 = <code class="constant">500.0_realType</code>*rlv(i, j, k)/(w(i, j, k, irho)*w(i, j, k, <code class="label">&</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="label">&          </code>itu2)*d2wall(i, j, k)**<code class="constant">2</code>)</a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">IF</code> (t1 .LT. t2) <code class="keyword">THEN</code></a>
          <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">arg2 = t2</a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">arg2 = t1</a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">END IF</code></a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">arg1 = arg2**<code class="constant">2</code></a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">f2 = <code class="funcname">TANH</code>(arg1)</a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="comment">! And compute the eddy viscosity.</code></a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">vortmag = <code class="funcname">SQRT</code>(vort(i, j, k))</a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">IF</code> (rssta1*w(i, j, k, itu2) .LT. f2*vortmag) <code class="keyword">THEN</code></a>
          <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">max1 = f2*vortmag</a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">max1 = rssta1*w(i, j, k, itu2)</a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">END IF</code></a>
        <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile">rev(i, j, k) = w(i, j, k, irho)*rssta1*w(i, j, k, itu1)/max1</a>
      <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">END DO</code></a>
    <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">END DO</code></a>
  <a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">END DO</code></a>
<a href="ssteddyviscosity_p.html#ssteddyviscosity" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SSTEDDYVISCOSITY_CD</code></a>
</pre>
</body>
