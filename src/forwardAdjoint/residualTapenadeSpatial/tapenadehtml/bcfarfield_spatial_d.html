<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="bcfarfield_spatial_d"></a><a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!  Differentiation of bcfarfield in forward (tangent) mode:</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!   variations   of useful results: *p *gamma *w</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!   with respect to varying inputs: *w gammaconstant</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!      * File:          bcFarfield.f90                                  *</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!      * Starting date: 03-10-2003                                      *</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!      * Last modified: 06-12-2005                                      *</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">BCFARFIELD_SPATIAL_D</code>(<code class="vardecl">secondhalo</code>, <code class="vardecl">correctfork</code>)</a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">BCTYPES_SPATIAL_D</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
<a name="bcfarfield_spatial_di0"></a>  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="comment">!close (UNIT=unitx)</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!      * bcFarfield applies the farfield boundary condition to a block. *</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!      * It is assumed that the pointers in blockPointers are already   *</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!      * set to the correct block on the correct grid level.            *</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!</code></a>
<a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a name="bcfarfield_spatial_di1"></a><a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="comment">!</code></a>
  <a href="bcfarfield_p.html#bcfarfieldi0" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">secondhalo</code>, <code class="vardecl">correctfork</code></a>
<a href="bcfarfield_p.html#bcfarfieldi1" target="origFile"><code class="comment">!</code></a>
<a href="bcfarfield_p.html#bcfarfieldi1" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="bcfarfield_spatial_di2"></a><a href="bcfarfield_p.html#bcfarfieldi1" target="origFile"><code class="comment">!</code></a>
<a name="bcfarfield_spatial_di3"></a>  <a href="bcfarfield_p.html#bcfarfieldi1" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">l</code></a>
  <a href="bcfarfield_p.html#bcfarfieldi2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">nnx</code>, <code class="vardecl">nny</code>, <code class="vardecl">nnz</code></a>
<a name="bcfarfield_spatial_di4"></a>  <a href="bcfarfield_p.html#bcfarfieldi3" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">gm1</code>, <code class="vardecl">ovgm1</code>, <code class="vardecl">ac1</code>, <code class="vardecl">ac2</code></a>
<a name="bcfarfield_spatial_di5"></a>  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ac1d</code>, <code class="vardecl">ac2d</code></a>
  <a href="bcfarfield_p.html#bcfarfieldi4" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">r0</code>, <code class="vardecl">u0</code>, <code class="vardecl">v0</code>, <code class="vardecl">w0</code>, <code class="vardecl">qn0</code>, <code class="vardecl">vn0</code>, <code class="vardecl">c0</code>, <code class="vardecl">s0</code></a>
<a name="bcfarfield_spatial_di6"></a>  <a href="bcfarfield_p.html#bcfarfieldi5" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">re</code>, <code class="vardecl">ue</code>, <code class="vardecl">ve</code>, <code class="vardecl">we</code>, <code class="vardecl">qne</code>, <code class="vardecl">ce</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">red</code>, <code class="vardecl">ued</code>, <code class="vardecl">ved</code>, <code class="vardecl">wed</code>, <code class="vardecl">qned</code>, <code class="vardecl">ced</code></a>
<a name="bcfarfield_spatial_di7"></a>  <a href="bcfarfield_p.html#bcfarfieldi6" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">qnf</code>, <code class="vardecl">cf</code>, <code class="vardecl">uf</code>, <code class="vardecl">vf</code>, <code class="vardecl">wf</code>, <code class="vardecl">sf</code>, <code class="vardecl">cc</code>, <code class="vardecl">qq</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">qnfd</code>, <code class="vardecl">cfd</code>, <code class="vardecl">ufd</code>, <code class="vardecl">vfd</code>, <code class="vardecl">wfd</code>, <code class="vardecl">sfd</code>, <code class="vardecl">ccd</code></a>
<a href="bcfarfield_p.html#bcfarfieldi7" target="origFile"><code class="comment">! Variables Added for forward AD</code></a>
<a name="bcfarfield_spatial_di8"></a>  <a href="bcfarfield_p.html#bcfarfieldi7" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rho</code>, <code class="vardecl">sf2</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rhod</code></a>
<a name="bcfarfield_spatial_di9"></a>  <a href="bcfarfield_p.html#bcfarfieldi8" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">ww1d</code>, <code class="vardecl">ww2d</code></a>
<a name="bcfarfield_spatial_di10"></a>  <a href="bcfarfield_p.html#bcfarfieldi9" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">pp1d</code>, <code class="vardecl">pp2d</code></a>
<a name="bcfarfield_spatial_di11"></a>  <a href="bcfarfield_p.html#bcfarfieldi10" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">gamma2</code></a>
<a name="bcfarfield_spatial_di12"></a>  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">gamma2d</code></a>
<a name="bcfarfield_spatial_di13"></a>  <a href="bcfarfield_p.html#bcfarfieldi11" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
  <a href="bcfarfield_p.html#bcfarfieldi12" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
<a name="bcfarfield_spatial_di14"></a>  <a href="bcfarfield_p.html#bcfarfieldi13" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1d</code></a>
<a name="bcfarfield_spatial_di15"></a>  <a href="bcfarfield_p.html#bcfarfieldi14" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">pwr1</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">pwr1d</code></a>
  <a href="bcfarfield_p.html#bcfarfieldi15" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">pwx1</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">pwx1d</code></a>
<a name="setbcpointers_spatial_d"></a>  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">INTERFACE </code></a>
      <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code>(<code class="vardecl">nn</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww1d</code>, <code class="vardecl">ww2</code>, <code class="vardecl">ww2d</code>, <code class="vardecl">pp1</code>, <code class="label">&</code></a>
<a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="label">&        </code><code class="vardecl">pp1d</code>, <code class="vardecl">pp2</code>, <code class="vardecl">pp2d</code>, <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code>, <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code>, <code class="vardecl">offset</code>)</a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">offset</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">ww1d</code>, <code class="vardecl">ww2d</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">pp1d</code>, <code class="vardecl">pp2d</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
      <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">END INTERFACE</code></a>
<a name="setbcpointers_cd2"></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">INTERFACE </code></a>
      <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD2</code>(<code class="vardecl">nn</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code>, <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code>, <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code>, <code class="label">&</code></a>
<a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="label">&        </code><code class="vardecl">rev1</code>, <code class="vardecl">rev2</code>, <code class="vardecl">offset</code>)</a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">offset</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
        <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
      <a href="bcfarfield_p.html#setbcpointers" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD2</code></a>
<a name="setbcpointers_cd2i16"></a>  <a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">END INTERFACE</code></a>

<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$       !File Parameters remove for AD</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$       integer :: unitx = 12,ierror</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$      integer ::iii,iiii,jjj,jjjj,kkk,kkkk,nnnn,istart2,jstart2,kstart2,iend2,jend2,kend2,n,ii,jj</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$      character(len = 16)::outfile</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$      </code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$      outfile = "xoriginal.txt"</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$      </code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$      open (UNIT=unitx,File=outfile,status='old',position='append',action='write',iostat=ierror)</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$      if(ierror /= 0)                        &</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$           call terminate("verifyResiduals", &</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$           "Something wrong when &</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!!$           &calling open")</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">!</code></a>
<a name="setbcpointers_cd2i17"></a><a href="bcfarfield_p.html#i16" target="origFile"><code class="comment">! Some constants needed to compute the riemann inVariants.</code></a>
<a name="setbcpointers_cd2i18"></a>  <a href="bcfarfield_p.html#i16" target="origFile">gm1 = gammainf - one</a>
  <a href="bcfarfield_p.html#i17" target="origFile">ovgm1 = one/gm1</a>
<a href="bcfarfield_p.html#i18" target="origFile"><code class="comment">! Compute the three velocity components, the speed of sound and</code></a>
<a name="setbcpointers_cd2i19"></a><a href="bcfarfield_p.html#i18" target="origFile"><code class="comment">! the entropy of the free stream.</code></a>
<a name="setbcpointers_cd2i20"></a>  <a href="bcfarfield_p.html#i18" target="origFile">r0 = one/winf(irho)</a>
<a name="setbcpointers_cd2i21"></a>  <a href="bcfarfield_p.html#i19" target="origFile">u0 = winf(ivx)</a>
<a name="setbcpointers_cd2i22"></a>  <a href="bcfarfield_p.html#i20" target="origFile">v0 = winf(ivy)</a>
<a name="setbcpointers_cd2i23"></a>  <a href="bcfarfield_p.html#i21" target="origFile">w0 = winf(ivz)</a>
<a name="setbcpointers_cd2i24"></a>  <a href="bcfarfield_p.html#i22" target="origFile">arg1 = gammainf*pinfcorr*r0</a>
<a name="setbcpointers_cd2i25"></a>  <a href="bcfarfield_p.html#i23" target="origFile">c0 = <code class="funcname">SQRT</code>(arg1)</a>
  <a href="bcfarfield_p.html#i24" target="origFile">pwr1 = winf(irho)**gammainf</a>
  <a href="bcfarfield_p.html#i25" target="origFile">s0 = pwr1/pinfcorr</a>
<a name="setbcpointers_cd2i26"></a>  <a href="bcfarfield_p.html#bcfarfield" target="origFile">pd = <code class="constant">0.0</code></a>
  <a href="bcfarfield_p.html#bcfarfield" target="origFile">gammad = <code class="constant">0.0</code></a>
<a name="setbcpointers_cd2i27"></a><a href="bcfarfield_p.html#i26" target="origFile"><code class="comment">! Loop over the boundary condition subfaces of this block.</code></a>
<a href="bcfarfield_p.html#i26" target="origFile"><code class="label">bocos:</code><code class="keyword">DO </code>nn=<code class="constant">1</code>,nbocos</a>
<a name="setbcpointers_cd2i28"></a><a href="bcfarfield_p.html#i27" target="origFile"><code class="comment">! Check for farfield boundary conditions.</code></a>
    <a href="bcfarfield_p.html#i27" target="origFile"><code class="keyword">IF</code> (bctype(nn) .EQ. farfield) <code class="keyword">THEN</code></a>
<a href="bcfarfield_p.html#i28" target="origFile"><code class="comment">! Nullify the pointers and set them to the correct subface.</code></a>
<a href="bcfarfield_p.html#i28" target="origFile"><code class="comment">! They are nullified first, because some compilers require</code></a>
<a href="bcfarfield_p.html#i28" target="origFile"><code class="comment">! that.</code></a>
<a name="p21"></a><a href="bcfarfield_p.html#i28" target="origFile"><code class="comment">!nullify(ww1, ww2, pp1, pp2, rlv1, rlv2, rev1, rev2)</code></a>
      <a href="bcfarfield_p.html#i28" target="origFile"><code class="keyword">CALL </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code>(nn, ww1, ww1d, ww2, ww2d, pp1, pp1d, <code class="label">&</code></a>
<a name="setbcpointers_cd2i29"></a><a href="bcfarfield_p.html#i28" target="origFile"><code class="label">&                             </code>pp2, pp2d, rlv1, rlv2, rev1, rev2, </a><a href="msg.html#p21" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="bcfarfield_p.html#i28" target="origFile"><code class="label">&</code></a>
<a href="bcfarfield_p.html#i28" target="origFile"><code class="label">&                             </code><code class="constant">0_intType</code>)</a>
<a href="bcfarfield_p.html#i29" target="origFile"><code class="comment">! Set the additional pointer for gamma2.</code></a>
      <a href="bcfarfield_p.html#i29" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
      <a href="bcfarfield_p.html#i29" target="origFile"><code class="keyword">CASE </code>(imin) </a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2d => gammad(<code class="constant">2</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2 => gamma(<code class="constant">2</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
      <a href="bcfarfield_p.html#i29" target="origFile"><code class="keyword">CASE </code>(imax) </a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2d => gammad(il, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2 => gamma(il, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
      <a href="bcfarfield_p.html#i29" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2d => gammad(<code class="constant">1</code>:, <code class="constant">2</code>, <code class="constant">1</code>:)</a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2 => gamma(<code class="constant">1</code>:, <code class="constant">2</code>, <code class="constant">1</code>:)</a>
      <a href="bcfarfield_p.html#i29" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2d => gammad(<code class="constant">1</code>:, jl, <code class="constant">1</code>:)</a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2 => gamma(<code class="constant">1</code>:, jl, <code class="constant">1</code>:)</a>
      <a href="bcfarfield_p.html#i29" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2d => gammad(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">2</code>)</a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2 => gamma(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">2</code>)</a>
      <a href="bcfarfield_p.html#i29" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
        <a href="bcfarfield_p.html#i29" target="origFile">gamma2d => gammad(<code class="constant">1</code>:, <code class="constant">1</code>:, kl)</a>
<a name="setbcpointers_cd2i36"></a>        <a href="bcfarfield_p.html#i29" target="origFile">gamma2 => gamma(<code class="constant">1</code>:, <code class="constant">1</code>:, kl)</a>
      <a href="bcfarfield_p.html#i29" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="bcfarfield_p.html#i36" target="origFile"><code class="comment">! Loop over the generic subface to set the state in the</code></a>
<a name="setbcpointers_cd2i37"></a><a href="bcfarfield_p.html#i36" target="origFile"><code class="comment">! halo cells.</code></a>
<a name="setbcpointers_cd2i38"></a>      <a href="bcfarfield_p.html#i36" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
        <a href="bcfarfield_p.html#i37" target="origFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
<a href="bcfarfield_p.html#i38" target="origFile"><code class="comment">! Store the three components of the unit normal a</code></a>
<a name="setbcpointers_cd2i39"></a><a href="bcfarfield_p.html#i38" target="origFile"><code class="comment">! bit easier.</code></a>
<a name="setbcpointers_cd2i40"></a>          <a href="bcfarfield_p.html#i38" target="origFile">nnx = bcdata(nn)%norm(i, j, <code class="constant">1</code>)</a>
<a name="setbcpointers_cd2i41"></a>          <a href="bcfarfield_p.html#i39" target="origFile">nny = bcdata(nn)%norm(i, j, <code class="constant">2</code>)</a>
          <a href="bcfarfield_p.html#i40" target="origFile">nnz = bcdata(nn)%norm(i, j, <code class="constant">3</code>)</a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       !print out pAdj</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       istart2 = -1!2</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       jstart2 = -1!2</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       kstart2 = -1!2</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       iend2 = 1!2</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       jend2 = 1!2</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       kend2 = 1!2 </code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       if(i==BCData(nn)%icBeg) istart2=0</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       if(j==BCData(nn)%jcBeg) jstart2= 0</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       !if(i==BCData(nn)%icBeg+1) istart2=-1</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       !if(j==BCData(nn)%jcBeg+1) jstart2=-1</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$!       if(kcell==2) kstart2=-1</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       !if(i==BCData(nn)%icEnd-1) iend2=1</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       !if(j==BCData(nn)%jcEnd-1) jend2=1</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       if(i==BCData(nn)%icEnd) iend2=0</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       if(j==BCData(nn)%jcEnd) jend2=0</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$!       if(kcell==kl) kend2=1</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$       do jjjj = jstart2,jend2</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$          do iiii = istart2,iend2</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$             !do kkkk = kstart2,kend2</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$               ! do n = 1,3!nw</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$                   !do n = 1,1!nw</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$                   !do n = 1,nw </code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$                   !do sps2 = 1,nTimeIntervalsSpectral</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$                   ii = i+iiii</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$                   jj = j+jjjj</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$                   !k = kcell+kkkk</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$                   !print *,'indices',i,j,iiii,jjjj,ii,jj,BCData(nn)%jcEnd, BCData(nn)%icEnd</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$                   write(unitx,11)i,j,ii,jj,nn,BCData(nn)%norm(ii,jj,1), BCData(nn)%rface(ii,jj)</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$11               format(1x,'wadj',5I8,2f20.14) </code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$               ! end do</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$             end do</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">!!$          end do</code></a>
<a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">! Compute the normal velocity of the free stream and</code></a>
<a name="setbcpointers_cd2i42"></a><a href="bcfarfield_p.html#i41" target="origFile"><code class="comment">! substract the normal velocity of the mesh.</code></a>
<a name="setbcpointers_cd2i43"></a>          <a href="bcfarfield_p.html#i41" target="origFile">qn0 = u0*nnx + v0*nny + w0*nnz</a>
          <a href="bcfarfield_p.html#i42" target="origFile">vn0 = qn0 - bcdata(nn)%rface(i, j)</a>
<a href="bcfarfield_p.html#i43" target="origFile"><code class="comment">! Compute the three velocity components, the normal</code></a>
<a href="bcfarfield_p.html#i43" target="origFile"><code class="comment">! velocity and the speed of sound of the current state</code></a>
<a href="bcfarfield_p.html#i43" target="origFile"><code class="comment">! in the internal cell.</code></a>
<a name="setbcpointers_cd2i44"></a>          <a href="bcfarfield_p.html#i43" target="origFile">red = -(one*ww2d(i, j, irho)/ww2(i, j, irho)**<code class="constant">2</code>)</a>
          <a href="bcfarfield_p.html#i43" target="origFile">re = one/ww2(i, j, irho)</a>
<a name="setbcpointers_cd2i45"></a>          <a href="bcfarfield_p.html#i44" target="origFile">ued = ww2d(i, j, ivx)</a>
          <a href="bcfarfield_p.html#i44" target="origFile">ue = ww2(i, j, ivx)</a>
<a name="setbcpointers_cd2i46"></a>          <a href="bcfarfield_p.html#i45" target="origFile">ved = ww2d(i, j, ivy)</a>
          <a href="bcfarfield_p.html#i45" target="origFile">ve = ww2(i, j, ivy)</a>
<a name="setbcpointers_cd2i47"></a>          <a href="bcfarfield_p.html#i46" target="origFile">wed = ww2d(i, j, ivz)</a>
          <a href="bcfarfield_p.html#i46" target="origFile">we = ww2(i, j, ivz)</a>
<a name="setbcpointers_cd2i48"></a>          <a href="bcfarfield_p.html#i47" target="origFile">qned = nnx*ued + nny*ved + nnz*wed</a>
          <a href="bcfarfield_p.html#i47" target="origFile">qne = ue*nnx + ve*nny + we*nnz</a>
          <a href="bcfarfield_p.html#i48" target="origFile">arg1d = (gamma2d(i, j)*re+gamma2(i, j)*red)*pp2(i, j) + gamma2<code class="label">&</code></a>
<a name="setbcpointers_cd2i49"></a><a href="bcfarfield_p.html#i48" target="origFile"><code class="label">&            </code>(i, j)*re*pp2d(i, j)</a>
          <a href="bcfarfield_p.html#i48" target="origFile">arg1 = gamma2(i, j)*pp2(i, j)*re</a>
          <a href="bcfarfield_p.html#i49" target="origFile"><code class="keyword">IF</code> (arg1 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
            <a href="bcfarfield_p.html#i49" target="origFile">ced = <code class="constant">0.0</code></a>
          <a href="bcfarfield_p.html#i49" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="bcfarfield_p.html#i49" target="origFile">ced = arg1d/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg1))</a>
<a name="setbcpointers_cd2i50"></a>          <a href="bcfarfield_p.html#i49" target="origFile"><code class="keyword">END IF</code></a>
          <a href="bcfarfield_p.html#i49" target="origFile">ce = <code class="funcname">SQRT</code>(arg1)</a>
<a href="bcfarfield_p.html#i50" target="origFile"><code class="comment">! Compute the new values of the riemann inVariants in</code></a>
<a href="bcfarfield_p.html#i50" target="origFile"><code class="comment">! the halo cell. Either the value in the internal cell</code></a>
<a href="bcfarfield_p.html#i50" target="origFile"><code class="comment">! is taken (positive sign of the corresponding</code></a>
<a href="bcfarfield_p.html#i50" target="origFile"><code class="comment">! eigenvalue) or the free stream value is taken</code></a>
<a name="setbcpointers_cd2i51"></a><a href="bcfarfield_p.html#i50" target="origFile"><code class="comment">! (otherwise).</code></a>
          <a href="bcfarfield_p.html#i50" target="origFile"><code class="keyword">IF</code> (vn0 .GT. -c0) <code class="keyword">THEN</code></a>
<a href="bcfarfield_p.html#i51" target="origFile"><code class="comment">! Outflow or subsonic inflow.</code></a>
            <a href="bcfarfield_p.html#i51" target="origFile">ac1d = qned + two*ovgm1*ced</a>
<a name="setbcpointers_cd2i52"></a>            <a href="bcfarfield_p.html#i51" target="origFile">ac1 = qne + two*ovgm1*ce</a>
          <a href="bcfarfield_p.html#i50" target="origFile"><code class="keyword">ELSE</code></a>
<a href="bcfarfield_p.html#i52" target="origFile"><code class="comment">! Supersonic inflow.</code></a>
            <a href="bcfarfield_p.html#i52" target="origFile">ac1 = qn0 + two*ovgm1*c0</a>
<a name="setbcpointers_cd2i53"></a>            <a href="bcfarfield_p.html#i50" target="origFile">ac1d = <code class="constant">0.0</code></a>
<a name="setbcpointers_cd2i54"></a>          <a href="bcfarfield_p.html#i50" target="origFile"><code class="keyword">END IF</code></a>
          <a href="bcfarfield_p.html#i53" target="origFile"><code class="keyword">IF</code> (vn0 .GT. c0) <code class="keyword">THEN</code></a>
<a href="bcfarfield_p.html#i54" target="origFile"><code class="comment">! Supersonic outflow.</code></a>
            <a href="bcfarfield_p.html#i54" target="origFile">ac2d = qned - two*ovgm1*ced</a>
<a name="setbcpointers_cd2i55"></a>            <a href="bcfarfield_p.html#i54" target="origFile">ac2 = qne - two*ovgm1*ce</a>
          <a href="bcfarfield_p.html#i53" target="origFile"><code class="keyword">ELSE</code></a>
<a href="bcfarfield_p.html#i55" target="origFile"><code class="comment">! Inflow or subsonic outflow.</code></a>
            <a href="bcfarfield_p.html#i55" target="origFile">ac2 = qn0 - two*ovgm1*c0</a>
<a name="setbcpointers_cd2i56"></a>            <a href="bcfarfield_p.html#i53" target="origFile">ac2d = <code class="constant">0.0</code></a>
          <a href="bcfarfield_p.html#i53" target="origFile"><code class="keyword">END IF</code></a>
<a name="setbcpointers_cd2i57"></a>          <a href="bcfarfield_p.html#i56" target="origFile">qnfd = half*(ac1d+ac2d)</a>
          <a href="bcfarfield_p.html#i56" target="origFile">qnf = half*(ac1+ac2)</a>
<a name="setbcpointers_cd2i58"></a>          <a href="bcfarfield_p.html#i57" target="origFile">cfd = fourth*gm1*(ac1d-ac2d)</a>
<a name="setbcpointers_cd2i59"></a>          <a href="bcfarfield_p.html#i57" target="origFile">cf = fourth*(ac1-ac2)*gm1</a>
          <a href="bcfarfield_p.html#i58" target="origFile"><code class="keyword">IF</code> (vn0 .GT. zero) <code class="keyword">THEN</code></a>
<a href="bcfarfield_p.html#i59" target="origFile"><code class="comment">! Outflow.</code></a>
<a name="setbcpointers_cd2i60"></a>            <a href="bcfarfield_p.html#i59" target="origFile">ufd = ued + nnx*(qnfd-qned)</a>
            <a href="bcfarfield_p.html#i59" target="origFile">uf = ue + (qnf-qne)*nnx</a>
<a name="setbcpointers_cd2i61"></a>            <a href="bcfarfield_p.html#i60" target="origFile">vfd = ved + nny*(qnfd-qned)</a>
            <a href="bcfarfield_p.html#i60" target="origFile">vf = ve + (qnf-qne)*nny</a>
<a name="setbcpointers_cd2i62"></a>            <a href="bcfarfield_p.html#i61" target="origFile">wfd = wed + nnz*(qnfd-qned)</a>
            <a href="bcfarfield_p.html#i61" target="origFile">wf = we + (qnf-qne)*nnz</a>
<a href="bcfarfield_p.html#i62" target="origFile"><code class="comment">!Intermediate rho variable added to fix AD bug,ww2 </code></a>
<a href="bcfarfield_p.html#i62" target="origFile"><code class="comment">! was not getting picked up here.</code></a>
<a name="setbcpointers_cd2i63"></a>            <a href="bcfarfield_p.html#i62" target="origFile">rhod = ww2d(i, j, irho)</a>
            <a href="bcfarfield_p.html#i62" target="origFile">rho = ww2(i, j, irho)</a>
            <a href="bcfarfield_p.html#i63" target="origFile"><code class="keyword">IF</code> (rho .GT. <code class="constant">0.0 </code>.OR. (rho .LT. <code class="constant">0.0 </code>.AND. gamma2(i, j) .EQ. <code class="label">&</code></a>
<a href="bcfarfield_p.html#i63" target="origFile"><code class="label">&                </code><code class="funcname">INT</code>(gamma2(i, j)))) <code class="keyword">THEN</code></a>
              <a href="bcfarfield_p.html#i63" target="origFile">pwr1d = gamma2(i, j)*rho**(gamma2(i, j)-<code class="constant">1</code>)*rhod</a>
            <a href="bcfarfield_p.html#i63" target="origFile"><code class="keyword">ELSE IF</code> (rho .EQ. <code class="constant">0.0 </code>.AND. gamma2(i, j) .EQ. <code class="constant">1.0</code>) <code class="keyword">THEN</code></a>
              <a href="bcfarfield_p.html#i63" target="origFile">pwr1d = rhod</a>
            <a href="bcfarfield_p.html#i63" target="origFile"><code class="keyword">ELSE</code></a>
              <a href="bcfarfield_p.html#i63" target="origFile">pwr1d = <code class="constant">0.0</code></a>
<a name="setbcpointers_cd2i64"></a>            <a href="bcfarfield_p.html#i63" target="origFile"><code class="keyword">END IF</code></a>
            <a href="bcfarfield_p.html#i63" target="origFile">pwr1 = rho**gamma2(i, j)</a>
<a name="setbcpointers_cd2i65"></a>            <a href="bcfarfield_p.html#i64" target="origFile">sfd = (pwr1d*pp2(i, j)-pwr1*pp2d(i, j))/pp2(i, j)**<code class="constant">2</code></a>
            <a href="bcfarfield_p.html#i64" target="origFile">sf = pwr1/pp2(i, j)</a>
<a href="bcfarfield_p.html#i65" target="origFile"><code class="comment">!old version</code></a>
<a name="setbcpointers_cd2i66"></a><a href="bcfarfield_p.html#i65" target="origFile"><code class="comment">!sf2 = ww2(i,j,irho)**gamma2(i,j)/pp2(i,j)</code></a>
            <a href="bcfarfield_p.html#i65" target="origFile"><code class="keyword">DO </code>l=nt1mg,nt2mg</a>
              <a href="bcfarfield_p.html#i66" target="origFile">ww1d(i, j, l) = ww2d(i, j, l)</a>
              <a href="bcfarfield_p.html#i66" target="origFile">ww1(i, j, l) = ww2(i, j, l)</a>
<a name="setbcpointers_cd2i67"></a>            <a href="bcfarfield_p.html#i65" target="origFile"><code class="keyword">END DO</code></a>
          <a href="bcfarfield_p.html#i58" target="origFile"><code class="keyword">ELSE</code></a>
<a href="bcfarfield_p.html#i67" target="origFile"><code class="comment">! Inflow</code></a>
<a name="setbcpointers_cd2i68"></a>            <a href="bcfarfield_p.html#i67" target="origFile">ufd = nnx*qnfd</a>
            <a href="bcfarfield_p.html#i67" target="origFile">uf = u0 + (qnf-qn0)*nnx</a>
<a name="setbcpointers_cd2i69"></a>            <a href="bcfarfield_p.html#i68" target="origFile">vfd = nny*qnfd</a>
            <a href="bcfarfield_p.html#i68" target="origFile">vf = v0 + (qnf-qn0)*nny</a>
<a name="setbcpointers_cd2i70"></a>            <a href="bcfarfield_p.html#i69" target="origFile">wfd = nnz*qnfd</a>
<a name="setbcpointers_cd2i71"></a>            <a href="bcfarfield_p.html#i69" target="origFile">wf = w0 + (qnf-qn0)*nnz</a>
<a name="setbcpointers_cd2i72"></a>            <a href="bcfarfield_p.html#i70" target="origFile">sf = s0</a>
            <a href="bcfarfield_p.html#i71" target="origFile"><code class="keyword">DO </code>l=nt1mg,nt2mg</a>
              <a href="bcfarfield_p.html#i72" target="origFile">ww1d(i, j, l) = <code class="constant">0.0</code></a>
              <a href="bcfarfield_p.html#i72" target="origFile">ww1(i, j, l) = winf(l)</a>
            <a href="bcfarfield_p.html#i71" target="origFile"><code class="keyword">END DO</code></a>
<a name="setbcpointers_cd2i73"></a>            <a href="bcfarfield_p.html#i58" target="origFile">sfd = <code class="constant">0.0</code></a>
          <a href="bcfarfield_p.html#i58" target="origFile"><code class="keyword">END IF</code></a>
<a href="bcfarfield_p.html#i73" target="origFile"><code class="comment">! Compute the density, velocity and pressure in the</code></a>
<a href="bcfarfield_p.html#i73" target="origFile"><code class="comment">! halo cell.</code></a>
          <a href="bcfarfield_p.html#i73" target="origFile">ccd = ((cfd*cf+cf*cfd)*gamma2(i, j)-cf**<code class="constant">2</code>*gamma2d(i, j))/<code class="label">&</code></a>
<a name="setbcpointers_cd2i74"></a><a href="bcfarfield_p.html#i73" target="origFile"><code class="label">&            </code>gamma2(i, j)**<code class="constant">2</code></a>
<a name="setbcpointers_cd2i75"></a>          <a href="bcfarfield_p.html#i73" target="origFile">cc = cf*cf/gamma2(i, j)</a>
          <a href="bcfarfield_p.html#i74" target="origFile">qq = uf*uf + vf*vf + wf*wf</a>
<a name="setbcpointers_cd2i76"></a>          <a href="bcfarfield_p.html#i75" target="origFile">pwx1d = sfd*cc + sf*ccd</a>
          <a href="bcfarfield_p.html#i75" target="origFile">pwx1 = sf*cc</a>
          <a href="bcfarfield_p.html#i76" target="origFile"><code class="keyword">IF</code> (pwx1 .GT. <code class="constant">0.0 </code>.OR. (pwx1 .LT. <code class="constant">0.0 </code>.AND. ovgm1 .EQ. <code class="funcname">INT</code>(<code class="label">&</code></a>
<a href="bcfarfield_p.html#i76" target="origFile"><code class="label">&              </code>ovgm1))) <code class="keyword">THEN</code></a>
            <a href="bcfarfield_p.html#i76" target="origFile">ww1d(i, j, irho) = ovgm1*pwx1**(ovgm1-<code class="constant">1</code>)*pwx1d</a>
          <a href="bcfarfield_p.html#i76" target="origFile"><code class="keyword">ELSE IF</code> (pwx1 .EQ. <code class="constant">0.0 </code>.AND. ovgm1 .EQ. <code class="constant">1.0</code>) <code class="keyword">THEN</code></a>
            <a href="bcfarfield_p.html#i76" target="origFile">ww1d(i, j, irho) = pwx1d</a>
          <a href="bcfarfield_p.html#i76" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="bcfarfield_p.html#i76" target="origFile">ww1d(i, j, irho) = <code class="constant">0.0</code></a>
<a name="setbcpointers_cd2i77"></a>          <a href="bcfarfield_p.html#i76" target="origFile"><code class="keyword">END IF</code></a>
          <a href="bcfarfield_p.html#i76" target="origFile">ww1(i, j, irho) = pwx1**ovgm1</a>
<a name="setbcpointers_cd2i78"></a>          <a href="bcfarfield_p.html#i77" target="origFile">ww1d(i, j, ivx) = ufd</a>
          <a href="bcfarfield_p.html#i77" target="origFile">ww1(i, j, ivx) = uf</a>
<a name="setbcpointers_cd2i79"></a>          <a href="bcfarfield_p.html#i78" target="origFile">ww1d(i, j, ivy) = vfd</a>
          <a href="bcfarfield_p.html#i78" target="origFile">ww1(i, j, ivy) = vf</a>
<a name="setbcpointers_cd2i80"></a>          <a href="bcfarfield_p.html#i79" target="origFile">ww1d(i, j, ivz) = wfd</a>
          <a href="bcfarfield_p.html#i79" target="origFile">ww1(i, j, ivz) = wf</a>
<a name="setbcpointers_cd2i81"></a>          <a href="bcfarfield_p.html#i80" target="origFile">pp1d(i, j) = ww1d(i, j, irho)*cc + ww1(i, j, irho)*ccd</a>
          <a href="bcfarfield_p.html#i80" target="origFile">pp1(i, j) = ww1(i, j, irho)*cc</a>
<a href="bcfarfield_p.html#i81" target="origFile"><code class="comment">! Simply set the laminar and eddy viscosity to</code></a>
<a name="setbcpointers_cd2i82"></a><a href="bcfarfield_p.html#i81" target="origFile"><code class="comment">! the value in the donor cell. Their values do</code></a>
<a name="setbcpointers_cd2i84"></a><a name="setbcpointers_cd2i83"></a><a href="bcfarfield_p.html#i81" target="origFile"><code class="comment">! not matter too much in the far field.</code></a>
          <a href="bcfarfield_p.html#i81" target="origFile"><code class="keyword">IF</code> (viscous) </a><a href="bcfarfield_p.html#i82" target="origFile">rlv1(i, j) = rlv2(i, j)</a>
          <a href="bcfarfield_p.html#i83" target="origFile"><code class="keyword">IF</code> (eddymodel) </a><a href="bcfarfield_p.html#i84" target="origFile">rev1(i, j) = rev2(i, j)</a>
<a name="setbcpointers_cd2i85"></a>        <a href="bcfarfield_p.html#i37" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bcfarfield_p.html#i36" target="origFile"><code class="keyword">END DO</code></a>
<a href="bcfarfield_p.html#i85" target="origFile"><code class="comment">! Compute the energy for these halo's.</code></a>
<a name="setbcpointers_cd2i86"></a>      <a href="bcfarfield_p.html#i85" target="origFile"><code class="keyword">CALL </code><code class="funcname">COMPUTEETOT_SPATIAL_D</code>(icbeg(nn), icend(nn), jcbeg(nn), jcend(<code class="label">&</code></a>
<a href="bcfarfield_p.html#i85" target="origFile"><code class="label">&                           </code>nn), kcbeg(nn), kcend(nn), correctfork)</a>
<a name="setbcpointers_cd2i87"></a><a href="bcfarfield_p.html#i86" target="origFile"><code class="comment">! Extrapolate the state vectors in case a second halo</code></a>
<a href="bcfarfield_p.html#i86" target="origFile"><code class="comment">! is needed.</code></a>
      <a href="bcfarfield_p.html#i86" target="origFile"><code class="keyword">IF</code> (secondhalo) </a><a href="bcfarfield_p.html#i87" target="origFile"><code class="keyword">CALL </code><code class="funcname">EXTRAPOLATE2NDHALO_SPATIAL_D</code>(nn, correctfork)</a>
    <a href="bcfarfield_p.html#i27" target="origFile"><code class="keyword">END IF</code></a>
  <a href="bcfarfield_p.html#i26" target="origFile"><code class="keyword">END DO </code><code class="label">bocos</code></a>
<a href="bcfarfield_p.html#bcfarfield" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">BCFARFIELD_SPATIAL_D</code></a>
</pre>
</body>
