<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="inviscidupwindflux_cd"></a><a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * File:          inviscidUpwindFlux.f90                          *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * Starting date: 03-25-2003                                      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * Last modified: 10-29-2007                                      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">INVISCIDUPWINDFLUX_CD</code>(<code class="vardecl">finegrid</code>)</a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">CGNSGRID_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTDISCRETIZATION_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * inviscidUpwindFlux computes the artificial dissipation part of *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * the Euler fluxes by means of an approximate solution of the 1D *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * Riemann problem on the face. For first order schemes,          *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * fineGrid == .false., the states in the cells are assumed to    *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * be constant; for the second order schemes on the fine grid a   *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * nonlinear reconstruction of the left and right state is done   *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * for which several options exist.                               *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * It is assumed that the pointers in blockPointers already       *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * point to the correct block.                                    *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">finegrid</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      Local variables.</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">portype</code><code class="typename">) </code>:: <code class="vardecl">por</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">nwint</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">ind</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">limused</code>, <code class="vardecl">riemannused</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sx</code>, <code class="vardecl">sy</code>, <code class="vardecl">sz</code>, <code class="vardecl">omk</code>, <code class="vardecl">opk</code>, <code class="vardecl">sfil</code>, <code class="vardecl">gammaface</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">factminmod</code>, <code class="vardecl">sface</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>nw<code class="typename">) </code>:: <code class="vardecl">left</code>, <code class="vardecl">right</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>nw<code class="typename">) </code>:: <code class="vardecl">du1</code>, <code class="vardecl">du2</code>, <code class="vardecl">du3</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>nwf<code class="typename">) </code>:: <code class="vardecl">flux</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">firstorderk</code>, <code class="vardecl">correctfork</code>, <code class="vardecl">rotationalperiodic</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ASSOCIATED</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max1</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a name="p14"></a><a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Check if rFil == 0. If so, the dissipative flux needs not to</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! be computed.</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p14" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">rfil .EQ. zero) <code class="keyword">THEN</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">RETURN</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">ELSE</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Check if the formulation for rotational periodic problems</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! must be used.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (<code class="funcname">ASSOCIATED</code>(rotmatrixi)) <code class="keyword">THEN</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">rotationalperiodic = <code class="constant">.true.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">rotationalperiodic = <code class="constant">.false.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Initialize the dissipative residual to a certain times,</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! possibly zero, the previously stored value. Owned cells</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! only, because the halo values do not matter.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sfil = one - rfil</a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irho) = sfil*fw(i, j, k, irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imx) = sfil*fw(i, j, k, imx)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imy) = sfil*fw(i, j, k, imy)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imz) = sfil*fw(i, j, k, imz)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irhoe) = sfil*fw(i, j, k, irhoe)</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Determine whether or not the total energy must be corrected</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! for the presence of the turbulent kinetic energy.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (kpresent) <code class="keyword">THEN</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (currentlevel .EQ. groundlevel .OR. turbcoupled) <code class="keyword">THEN</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">correctfork = <code class="constant">.true.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">correctfork = <code class="constant">.false.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">correctfork = <code class="constant">.false.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-10_realType </code>.LT. one - kappacoef) <code class="keyword">THEN</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">max1 = one - kappacoef</a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">max1 = <code class="constant">1.e-10_realType</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the factor used in the minmod limiter.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">factminmod = (three-kappacoef)/max1</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Determine the limiter scheme to be used. On the fine grid the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! user specified scheme is used; on the coarse grid a first order</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! scheme is computed.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">limused = firstorder</a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (finegrid) limused = limiter</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Lumped diss is true for doing approx PC</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (lumpeddiss) limused = firstorder</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Determine the riemann solver which must be used.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">riemannused = riemanncoarse</a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (finegrid) riemannused = riemann</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store 1-kappa and 1+kappa a bit easier and multiply it by 0.25.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">omk = fourth*(one-kappacoef)</a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">opk = fourth*(one+kappacoef)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Initialize sFace to zero. This value will be used if the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! block is not moving.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sface = zero</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Set the number of variables to be interpolated depending</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! whether or not a k-equation is present. If a k-equation is</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! present also set the logical firstOrderK. This indicates</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! whether or not only a first order approximation is to be used</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! for the turbulent kinetic energy.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (orderturb .EQ. firstorder) <code class="keyword">THEN</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">nwint = nwf</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">firstorderk = <code class="constant">.true.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">nwint = itu1</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">firstorderk = <code class="constant">.false.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">nwint = nwf</a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">firstorderk = <code class="constant">.false.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * Flux computation. A distinction is made between first and      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * second order schemes to avoid the overhead for the first order *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * scheme.                                                        *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (limused .EQ. firstorder) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        * First order reconstruction. The states in the cells are      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        * constant. The left and right states are constructed easily.  *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Fluxes in the i-direction.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sx = si(i, j, k, <code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sy = si(i, j, k, <code class="constant">2</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sz = si(i, j, k, <code class="constant">3</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">por = pori(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (addgridvelocities) sface = sfacei(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Determine the left and right state.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irho) = w(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivx) = w(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivy) = w(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivz) = w(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irhoe) = p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) left(itu1) = w(i, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irho) = w(i+<code class="constant">1</code>, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivx) = w(i+<code class="constant">1</code>, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivy) = w(i+<code class="constant">1</code>, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivz) = w(i+<code class="constant">1</code>, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irhoe) = p(i+<code class="constant">1</code>, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) right(itu1) = w(i+<code class="constant">1</code>, j, k, itu1)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i+<code class="constant">1</code>, j, k))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) - flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) - flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) - flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) - flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">ind = indfamilyi(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyi(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Fluxes in j-direction.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sx = sj(i, j, k, <code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sy = sj(i, j, k, <code class="constant">2</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sz = sj(i, j, k, <code class="constant">3</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">por = porj(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (addgridvelocities) sface = sfacej(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Determine the left and right state.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irho) = w(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivx) = w(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivy) = w(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivz) = w(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irhoe) = p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) left(itu1) = w(i, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irho) = w(i, j+<code class="constant">1</code>, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivx) = w(i, j+<code class="constant">1</code>, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivy) = w(i, j+<code class="constant">1</code>, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivz) = w(i, j+<code class="constant">1</code>, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irhoe) = p(i, j+<code class="constant">1</code>, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) right(itu1) = w(i, j+<code class="constant">1</code>, k, itu1)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i, j+<code class="constant">1</code>, k))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) - flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) - flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) - flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) - flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">ind = indfamilyj(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyj(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Fluxes in k-direction.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sx = sk(i, j, k, <code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sy = sk(i, j, k, <code class="constant">2</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sz = sk(i, j, k, <code class="constant">3</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">por = pork(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (addgridvelocities) sface = sfacek(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Determine the left and right state.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irho) = w(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivx) = w(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivy) = w(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivz) = w(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irhoe) = p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) left(itu1) = w(i, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irho) = w(i, j, k+<code class="constant">1</code>, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivx) = w(i, j, k+<code class="constant">1</code>, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivy) = w(i, j, k+<code class="constant">1</code>, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivz) = w(i, j, k+<code class="constant">1</code>, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irhoe) = p(i, j, k+<code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) right(itu1) = w(i, j, k+<code class="constant">1</code>, itu1)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i, j, k+<code class="constant">1</code>))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! And scatter it the left and right.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) - flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) - flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) - flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) - flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">ind = indfamilyk(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyk(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">ELSE</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ==================================================================</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ==================================================================</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        * Second order reconstruction of the left and right state.     *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        * The three differences used in the, possibly nonlinear,       *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        * interpolation are constructed here; the actual left and      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        * right states, or at least the differences from the first     *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        * order interpolation, are computed in the subroutine          *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        * leftRightState.                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Fluxes in the i-direction.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the three differences used in the interpolation</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! in du1, du2, du3.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(irho) = w(i, j, k, irho) - w(i-<code class="constant">1</code>, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(irho) = w(i+<code class="constant">1</code>, j, k, irho) - w(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(irho) = w(i+<code class="constant">2</code>, j, k, irho) - w(i+<code class="constant">1</code>, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(ivx) = w(i, j, k, ivx) - w(i-<code class="constant">1</code>, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(ivx) = w(i+<code class="constant">1</code>, j, k, ivx) - w(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(ivx) = w(i+<code class="constant">2</code>, j, k, ivx) - w(i+<code class="constant">1</code>, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(ivy) = w(i, j, k, ivy) - w(i-<code class="constant">1</code>, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(ivy) = w(i+<code class="constant">1</code>, j, k, ivy) - w(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(ivy) = w(i+<code class="constant">2</code>, j, k, ivy) - w(i+<code class="constant">1</code>, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(ivz) = w(i, j, k, ivz) - w(i-<code class="constant">1</code>, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(ivz) = w(i+<code class="constant">1</code>, j, k, ivz) - w(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(ivz) = w(i+<code class="constant">2</code>, j, k, ivz) - w(i+<code class="constant">1</code>, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(irhoe) = p(i, j, k) - p(i-<code class="constant">1</code>, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(irhoe) = p(i+<code class="constant">1</code>, j, k) - p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(irhoe) = p(i+<code class="constant">2</code>, j, k) - p(i+<code class="constant">1</code>, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(itu1) = w(i, j, k, itu1) - w(i-<code class="constant">1</code>, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(itu1) = w(i+<code class="constant">1</code>, j, k, itu1) - w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(itu1) = w(i+<code class="constant">2</code>, j, k, itu1) - w(i+<code class="constant">1</code>, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the differences from the first order scheme.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">LEFTRIGHTSTATE</code>(du1, du2, du3, rotmatrixi, left, right)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Add the first order part to the currently stored</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! differences, such that the correct state vector</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! is stored.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irho) = left(irho) + w(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivx) = left(ivx) + w(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivy) = left(ivy) + w(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivz) = left(ivz) + w(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irhoe) = left(irhoe) + p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irho) = right(irho) + w(i+<code class="constant">1</code>, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivx) = right(ivx) + w(i+<code class="constant">1</code>, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivy) = right(ivy) + w(i+<code class="constant">1</code>, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivz) = right(ivz) + w(i+<code class="constant">1</code>, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irhoe) = right(irhoe) + p(i+<code class="constant">1</code>, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(itu1) = left(itu1) + w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(itu1) = right(itu1) + w(i+<code class="constant">1</code>, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sx = si(i, j, k, <code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sy = si(i, j, k, <code class="constant">2</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sz = si(i, j, k, <code class="constant">3</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">por = pori(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (addgridvelocities) sface = sfacei(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i+<code class="constant">1</code>, j, k))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) - flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) - flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) - flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) - flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">ind = indfamilyi(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyi(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Fluxes in the j-direction.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the three differences used in the interpolation</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! in du1, du2, du3.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(irho) = w(i, j, k, irho) - w(i, j-<code class="constant">1</code>, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(irho) = w(i, j+<code class="constant">1</code>, k, irho) - w(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(irho) = w(i, j+<code class="constant">2</code>, k, irho) - w(i, j+<code class="constant">1</code>, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(ivx) = w(i, j, k, ivx) - w(i, j-<code class="constant">1</code>, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(ivx) = w(i, j+<code class="constant">1</code>, k, ivx) - w(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(ivx) = w(i, j+<code class="constant">2</code>, k, ivx) - w(i, j+<code class="constant">1</code>, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(ivy) = w(i, j, k, ivy) - w(i, j-<code class="constant">1</code>, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(ivy) = w(i, j+<code class="constant">1</code>, k, ivy) - w(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(ivy) = w(i, j+<code class="constant">2</code>, k, ivy) - w(i, j+<code class="constant">1</code>, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(ivz) = w(i, j, k, ivz) - w(i, j-<code class="constant">1</code>, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(ivz) = w(i, j+<code class="constant">1</code>, k, ivz) - w(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(ivz) = w(i, j+<code class="constant">2</code>, k, ivz) - w(i, j+<code class="constant">1</code>, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(irhoe) = p(i, j, k) - p(i, j-<code class="constant">1</code>, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(irhoe) = p(i, j+<code class="constant">1</code>, k) - p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(irhoe) = p(i, j+<code class="constant">2</code>, k) - p(i, j+<code class="constant">1</code>, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(itu1) = w(i, j, k, itu1) - w(i, j-<code class="constant">1</code>, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(itu1) = w(i, j+<code class="constant">1</code>, k, itu1) - w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(itu1) = w(i, j+<code class="constant">2</code>, k, itu1) - w(i, j+<code class="constant">1</code>, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the differences from the first order scheme.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">LEFTRIGHTSTATE</code>(du1, du2, du3, rotmatrixj, left, right)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Add the first order part to the currently stored</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! differences, such that the correct state vector</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! is stored.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irho) = left(irho) + w(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivx) = left(ivx) + w(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivy) = left(ivy) + w(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivz) = left(ivz) + w(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irhoe) = left(irhoe) + p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irho) = right(irho) + w(i, j+<code class="constant">1</code>, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivx) = right(ivx) + w(i, j+<code class="constant">1</code>, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivy) = right(ivy) + w(i, j+<code class="constant">1</code>, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivz) = right(ivz) + w(i, j+<code class="constant">1</code>, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irhoe) = right(irhoe) + p(i, j+<code class="constant">1</code>, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(itu1) = left(itu1) + w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(itu1) = right(itu1) + w(i, j+<code class="constant">1</code>, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sx = sj(i, j, k, <code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sy = sj(i, j, k, <code class="constant">2</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sz = sj(i, j, k, <code class="constant">3</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">por = porj(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (addgridvelocities) sface = sfacej(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i, j+<code class="constant">1</code>, k))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) - flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) - flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) - flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) - flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">ind = indfamilyj(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyj(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Fluxes in the k-direction.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the three differences used in the interpolation</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! in du1, du2, du3.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(irho) = w(i, j, k, irho) - w(i, j, k-<code class="constant">1</code>, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(irho) = w(i, j, k+<code class="constant">1</code>, irho) - w(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(irho) = w(i, j, k+<code class="constant">2</code>, irho) - w(i, j, k+<code class="constant">1</code>, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(ivx) = w(i, j, k, ivx) - w(i, j, k-<code class="constant">1</code>, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(ivx) = w(i, j, k+<code class="constant">1</code>, ivx) - w(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(ivx) = w(i, j, k+<code class="constant">2</code>, ivx) - w(i, j, k+<code class="constant">1</code>, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(ivy) = w(i, j, k, ivy) - w(i, j, k-<code class="constant">1</code>, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(ivy) = w(i, j, k+<code class="constant">1</code>, ivy) - w(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(ivy) = w(i, j, k+<code class="constant">2</code>, ivy) - w(i, j, k+<code class="constant">1</code>, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(ivz) = w(i, j, k, ivz) - w(i, j, k-<code class="constant">1</code>, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(ivz) = w(i, j, k+<code class="constant">1</code>, ivz) - w(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(ivz) = w(i, j, k+<code class="constant">2</code>, ivz) - w(i, j, k+<code class="constant">1</code>, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(irhoe) = p(i, j, k) - p(i, j, k-<code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(irhoe) = p(i, j, k+<code class="constant">1</code>) - p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(irhoe) = p(i, j, k+<code class="constant">2</code>) - p(i, j, k+<code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du1(itu1) = w(i, j, k, itu1) - w(i, j, k-<code class="constant">1</code>, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du2(itu1) = w(i, j, k+<code class="constant">1</code>, itu1) - w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">du3(itu1) = w(i, j, k+<code class="constant">2</code>, itu1) - w(i, j, k+<code class="constant">1</code>, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the differences from the first order scheme.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">LEFTRIGHTSTATE</code>(du1, du2, du3, rotmatrixk, left, right)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Add the first order part to the currently stored</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! differences, such that the correct state vector</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! is stored.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irho) = left(irho) + w(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivx) = left(ivx) + w(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivy) = left(ivy) + w(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(ivz) = left(ivz) + w(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(irhoe) = left(irhoe) + p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irho) = right(irho) + w(i, j, k+<code class="constant">1</code>, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivx) = right(ivx) + w(i, j, k+<code class="constant">1</code>, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivy) = right(ivy) + w(i, j, k+<code class="constant">1</code>, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(ivz) = right(ivz) + w(i, j, k+<code class="constant">1</code>, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(irhoe) = right(irhoe) + p(i, j, k+<code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">left(itu1) = left(itu1) + w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">right(itu1) = right(itu1) + w(i, j, k+<code class="constant">1</code>, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sx = sk(i, j, k, <code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sy = sk(i, j, k, <code class="constant">2</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">sz = sk(i, j, k, <code class="constant">3</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">por = pork(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IF</code> (addgridvelocities) sface = sfacek(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i, j, k+<code class="constant">1</code>))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) - flux(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) - flux(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) - flux(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) - flux(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">ind = indfamilyk(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyk(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">INVISCIDUPWINDFLUX_CD</code></a>
</pre>
</body>
