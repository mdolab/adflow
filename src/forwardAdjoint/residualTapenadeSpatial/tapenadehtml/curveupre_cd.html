<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="curveupre_cd"></a><a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      * File:          curveFit.f90                                    *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      * Author:        Georgi Kalitzin, Edwin van der Weide            *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      * Starting date: 03-02-2004                                      *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      * Last modified: 04-12-2005                                      *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">FUNCTION </code><code class="funcname">CURVEUPRE_CD</code>(<code class="vardecl">re</code>) RESULT (CURVEUPRE)</a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">USE </code><code class="funcname">PARAMTURB_SPATIAL_D</code></a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      * curveUpRe determines the value of the nonDimensional           *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      * tangential velocity (made nonDimensional with the skin         *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      * friction velocity) for the given Reynolds number.              *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      * This data has been curve fitted with cubic splines.            *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      Function type.</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">curveupre</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      Function arguments.</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">re</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      Local variables.</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">ii</code>, <code class="vardecl">nn</code>, <code class="vardecl">start</code></a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x</code>, <code class="vardecl">x2</code>, <code class="vardecl">x3</code>, <code class="vardecl">upre</code></a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">!</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! Determine the situation we are dealing with.</code></a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">IF</code> (re .LE. ret(<code class="constant">0</code>)) <code class="keyword">THEN</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! Reynolds number is less than the smallest number in the curve</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! fit. Use extrapolation.</code></a>
    <a href="curveupre_p.html#curveupre" target="origFile">arg1 = re/ret(<code class="constant">0</code>)</a>
    <a href="curveupre_p.html#curveupre" target="origFile">x = <code class="funcname">SQRT</code>(arg1)</a>
    <a href="curveupre_p.html#curveupre" target="origFile">upre = x*up0(<code class="constant">1</code>)</a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">ELSE IF</code> (re .GE. ret(nfit)) <code class="keyword">THEN</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! Reynolds number is larger than the largest number in the curve</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! fit. Set upRe to the largest value available.</code></a>
    <a href="curveupre_p.html#curveupre" target="origFile">nn = nfit</a>
    <a href="curveupre_p.html#curveupre" target="origFile">x = ret(nn) - ret(nn-<code class="constant">1</code>)</a>
    <a href="curveupre_p.html#curveupre" target="origFile">x2 = x*x</a>
    <a href="curveupre_p.html#curveupre" target="origFile">x3 = x*x2</a>
    <a href="curveupre_p.html#curveupre" target="origFile">upre = up0(nn) + up1(nn)*x + up2(nn)*x2 + up3(nn)*x3</a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">ELSE</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! Reynolds number is in the range of the curve fits.</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! First find the correct interval.</code></a>
    <a href="curveupre_p.html#curveupre" target="origFile">ii = nfit</a>
    <a href="curveupre_p.html#curveupre" target="origFile">start = <code class="constant">1</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="label">interval:</code><code class="keyword">DO </code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! Next guess for the interval.</code></a>
      <a href="curveupre_p.html#curveupre" target="origFile">nn = start + ii/<code class="constant">2</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! Determine the situation we are having here.</code></a>
      <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">IF</code> (re .GT. ret(nn)) <code class="keyword">THEN</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! Reynoldls number is larger than the upper boundary of</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! the current interval. Update the lower boundary.</code></a>
        <a href="curveupre_p.html#curveupre" target="origFile">start = nn + <code class="constant">1</code></a>
        <a href="curveupre_p.html#curveupre" target="origFile">ii = ii - <code class="constant">1</code></a>
      <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">ELSE IF</code> (re .GE. ret(nn-<code class="constant">1</code>)) <code class="keyword">THEN</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! Compute upRe using the cubic polynomial for this interval.</code></a>
        <a href="curveupre_p.html#curveupre" target="origFile">x = re - ret(nn-<code class="constant">1</code>)</a>
        <a href="curveupre_p.html#curveupre" target="origFile">x2 = x*x</a>
        <a href="curveupre_p.html#curveupre" target="origFile">x3 = x*x2</a>
        <a href="curveupre_p.html#curveupre" target="origFile">upre = up0(nn) + up1(nn)*x + up2(nn)*x2 + up3(nn)*x3</a>
        <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
      <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">END IF</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! This is the correct range. Exit the do-loop.</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! Modify ii for the next branch to search.</code></a>
      <a href="curveupre_p.html#curveupre" target="origFile">ii = ii/<code class="constant">2</code></a>
    <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">END DO </code><code class="label">interval</code></a>
  <a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">END IF</code></a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="comment">! And set the function value.</code></a>
 <a href="curveupre_p.html#curveupre" target="origFile"><code class="label">100 </code>curveupre = upre</a>
<a href="curveupre_p.html#curveupre" target="origFile"><code class="keyword">END FUNCTION </code><code class="funcname">CURVEUPRE_CD</code></a>
</pre>
</body>
