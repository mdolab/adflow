<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="inviscidupwindflux_spatial_d"></a><a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!  Differentiation of inviscidupwindflux in forward (tangent) mode:</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!   variations   of useful results: *fw</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!   with respect to varying inputs: *p *w gammaconstant</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * File:          inviscidUpwindFlux.f90                          *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * Starting date: 03-25-2003                                      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      * Last modified: 10-29-2007                                      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">INVISCIDUPWINDFLUX_SPATIAL_D</code>(<code class="vardecl">finegrid</code>)</a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">CGNSGRID_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTDISCRETIZATION_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
<a name="inviscidupwindflux_spatial_di0"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      * inviscidUpwindFlux computes the artificial dissipation part of *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      * the Euler fluxes by means of an approximate solution of the 1D *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      * Riemann problem on the face. For first order schemes,          *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      * fineGrid == .false., the states in the cells are assumed to    *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      * be constant; for the second order schemes on the fine grid a   *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      * nonlinear reconstruction of the left and right state is done   *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      * for which several options exist.                               *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      * It is assumed that the pointers in blockPointers already       *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      * point to the correct block.                                    *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a name="inviscidupwindflux_spatial_di1"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="comment">!</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi0" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">finegrid</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi1" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi1" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="inviscidupwindflux_spatial_di2"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi1" target="origFile"><code class="comment">!</code></a>
<a name="inviscidupwindflux_spatial_di3"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi1" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">portype</code><code class="typename">) </code>:: <code class="vardecl">por</code></a>
<a name="inviscidupwindflux_spatial_di4"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi2" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">nwint</code></a>
<a name="inviscidupwindflux_spatial_di5"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi3" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">ind</code></a>
<a name="inviscidupwindflux_spatial_di6"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi4" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">limused</code>, <code class="vardecl">riemannused</code></a>
<a name="inviscidupwindflux_spatial_di7"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi5" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sx</code>, <code class="vardecl">sy</code>, <code class="vardecl">sz</code>, <code class="vardecl">omk</code>, <code class="vardecl">opk</code>, <code class="vardecl">sfil</code>, <code class="vardecl">gammaface</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi6" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">factminmod</code>, <code class="vardecl">sface</code></a>
<a name="inviscidupwindflux_spatial_di8"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi7" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>nw<code class="typename">) </code>:: <code class="vardecl">left</code>, <code class="vardecl">right</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(nw) :: <code class="vardecl">leftd</code>, <code class="vardecl">rightd</code></a>
<a name="inviscidupwindflux_spatial_di9"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi8" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>nw<code class="typename">) </code>:: <code class="vardecl">du1</code>, <code class="vardecl">du2</code>, <code class="vardecl">du3</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(nw) :: <code class="vardecl">du1d</code>, <code class="vardecl">du2d</code>, <code class="vardecl">du3d</code></a>
<a name="inviscidupwindflux_spatial_di10"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi9" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>nwf<code class="typename">) </code>:: <code class="vardecl">flux</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(nwf) :: <code class="vardecl">fluxd</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi10" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">firstorderk</code>, <code class="vardecl">correctfork</code>, <code class="vardecl">rotationalperiodic</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
<a name="inviscidupwindflux_spatial_di11"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ASSOCIATED</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max1</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="comment">!</code></a>
<a name="p14"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="comment">! Check if rFil == 0. If so, the dissipative flux needs not to</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="comment">! be computed.</code></a>
<a name="inviscidupwindflux_spatial_di12"></a>  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p14" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile">rfil .EQ. zero) <code class="keyword">THEN</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile">fwd = <code class="constant">0.0</code></a>
<a name="inviscidupwindflux_spatial_di13"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi12" target="origFile"><code class="keyword">RETURN</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="keyword">ELSE</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi13" target="origFile"><code class="comment">! Check if the formulation for rotational periodic problems</code></a>
<a name="inviscidupwindflux_spatial_di14"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi13" target="origFile"><code class="comment">! must be used.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi13" target="origFile"><code class="keyword">IF</code> (<code class="funcname">ASSOCIATED</code>(rotmatrixi)) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di15"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi14" target="origFile">rotationalperiodic = <code class="constant">.true.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi13" target="origFile"><code class="keyword">ELSE</code></a>
<a name="inviscidupwindflux_spatial_di16"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi15" target="origFile">rotationalperiodic = <code class="constant">.false.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi13" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi16" target="origFile"><code class="comment">! Initialize the dissipative residual to a certain times,</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi16" target="origFile"><code class="comment">! possibly zero, the previously stored value. Owned cells</code></a>
<a name="inviscidupwindflux_spatial_di17"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi16" target="origFile"><code class="comment">! only, because the halo values do not matter.</code></a>
<a name="inviscidupwindflux_spatial_di18"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi16" target="origFile">sfil = one - rfil</a>
<a name="inviscidupwindflux_spatial_di19"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi17" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindflux_spatial_di20"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi18" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi19" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="inviscidupwindflux_spatial_di21"></a>          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi20" target="origFile">fwd(i, j, k, irho) = <code class="constant">0.0</code></a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi20" target="origFile">fw(i, j, k, irho) = sfil*fw(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di22"></a>          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi21" target="origFile">fwd(i, j, k, imx) = <code class="constant">0.0</code></a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi21" target="origFile">fw(i, j, k, imx) = sfil*fw(i, j, k, imx)</a>
<a name="inviscidupwindflux_spatial_di23"></a>          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi22" target="origFile">fwd(i, j, k, imy) = <code class="constant">0.0</code></a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi22" target="origFile">fw(i, j, k, imy) = sfil*fw(i, j, k, imy)</a>
<a name="inviscidupwindflux_spatial_di24"></a>          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi23" target="origFile">fwd(i, j, k, imz) = <code class="constant">0.0</code></a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi23" target="origFile">fw(i, j, k, imz) = sfil*fw(i, j, k, imz)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi24" target="origFile">fwd(i, j, k, irhoe) = <code class="constant">0.0</code></a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi24" target="origFile">fw(i, j, k, irhoe) = sfil*fw(i, j, k, irhoe)</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi19" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindflux_spatial_di25"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi18" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi17" target="origFile"><code class="keyword">END DO</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi25" target="origFile"><code class="comment">! Determine whether or not the total energy must be corrected</code></a>
<a name="inviscidupwindflux_spatial_di26"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi25" target="origFile"><code class="comment">! for the presence of the turbulent kinetic energy.</code></a>
<a name="inviscidupwindflux_spatial_di27"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi25" target="origFile"><code class="keyword">IF</code> (kpresent) <code class="keyword">THEN</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi26" target="origFile"><code class="keyword">IF</code> (currentlevel .EQ. groundlevel .OR. turbcoupled) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di28"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi27" target="origFile">correctfork = <code class="constant">.true.</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi26" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi28" target="origFile">correctfork = <code class="constant">.false.</code></a>
<a name="inviscidupwindflux_spatial_di29"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi26" target="origFile"><code class="keyword">END IF</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi25" target="origFile"><code class="keyword">ELSE</code></a>
<a name="inviscidupwindflux_spatial_di30"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi29" target="origFile">correctfork = <code class="constant">.false.</code></a>
<a name="inviscidupwindflux_spatial_di32"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi25" target="origFile"><code class="keyword">END IF</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi30" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-10_realType </code>.LT. one - kappacoef) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di31"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi32" target="origFile">max1 = one - kappacoef</a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi30" target="origFile"><code class="keyword">ELSE</code></a>
<a name="inviscidupwindflux_spatial_di33"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi31" target="origFile">max1 = <code class="constant">1.e-10_realType</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi30" target="origFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindflux_spatial_di34"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi33" target="origFile"><code class="comment">! Compute the factor used in the minmod limiter.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi33" target="origFile">factminmod = (three-kappacoef)/max1</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi34" target="origFile"><code class="comment">! Determine the limiter scheme to be used. On the fine grid the</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi34" target="origFile"><code class="comment">! user specified scheme is used; on the coarse grid a first order</code></a>
<a name="inviscidupwindflux_spatial_di36"></a><a name="inviscidupwindflux_spatial_di35"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi34" target="origFile"><code class="comment">! scheme is computed.</code></a>
<a name="inviscidupwindflux_spatial_di37"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi34" target="origFile">limused = firstorder</a>
<a name="inviscidupwindflux_spatial_di38"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi35" target="origFile"><code class="keyword">IF</code> (finegrid) </a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi36" target="origFile">limused = limiter</a>
<a name="inviscidupwindflux_spatial_di39"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi37" target="origFile"><code class="comment">! Lumped diss is true for doing approx PC</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi37" target="origFile"><code class="keyword">IF</code> (lumpeddiss) </a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi38" target="origFile">limused = firstorder</a>
<a name="inviscidupwindflux_spatial_di41"></a><a name="inviscidupwindflux_spatial_di40"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi39" target="origFile"><code class="comment">! Determine the riemann solver which must be used.</code></a>
<a name="inviscidupwindflux_spatial_di42"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi39" target="origFile">riemannused = riemanncoarse</a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi40" target="origFile"><code class="keyword">IF</code> (finegrid) </a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi41" target="origFile">riemannused = riemann</a>
<a name="inviscidupwindflux_spatial_di43"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi42" target="origFile"><code class="comment">! Store 1-kappa and 1+kappa a bit easier and multiply it by 0.25.</code></a>
<a name="inviscidupwindflux_spatial_di44"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi42" target="origFile">omk = fourth*(one-kappacoef)</a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi43" target="origFile">opk = fourth*(one+kappacoef)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi44" target="origFile"><code class="comment">! Initialize sFace to zero. This value will be used if the</code></a>
<a name="inviscidupwindflux_spatial_di45"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi44" target="origFile"><code class="comment">! block is not moving.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi44" target="origFile">sface = zero</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi45" target="origFile"><code class="comment">! Set the number of variables to be interpolated depending</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi45" target="origFile"><code class="comment">! whether or not a k-equation is present. If a k-equation is</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi45" target="origFile"><code class="comment">! present also set the logical firstOrderK. This indicates</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi45" target="origFile"><code class="comment">! whether or not only a first order approximation is to be used</code></a>
<a name="inviscidupwindflux_spatial_di46"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi45" target="origFile"><code class="comment">! for the turbulent kinetic energy.</code></a>
<a name="inviscidupwindflux_spatial_di47"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi45" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di48"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi46" target="origFile"><code class="keyword">IF</code> (orderturb .EQ. firstorder) <code class="keyword">THEN</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi47" target="origFile">nwint = nwf</a>
<a name="inviscidupwindflux_spatial_di49"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi48" target="origFile">firstorderk = <code class="constant">.true.</code></a>
<a name="inviscidupwindflux_spatial_di50"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi46" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi49" target="origFile">nwint = itu1</a>
        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi50" target="origFile">firstorderk = <code class="constant">.false.</code></a>
<a name="inviscidupwindflux_spatial_di51"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi46" target="origFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindflux_spatial_di52"></a>    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi45" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi51" target="origFile">nwint = nwf</a>
<a name="inviscidupwindflux_spatial_di53"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi52" target="origFile">firstorderk = <code class="constant">.false.</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi45" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="comment">!      * Flux computation. A distinction is made between first and      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="comment">!      * second order schemes to avoid the overhead for the first order *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="comment">!      * scheme.                                                        *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="keyword">IF</code> (limused .EQ. firstorder) <code class="keyword">THEN</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">fwd = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">fluxd = <code class="constant">0.0</code></a>
<a name="inviscidupwindflux_spatial_di54"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">leftd = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">rightd = <code class="constant">0.0</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="comment">!        * First order reconstruction. The states in the cells are      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="comment">!        * constant. The left and right states are constructed easily.  *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="comment">!</code></a>
<a name="inviscidupwindflux_spatial_di55"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="comment">! Fluxes in the i-direction.</code></a>
<a name="inviscidupwindflux_spatial_di56"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindflux_spatial_di57"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi55" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi56" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi57" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindflux_spatial_di58"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi57" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindflux_spatial_di59"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi57" target="origFile">sx = si(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di60"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi58" target="origFile">sy = si(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindflux_spatial_di62"></a><a name="inviscidupwindflux_spatial_di61"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi59" target="origFile">sz = si(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindflux_spatial_di63"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi60" target="origFile">por = pori(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi61" target="origFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi62" target="origFile">sface = sfacei(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi63" target="origFile"><code class="comment">! Determine the left and right state.</code></a>
<a name="inviscidupwindflux_spatial_di64"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi63" target="origFile">leftd(irho) = wd(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi63" target="origFile">left(irho) = w(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di65"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi64" target="origFile">leftd(ivx) = wd(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi64" target="origFile">left(ivx) = w(i, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di66"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi65" target="origFile">leftd(ivy) = wd(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi65" target="origFile">left(ivy) = w(i, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di67"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi66" target="origFile">leftd(ivz) = wd(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi66" target="origFile">left(ivz) = w(i, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di68"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi67" target="origFile">leftd(irhoe) = pd(i, j, k)</a>
<a name="inviscidupwindflux_spatial_di69"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi67" target="origFile">left(irhoe) = p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi68" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi69" target="origFile">leftd(itu1) = wd(i, j, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di70"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi69" target="origFile">left(itu1) = w(i, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi68" target="origFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindflux_spatial_di71"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi70" target="origFile">rightd(irho) = wd(i+<code class="constant">1</code>, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi70" target="origFile">right(irho) = w(i+<code class="constant">1</code>, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di72"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi71" target="origFile">rightd(ivx) = wd(i+<code class="constant">1</code>, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi71" target="origFile">right(ivx) = w(i+<code class="constant">1</code>, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di73"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi72" target="origFile">rightd(ivy) = wd(i+<code class="constant">1</code>, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi72" target="origFile">right(ivy) = w(i+<code class="constant">1</code>, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di74"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi73" target="origFile">rightd(ivz) = wd(i+<code class="constant">1</code>, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi73" target="origFile">right(ivz) = w(i+<code class="constant">1</code>, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di75"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi74" target="origFile">rightd(irhoe) = pd(i+<code class="constant">1</code>, j, k)</a>
<a name="inviscidupwindflux_spatial_di76"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi74" target="origFile">right(irhoe) = p(i+<code class="constant">1</code>, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi75" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi76" target="origFile">rightd(itu1) = wd(i+<code class="constant">1</code>, j, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di77"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi76" target="origFile">right(itu1) = w(i+<code class="constant">1</code>, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi75" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi77" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindflux_spatial_di78"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi77" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi77" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i+<code class="constant">1</code>, j, k))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi78" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
<a name="inviscidupwindflux_spatial_di79"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi78" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX_SPATIAL_D</code>(left, leftd, right, rightd, flux<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi78" target="origFile"><code class="label">&                                 </code>, fluxd)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi79" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindflux_spatial_di80"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi79" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) + fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi79" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindflux_spatial_di81"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi80" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) + fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi80" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindflux_spatial_di82"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi81" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) + fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi81" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindflux_spatial_di83"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi82" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) + fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi82" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindflux_spatial_di84"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi83" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) + fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi83" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindflux_spatial_di85"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi84" target="origFile">fwd(i+<code class="constant">1</code>, j, k, irho) = fwd(i+<code class="constant">1</code>, j, k, irho) - fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi84" target="origFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) - flux(irho)</a>
<a name="inviscidupwindflux_spatial_di86"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi85" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imx) = fwd(i+<code class="constant">1</code>, j, k, imx) - fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi85" target="origFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) - flux(imx)</a>
<a name="inviscidupwindflux_spatial_di87"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi86" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imy) = fwd(i+<code class="constant">1</code>, j, k, imy) - fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi86" target="origFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) - flux(imy)</a>
<a name="inviscidupwindflux_spatial_di88"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi87" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imz) = fwd(i+<code class="constant">1</code>, j, k, imz) - fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi87" target="origFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) - flux(imz)</a>
<a name="inviscidupwindflux_spatial_di89"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi88" target="origFile">fwd(i+<code class="constant">1</code>, j, k, irhoe) = fwd(i+<code class="constant">1</code>, j, k, irhoe) - fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi88" target="origFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi89" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindflux_spatial_di90"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi89" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi89" target="origFile">ind = indfamilyi(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi90" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi90" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyi(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi56" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindflux_spatial_di91"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi55" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi54" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindflux_spatial_di92"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi91" target="origFile"><code class="comment">! Fluxes in j-direction.</code></a>
<a name="inviscidupwindflux_spatial_di93"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi91" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindflux_spatial_di94"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi92" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi93" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi94" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindflux_spatial_di95"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi94" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindflux_spatial_di96"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi94" target="origFile">sx = sj(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di97"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi95" target="origFile">sy = sj(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindflux_spatial_di99"></a><a name="inviscidupwindflux_spatial_di98"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi96" target="origFile">sz = sj(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindflux_spatial_di100"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi97" target="origFile">por = porj(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi98" target="origFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi99" target="origFile">sface = sfacej(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi100" target="origFile"><code class="comment">! Determine the left and right state.</code></a>
<a name="inviscidupwindflux_spatial_di101"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi100" target="origFile">leftd(irho) = wd(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi100" target="origFile">left(irho) = w(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di102"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi101" target="origFile">leftd(ivx) = wd(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi101" target="origFile">left(ivx) = w(i, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di103"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi102" target="origFile">leftd(ivy) = wd(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi102" target="origFile">left(ivy) = w(i, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di104"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi103" target="origFile">leftd(ivz) = wd(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi103" target="origFile">left(ivz) = w(i, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di105"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi104" target="origFile">leftd(irhoe) = pd(i, j, k)</a>
<a name="inviscidupwindflux_spatial_di106"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi104" target="origFile">left(irhoe) = p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi105" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi106" target="origFile">leftd(itu1) = wd(i, j, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di107"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi106" target="origFile">left(itu1) = w(i, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi105" target="origFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindflux_spatial_di108"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi107" target="origFile">rightd(irho) = wd(i, j+<code class="constant">1</code>, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi107" target="origFile">right(irho) = w(i, j+<code class="constant">1</code>, k, irho)</a>
<a name="inviscidupwindflux_spatial_di109"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi108" target="origFile">rightd(ivx) = wd(i, j+<code class="constant">1</code>, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi108" target="origFile">right(ivx) = w(i, j+<code class="constant">1</code>, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di110"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi109" target="origFile">rightd(ivy) = wd(i, j+<code class="constant">1</code>, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi109" target="origFile">right(ivy) = w(i, j+<code class="constant">1</code>, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di111"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi110" target="origFile">rightd(ivz) = wd(i, j+<code class="constant">1</code>, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi110" target="origFile">right(ivz) = w(i, j+<code class="constant">1</code>, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di112"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi111" target="origFile">rightd(irhoe) = pd(i, j+<code class="constant">1</code>, k)</a>
<a name="inviscidupwindflux_spatial_di113"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi111" target="origFile">right(irhoe) = p(i, j+<code class="constant">1</code>, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi112" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi113" target="origFile">rightd(itu1) = wd(i, j+<code class="constant">1</code>, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di114"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi113" target="origFile">right(itu1) = w(i, j+<code class="constant">1</code>, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi112" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi114" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindflux_spatial_di115"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi114" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi114" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i, j+<code class="constant">1</code>, k))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi115" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
<a name="inviscidupwindflux_spatial_di116"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi115" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX_SPATIAL_D</code>(left, leftd, right, rightd, flux<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi115" target="origFile"><code class="label">&                                 </code>, fluxd)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi116" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindflux_spatial_di117"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi116" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) + fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi116" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindflux_spatial_di118"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi117" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) + fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi117" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindflux_spatial_di119"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi118" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) + fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi118" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindflux_spatial_di120"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi119" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) + fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi119" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindflux_spatial_di121"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi120" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) + fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi120" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindflux_spatial_di122"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi121" target="origFile">fwd(i, j+<code class="constant">1</code>, k, irho) = fwd(i, j+<code class="constant">1</code>, k, irho) - fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi121" target="origFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) - flux(irho)</a>
<a name="inviscidupwindflux_spatial_di123"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi122" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imx) = fwd(i, j+<code class="constant">1</code>, k, imx) - fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi122" target="origFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) - flux(imx)</a>
<a name="inviscidupwindflux_spatial_di124"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi123" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imy) = fwd(i, j+<code class="constant">1</code>, k, imy) - fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi123" target="origFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) - flux(imy)</a>
<a name="inviscidupwindflux_spatial_di125"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi124" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imz) = fwd(i, j+<code class="constant">1</code>, k, imz) - fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi124" target="origFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) - flux(imz)</a>
<a name="inviscidupwindflux_spatial_di126"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi125" target="origFile">fwd(i, j+<code class="constant">1</code>, k, irhoe) = fwd(i, j+<code class="constant">1</code>, k, irhoe) - fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi125" target="origFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi126" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindflux_spatial_di127"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi126" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi126" target="origFile">ind = indfamilyj(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi127" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi127" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyj(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi93" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindflux_spatial_di128"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi92" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi91" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindflux_spatial_di129"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi128" target="origFile"><code class="comment">! Fluxes in k-direction.</code></a>
<a name="inviscidupwindflux_spatial_di130"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi128" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
<a name="inviscidupwindflux_spatial_di131"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi129" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi130" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi131" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindflux_spatial_di132"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi131" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindflux_spatial_di133"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi131" target="origFile">sx = sk(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di134"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi132" target="origFile">sy = sk(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindflux_spatial_di136"></a><a name="inviscidupwindflux_spatial_di135"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi133" target="origFile">sz = sk(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindflux_spatial_di137"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi134" target="origFile">por = pork(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi135" target="origFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi136" target="origFile">sface = sfacek(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi137" target="origFile"><code class="comment">! Determine the left and right state.</code></a>
<a name="inviscidupwindflux_spatial_di138"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi137" target="origFile">leftd(irho) = wd(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi137" target="origFile">left(irho) = w(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di139"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi138" target="origFile">leftd(ivx) = wd(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi138" target="origFile">left(ivx) = w(i, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di140"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi139" target="origFile">leftd(ivy) = wd(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi139" target="origFile">left(ivy) = w(i, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di141"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi140" target="origFile">leftd(ivz) = wd(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi140" target="origFile">left(ivz) = w(i, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di142"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi141" target="origFile">leftd(irhoe) = pd(i, j, k)</a>
<a name="inviscidupwindflux_spatial_di143"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi141" target="origFile">left(irhoe) = p(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi142" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi143" target="origFile">leftd(itu1) = wd(i, j, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di144"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi143" target="origFile">left(itu1) = w(i, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi142" target="origFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindflux_spatial_di145"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi144" target="origFile">rightd(irho) = wd(i, j, k+<code class="constant">1</code>, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi144" target="origFile">right(irho) = w(i, j, k+<code class="constant">1</code>, irho)</a>
<a name="inviscidupwindflux_spatial_di146"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi145" target="origFile">rightd(ivx) = wd(i, j, k+<code class="constant">1</code>, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi145" target="origFile">right(ivx) = w(i, j, k+<code class="constant">1</code>, ivx)</a>
<a name="inviscidupwindflux_spatial_di147"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi146" target="origFile">rightd(ivy) = wd(i, j, k+<code class="constant">1</code>, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi146" target="origFile">right(ivy) = w(i, j, k+<code class="constant">1</code>, ivy)</a>
<a name="inviscidupwindflux_spatial_di148"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi147" target="origFile">rightd(ivz) = wd(i, j, k+<code class="constant">1</code>, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi147" target="origFile">right(ivz) = w(i, j, k+<code class="constant">1</code>, ivz)</a>
<a name="inviscidupwindflux_spatial_di149"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi148" target="origFile">rightd(irhoe) = pd(i, j, k+<code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di150"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi148" target="origFile">right(irhoe) = p(i, j, k+<code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi149" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi150" target="origFile">rightd(itu1) = wd(i, j, k+<code class="constant">1</code>, itu1)</a>
<a name="inviscidupwindflux_spatial_di151"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi150" target="origFile">right(itu1) = w(i, j, k+<code class="constant">1</code>, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi149" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi151" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindflux_spatial_di152"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi151" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi151" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i, j, k+<code class="constant">1</code>))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi152" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
<a name="inviscidupwindflux_spatial_di153"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi152" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX_SPATIAL_D</code>(left, leftd, right, rightd, flux<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi152" target="origFile"><code class="label">&                                 </code>, fluxd)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi153" target="origFile"><code class="comment">! And scatter it the left and right.</code></a>
<a name="inviscidupwindflux_spatial_di154"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi153" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) + fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi153" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindflux_spatial_di155"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi154" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) + fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi154" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindflux_spatial_di156"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi155" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) + fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi155" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindflux_spatial_di157"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi156" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) + fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi156" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindflux_spatial_di158"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi157" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) + fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi157" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindflux_spatial_di159"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi158" target="origFile">fwd(i, j, k+<code class="constant">1</code>, irho) = fwd(i, j, k+<code class="constant">1</code>, irho) - fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi158" target="origFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) - flux(irho)</a>
<a name="inviscidupwindflux_spatial_di160"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi159" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imx) = fwd(i, j, k+<code class="constant">1</code>, imx) - fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi159" target="origFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) - flux(imx)</a>
<a name="inviscidupwindflux_spatial_di161"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi160" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imy) = fwd(i, j, k+<code class="constant">1</code>, imy) - fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi160" target="origFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) - flux(imy)</a>
<a name="inviscidupwindflux_spatial_di162"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi161" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imz) = fwd(i, j, k+<code class="constant">1</code>, imz) - fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi161" target="origFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) - flux(imz)</a>
<a name="inviscidupwindflux_spatial_di163"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi162" target="origFile">fwd(i, j, k+<code class="constant">1</code>, irhoe) = fwd(i, j, k+<code class="constant">1</code>, irhoe) - fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi162" target="origFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi163" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindflux_spatial_di164"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi163" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi163" target="origFile">ind = indfamilyk(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi164" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi164" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyk(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi130" target="origFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi129" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi128" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">fwd = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">fluxd = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">leftd = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">rightd = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">du1d = <code class="constant">0.0</code></a>
<a name="inviscidupwindflux_spatial_di165"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">du2d = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile">du3d = <code class="constant">0.0</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!      ==================================================================</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!      ==================================================================</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        * Second order reconstruction of the left and right state.     *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        * The three differences used in the, possibly nonlinear,       *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        * interpolation are constructed here; the actual left and      *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        * right states, or at least the differences from the first     *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        * order interpolation, are computed in the subroutine          *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        * leftRightState.                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">!</code></a>
<a name="inviscidupwindflux_spatial_di166"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="comment">! Fluxes in the i-direction.</code></a>
<a name="inviscidupwindflux_spatial_di167"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindflux_spatial_di168"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi166" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi167" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi168" target="origFile"><code class="comment">! Store the three differences used in the interpolation</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi168" target="origFile"><code class="comment">! in du1, du2, du3.</code></a>
<a name="inviscidupwindflux_spatial_di169"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi168" target="origFile">du1d(irho) = wd(i, j, k, irho) - wd(i-<code class="constant">1</code>, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi168" target="origFile">du1(irho) = w(i, j, k, irho) - w(i-<code class="constant">1</code>, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di170"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi169" target="origFile">du2d(irho) = wd(i+<code class="constant">1</code>, j, k, irho) - wd(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi169" target="origFile">du2(irho) = w(i+<code class="constant">1</code>, j, k, irho) - w(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di171"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi170" target="origFile">du3d(irho) = wd(i+<code class="constant">2</code>, j, k, irho) - wd(i+<code class="constant">1</code>, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi170" target="origFile">du3(irho) = w(i+<code class="constant">2</code>, j, k, irho) - w(i+<code class="constant">1</code>, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di172"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi171" target="origFile">du1d(ivx) = wd(i, j, k, ivx) - wd(i-<code class="constant">1</code>, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi171" target="origFile">du1(ivx) = w(i, j, k, ivx) - w(i-<code class="constant">1</code>, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di173"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi172" target="origFile">du2d(ivx) = wd(i+<code class="constant">1</code>, j, k, ivx) - wd(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi172" target="origFile">du2(ivx) = w(i+<code class="constant">1</code>, j, k, ivx) - w(i, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di174"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi173" target="origFile">du3d(ivx) = wd(i+<code class="constant">2</code>, j, k, ivx) - wd(i+<code class="constant">1</code>, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi173" target="origFile">du3(ivx) = w(i+<code class="constant">2</code>, j, k, ivx) - w(i+<code class="constant">1</code>, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di175"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi174" target="origFile">du1d(ivy) = wd(i, j, k, ivy) - wd(i-<code class="constant">1</code>, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi174" target="origFile">du1(ivy) = w(i, j, k, ivy) - w(i-<code class="constant">1</code>, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di176"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi175" target="origFile">du2d(ivy) = wd(i+<code class="constant">1</code>, j, k, ivy) - wd(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi175" target="origFile">du2(ivy) = w(i+<code class="constant">1</code>, j, k, ivy) - w(i, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di177"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi176" target="origFile">du3d(ivy) = wd(i+<code class="constant">2</code>, j, k, ivy) - wd(i+<code class="constant">1</code>, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi176" target="origFile">du3(ivy) = w(i+<code class="constant">2</code>, j, k, ivy) - w(i+<code class="constant">1</code>, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di178"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi177" target="origFile">du1d(ivz) = wd(i, j, k, ivz) - wd(i-<code class="constant">1</code>, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi177" target="origFile">du1(ivz) = w(i, j, k, ivz) - w(i-<code class="constant">1</code>, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di179"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi178" target="origFile">du2d(ivz) = wd(i+<code class="constant">1</code>, j, k, ivz) - wd(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi178" target="origFile">du2(ivz) = w(i+<code class="constant">1</code>, j, k, ivz) - w(i, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di180"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi179" target="origFile">du3d(ivz) = wd(i+<code class="constant">2</code>, j, k, ivz) - wd(i+<code class="constant">1</code>, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi179" target="origFile">du3(ivz) = w(i+<code class="constant">2</code>, j, k, ivz) - w(i+<code class="constant">1</code>, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di181"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi180" target="origFile">du1d(irhoe) = pd(i, j, k) - pd(i-<code class="constant">1</code>, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi180" target="origFile">du1(irhoe) = p(i, j, k) - p(i-<code class="constant">1</code>, j, k)</a>
<a name="inviscidupwindflux_spatial_di182"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi181" target="origFile">du2d(irhoe) = pd(i+<code class="constant">1</code>, j, k) - pd(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi181" target="origFile">du2(irhoe) = p(i+<code class="constant">1</code>, j, k) - p(i, j, k)</a>
<a name="inviscidupwindflux_spatial_di183"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi182" target="origFile">du3d(irhoe) = pd(i+<code class="constant">2</code>, j, k) - pd(i+<code class="constant">1</code>, j, k)</a>
<a name="inviscidupwindflux_spatial_di184"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi182" target="origFile">du3(irhoe) = p(i+<code class="constant">2</code>, j, k) - p(i+<code class="constant">1</code>, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi183" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di185"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi184" target="origFile">du1d(itu1) = wd(i, j, k, itu1) - wd(i-<code class="constant">1</code>, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi184" target="origFile">du1(itu1) = w(i, j, k, itu1) - w(i-<code class="constant">1</code>, j, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di186"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi185" target="origFile">du2d(itu1) = wd(i+<code class="constant">1</code>, j, k, itu1) - wd(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi185" target="origFile">du2(itu1) = w(i+<code class="constant">1</code>, j, k, itu1) - w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi186" target="origFile">du3d(itu1) = wd(i+<code class="constant">2</code>, j, k, itu1) - wd(i+<code class="constant">1</code>, j, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di187"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi186" target="origFile">du3(itu1) = w(i+<code class="constant">2</code>, j, k, itu1) - w(i+<code class="constant">1</code>, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi183" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi187" target="origFile"><code class="comment">! Compute the differences from the first order scheme.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi187" target="origFile"><code class="keyword">CALL </code><code class="funcname">LEFTRIGHTSTATE_SPATIAL_D</code>(du1, du1d, du2, du2d, du3, <code class="label">&</code></a>
<a name="inviscidupwindflux_spatial_di188"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi187" target="origFile"><code class="label">&                                    </code>du3d, rotmatrixi, rotmatrixid, left<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi187" target="origFile"><code class="label">&                                    </code>, leftd, right, rightd)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi188" target="origFile"><code class="comment">! Add the first order part to the currently stored</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi188" target="origFile"><code class="comment">! differences, such that the correct state vector</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi188" target="origFile"><code class="comment">! is stored.</code></a>
<a name="inviscidupwindflux_spatial_di189"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi188" target="origFile">leftd(irho) = leftd(irho) + wd(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi188" target="origFile">left(irho) = left(irho) + w(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di190"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi189" target="origFile">leftd(ivx) = leftd(ivx) + wd(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi189" target="origFile">left(ivx) = left(ivx) + w(i, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di191"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi190" target="origFile">leftd(ivy) = leftd(ivy) + wd(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi190" target="origFile">left(ivy) = left(ivy) + w(i, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di192"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi191" target="origFile">leftd(ivz) = leftd(ivz) + wd(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi191" target="origFile">left(ivz) = left(ivz) + w(i, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di193"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi192" target="origFile">leftd(irhoe) = leftd(irhoe) + pd(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi192" target="origFile">left(irhoe) = left(irhoe) + p(i, j, k)</a>
<a name="inviscidupwindflux_spatial_di194"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi193" target="origFile">rightd(irho) = rightd(irho) + wd(i+<code class="constant">1</code>, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi193" target="origFile">right(irho) = right(irho) + w(i+<code class="constant">1</code>, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di195"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi194" target="origFile">rightd(ivx) = rightd(ivx) + wd(i+<code class="constant">1</code>, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi194" target="origFile">right(ivx) = right(ivx) + w(i+<code class="constant">1</code>, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di196"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi195" target="origFile">rightd(ivy) = rightd(ivy) + wd(i+<code class="constant">1</code>, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi195" target="origFile">right(ivy) = right(ivy) + w(i+<code class="constant">1</code>, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di197"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi196" target="origFile">rightd(ivz) = rightd(ivz) + wd(i+<code class="constant">1</code>, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi196" target="origFile">right(ivz) = right(ivz) + w(i+<code class="constant">1</code>, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di198"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi197" target="origFile">rightd(irhoe) = rightd(irhoe) + pd(i+<code class="constant">1</code>, j, k)</a>
<a name="inviscidupwindflux_spatial_di199"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi197" target="origFile">right(irhoe) = right(irhoe) + p(i+<code class="constant">1</code>, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi198" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di200"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi199" target="origFile">leftd(itu1) = leftd(itu1) + wd(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi199" target="origFile">left(itu1) = left(itu1) + w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi200" target="origFile">rightd(itu1) = rightd(itu1) + wd(i+<code class="constant">1</code>, j, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di201"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi200" target="origFile">right(itu1) = right(itu1) + w(i+<code class="constant">1</code>, j, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi198" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi201" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindflux_spatial_di202"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi201" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindflux_spatial_di203"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi201" target="origFile">sx = si(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di204"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi202" target="origFile">sy = si(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindflux_spatial_di206"></a><a name="inviscidupwindflux_spatial_di205"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi203" target="origFile">sz = si(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindflux_spatial_di207"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi204" target="origFile">por = pori(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi205" target="origFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi206" target="origFile">sface = sfacei(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi207" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindflux_spatial_di208"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi207" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi207" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i+<code class="constant">1</code>, j, k))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi208" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
<a name="inviscidupwindflux_spatial_di209"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi208" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX_SPATIAL_D</code>(left, leftd, right, rightd, flux<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi208" target="origFile"><code class="label">&                                 </code>, fluxd)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi209" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindflux_spatial_di210"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi209" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) + fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi209" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindflux_spatial_di211"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi210" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) + fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi210" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindflux_spatial_di212"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi211" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) + fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi211" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindflux_spatial_di213"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi212" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) + fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi212" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindflux_spatial_di214"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi213" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) + fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi213" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindflux_spatial_di215"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi214" target="origFile">fwd(i+<code class="constant">1</code>, j, k, irho) = fwd(i+<code class="constant">1</code>, j, k, irho) - fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi214" target="origFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) - flux(irho)</a>
<a name="inviscidupwindflux_spatial_di216"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi215" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imx) = fwd(i+<code class="constant">1</code>, j, k, imx) - fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi215" target="origFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) - flux(imx)</a>
<a name="inviscidupwindflux_spatial_di217"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi216" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imy) = fwd(i+<code class="constant">1</code>, j, k, imy) - fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi216" target="origFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) - flux(imy)</a>
<a name="inviscidupwindflux_spatial_di218"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi217" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imz) = fwd(i+<code class="constant">1</code>, j, k, imz) - fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi217" target="origFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) - flux(imz)</a>
<a name="inviscidupwindflux_spatial_di219"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi218" target="origFile">fwd(i+<code class="constant">1</code>, j, k, irhoe) = fwd(i+<code class="constant">1</code>, j, k, irhoe) - fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi218" target="origFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi219" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindflux_spatial_di220"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi219" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi219" target="origFile">ind = indfamilyi(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi220" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi220" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyi(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi167" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindflux_spatial_di221"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi166" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi165" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindflux_spatial_di222"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi221" target="origFile"><code class="comment">! Fluxes in the j-direction.</code></a>
<a name="inviscidupwindflux_spatial_di223"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi221" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindflux_spatial_di224"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi222" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi223" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi224" target="origFile"><code class="comment">! Store the three differences used in the interpolation</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi224" target="origFile"><code class="comment">! in du1, du2, du3.</code></a>
<a name="inviscidupwindflux_spatial_di225"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi224" target="origFile">du1d(irho) = wd(i, j, k, irho) - wd(i, j-<code class="constant">1</code>, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi224" target="origFile">du1(irho) = w(i, j, k, irho) - w(i, j-<code class="constant">1</code>, k, irho)</a>
<a name="inviscidupwindflux_spatial_di226"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi225" target="origFile">du2d(irho) = wd(i, j+<code class="constant">1</code>, k, irho) - wd(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi225" target="origFile">du2(irho) = w(i, j+<code class="constant">1</code>, k, irho) - w(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di227"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi226" target="origFile">du3d(irho) = wd(i, j+<code class="constant">2</code>, k, irho) - wd(i, j+<code class="constant">1</code>, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi226" target="origFile">du3(irho) = w(i, j+<code class="constant">2</code>, k, irho) - w(i, j+<code class="constant">1</code>, k, irho)</a>
<a name="inviscidupwindflux_spatial_di228"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi227" target="origFile">du1d(ivx) = wd(i, j, k, ivx) - wd(i, j-<code class="constant">1</code>, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi227" target="origFile">du1(ivx) = w(i, j, k, ivx) - w(i, j-<code class="constant">1</code>, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di229"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi228" target="origFile">du2d(ivx) = wd(i, j+<code class="constant">1</code>, k, ivx) - wd(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi228" target="origFile">du2(ivx) = w(i, j+<code class="constant">1</code>, k, ivx) - w(i, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di230"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi229" target="origFile">du3d(ivx) = wd(i, j+<code class="constant">2</code>, k, ivx) - wd(i, j+<code class="constant">1</code>, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi229" target="origFile">du3(ivx) = w(i, j+<code class="constant">2</code>, k, ivx) - w(i, j+<code class="constant">1</code>, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di231"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi230" target="origFile">du1d(ivy) = wd(i, j, k, ivy) - wd(i, j-<code class="constant">1</code>, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi230" target="origFile">du1(ivy) = w(i, j, k, ivy) - w(i, j-<code class="constant">1</code>, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di232"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi231" target="origFile">du2d(ivy) = wd(i, j+<code class="constant">1</code>, k, ivy) - wd(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi231" target="origFile">du2(ivy) = w(i, j+<code class="constant">1</code>, k, ivy) - w(i, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di233"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi232" target="origFile">du3d(ivy) = wd(i, j+<code class="constant">2</code>, k, ivy) - wd(i, j+<code class="constant">1</code>, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi232" target="origFile">du3(ivy) = w(i, j+<code class="constant">2</code>, k, ivy) - w(i, j+<code class="constant">1</code>, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di234"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi233" target="origFile">du1d(ivz) = wd(i, j, k, ivz) - wd(i, j-<code class="constant">1</code>, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi233" target="origFile">du1(ivz) = w(i, j, k, ivz) - w(i, j-<code class="constant">1</code>, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di235"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi234" target="origFile">du2d(ivz) = wd(i, j+<code class="constant">1</code>, k, ivz) - wd(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi234" target="origFile">du2(ivz) = w(i, j+<code class="constant">1</code>, k, ivz) - w(i, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di236"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi235" target="origFile">du3d(ivz) = wd(i, j+<code class="constant">2</code>, k, ivz) - wd(i, j+<code class="constant">1</code>, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi235" target="origFile">du3(ivz) = w(i, j+<code class="constant">2</code>, k, ivz) - w(i, j+<code class="constant">1</code>, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di237"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi236" target="origFile">du1d(irhoe) = pd(i, j, k) - pd(i, j-<code class="constant">1</code>, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi236" target="origFile">du1(irhoe) = p(i, j, k) - p(i, j-<code class="constant">1</code>, k)</a>
<a name="inviscidupwindflux_spatial_di238"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi237" target="origFile">du2d(irhoe) = pd(i, j+<code class="constant">1</code>, k) - pd(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi237" target="origFile">du2(irhoe) = p(i, j+<code class="constant">1</code>, k) - p(i, j, k)</a>
<a name="inviscidupwindflux_spatial_di239"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi238" target="origFile">du3d(irhoe) = pd(i, j+<code class="constant">2</code>, k) - pd(i, j+<code class="constant">1</code>, k)</a>
<a name="inviscidupwindflux_spatial_di240"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi238" target="origFile">du3(irhoe) = p(i, j+<code class="constant">2</code>, k) - p(i, j+<code class="constant">1</code>, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi239" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di241"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi240" target="origFile">du1d(itu1) = wd(i, j, k, itu1) - wd(i, j-<code class="constant">1</code>, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi240" target="origFile">du1(itu1) = w(i, j, k, itu1) - w(i, j-<code class="constant">1</code>, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di242"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi241" target="origFile">du2d(itu1) = wd(i, j+<code class="constant">1</code>, k, itu1) - wd(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi241" target="origFile">du2(itu1) = w(i, j+<code class="constant">1</code>, k, itu1) - w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi242" target="origFile">du3d(itu1) = wd(i, j+<code class="constant">2</code>, k, itu1) - wd(i, j+<code class="constant">1</code>, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di243"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi242" target="origFile">du3(itu1) = w(i, j+<code class="constant">2</code>, k, itu1) - w(i, j+<code class="constant">1</code>, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi239" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi243" target="origFile"><code class="comment">! Compute the differences from the first order scheme.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi243" target="origFile"><code class="keyword">CALL </code><code class="funcname">LEFTRIGHTSTATE_SPATIAL_D</code>(du1, du1d, du2, du2d, du3, <code class="label">&</code></a>
<a name="inviscidupwindflux_spatial_di244"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi243" target="origFile"><code class="label">&                                    </code>du3d, rotmatrixj, rotmatrixjd, left<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi243" target="origFile"><code class="label">&                                    </code>, leftd, right, rightd)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi244" target="origFile"><code class="comment">! Add the first order part to the currently stored</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi244" target="origFile"><code class="comment">! differences, such that the correct state vector</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi244" target="origFile"><code class="comment">! is stored.</code></a>
<a name="inviscidupwindflux_spatial_di245"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi244" target="origFile">leftd(irho) = leftd(irho) + wd(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi244" target="origFile">left(irho) = left(irho) + w(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di246"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi245" target="origFile">leftd(ivx) = leftd(ivx) + wd(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi245" target="origFile">left(ivx) = left(ivx) + w(i, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di247"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi246" target="origFile">leftd(ivy) = leftd(ivy) + wd(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi246" target="origFile">left(ivy) = left(ivy) + w(i, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di248"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi247" target="origFile">leftd(ivz) = leftd(ivz) + wd(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi247" target="origFile">left(ivz) = left(ivz) + w(i, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di249"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi248" target="origFile">leftd(irhoe) = leftd(irhoe) + pd(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi248" target="origFile">left(irhoe) = left(irhoe) + p(i, j, k)</a>
<a name="inviscidupwindflux_spatial_di250"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi249" target="origFile">rightd(irho) = rightd(irho) + wd(i, j+<code class="constant">1</code>, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi249" target="origFile">right(irho) = right(irho) + w(i, j+<code class="constant">1</code>, k, irho)</a>
<a name="inviscidupwindflux_spatial_di251"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi250" target="origFile">rightd(ivx) = rightd(ivx) + wd(i, j+<code class="constant">1</code>, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi250" target="origFile">right(ivx) = right(ivx) + w(i, j+<code class="constant">1</code>, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di252"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi251" target="origFile">rightd(ivy) = rightd(ivy) + wd(i, j+<code class="constant">1</code>, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi251" target="origFile">right(ivy) = right(ivy) + w(i, j+<code class="constant">1</code>, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di253"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi252" target="origFile">rightd(ivz) = rightd(ivz) + wd(i, j+<code class="constant">1</code>, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi252" target="origFile">right(ivz) = right(ivz) + w(i, j+<code class="constant">1</code>, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di254"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi253" target="origFile">rightd(irhoe) = rightd(irhoe) + pd(i, j+<code class="constant">1</code>, k)</a>
<a name="inviscidupwindflux_spatial_di255"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi253" target="origFile">right(irhoe) = right(irhoe) + p(i, j+<code class="constant">1</code>, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi254" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di256"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi255" target="origFile">leftd(itu1) = leftd(itu1) + wd(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi255" target="origFile">left(itu1) = left(itu1) + w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi256" target="origFile">rightd(itu1) = rightd(itu1) + wd(i, j+<code class="constant">1</code>, k, itu1)</a>
<a name="inviscidupwindflux_spatial_di257"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi256" target="origFile">right(itu1) = right(itu1) + w(i, j+<code class="constant">1</code>, k, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi254" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi257" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindflux_spatial_di258"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi257" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindflux_spatial_di259"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi257" target="origFile">sx = sj(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di260"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi258" target="origFile">sy = sj(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindflux_spatial_di262"></a><a name="inviscidupwindflux_spatial_di261"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi259" target="origFile">sz = sj(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindflux_spatial_di263"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi260" target="origFile">por = porj(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi261" target="origFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi262" target="origFile">sface = sfacej(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi263" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindflux_spatial_di264"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi263" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi263" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i, j+<code class="constant">1</code>, k))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi264" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
<a name="inviscidupwindflux_spatial_di265"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi264" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX_SPATIAL_D</code>(left, leftd, right, rightd, flux<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi264" target="origFile"><code class="label">&                                 </code>, fluxd)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi265" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindflux_spatial_di266"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi265" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) + fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi265" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindflux_spatial_di267"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi266" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) + fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi266" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindflux_spatial_di268"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi267" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) + fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi267" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindflux_spatial_di269"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi268" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) + fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi268" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindflux_spatial_di270"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi269" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) + fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi269" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindflux_spatial_di271"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi270" target="origFile">fwd(i, j+<code class="constant">1</code>, k, irho) = fwd(i, j+<code class="constant">1</code>, k, irho) - fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi270" target="origFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) - flux(irho)</a>
<a name="inviscidupwindflux_spatial_di272"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi271" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imx) = fwd(i, j+<code class="constant">1</code>, k, imx) - fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi271" target="origFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) - flux(imx)</a>
<a name="inviscidupwindflux_spatial_di273"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi272" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imy) = fwd(i, j+<code class="constant">1</code>, k, imy) - fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi272" target="origFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) - flux(imy)</a>
<a name="inviscidupwindflux_spatial_di274"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi273" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imz) = fwd(i, j+<code class="constant">1</code>, k, imz) - fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi273" target="origFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) - flux(imz)</a>
<a name="inviscidupwindflux_spatial_di275"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi274" target="origFile">fwd(i, j+<code class="constant">1</code>, k, irhoe) = fwd(i, j+<code class="constant">1</code>, k, irhoe) - fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi274" target="origFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi275" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindflux_spatial_di276"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi275" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi275" target="origFile">ind = indfamilyj(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi276" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi276" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyj(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi223" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindflux_spatial_di277"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi222" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi221" target="origFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindflux_spatial_di278"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi277" target="origFile"><code class="comment">! Fluxes in the k-direction.</code></a>
<a name="inviscidupwindflux_spatial_di279"></a>      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi277" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
<a name="inviscidupwindflux_spatial_di280"></a>        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi278" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi279" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi280" target="origFile"><code class="comment">! Store the three differences used in the interpolation</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi280" target="origFile"><code class="comment">! in du1, du2, du3.</code></a>
<a name="inviscidupwindflux_spatial_di281"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi280" target="origFile">du1d(irho) = wd(i, j, k, irho) - wd(i, j, k-<code class="constant">1</code>, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi280" target="origFile">du1(irho) = w(i, j, k, irho) - w(i, j, k-<code class="constant">1</code>, irho)</a>
<a name="inviscidupwindflux_spatial_di282"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi281" target="origFile">du2d(irho) = wd(i, j, k+<code class="constant">1</code>, irho) - wd(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi281" target="origFile">du2(irho) = w(i, j, k+<code class="constant">1</code>, irho) - w(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di283"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi282" target="origFile">du3d(irho) = wd(i, j, k+<code class="constant">2</code>, irho) - wd(i, j, k+<code class="constant">1</code>, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi282" target="origFile">du3(irho) = w(i, j, k+<code class="constant">2</code>, irho) - w(i, j, k+<code class="constant">1</code>, irho)</a>
<a name="inviscidupwindflux_spatial_di284"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi283" target="origFile">du1d(ivx) = wd(i, j, k, ivx) - wd(i, j, k-<code class="constant">1</code>, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi283" target="origFile">du1(ivx) = w(i, j, k, ivx) - w(i, j, k-<code class="constant">1</code>, ivx)</a>
<a name="inviscidupwindflux_spatial_di285"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi284" target="origFile">du2d(ivx) = wd(i, j, k+<code class="constant">1</code>, ivx) - wd(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi284" target="origFile">du2(ivx) = w(i, j, k+<code class="constant">1</code>, ivx) - w(i, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di286"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi285" target="origFile">du3d(ivx) = wd(i, j, k+<code class="constant">2</code>, ivx) - wd(i, j, k+<code class="constant">1</code>, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi285" target="origFile">du3(ivx) = w(i, j, k+<code class="constant">2</code>, ivx) - w(i, j, k+<code class="constant">1</code>, ivx)</a>
<a name="inviscidupwindflux_spatial_di287"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi286" target="origFile">du1d(ivy) = wd(i, j, k, ivy) - wd(i, j, k-<code class="constant">1</code>, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi286" target="origFile">du1(ivy) = w(i, j, k, ivy) - w(i, j, k-<code class="constant">1</code>, ivy)</a>
<a name="inviscidupwindflux_spatial_di288"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi287" target="origFile">du2d(ivy) = wd(i, j, k+<code class="constant">1</code>, ivy) - wd(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi287" target="origFile">du2(ivy) = w(i, j, k+<code class="constant">1</code>, ivy) - w(i, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di289"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi288" target="origFile">du3d(ivy) = wd(i, j, k+<code class="constant">2</code>, ivy) - wd(i, j, k+<code class="constant">1</code>, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi288" target="origFile">du3(ivy) = w(i, j, k+<code class="constant">2</code>, ivy) - w(i, j, k+<code class="constant">1</code>, ivy)</a>
<a name="inviscidupwindflux_spatial_di290"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi289" target="origFile">du1d(ivz) = wd(i, j, k, ivz) - wd(i, j, k-<code class="constant">1</code>, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi289" target="origFile">du1(ivz) = w(i, j, k, ivz) - w(i, j, k-<code class="constant">1</code>, ivz)</a>
<a name="inviscidupwindflux_spatial_di291"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi290" target="origFile">du2d(ivz) = wd(i, j, k+<code class="constant">1</code>, ivz) - wd(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi290" target="origFile">du2(ivz) = w(i, j, k+<code class="constant">1</code>, ivz) - w(i, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di292"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi291" target="origFile">du3d(ivz) = wd(i, j, k+<code class="constant">2</code>, ivz) - wd(i, j, k+<code class="constant">1</code>, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi291" target="origFile">du3(ivz) = w(i, j, k+<code class="constant">2</code>, ivz) - w(i, j, k+<code class="constant">1</code>, ivz)</a>
<a name="inviscidupwindflux_spatial_di293"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi292" target="origFile">du1d(irhoe) = pd(i, j, k) - pd(i, j, k-<code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi292" target="origFile">du1(irhoe) = p(i, j, k) - p(i, j, k-<code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di294"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi293" target="origFile">du2d(irhoe) = pd(i, j, k+<code class="constant">1</code>) - pd(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi293" target="origFile">du2(irhoe) = p(i, j, k+<code class="constant">1</code>) - p(i, j, k)</a>
<a name="inviscidupwindflux_spatial_di295"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi294" target="origFile">du3d(irhoe) = pd(i, j, k+<code class="constant">2</code>) - pd(i, j, k+<code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di296"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi294" target="origFile">du3(irhoe) = p(i, j, k+<code class="constant">2</code>) - p(i, j, k+<code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi295" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di297"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi296" target="origFile">du1d(itu1) = wd(i, j, k, itu1) - wd(i, j, k-<code class="constant">1</code>, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi296" target="origFile">du1(itu1) = w(i, j, k, itu1) - w(i, j, k-<code class="constant">1</code>, itu1)</a>
<a name="inviscidupwindflux_spatial_di298"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi297" target="origFile">du2d(itu1) = wd(i, j, k+<code class="constant">1</code>, itu1) - wd(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi297" target="origFile">du2(itu1) = w(i, j, k+<code class="constant">1</code>, itu1) - w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi298" target="origFile">du3d(itu1) = wd(i, j, k+<code class="constant">2</code>, itu1) - wd(i, j, k+<code class="constant">1</code>, itu1)</a>
<a name="inviscidupwindflux_spatial_di299"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi298" target="origFile">du3(itu1) = w(i, j, k+<code class="constant">2</code>, itu1) - w(i, j, k+<code class="constant">1</code>, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi295" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi299" target="origFile"><code class="comment">! Compute the differences from the first order scheme.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi299" target="origFile"><code class="keyword">CALL </code><code class="funcname">LEFTRIGHTSTATE_SPATIAL_D</code>(du1, du1d, du2, du2d, du3, <code class="label">&</code></a>
<a name="inviscidupwindflux_spatial_di300"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi299" target="origFile"><code class="label">&                                    </code>du3d, rotmatrixk, rotmatrixkd, left<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi299" target="origFile"><code class="label">&                                    </code>, leftd, right, rightd)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi300" target="origFile"><code class="comment">! Add the first order part to the currently stored</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi300" target="origFile"><code class="comment">! differences, such that the correct state vector</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi300" target="origFile"><code class="comment">! is stored.</code></a>
<a name="inviscidupwindflux_spatial_di301"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi300" target="origFile">leftd(irho) = leftd(irho) + wd(i, j, k, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi300" target="origFile">left(irho) = left(irho) + w(i, j, k, irho)</a>
<a name="inviscidupwindflux_spatial_di302"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi301" target="origFile">leftd(ivx) = leftd(ivx) + wd(i, j, k, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi301" target="origFile">left(ivx) = left(ivx) + w(i, j, k, ivx)</a>
<a name="inviscidupwindflux_spatial_di303"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi302" target="origFile">leftd(ivy) = leftd(ivy) + wd(i, j, k, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi302" target="origFile">left(ivy) = left(ivy) + w(i, j, k, ivy)</a>
<a name="inviscidupwindflux_spatial_di304"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi303" target="origFile">leftd(ivz) = leftd(ivz) + wd(i, j, k, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi303" target="origFile">left(ivz) = left(ivz) + w(i, j, k, ivz)</a>
<a name="inviscidupwindflux_spatial_di305"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi304" target="origFile">leftd(irhoe) = leftd(irhoe) + pd(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi304" target="origFile">left(irhoe) = left(irhoe) + p(i, j, k)</a>
<a name="inviscidupwindflux_spatial_di306"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi305" target="origFile">rightd(irho) = rightd(irho) + wd(i, j, k+<code class="constant">1</code>, irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi305" target="origFile">right(irho) = right(irho) + w(i, j, k+<code class="constant">1</code>, irho)</a>
<a name="inviscidupwindflux_spatial_di307"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi306" target="origFile">rightd(ivx) = rightd(ivx) + wd(i, j, k+<code class="constant">1</code>, ivx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi306" target="origFile">right(ivx) = right(ivx) + w(i, j, k+<code class="constant">1</code>, ivx)</a>
<a name="inviscidupwindflux_spatial_di308"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi307" target="origFile">rightd(ivy) = rightd(ivy) + wd(i, j, k+<code class="constant">1</code>, ivy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi307" target="origFile">right(ivy) = right(ivy) + w(i, j, k+<code class="constant">1</code>, ivy)</a>
<a name="inviscidupwindflux_spatial_di309"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi308" target="origFile">rightd(ivz) = rightd(ivz) + wd(i, j, k+<code class="constant">1</code>, ivz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi308" target="origFile">right(ivz) = right(ivz) + w(i, j, k+<code class="constant">1</code>, ivz)</a>
<a name="inviscidupwindflux_spatial_di310"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi309" target="origFile">rightd(irhoe) = rightd(irhoe) + pd(i, j, k+<code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di311"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi309" target="origFile">right(irhoe) = right(irhoe) + p(i, j, k+<code class="constant">1</code>)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi310" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindflux_spatial_di312"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi311" target="origFile">leftd(itu1) = leftd(itu1) + wd(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi311" target="origFile">left(itu1) = left(itu1) + w(i, j, k, itu1)</a>
              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi312" target="origFile">rightd(itu1) = rightd(itu1) + wd(i, j, k+<code class="constant">1</code>, itu1)</a>
<a name="inviscidupwindflux_spatial_di313"></a>              <a href="inviscidupwindflux_p.html#inviscidupwindfluxi312" target="origFile">right(itu1) = right(itu1) + w(i, j, k+<code class="constant">1</code>, itu1)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi310" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi313" target="origFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindflux_spatial_di314"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi313" target="origFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindflux_spatial_di315"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi313" target="origFile">sx = sk(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindflux_spatial_di316"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi314" target="origFile">sy = sk(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindflux_spatial_di318"></a><a name="inviscidupwindflux_spatial_di317"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi315" target="origFile">sz = sk(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindflux_spatial_di319"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi316" target="origFile">por = pork(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi317" target="origFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi318" target="origFile">sface = sfacek(i, j, k)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi319" target="origFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindflux_spatial_di320"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi319" target="origFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi319" target="origFile">gammaface = half*(gamma(i, j, k)+gamma(i, j, k+<code class="constant">1</code>))</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi320" target="origFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
<a name="inviscidupwindflux_spatial_di321"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi320" target="origFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX_SPATIAL_D</code>(left, leftd, right, rightd, flux<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi320" target="origFile"><code class="label">&                                 </code>, fluxd)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi321" target="origFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindflux_spatial_di322"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi321" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) + fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi321" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindflux_spatial_di323"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi322" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) + fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi322" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindflux_spatial_di324"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi323" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) + fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi323" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindflux_spatial_di325"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi324" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) + fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi324" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindflux_spatial_di326"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi325" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) + fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi325" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindflux_spatial_di327"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi326" target="origFile">fwd(i, j, k+<code class="constant">1</code>, irho) = fwd(i, j, k+<code class="constant">1</code>, irho) - fluxd(irho)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi326" target="origFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) - flux(irho)</a>
<a name="inviscidupwindflux_spatial_di328"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi327" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imx) = fwd(i, j, k+<code class="constant">1</code>, imx) - fluxd(imx)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi327" target="origFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) - flux(imx)</a>
<a name="inviscidupwindflux_spatial_di329"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi328" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imy) = fwd(i, j, k+<code class="constant">1</code>, imy) - fluxd(imy)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi328" target="origFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) - flux(imy)</a>
<a name="inviscidupwindflux_spatial_di330"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi329" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imz) = fwd(i, j, k+<code class="constant">1</code>, imz) - fluxd(imz)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi329" target="origFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) - flux(imz)</a>
<a name="inviscidupwindflux_spatial_di331"></a>            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi330" target="origFile">fwd(i, j, k+<code class="constant">1</code>, irhoe) = fwd(i, j, k+<code class="constant">1</code>, irhoe) - fluxd(irhoe)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi330" target="origFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi331" target="origFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindflux_spatial_di332"></a><a href="inviscidupwindflux_p.html#inviscidupwindfluxi331" target="origFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi331" target="origFile">ind = indfamilyk(i, j, k)</a>
            <a href="inviscidupwindflux_p.html#inviscidupwindfluxi332" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindfluxi332" target="origFile"><code class="label">&              </code>ind, spectralsol) + factfamilyk(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux_p.html#inviscidupwindfluxi279" target="origFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux_p.html#inviscidupwindfluxi278" target="origFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux_p.html#inviscidupwindfluxi277" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#inviscidupwindfluxi53" target="origFile"><code class="keyword">END IF</code></a>
  <a href="inviscidupwindflux_p.html#inviscidupwindfluxi11" target="origFile"><code class="keyword">END IF</code></a>
<a name="leftrightstate_spatial_d"></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">CONTAINS</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!  Differentiation of leftrightstate in forward (tangent) mode:</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!   variations   of useful results: left right du1 du2 du3</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!   with respect to varying inputs: left right du1 du2 du3</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!      ==================================================================</code></a>
  <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">LEFTRIGHTSTATE_SPATIAL_D</code>(<code class="vardecl">du1</code>, <code class="vardecl">du1d</code>, <code class="vardecl">du2</code>, <code class="vardecl">du2d</code>, <code class="vardecl">du3</code>, <code class="vardecl">du3d</code>, <code class="label">&</code></a>
<a name="leftrightstate_spatial_di0"></a><a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="label">&    </code><code class="vardecl">rotmatrix</code>, <code class="vardecl">rotmatrixd</code>, <code class="vardecl">left</code>, <code class="vardecl">leftd</code>, <code class="vardecl">right</code>, <code class="vardecl">rightd</code>)</a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei0" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei0" target="origFile"><code class="comment">!        Local parameter.</code></a>
<a name="leftrightstate_spatial_di1"></a><a href="inviscidupwindflux_p.html#leftrightstatei0" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei0" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">epslim</code>=<code class="constant">1.e-10_realType</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei1" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei1" target="origFile"><code class="comment">!        Subroutine arguments.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei1" target="origFile"><code class="comment">!</code></a>
<a name="leftrightstate_spatial_di2"></a>    <a href="inviscidupwindflux_p.html#leftrightstatei1" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">du1</code>, <code class="vardecl">du2</code>, <code class="vardecl">du3</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:), <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">du1d</code>, <code class="vardecl">du2d</code>, <code class="vardecl">du3d</code></a>
<a name="leftrightstate_spatial_di3"></a>    <a href="inviscidupwindflux_p.html#leftrightstatei2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">left</code>, <code class="vardecl">right</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:), <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">leftd</code>, <code class="vardecl">rightd</code></a>
<a name="leftrightstate_spatial_di4"></a>    <a href="inviscidupwindflux_p.html#leftrightstatei3" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rotmatrix</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">rotmatrixd</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei4" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei4" target="origFile"><code class="comment">!        Local variables.</code></a>
<a name="leftrightstate_spatial_di5"></a><a href="inviscidupwindflux_p.html#leftrightstatei4" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei4" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">l</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei5" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rl1</code>, <code class="vardecl">rl2</code>, <code class="vardecl">rr1</code>, <code class="vardecl">rr2</code>, <code class="vardecl">tmp</code>, <code class="vardecl">dvx</code>, <code class="vardecl">dvy</code>, <code class="vardecl">dvz</code></a>
<a name="leftrightstate_spatial_di6"></a>    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rl1d</code>, <code class="vardecl">rl2d</code>, <code class="vardecl">rr1d</code>, <code class="vardecl">rr2d</code>, <code class="vardecl">tmpd</code>, <code class="vardecl">dvxd</code>, <code class="vardecl">dvyd</code>, <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="label">&    </code><code class="vardecl">dvzd</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei6" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">3</code>, <code class="constant">3</code><code class="typename">) </code>:: <code class="vardecl">rot</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(<code class="constant">3</code>, <code class="constant">3</code>) :: <code class="vardecl">rotd</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x6d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y4d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max2d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max5d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x6</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SIGN</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x5</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x4</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x3</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x5d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y3d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max4d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max7d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x4d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y2d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max3d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max7</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max6</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max6d</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max5</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max4</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max3</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y4</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y3</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y2</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x3d</code></a>
<a name="leftrightstate_spatial_di7"></a>    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y1</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y1d</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="comment">!        * Begin execution.                                             *</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="comment">! Check if the velocity components should be transformed to</code></a>
<a name="leftrightstate_spatial_di8"></a><a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="comment">! the cylindrical frame.</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="keyword">IF</code> (rotationalperiodic) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei8" target="origFile"><code class="comment">! Store the rotation matrix a bit easier. Note that the i,j,k</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei8" target="origFile"><code class="comment">! come from the main subroutine.</code></a>
<a name="leftrightstate_spatial_di9"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei8" target="origFile">rotd(<code class="constant">1</code>, <code class="constant">1</code>) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei8" target="origFile">rot(<code class="constant">1</code>, <code class="constant">1</code>) = rotmatrix(i, j, k, <code class="constant">1</code>, <code class="constant">1</code>)</a>
<a name="leftrightstate_spatial_di10"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei9" target="origFile">rotd(<code class="constant">1</code>, <code class="constant">2</code>) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei9" target="origFile">rot(<code class="constant">1</code>, <code class="constant">2</code>) = rotmatrix(i, j, k, <code class="constant">1</code>, <code class="constant">2</code>)</a>
<a name="leftrightstate_spatial_di11"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei10" target="origFile">rotd(<code class="constant">1</code>, <code class="constant">3</code>) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei10" target="origFile">rot(<code class="constant">1</code>, <code class="constant">3</code>) = rotmatrix(i, j, k, <code class="constant">1</code>, <code class="constant">3</code>)</a>
<a name="leftrightstate_spatial_di12"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei11" target="origFile">rotd(<code class="constant">2</code>, <code class="constant">1</code>) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei11" target="origFile">rot(<code class="constant">2</code>, <code class="constant">1</code>) = rotmatrix(i, j, k, <code class="constant">2</code>, <code class="constant">1</code>)</a>
<a name="leftrightstate_spatial_di13"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei12" target="origFile">rotd(<code class="constant">2</code>, <code class="constant">2</code>) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei12" target="origFile">rot(<code class="constant">2</code>, <code class="constant">2</code>) = rotmatrix(i, j, k, <code class="constant">2</code>, <code class="constant">2</code>)</a>
<a name="leftrightstate_spatial_di14"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei13" target="origFile">rotd(<code class="constant">2</code>, <code class="constant">3</code>) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei13" target="origFile">rot(<code class="constant">2</code>, <code class="constant">3</code>) = rotmatrix(i, j, k, <code class="constant">2</code>, <code class="constant">3</code>)</a>
<a name="leftrightstate_spatial_di15"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei14" target="origFile">rotd(<code class="constant">3</code>, <code class="constant">1</code>) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei14" target="origFile">rot(<code class="constant">3</code>, <code class="constant">1</code>) = rotmatrix(i, j, k, <code class="constant">3</code>, <code class="constant">1</code>)</a>
<a name="leftrightstate_spatial_di16"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei15" target="origFile">rotd(<code class="constant">3</code>, <code class="constant">2</code>) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei15" target="origFile">rot(<code class="constant">3</code>, <code class="constant">2</code>) = rotmatrix(i, j, k, <code class="constant">3</code>, <code class="constant">2</code>)</a>
<a name="leftrightstate_spatial_di17"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei16" target="origFile">rotd(<code class="constant">3</code>, <code class="constant">3</code>) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei16" target="origFile">rot(<code class="constant">3</code>, <code class="constant">3</code>) = rotmatrix(i, j, k, <code class="constant">3</code>, <code class="constant">3</code>)</a>
<a href="inviscidupwindflux_p.html#leftrightstatei17" target="origFile"><code class="comment">! Apply the transformation to the velocity components</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei17" target="origFile"><code class="comment">! of du1, du2 and du3.</code></a>
<a name="leftrightstate_spatial_di18"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei17" target="origFile">dvxd = du1d(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei17" target="origFile">dvx = du1(ivx)</a>
<a name="leftrightstate_spatial_di19"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei18" target="origFile">dvyd = du1d(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei18" target="origFile">dvy = du1(ivy)</a>
<a name="leftrightstate_spatial_di20"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei19" target="origFile">dvzd = du1d(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei19" target="origFile">dvz = du1(ivz)</a>
<a name="leftrightstate_spatial_di21"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei20" target="origFile">du1d(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei20" target="origFile">du1(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstate_spatial_di22"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei21" target="origFile">du1d(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei21" target="origFile">du1(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstate_spatial_di23"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei22" target="origFile">du1d(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei22" target="origFile">du1(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstate_spatial_di24"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei23" target="origFile">dvxd = du2d(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei23" target="origFile">dvx = du2(ivx)</a>
<a name="leftrightstate_spatial_di25"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei24" target="origFile">dvyd = du2d(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei24" target="origFile">dvy = du2(ivy)</a>
<a name="leftrightstate_spatial_di26"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei25" target="origFile">dvzd = du2d(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei25" target="origFile">dvz = du2(ivz)</a>
<a name="leftrightstate_spatial_di27"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei26" target="origFile">du2d(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei26" target="origFile">du2(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstate_spatial_di28"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei27" target="origFile">du2d(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei27" target="origFile">du2(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstate_spatial_di29"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei28" target="origFile">du2d(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei28" target="origFile">du2(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstate_spatial_di30"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei29" target="origFile">dvxd = du3d(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei29" target="origFile">dvx = du3(ivx)</a>
<a name="leftrightstate_spatial_di31"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei30" target="origFile">dvyd = du3d(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei30" target="origFile">dvy = du3(ivy)</a>
<a name="leftrightstate_spatial_di32"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei31" target="origFile">dvzd = du3d(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei31" target="origFile">dvz = du3(ivz)</a>
<a name="leftrightstate_spatial_di33"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei32" target="origFile">du3d(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei32" target="origFile">du3(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstate_spatial_di34"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei33" target="origFile">du3d(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei33" target="origFile">du3(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei34" target="origFile">du3d(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvzd</a>
<a name="leftrightstate_spatial_di35"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei34" target="origFile">du3(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
    <a href="inviscidupwindflux_p.html#leftrightstatei7" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei35" target="origFile"><code class="comment">! Determine the limiter used.</code></a>
<a name="leftrightstate_spatial_di36"></a>    <a href="inviscidupwindflux_p.html#leftrightstatei35" target="origFile"><code class="keyword">SELECT CASE </code> (limused) </a>
    <a href="inviscidupwindflux_p.html#leftrightstatei35" target="origFile"><code class="keyword">CASE </code>(nolimiter) </a>
<a href="inviscidupwindflux_p.html#leftrightstatei36" target="origFile"><code class="comment">! Linear interpolation; no limiter.</code></a>
<a name="leftrightstate_spatial_di37"></a><a href="inviscidupwindflux_p.html#leftrightstatei36" target="origFile"><code class="comment">! Loop over the number of variables to be interpolated.</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei36" target="origFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,nwint</a>
<a name="leftrightstate_spatial_di38"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei37" target="origFile">leftd(l) = omk*du1d(l) + opk*du2d(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei37" target="origFile">left(l) = omk*du1(l) + opk*du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei38" target="origFile">rightd(l) = -(omk*du3d(l)) - opk*du2d(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei38" target="origFile">right(l) = -(omk*du3(l)) - opk*du2(l)</a>
<a name="leftrightstate_spatial_di39"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei36" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei35" target="origFile"><code class="keyword">CASE </code>(vanalbeda) </a>
<a href="inviscidupwindflux_p.html#leftrightstatei39" target="origFile"><code class="comment">!          ==============================================================</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei39" target="origFile"><code class="comment">! Nonlinear interpolation using the van albeda limiter.</code></a>
<a name="leftrightstate_spatial_di40"></a><a href="inviscidupwindflux_p.html#leftrightstatei39" target="origFile"><code class="comment">! Loop over the number of variables to be interpolated.</code></a>
<a name="leftrightstate_spatial_di42"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei39" target="origFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,nwint</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei40" target="origFile"><code class="keyword">IF</code> (du2(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei42" target="origFile">x1d = du2d(l)</a>
<a name="leftrightstate_spatial_di41"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei42" target="origFile">x1 = du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei40" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei41" target="origFile">x1d = -du2d(l)</a>
<a name="leftrightstate_spatial_di43"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei41" target="origFile">x1 = -du2(l)</a>
<a name="leftrightstate_spatial_di44"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei40" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei43" target="origFile"><code class="keyword">IF</code> (x1 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei44" target="origFile">max2 = epslim</a>
<a name="leftrightstate_spatial_di45"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei43" target="origFile">max2d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei43" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei45" target="origFile">max2d = x1d</a>
<a name="leftrightstate_spatial_di46"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei45" target="origFile">max2 = x1</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei43" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei46" target="origFile"><code class="comment">! Compute the limiter argument rl1, rl2, rr1 and rr2.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei46" target="origFile"><code class="comment">! Note the cut off to 0.0.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei46" target="origFile">tmpd = -(one*max2d*<code class="funcname">SIGN</code>(<code class="constant">1.d0</code>, max2*du2(l))/<code class="funcname">SIGN</code>(max2, du2(l))**<code class="constant">2</code><code class="label">&</code></a>
<a name="leftrightstate_spatial_di47"></a><a href="inviscidupwindflux_p.html#leftrightstatei46" target="origFile"><code class="label">&          </code>)</a>
<a name="leftrightstate_spatial_di49"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei46" target="origFile">tmp = one/<code class="funcname">SIGN</code>(max2, du2(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei47" target="origFile"><code class="keyword">IF</code> (du1(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei49" target="origFile">x3d = du1d(l)</a>
<a name="leftrightstate_spatial_di48"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei49" target="origFile">x3 = du1(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei47" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei48" target="origFile">x3d = -du1d(l)</a>
<a name="leftrightstate_spatial_di50"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei48" target="origFile">x3 = -du1(l)</a>
<a name="leftrightstate_spatial_di51"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei47" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei50" target="origFile"><code class="keyword">IF</code> (x3 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei51" target="origFile">max4 = epslim</a>
<a name="leftrightstate_spatial_di52"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei50" target="origFile">max4d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei50" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei52" target="origFile">max4d = x3d</a>
<a name="leftrightstate_spatial_di53"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei52" target="origFile">max4 = x3</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei50" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei53" target="origFile">y1d = (du2d(l)*<code class="funcname">SIGN</code>(max4, du1(l))-du2(l)*max4d*<code class="funcname">SIGN</code>(<code class="constant">1.d0</code>, max4*<code class="label">&</code></a>
<a name="leftrightstate_spatial_di54"></a><a href="inviscidupwindflux_p.html#leftrightstatei53" target="origFile"><code class="label">&          </code>du1(l)))/<code class="funcname">SIGN</code>(max4, du1(l))**<code class="constant">2</code></a>
<a name="leftrightstate_spatial_di55"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei53" target="origFile">y1 = du2(l)/<code class="funcname">SIGN</code>(max4, du1(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei54" target="origFile"><code class="keyword">IF</code> (zero .LT. y1) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei55" target="origFile">rl1d = y1d</a>
<a name="leftrightstate_spatial_di56"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei55" target="origFile">rl1 = y1</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei54" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei56" target="origFile">rl1 = zero</a>
<a name="leftrightstate_spatial_di57"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei54" target="origFile">rl1d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di59"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei54" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei57" target="origFile"><code class="keyword">IF</code> (zero .LT. du1(l)*tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei59" target="origFile">rl2d = du1d(l)*tmp + du1(l)*tmpd</a>
<a name="leftrightstate_spatial_di58"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei59" target="origFile">rl2 = du1(l)*tmp</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei57" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei58" target="origFile">rl2 = zero</a>
<a name="leftrightstate_spatial_di60"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei57" target="origFile">rl2d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di62"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei57" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei60" target="origFile"><code class="keyword">IF</code> (zero .LT. du3(l)*tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei62" target="origFile">rr1d = du3d(l)*tmp + du3(l)*tmpd</a>
<a name="leftrightstate_spatial_di61"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei62" target="origFile">rr1 = du3(l)*tmp</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei60" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei61" target="origFile">rr1 = zero</a>
<a name="leftrightstate_spatial_di63"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei60" target="origFile">rr1d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di65"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei60" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei63" target="origFile"><code class="keyword">IF</code> (du3(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei65" target="origFile">x4d = du3d(l)</a>
<a name="leftrightstate_spatial_di64"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei65" target="origFile">x4 = du3(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei63" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei64" target="origFile">x4d = -du3d(l)</a>
<a name="leftrightstate_spatial_di66"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei64" target="origFile">x4 = -du3(l)</a>
<a name="leftrightstate_spatial_di67"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei63" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei66" target="origFile"><code class="keyword">IF</code> (x4 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei67" target="origFile">max5 = epslim</a>
<a name="leftrightstate_spatial_di68"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei66" target="origFile">max5d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei66" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei68" target="origFile">max5d = x4d</a>
<a name="leftrightstate_spatial_di69"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei68" target="origFile">max5 = x4</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei66" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei69" target="origFile">y2d = (du2d(l)*<code class="funcname">SIGN</code>(max5, du3(l))-du2(l)*max5d*<code class="funcname">SIGN</code>(<code class="constant">1.d0</code>, max5*<code class="label">&</code></a>
<a name="leftrightstate_spatial_di70"></a><a href="inviscidupwindflux_p.html#leftrightstatei69" target="origFile"><code class="label">&          </code>du3(l)))/<code class="funcname">SIGN</code>(max5, du3(l))**<code class="constant">2</code></a>
<a name="leftrightstate_spatial_di71"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei69" target="origFile">y2 = du2(l)/<code class="funcname">SIGN</code>(max5, du3(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei70" target="origFile"><code class="keyword">IF</code> (zero .LT. y2) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei71" target="origFile">rr2d = y2d</a>
<a name="leftrightstate_spatial_di72"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei71" target="origFile">rr2 = y2</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei70" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei72" target="origFile">rr2 = zero</a>
<a name="leftrightstate_spatial_di73"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei70" target="origFile">rr2d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei70" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei73" target="origFile"><code class="comment">! Compute the corresponding limiter values.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei73" target="origFile">rl1d = ((rl1d*(rl1+one)+rl1*rl1d)*(rl1*rl1+one)-rl1*(rl1+one)*(<code class="label">&</code></a>
<a name="leftrightstate_spatial_di74"></a><a href="inviscidupwindflux_p.html#leftrightstatei73" target="origFile"><code class="label">&          </code>rl1d*rl1+rl1*rl1d))/(rl1*rl1+one)**<code class="constant">2</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei73" target="origFile">rl1 = rl1*(rl1+one)/(rl1*rl1+one)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei74" target="origFile">rl2d = ((rl2d*(rl2+one)+rl2*rl2d)*(rl2*rl2+one)-rl2*(rl2+one)*(<code class="label">&</code></a>
<a name="leftrightstate_spatial_di75"></a><a href="inviscidupwindflux_p.html#leftrightstatei74" target="origFile"><code class="label">&          </code>rl2d*rl2+rl2*rl2d))/(rl2*rl2+one)**<code class="constant">2</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei74" target="origFile">rl2 = rl2*(rl2+one)/(rl2*rl2+one)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei75" target="origFile">rr1d = ((rr1d*(rr1+one)+rr1*rr1d)*(rr1*rr1+one)-rr1*(rr1+one)*(<code class="label">&</code></a>
<a name="leftrightstate_spatial_di76"></a><a href="inviscidupwindflux_p.html#leftrightstatei75" target="origFile"><code class="label">&          </code>rr1d*rr1+rr1*rr1d))/(rr1*rr1+one)**<code class="constant">2</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei75" target="origFile">rr1 = rr1*(rr1+one)/(rr1*rr1+one)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei76" target="origFile">rr2d = ((rr2d*(rr2+one)+rr2*rr2d)*(rr2*rr2+one)-rr2*(rr2+one)*(<code class="label">&</code></a>
<a name="leftrightstate_spatial_di77"></a><a href="inviscidupwindflux_p.html#leftrightstatei76" target="origFile"><code class="label">&          </code>rr2d*rr2+rr2*rr2d))/(rr2*rr2+one)**<code class="constant">2</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei76" target="origFile">rr2 = rr2*(rr2+one)/(rr2*rr2+one)</a>
<a href="inviscidupwindflux_p.html#leftrightstatei77" target="origFile"><code class="comment">! Compute the nonlinear corrections to the first order</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei77" target="origFile"><code class="comment">! scheme.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei77" target="origFile">leftd(l) = omk*(rl1d*du1(l)+rl1*du1d(l)) + opk*(rl2d*du2(l)+rl2*<code class="label">&</code></a>
<a name="leftrightstate_spatial_di78"></a><a href="inviscidupwindflux_p.html#leftrightstatei77" target="origFile"><code class="label">&          </code>du2d(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei77" target="origFile">left(l) = omk*rl1*du1(l) + opk*rl2*du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei78" target="origFile">rightd(l) = -(opk*(rr1d*du2(l)+rr1*du2d(l))) - omk*(rr2d*du3(l)+<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei78" target="origFile"><code class="label">&          </code>rr2*du3d(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei78" target="origFile">right(l) = -(opk*rr1*du2(l)) - omk*rr2*du3(l)</a>
<a name="leftrightstate_spatial_di79"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei39" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei35" target="origFile"><code class="keyword">CASE </code>(minmod) </a>
<a href="inviscidupwindflux_p.html#leftrightstatei79" target="origFile"><code class="comment">!          ==============================================================</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei79" target="origFile"><code class="comment">! Nonlinear interpolation using the minmod limiter.</code></a>
<a name="leftrightstate_spatial_di80"></a><a href="inviscidupwindflux_p.html#leftrightstatei79" target="origFile"><code class="comment">! Loop over the number of variables to be interpolated.</code></a>
<a name="leftrightstate_spatial_di82"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei79" target="origFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,nwint</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei80" target="origFile"><code class="keyword">IF</code> (du2(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei82" target="origFile">x2d = du2d(l)</a>
<a name="leftrightstate_spatial_di81"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei82" target="origFile">x2 = du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei80" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei81" target="origFile">x2d = -du2d(l)</a>
<a name="leftrightstate_spatial_di83"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei81" target="origFile">x2 = -du2(l)</a>
<a name="leftrightstate_spatial_di84"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei80" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei83" target="origFile"><code class="keyword">IF</code> (x2 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei84" target="origFile">max3 = epslim</a>
<a name="leftrightstate_spatial_di85"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei83" target="origFile">max3d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei83" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei85" target="origFile">max3d = x2d</a>
<a name="leftrightstate_spatial_di86"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei85" target="origFile">max3 = x2</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei83" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei86" target="origFile"><code class="comment">! Compute the limiter argument rl1, rl2, rr1 and rr2.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei86" target="origFile"><code class="comment">! Note the cut off to 0.0.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei86" target="origFile">tmpd = -(one*max3d*<code class="funcname">SIGN</code>(<code class="constant">1.d0</code>, max3*du2(l))/<code class="funcname">SIGN</code>(max3, du2(l))**<code class="constant">2</code><code class="label">&</code></a>
<a name="leftrightstate_spatial_di87"></a><a href="inviscidupwindflux_p.html#leftrightstatei86" target="origFile"><code class="label">&          </code>)</a>
<a name="leftrightstate_spatial_di89"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei86" target="origFile">tmp = one/<code class="funcname">SIGN</code>(max3, du2(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei87" target="origFile"><code class="keyword">IF</code> (du1(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei89" target="origFile">x5d = du1d(l)</a>
<a name="leftrightstate_spatial_di88"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei89" target="origFile">x5 = du1(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei87" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei88" target="origFile">x5d = -du1d(l)</a>
<a name="leftrightstate_spatial_di90"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei88" target="origFile">x5 = -du1(l)</a>
<a name="leftrightstate_spatial_di91"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei87" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei90" target="origFile"><code class="keyword">IF</code> (x5 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei91" target="origFile">max6 = epslim</a>
<a name="leftrightstate_spatial_di92"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei90" target="origFile">max6d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei90" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei92" target="origFile">max6d = x5d</a>
<a name="leftrightstate_spatial_di93"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei92" target="origFile">max6 = x5</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei90" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei93" target="origFile">y3d = (du2d(l)*<code class="funcname">SIGN</code>(max6, du1(l))-du2(l)*max6d*<code class="funcname">SIGN</code>(<code class="constant">1.d0</code>, max6*<code class="label">&</code></a>
<a name="leftrightstate_spatial_di94"></a><a href="inviscidupwindflux_p.html#leftrightstatei93" target="origFile"><code class="label">&          </code>du1(l)))/<code class="funcname">SIGN</code>(max6, du1(l))**<code class="constant">2</code></a>
<a name="leftrightstate_spatial_di95"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei93" target="origFile">y3 = du2(l)/<code class="funcname">SIGN</code>(max6, du1(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei94" target="origFile"><code class="keyword">IF</code> (zero .LT. y3) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei95" target="origFile">rl1d = y3d</a>
<a name="leftrightstate_spatial_di96"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei95" target="origFile">rl1 = y3</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei94" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei96" target="origFile">rl1 = zero</a>
<a name="leftrightstate_spatial_di97"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei94" target="origFile">rl1d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di99"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei94" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei97" target="origFile"><code class="keyword">IF</code> (zero .LT. du1(l)*tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei99" target="origFile">rl2d = du1d(l)*tmp + du1(l)*tmpd</a>
<a name="leftrightstate_spatial_di98"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei99" target="origFile">rl2 = du1(l)*tmp</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei97" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei98" target="origFile">rl2 = zero</a>
<a name="leftrightstate_spatial_di100"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei97" target="origFile">rl2d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di102"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei97" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei100" target="origFile"><code class="keyword">IF</code> (zero .LT. du3(l)*tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei102" target="origFile">rr1d = du3d(l)*tmp + du3(l)*tmpd</a>
<a name="leftrightstate_spatial_di101"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei102" target="origFile">rr1 = du3(l)*tmp</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei100" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei101" target="origFile">rr1 = zero</a>
<a name="leftrightstate_spatial_di103"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei100" target="origFile">rr1d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di105"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei100" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei103" target="origFile"><code class="keyword">IF</code> (du3(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei105" target="origFile">x6d = du3d(l)</a>
<a name="leftrightstate_spatial_di104"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei105" target="origFile">x6 = du3(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei103" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei104" target="origFile">x6d = -du3d(l)</a>
<a name="leftrightstate_spatial_di106"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei104" target="origFile">x6 = -du3(l)</a>
<a name="leftrightstate_spatial_di107"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei103" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei106" target="origFile"><code class="keyword">IF</code> (x6 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei107" target="origFile">max7 = epslim</a>
<a name="leftrightstate_spatial_di108"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei106" target="origFile">max7d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei106" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei108" target="origFile">max7d = x6d</a>
<a name="leftrightstate_spatial_di109"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei108" target="origFile">max7 = x6</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei106" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei109" target="origFile">y4d = (du2d(l)*<code class="funcname">SIGN</code>(max7, du3(l))-du2(l)*max7d*<code class="funcname">SIGN</code>(<code class="constant">1.d0</code>, max7*<code class="label">&</code></a>
<a name="leftrightstate_spatial_di110"></a><a href="inviscidupwindflux_p.html#leftrightstatei109" target="origFile"><code class="label">&          </code>du3(l)))/<code class="funcname">SIGN</code>(max7, du3(l))**<code class="constant">2</code></a>
<a name="leftrightstate_spatial_di111"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei109" target="origFile">y4 = du2(l)/<code class="funcname">SIGN</code>(max7, du3(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei110" target="origFile"><code class="keyword">IF</code> (zero .LT. y4) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei111" target="origFile">rr2d = y4d</a>
<a name="leftrightstate_spatial_di112"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei111" target="origFile">rr2 = y4</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei110" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei112" target="origFile">rr2 = zero</a>
<a name="leftrightstate_spatial_di113"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei110" target="origFile">rr2d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di115"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei110" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei113" target="origFile"><code class="keyword">IF</code> (one .GT. factminmod*rl1) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei115" target="origFile">rl1d = factminmod*rl1d</a>
<a name="leftrightstate_spatial_di114"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei115" target="origFile">rl1 = factminmod*rl1</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei113" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei114" target="origFile">rl1 = one</a>
<a name="leftrightstate_spatial_di116"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei113" target="origFile">rl1d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di118"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei113" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei116" target="origFile"><code class="keyword">IF</code> (one .GT. factminmod*rl2) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei118" target="origFile">rl2d = factminmod*rl2d</a>
<a name="leftrightstate_spatial_di117"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei118" target="origFile">rl2 = factminmod*rl2</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei116" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei117" target="origFile">rl2 = one</a>
<a name="leftrightstate_spatial_di119"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei116" target="origFile">rl2d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di121"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei116" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei119" target="origFile"><code class="keyword">IF</code> (one .GT. factminmod*rr1) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei121" target="origFile">rr1d = factminmod*rr1d</a>
<a name="leftrightstate_spatial_di120"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei121" target="origFile">rr1 = factminmod*rr1</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei119" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei120" target="origFile">rr1 = one</a>
<a name="leftrightstate_spatial_di122"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei119" target="origFile">rr1d = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di124"></a>        <a href="inviscidupwindflux_p.html#leftrightstatei119" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei122" target="origFile"><code class="keyword">IF</code> (one .GT. factminmod*rr2) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei124" target="origFile">rr2d = factminmod*rr2d</a>
<a name="leftrightstate_spatial_di123"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei124" target="origFile">rr2 = factminmod*rr2</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei122" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstatei123" target="origFile">rr2 = one</a>
<a name="leftrightstate_spatial_di125"></a>          <a href="inviscidupwindflux_p.html#leftrightstatei122" target="origFile">rr2d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei122" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei125" target="origFile"><code class="comment">! Compute the nonlinear corrections to the first order</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei125" target="origFile"><code class="comment">! scheme.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstatei125" target="origFile">leftd(l) = omk*(rl1d*du1(l)+rl1*du1d(l)) + opk*(rl2d*du2(l)+rl2*<code class="label">&</code></a>
<a name="leftrightstate_spatial_di126"></a><a href="inviscidupwindflux_p.html#leftrightstatei125" target="origFile"><code class="label">&          </code>du2d(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei125" target="origFile">left(l) = omk*rl1*du1(l) + opk*rl2*du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei126" target="origFile">rightd(l) = -(opk*(rr1d*du2(l)+rr1*du2d(l))) - omk*(rr2d*du3(l)+<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei126" target="origFile"><code class="label">&          </code>rr2*du3d(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstatei126" target="origFile">right(l) = -(opk*rr1*du2(l)) - omk*rr2*du3(l)</a>
<a name="leftrightstate_spatial_di127"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei79" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei35" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei127" target="origFile"><code class="comment">! In case only a first order scheme must be used for the</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei127" target="origFile"><code class="comment">! turbulent transport equations, set the correction for the</code></a>
<a name="leftrightstate_spatial_di128"></a><a href="inviscidupwindflux_p.html#leftrightstatei127" target="origFile"><code class="comment">! turbulent kinetic energy to 0.</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei127" target="origFile"><code class="keyword">IF</code> (firstorderk) <code class="keyword">THEN</code></a>
<a name="leftrightstate_spatial_di129"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei128" target="origFile">leftd(itu1) = <code class="constant">0.0</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstatei128" target="origFile">left(itu1) = zero</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei129" target="origFile">rightd(itu1) = <code class="constant">0.0</code></a>
<a name="leftrightstate_spatial_di130"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei129" target="origFile">right(itu1) = zero</a>
    <a href="inviscidupwindflux_p.html#leftrightstatei127" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei130" target="origFile"><code class="comment">! For rotational periodic problems transform the velocity</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei130" target="origFile"><code class="comment">! differences back to Cartesian again. Note that now the</code></a>
<a name="leftrightstate_spatial_di131"></a><a href="inviscidupwindflux_p.html#leftrightstatei130" target="origFile"><code class="comment">! transpose of the rotation matrix must be used.</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstatei130" target="origFile"><code class="keyword">IF</code> (rotationalperiodic) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux_p.html#leftrightstatei131" target="origFile"><code class="comment">! Left state.</code></a>
<a name="leftrightstate_spatial_di132"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei131" target="origFile">dvxd = leftd(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei131" target="origFile">dvx = left(ivx)</a>
<a name="leftrightstate_spatial_di133"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei132" target="origFile">dvyd = leftd(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei132" target="origFile">dvy = left(ivy)</a>
<a name="leftrightstate_spatial_di134"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei133" target="origFile">dvzd = leftd(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei133" target="origFile">dvz = left(ivz)</a>
<a name="leftrightstate_spatial_di135"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei134" target="origFile">leftd(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvyd + rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei134" target="origFile">left(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvz</a>
<a name="leftrightstate_spatial_di136"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei135" target="origFile">leftd(ivy) = rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvxd + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei135" target="origFile">left(ivy) = rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvz</a>
<a name="leftrightstate_spatial_di137"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei136" target="origFile">leftd(ivz) = rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvxd + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvyd + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei136" target="origFile">left(ivz) = rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a href="inviscidupwindflux_p.html#leftrightstatei137" target="origFile"><code class="comment">! Right state.</code></a>
<a name="leftrightstate_spatial_di138"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei137" target="origFile">dvxd = rightd(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei137" target="origFile">dvx = right(ivx)</a>
<a name="leftrightstate_spatial_di139"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei138" target="origFile">dvyd = rightd(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei138" target="origFile">dvy = right(ivy)</a>
<a name="leftrightstate_spatial_di140"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei139" target="origFile">dvzd = rightd(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei139" target="origFile">dvz = right(ivz)</a>
<a name="leftrightstate_spatial_di141"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei140" target="origFile">rightd(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvxd + rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvyd + rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei140" target="origFile">right(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvz</a>
<a name="leftrightstate_spatial_di142"></a>      <a href="inviscidupwindflux_p.html#leftrightstatei141" target="origFile">rightd(ivy) = rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvxd + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvyd + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei141" target="origFile">right(ivy) = rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei142" target="origFile">rightd(ivz) = rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvxd + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvyd + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvzd</a>
      <a href="inviscidupwindflux_p.html#leftrightstatei142" target="origFile">right(ivz) = rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstate"></a>    <a href="inviscidupwindflux_p.html#leftrightstatei130" target="origFile"><code class="keyword">END IF</code></a>
  <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">LEFTRIGHTSTATE_SPATIAL_D</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!      ==================================================================</code></a>
  <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">LEFTRIGHTSTATE</code>(<code class="vardecl">du1</code>, <code class="vardecl">du2</code>, <code class="vardecl">du3</code>, <code class="vardecl">rotmatrix</code>, <code class="vardecl">left</code>, <code class="vardecl">right</code>)</a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!        Local parameter.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">epslim</code>=<code class="constant">1.e-10_realType</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!        Subroutine arguments.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">du1</code>, <code class="vardecl">du2</code>, <code class="vardecl">du3</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">left</code>, <code class="vardecl">right</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rotmatrix</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!        Local variables.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">l</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rl1</code>, <code class="vardecl">rl2</code>, <code class="vardecl">rr1</code>, <code class="vardecl">rr2</code>, <code class="vardecl">tmp</code>, <code class="vardecl">dvx</code>, <code class="vardecl">dvy</code>, <code class="vardecl">dvz</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">3</code>, <code class="constant">3</code><code class="typename">) </code>:: <code class="vardecl">rot</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x6</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SIGN</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x5</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x4</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x3</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max7</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max6</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max5</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max4</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max3</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y4</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y3</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y2</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y1</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!        * Begin execution.                                             *</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Check if the velocity components should be transformed to</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! the cylindrical frame.</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (rotationalperiodic) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Store the rotation matrix a bit easier. Note that the i,j,k</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! come from the main subroutine.</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rot(<code class="constant">1</code>, <code class="constant">1</code>) = rotmatrix(i, j, k, <code class="constant">1</code>, <code class="constant">1</code>)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rot(<code class="constant">1</code>, <code class="constant">2</code>) = rotmatrix(i, j, k, <code class="constant">1</code>, <code class="constant">2</code>)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rot(<code class="constant">1</code>, <code class="constant">3</code>) = rotmatrix(i, j, k, <code class="constant">1</code>, <code class="constant">3</code>)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rot(<code class="constant">2</code>, <code class="constant">1</code>) = rotmatrix(i, j, k, <code class="constant">2</code>, <code class="constant">1</code>)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rot(<code class="constant">2</code>, <code class="constant">2</code>) = rotmatrix(i, j, k, <code class="constant">2</code>, <code class="constant">2</code>)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rot(<code class="constant">2</code>, <code class="constant">3</code>) = rotmatrix(i, j, k, <code class="constant">2</code>, <code class="constant">3</code>)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rot(<code class="constant">3</code>, <code class="constant">1</code>) = rotmatrix(i, j, k, <code class="constant">3</code>, <code class="constant">1</code>)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rot(<code class="constant">3</code>, <code class="constant">2</code>) = rotmatrix(i, j, k, <code class="constant">3</code>, <code class="constant">2</code>)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rot(<code class="constant">3</code>, <code class="constant">3</code>) = rotmatrix(i, j, k, <code class="constant">3</code>, <code class="constant">3</code>)</a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Apply the transformation to the velocity components</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! of du1, du2 and du3.</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvx = du1(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvy = du1(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvz = du1(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">du1(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">du1(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">du1(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvx = du2(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvy = du2(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvz = du2(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">du2(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">du2(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">du2(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvx = du3(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvy = du3(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvz = du3(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">du3(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">du3(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">du3(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Determine the limiter used.</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">SELECT CASE </code> (limused) </a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">CASE </code>(nolimiter) </a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Linear interpolation; no limiter.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Loop over the number of variables to be interpolated.</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,nwint</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">left(l) = omk*du1(l) + opk*du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">right(l) = -(omk*du3(l)) - opk*du2(l)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">CASE </code>(vanalbeda) </a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!          ==============================================================</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Nonlinear interpolation using the van albeda limiter.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Loop over the number of variables to be interpolated.</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,nwint</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (du2(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x1 = du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x1 = -du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (x1 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max2 = epslim</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max2 = x1</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Compute the limiter argument rl1, rl2, rr1 and rr2.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Note the cut off to 0.0.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">tmp = one/<code class="funcname">SIGN</code>(max2, du2(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (du1(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x3 = du1(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x3 = -du1(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (x3 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max4 = epslim</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max4 = x3</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">y1 = du2(l)/<code class="funcname">SIGN</code>(max4, du1(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (zero .LT. y1) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl1 = y1</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl1 = zero</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (zero .LT. du1(l)*tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl2 = du1(l)*tmp</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl2 = zero</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (zero .LT. du3(l)*tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr1 = du3(l)*tmp</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr1 = zero</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (du3(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x4 = du3(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x4 = -du3(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (x4 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max5 = epslim</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max5 = x4</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">y2 = du2(l)/<code class="funcname">SIGN</code>(max5, du3(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (zero .LT. y2) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr2 = y2</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr2 = zero</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Compute the corresponding limiter values.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl1 = rl1*(rl1+one)/(rl1*rl1+one)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl2 = rl2*(rl2+one)/(rl2*rl2+one)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr1 = rr1*(rr1+one)/(rr1*rr1+one)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr2 = rr2*(rr2+one)/(rr2*rr2+one)</a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Compute the nonlinear corrections to the first order</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! scheme.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">left(l) = omk*rl1*du1(l) + opk*rl2*du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">right(l) = -(opk*rr1*du2(l)) - omk*rr2*du3(l)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">CASE </code>(minmod) </a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">!          ==============================================================</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Nonlinear interpolation using the minmod limiter.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Loop over the number of variables to be interpolated.</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,nwint</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (du2(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x2 = du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x2 = -du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (x2 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max3 = epslim</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max3 = x2</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Compute the limiter argument rl1, rl2, rr1 and rr2.</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Note the cut off to 0.0.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">tmp = one/<code class="funcname">SIGN</code>(max3, du2(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (du1(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x5 = du1(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x5 = -du1(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (x5 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max6 = epslim</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max6 = x5</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">y3 = du2(l)/<code class="funcname">SIGN</code>(max6, du1(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (zero .LT. y3) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl1 = y3</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl1 = zero</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (zero .LT. du1(l)*tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl2 = du1(l)*tmp</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl2 = zero</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (zero .LT. du3(l)*tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr1 = du3(l)*tmp</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr1 = zero</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (du3(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x6 = du3(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">x6 = -du3(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (x6 .LT. epslim) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max7 = epslim</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">max7 = x6</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">y4 = du2(l)/<code class="funcname">SIGN</code>(max7, du3(l))</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (zero .LT. y4) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr2 = y4</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr2 = zero</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (one .GT. factminmod*rl1) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl1 = factminmod*rl1</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl1 = one</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (one .GT. factminmod*rl2) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl2 = factminmod*rl2</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rl2 = one</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (one .GT. factminmod*rr1) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr1 = factminmod*rr1</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr1 = one</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (one .GT. factminmod*rr2) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr2 = factminmod*rr2</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">rr2 = one</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Compute the nonlinear corrections to the first order</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! scheme.</code></a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">left(l) = omk*rl1*du1(l) + opk*rl2*du2(l)</a>
        <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">right(l) = -(opk*rr1*du2(l)) - omk*rr2*du3(l)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! In case only a first order scheme must be used for the</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! turbulent transport equations, set the correction for the</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! turbulent kinetic energy to 0.</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (firstorderk) <code class="keyword">THEN</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">left(itu1) = zero</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">right(itu1) = zero</a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! For rotational periodic problems transform the velocity</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! differences back to Cartesian again. Note that now the</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! transpose of the rotation matrix must be used.</code></a>
    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">IF</code> (rotationalperiodic) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Left state.</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvx = left(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvy = left(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvz = left(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">left(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">left(ivy) = rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">left(ivz) = rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="comment">! Right state.</code></a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvx = right(ivx)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvy = right(ivy)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">dvz = right(ivz)</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">right(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">right(ivy) = rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvz</a>
      <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile">right(ivz) = rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a name="riemannflux_spatial_d"></a>    <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END IF</code></a>
  <a href="inviscidupwindflux_p.html#leftrightstate" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">LEFTRIGHTSTATE</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!  Differentiation of riemannflux in forward (tangent) mode:</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!   variations   of useful results: flux</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!   with respect to varying inputs: flux left right</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!        ================================================================</code></a>
  <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">RIEMANNFLUX_SPATIAL_D</code>(<code class="vardecl">left</code>, <code class="vardecl">leftd</code>, <code class="vardecl">right</code>, <code class="vardecl">rightd</code>, <code class="vardecl">flux</code>, <code class="label">&</code></a>
<a name="riemannflux_spatial_di0"></a><a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="label">&    </code><code class="vardecl">fluxd</code>)</a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi0" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi0" target="origFile"><code class="comment">!        Subroutine arguments.</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi0" target="origFile"><code class="comment">!</code></a>
<a name="riemannflux_spatial_di1"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi0" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="keyword">*</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">left</code>, <code class="vardecl">right</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(<code class="keyword">*</code>), <code class="typename">INTENT(IN) </code>:: <code class="vardecl">leftd</code>, <code class="vardecl">rightd</code></a>
<a name="riemannflux_spatial_di2"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi1" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="keyword">*</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(<code class="keyword">*</code>), <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">fluxd</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi2" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi2" target="origFile"><code class="comment">!        Local variables.</code></a>
<a name="riemannflux_spatial_di3"></a><a href="inviscidupwindflux_p.html#riemannfluxi2" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#riemannfluxi2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">porflux</code>, <code class="vardecl">rface</code></a>
<a name="riemannflux_spatial_di4"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi3" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">etl</code>, <code class="vardecl">etr</code>, <code class="vardecl">z1l</code>, <code class="vardecl">z1r</code>, <code class="vardecl">tmp</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">etld</code>, <code class="vardecl">etrd</code>, <code class="vardecl">z1ld</code>, <code class="vardecl">z1rd</code>, <code class="vardecl">tmpd</code></a>
<a name="riemannflux_spatial_di5"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi4" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dr</code>, <code class="vardecl">dru</code>, <code class="vardecl">drv</code>, <code class="vardecl">drw</code>, <code class="vardecl">dre</code>, <code class="vardecl">drk</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">drd</code>, <code class="vardecl">drud</code>, <code class="vardecl">drvd</code>, <code class="vardecl">drwd</code>, <code class="vardecl">dred</code>, <code class="vardecl">drkd</code></a>
<a name="riemannflux_spatial_di6"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi5" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ravg</code>, <code class="vardecl">uavg</code>, <code class="vardecl">vavg</code>, <code class="vardecl">wavg</code>, <code class="vardecl">havg</code>, <code class="vardecl">kavg</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">uavgd</code>, <code class="vardecl">vavgd</code>, <code class="vardecl">wavgd</code>, <code class="vardecl">havgd</code>, <code class="vardecl">kavgd</code></a>
<a name="riemannflux_spatial_di7"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi6" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">alphaavg</code>, <code class="vardecl">a2avg</code>, <code class="vardecl">aavg</code>, <code class="vardecl">unavg</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">alphaavgd</code>, <code class="vardecl">a2avgd</code>, <code class="vardecl">aavgd</code>, <code class="vardecl">unavgd</code></a>
<a name="riemannflux_spatial_di8"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi7" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ovaavg</code>, <code class="vardecl">ova2avg</code>, <code class="vardecl">area</code>, <code class="vardecl">eta</code></a>
<a name="riemannflux_spatial_di9"></a>    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ovaavgd</code>, <code class="vardecl">ova2avgd</code>, <code class="vardecl">etad</code></a>
    <a href="inviscidupwindflux_p.html#riemannfluxi8" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">gm1</code>, <code class="vardecl">gm53</code></a>
<a name="riemannflux_spatial_di10"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi9" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">lam1</code>, <code class="vardecl">lam2</code>, <code class="vardecl">lam3</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">lam1d</code>, <code class="vardecl">lam2d</code>, <code class="vardecl">lam3d</code></a>
    <a href="inviscidupwindflux_p.html#riemannfluxi10" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abv1</code>, <code class="vardecl">abv2</code>, <code class="vardecl">abv3</code>, <code class="vardecl">abv4</code>, <code class="vardecl">abv5</code>, <code class="vardecl">abv6</code>, <code class="vardecl">abv7</code></a>
<a name="riemannflux_spatial_di11"></a>    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abv1d</code>, <code class="vardecl">abv2d</code>, <code class="vardecl">abv3d</code>, <code class="vardecl">abv4d</code>, <code class="vardecl">abv5d</code>, <code class="vardecl">abv6d</code>, <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="label">&    </code><code class="vardecl">abv7d</code></a>
<a name="riemannflux_spatial_di12"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi11" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">2</code><code class="typename">) </code>:: <code class="vardecl">rhotmp</code>, <code class="vardecl">utmp</code>, <code class="vardecl">vtmp</code>, <code class="vardecl">wtmp</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(<code class="constant">2</code>) :: <code class="vardecl">rhotmpd</code>, <code class="vardecl">utmpd</code>, <code class="vardecl">vtmpd</code>, <code class="vardecl">wtmpd</code></a>
<a name="riemannflux_spatial_di13"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi12" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">2</code><code class="typename">) </code>:: <code class="vardecl">ptmp</code>, <code class="vardecl">ktmp</code>, <code class="vardecl">etmp</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(<code class="constant">2</code>) :: <code class="vardecl">ptmpd</code>, <code class="vardecl">ktmpd</code>, <code class="vardecl">etmpd</code></a>
<a name="riemannflux_spatial_di14"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi13" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1d</code></a>
<a name="riemannflux_spatial_di15"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi14" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">result1</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">result1d</code></a>
<a name="riemannflux_spatial_di16"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi15" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg2</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg2d</code></a>
    <a href="inviscidupwindflux_p.html#riemannfluxi16" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">result2</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">result2d</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs1d</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2d</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1d</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs2</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs2d</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs1</code></a>
<a name="riemannflux_spatial_di17"></a>    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile"><code class="comment">!        * Begin execution.                                             *</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile"><code class="comment">! Set the porosity for the flux. The default value, 0.5*rFil, is</code></a>
<a name="riemannflux_spatial_di19"></a><a name="riemannflux_spatial_di18"></a><a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile"><code class="comment">! a scaling factor where an rFil != 1 is taken into account.</code></a>
<a name="riemannflux_spatial_di20"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi17" target="origFile">porflux = half*rfil</a>
    <a href="inviscidupwindflux_p.html#riemannfluxi18" target="origFile"><code class="keyword">IF</code> (por .EQ. noflux .OR. por .EQ. boundflux) </a><a href="inviscidupwindflux_p.html#riemannfluxi19" target="origFile">porflux = zero</a>
<a name="riemannflux_spatial_di21"></a><a href="inviscidupwindflux_p.html#riemannfluxi20" target="origFile"><code class="comment">! Abbreviate some expressions in which gamma occurs.</code></a>
<a name="riemannflux_spatial_di22"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi20" target="origFile">gm1 = gammaface - one</a>
    <a href="inviscidupwindflux_p.html#riemannfluxi21" target="origFile">gm53 = gammaface - five*third</a>
<a href="inviscidupwindflux_p.html#riemannfluxi22" target="origFile"><code class="comment">! Determine which riemann solver must be solved.</code></a>
<a name="riemannflux_spatial_di23"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi22" target="origFile"><code class="keyword">SELECT CASE </code> (riemannused) </a>
    <a href="inviscidupwindflux_p.html#riemannfluxi22" target="origFile"><code class="keyword">CASE </code>(roe) </a>
<a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="comment">! Determine the preconditioner used.</code></a>
<a name="riemannflux_spatial_di24"></a>      <a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="keyword">SELECT CASE </code> (precond) </a>
      <a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="keyword">CASE </code>(noprecond) </a>
<a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile"><code class="comment">! No preconditioner used. Use the Roe scheme of the</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile"><code class="comment">! standard equations.</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile"><code class="comment">! Compute the square root of the left and right densities</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile"><code class="comment">! and the inverse of the sum.</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile"><code class="keyword">IF</code> (left(irho) .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile">z1ld = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile">z1ld = leftd(irho)/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(left(irho)))</a>
<a name="riemannflux_spatial_di25"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi24" target="origFile">z1l = <code class="funcname">SQRT</code>(left(irho))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi25" target="origFile"><code class="keyword">IF</code> (right(irho) .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi25" target="origFile">z1rd = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi25" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi25" target="origFile">z1rd = rightd(irho)/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(right(irho)))</a>
<a name="riemannflux_spatial_di26"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi25" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi25" target="origFile">z1r = <code class="funcname">SQRT</code>(right(irho))</a>
<a name="riemannflux_spatial_di27"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi26" target="origFile">tmpd = -(one*(z1ld+z1rd)/(z1l+z1r)**<code class="constant">2</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi26" target="origFile">tmp = one/(z1l+z1r)</a>
<a href="inviscidupwindflux_p.html#riemannfluxi27" target="origFile"><code class="comment">! Compute some variables depending whether or not a</code></a>
<a name="riemannflux_spatial_di28"></a><a href="inviscidupwindflux_p.html#riemannfluxi27" target="origFile"><code class="comment">! k-equation is present.</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi27" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi28" target="origFile"><code class="comment">! Store the left and right kinetic energy in ktmp,</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi28" target="origFile"><code class="comment">! which is needed to compute the total energy.</code></a>
<a name="riemannflux_spatial_di29"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi28" target="origFile">ktmpd(<code class="constant">1</code>) = leftd(itu1)</a>
          <a href="inviscidupwindflux_p.html#riemannfluxi28" target="origFile">ktmp(<code class="constant">1</code>) = left(itu1)</a>
<a name="riemannflux_spatial_di30"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi29" target="origFile">ktmpd(<code class="constant">2</code>) = rightd(itu1)</a>
          <a href="inviscidupwindflux_p.html#riemannfluxi29" target="origFile">ktmp(<code class="constant">2</code>) = right(itu1)</a>
<a href="inviscidupwindflux_p.html#riemannfluxi30" target="origFile"><code class="comment">! Store the difference of the turbulent kinetic energy</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi30" target="origFile"><code class="comment">! per unit volume, i.e. the conserved variable.</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi30" target="origFile">drkd = rightd(irho)*right(itu1) + right(irho)*rightd(itu1) - <code class="label">&</code></a>
<a name="riemannflux_spatial_di31"></a><a href="inviscidupwindflux_p.html#riemannfluxi30" target="origFile"><code class="label">&            </code>leftd(irho)*left(itu1) - left(irho)*leftd(itu1)</a>
          <a href="inviscidupwindflux_p.html#riemannfluxi30" target="origFile">drk = right(irho)*right(itu1) - left(irho)*left(itu1)</a>
<a href="inviscidupwindflux_p.html#riemannfluxi31" target="origFile"><code class="comment">! Compute the average turbulent energy per unit mass</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi31" target="origFile"><code class="comment">! using Roe averages.</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi31" target="origFile">kavgd = tmpd*(z1l*left(itu1)+z1r*right(itu1)) + tmp*(z1ld*left<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi31" target="origFile"><code class="label">&            </code>(itu1)+z1l*leftd(itu1)+z1rd*right(itu1)+z1r*rightd(itu1))</a>
<a name="riemannflux_spatial_di32"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi31" target="origFile">kavg = tmp*(z1l*left(itu1)+z1r*right(itu1))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi27" target="origFile"><code class="keyword">ELSE</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi32" target="origFile"><code class="comment">! Set the difference of the turbulent kinetic energy</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi32" target="origFile"><code class="comment">! per unit volume and the averaged kinetic energy per</code></a>
<a name="riemannflux_spatial_di33"></a><a href="inviscidupwindflux_p.html#riemannfluxi32" target="origFile"><code class="comment">! unit mass to zero.</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi32" target="origFile">drk = <code class="constant">0.0</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi33" target="origFile">kavg = <code class="constant">0.0</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi27" target="origFile">ktmpd = <code class="constant">0.0</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi27" target="origFile">kavgd = <code class="constant">0.0</code></a>
<a name="riemannflux_spatial_di34"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi27" target="origFile">drkd = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi27" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi34" target="origFile"><code class="comment">! Compute the total energy of the left and right state.</code></a>
<a name="riemannflux_spatial_di35"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi34" target="origFile">rhotmpd(<code class="constant">1</code>) = leftd(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi34" target="origFile">rhotmp(<code class="constant">1</code>) = left(irho)</a>
<a name="riemannflux_spatial_di36"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi35" target="origFile">rhotmpd(<code class="constant">2</code>) = rightd(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi35" target="origFile">rhotmp(<code class="constant">2</code>) = right(irho)</a>
<a name="riemannflux_spatial_di37"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi36" target="origFile">utmpd(<code class="constant">1</code>) = leftd(ivx)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi36" target="origFile">utmp(<code class="constant">1</code>) = left(ivx)</a>
<a name="riemannflux_spatial_di38"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi37" target="origFile">utmpd(<code class="constant">2</code>) = rightd(ivx)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi37" target="origFile">utmp(<code class="constant">2</code>) = right(ivx)</a>
<a name="riemannflux_spatial_di39"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi38" target="origFile">vtmpd(<code class="constant">1</code>) = leftd(ivy)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi38" target="origFile">vtmp(<code class="constant">1</code>) = left(ivy)</a>
<a name="riemannflux_spatial_di40"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi39" target="origFile">vtmpd(<code class="constant">2</code>) = rightd(ivy)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi39" target="origFile">vtmp(<code class="constant">2</code>) = right(ivy)</a>
<a name="riemannflux_spatial_di41"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi40" target="origFile">wtmpd(<code class="constant">1</code>) = leftd(ivz)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi40" target="origFile">wtmp(<code class="constant">1</code>) = left(ivz)</a>
<a name="riemannflux_spatial_di42"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi41" target="origFile">wtmpd(<code class="constant">2</code>) = rightd(ivz)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi41" target="origFile">wtmp(<code class="constant">2</code>) = right(ivz)</a>
<a name="riemannflux_spatial_di43"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi42" target="origFile">ptmpd(<code class="constant">1</code>) = leftd(irhoe)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi42" target="origFile">ptmp(<code class="constant">1</code>) = left(irhoe)</a>
<a name="riemannflux_spatial_di44"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi43" target="origFile">ptmpd(<code class="constant">2</code>) = rightd(irhoe)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi43" target="origFile">ptmp(<code class="constant">2</code>) = right(irhoe)</a>
<a name="p15"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi44" target="origFile"><code class="keyword">CALL </code><code class="funcname">ETOTARRAY_SPATIAL_D</code>(rhotmp, rhotmpd, utmp, utmpd, vtmp, <code class="label">&</code></a>
<a name="riemannflux_spatial_di45"></a><a href="inviscidupwindflux_p.html#riemannfluxi44" target="origFile"><code class="label">&                           </code>vtmpd, wtmp, wtmpd, ptmp, ptmpd, ktmp, ktmpd<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi44" target="origFile"><code class="label">&                           </code>, etmp, etmpd, correctfork, </a><a href="msg.html#p15" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux_p.html#riemannfluxi44" target="origFile"><code class="constant">2_intType</code>)</a>
<a name="riemannflux_spatial_di46"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi45" target="origFile">etld = etmpd(<code class="constant">1</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi45" target="origFile">etl = etmp(<code class="constant">1</code>)</a>
<a name="riemannflux_spatial_di47"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi46" target="origFile">etrd = etmpd(<code class="constant">2</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi46" target="origFile">etr = etmp(<code class="constant">2</code>)</a>
<a href="inviscidupwindflux_p.html#riemannfluxi47" target="origFile"><code class="comment">! Compute the difference of the conservative mean</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi47" target="origFile"><code class="comment">! flow variables.</code></a>
<a name="riemannflux_spatial_di48"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi47" target="origFile">drd = rightd(irho) - leftd(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi47" target="origFile">dr = right(irho) - left(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi48" target="origFile">drud = rightd(irho)*right(ivx) + right(irho)*rightd(ivx) - leftd<code class="label">&</code></a>
<a name="riemannflux_spatial_di49"></a><a href="inviscidupwindflux_p.html#riemannfluxi48" target="origFile"><code class="label">&          </code>(irho)*left(ivx) - left(irho)*leftd(ivx)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi48" target="origFile">dru = right(irho)*right(ivx) - left(irho)*left(ivx)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi49" target="origFile">drvd = rightd(irho)*right(ivy) + right(irho)*rightd(ivy) - leftd<code class="label">&</code></a>
<a name="riemannflux_spatial_di50"></a><a href="inviscidupwindflux_p.html#riemannfluxi49" target="origFile"><code class="label">&          </code>(irho)*left(ivy) - left(irho)*leftd(ivy)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi49" target="origFile">drv = right(irho)*right(ivy) - left(irho)*left(ivy)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi50" target="origFile">drwd = rightd(irho)*right(ivz) + right(irho)*rightd(ivz) - leftd<code class="label">&</code></a>
<a name="riemannflux_spatial_di51"></a><a href="inviscidupwindflux_p.html#riemannfluxi50" target="origFile"><code class="label">&          </code>(irho)*left(ivz) - left(irho)*leftd(ivz)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi50" target="origFile">drw = right(irho)*right(ivz) - left(irho)*left(ivz)</a>
<a name="riemannflux_spatial_di52"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi51" target="origFile">dred = etrd - etld</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi51" target="origFile">dre = etr - etl</a>
<a href="inviscidupwindflux_p.html#riemannfluxi52" target="origFile"><code class="comment">! Compute the Roe average variables, which can be</code></a>
<a name="riemannflux_spatial_di53"></a><a href="inviscidupwindflux_p.html#riemannfluxi52" target="origFile"><code class="comment">! computed directly from the average Roe vector.</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi52" target="origFile">ravg = fourth*(z1r+z1l)**<code class="constant">2</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi53" target="origFile">uavgd = tmpd*(z1l*left(ivx)+z1r*right(ivx)) + tmp*(z1ld*left(ivx<code class="label">&</code></a>
<a name="riemannflux_spatial_di54"></a><a href="inviscidupwindflux_p.html#riemannfluxi53" target="origFile"><code class="label">&          </code>)+z1l*leftd(ivx)+z1rd*right(ivx)+z1r*rightd(ivx))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi53" target="origFile">uavg = tmp*(z1l*left(ivx)+z1r*right(ivx))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi54" target="origFile">vavgd = tmpd*(z1l*left(ivy)+z1r*right(ivy)) + tmp*(z1ld*left(ivy<code class="label">&</code></a>
<a name="riemannflux_spatial_di55"></a><a href="inviscidupwindflux_p.html#riemannfluxi54" target="origFile"><code class="label">&          </code>)+z1l*leftd(ivy)+z1rd*right(ivy)+z1r*rightd(ivy))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi54" target="origFile">vavg = tmp*(z1l*left(ivy)+z1r*right(ivy))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi55" target="origFile">wavgd = tmpd*(z1l*left(ivz)+z1r*right(ivz)) + tmp*(z1ld*left(ivz<code class="label">&</code></a>
<a name="riemannflux_spatial_di56"></a><a href="inviscidupwindflux_p.html#riemannfluxi55" target="origFile"><code class="label">&          </code>)+z1l*leftd(ivz)+z1rd*right(ivz)+z1r*rightd(ivz))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi55" target="origFile">wavg = tmp*(z1l*left(ivz)+z1r*right(ivz))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi56" target="origFile">havgd = tmpd*((etl+left(irhoe))/z1l+(etr+right(irhoe))/z1r) + <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi56" target="origFile"><code class="label">&          </code>tmp*(((etld+leftd(irhoe))*z1l-(etl+left(irhoe))*z1ld)/z1l**<code class="constant">2</code>+(<code class="label">&</code></a>
<a name="riemannflux_spatial_di57"></a><a href="inviscidupwindflux_p.html#riemannfluxi56" target="origFile"><code class="label">&          </code>(etrd+rightd(irhoe))*z1r-(etr+right(irhoe))*z1rd)/z1r**<code class="constant">2</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi56" target="origFile">havg = tmp*((etl+left(irhoe))/z1l+(etr+right(irhoe))/z1r)</a>
<a href="inviscidupwindflux_p.html#riemannfluxi57" target="origFile"><code class="comment">! Compute the unit vector and store the area of the</code></a>
<a name="riemannflux_spatial_di58"></a><a href="inviscidupwindflux_p.html#riemannfluxi57" target="origFile"><code class="comment">! normal. Also compute the unit normal velocity of the face.</code></a>
<a name="riemannflux_spatial_di59"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi57" target="origFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
<a name="riemannflux_spatial_di61"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi58" target="origFile">area = <code class="funcname">SQRT</code>(arg1)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi59" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
<a name="riemannflux_spatial_di60"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi61" target="origFile">max2 = area</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi59" target="origFile"><code class="keyword">ELSE</code></a>
<a name="riemannflux_spatial_di62"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi60" target="origFile">max2 = <code class="constant">1.e-25_realType</code></a>
<a name="riemannflux_spatial_di63"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi59" target="origFile"><code class="keyword">END IF</code></a>
<a name="riemannflux_spatial_di64"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi62" target="origFile">tmp = one/max2</a>
<a name="riemannflux_spatial_di65"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi63" target="origFile">sx = sx*tmp</a>
<a name="riemannflux_spatial_di66"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi64" target="origFile">sy = sy*tmp</a>
<a name="riemannflux_spatial_di67"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi65" target="origFile">sz = sz*tmp</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi66" target="origFile">rface = sface*tmp</a>
<a href="inviscidupwindflux_p.html#riemannfluxi67" target="origFile"><code class="comment">! Compute some dependent variables at the Roe</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi67" target="origFile"><code class="comment">! average state.</code></a>
<a name="riemannflux_spatial_di68"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi67" target="origFile">alphaavgd = half*(<code class="constant">2</code>*uavg*uavgd+<code class="constant">2</code>*vavg*vavgd+<code class="constant">2</code>*wavg*wavgd)</a>
<a name="riemannflux_spatial_di70"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi67" target="origFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi68" target="origFile"><code class="keyword">IF</code> (gm1*(havg-alphaavg) - gm53*kavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi70" target="origFile">a2avgd = gm1*(havgd-alphaavgd) - gm53*kavgd</a>
<a name="riemannflux_spatial_di69"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi70" target="origFile">a2avg = gm1*(havg-alphaavg) - gm53*kavg</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi68" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi69" target="origFile">a2avgd = -(gm1*(havgd-alphaavgd)-gm53*kavgd)</a>
<a name="riemannflux_spatial_di71"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi69" target="origFile">a2avg = -(gm1*(havg-alphaavg)-gm53*kavg)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi68" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi71" target="origFile"><code class="keyword">IF</code> (a2avg .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi71" target="origFile">aavgd = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi71" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi71" target="origFile">aavgd = a2avgd/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(a2avg))</a>
<a name="riemannflux_spatial_di72"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi71" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi71" target="origFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
<a name="riemannflux_spatial_di73"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi72" target="origFile">unavgd = sx*uavgd + sy*vavgd + sz*wavgd</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi72" target="origFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
<a name="riemannflux_spatial_di74"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi73" target="origFile">ovaavgd = -(one*aavgd/aavg**<code class="constant">2</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi73" target="origFile">ovaavg = one/aavg</a>
<a name="riemannflux_spatial_di75"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi74" target="origFile">ova2avgd = -(one*a2avgd/a2avg**<code class="constant">2</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi74" target="origFile">ova2avg = one/a2avg</a>
<a href="inviscidupwindflux_p.html#riemannfluxi75" target="origFile"><code class="comment">! Set for a boundary the normal velocity to rFace, the</code></a>
<a name="riemannflux_spatial_di76"></a><a href="inviscidupwindflux_p.html#riemannfluxi75" target="origFile"><code class="comment">! normal velocity of the boundary.</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi75" target="origFile"><code class="keyword">IF</code> (por .EQ. boundflux) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi76" target="origFile">unavg = rface</a>
<a name="riemannflux_spatial_di77"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi75" target="origFile">unavgd = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi75" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi77" target="origFile">x1d = sx*(leftd(ivx)-rightd(ivx)) + sy*(leftd(ivy)-rightd(ivy)) <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi77" target="origFile"><code class="label">&          </code>+ sz*(leftd(ivz)-rightd(ivz))</a>
<a name="riemannflux_spatial_di78"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi77" target="origFile">x1 = (left(ivx)-right(ivx))*sx + (left(ivy)-right(ivy))*sy + (<code class="label">&</code></a>
<a name="riemannflux_spatial_di80"></a><a href="inviscidupwindflux_p.html#riemannfluxi77" target="origFile"><code class="label">&          </code>left(ivz)-right(ivz))*sz</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi78" target="origFile"><code class="keyword">IF</code> (x1 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi80" target="origFile">abs1d = x1d</a>
<a name="riemannflux_spatial_di79"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi80" target="origFile">abs1 = x1</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi78" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi79" target="origFile">abs1d = -x1d</a>
<a name="riemannflux_spatial_di81"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi79" target="origFile">abs1 = -x1</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi78" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi81" target="origFile">arg1d = (gammaface*leftd(irhoe)*left(irho)-gammaface*left(irhoe)<code class="label">&</code></a>
<a name="riemannflux_spatial_di82"></a><a href="inviscidupwindflux_p.html#riemannfluxi81" target="origFile"><code class="label">&          </code>*leftd(irho))/left(irho)**<code class="constant">2</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi81" target="origFile">arg1 = gammaface*left(irhoe)/left(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi82" target="origFile"><code class="keyword">IF</code> (arg1 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi82" target="origFile">result1d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi82" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi82" target="origFile">result1d = arg1d/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg1))</a>
<a name="riemannflux_spatial_di83"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi82" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi82" target="origFile">result1 = <code class="funcname">SQRT</code>(arg1)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi83" target="origFile">arg2d = (gammaface*rightd(irhoe)*right(irho)-gammaface*right(<code class="label">&</code></a>
<a name="riemannflux_spatial_di84"></a><a href="inviscidupwindflux_p.html#riemannfluxi83" target="origFile"><code class="label">&          </code>irhoe)*rightd(irho))/right(irho)**<code class="constant">2</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi83" target="origFile">arg2 = gammaface*right(irhoe)/right(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi84" target="origFile"><code class="keyword">IF</code> (arg2 .EQ. <code class="constant">0.0</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi84" target="origFile">result2d = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi84" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi84" target="origFile">result2d = arg2d/(<code class="constant">2.0</code>*<code class="funcname">SQRT</code>(arg2))</a>
<a name="riemannflux_spatial_di85"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi84" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi84" target="origFile">result2 = <code class="funcname">SQRT</code>(arg2)</a>
<a name="riemannflux_spatial_di86"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi85" target="origFile">x2d = result1d - result2d</a>
<a name="riemannflux_spatial_di88"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi85" target="origFile">x2 = result1 - result2</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi86" target="origFile"><code class="keyword">IF</code> (x2 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi88" target="origFile">abs2d = x2d</a>
<a name="riemannflux_spatial_di87"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi88" target="origFile">abs2 = x2</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi86" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi87" target="origFile">abs2d = -x2d</a>
<a name="riemannflux_spatial_di89"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi87" target="origFile">abs2 = -x2</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi86" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! Compute the coefficient eta for the entropy correction.</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! At the moment a 1D entropy correction is used, which</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! removes expansion shocks. Although it also reduces the</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! carbuncle phenomenon, it does not remove it completely.</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! In other to do that a multi-dimensional entropy fix is</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! needed, see Sanders et. al, JCP, vol. 145, 1998,</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! pp. 511 - 537. Although relatively easy to implement,</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! an efficient implementation requires the storage of</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! all the left and right states, which is rather</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile"><code class="comment">! expensive in terms of memory.</code></a>
<a name="riemannflux_spatial_di90"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile">etad = half*(abs1d+abs2d)</a>
<a name="riemannflux_spatial_di92"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi89" target="origFile">eta = half*(abs1+abs2)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi90" target="origFile"><code class="keyword">IF</code> (unavg - rface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi92" target="origFile">lam1d = unavgd + aavgd</a>
<a name="riemannflux_spatial_di91"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi92" target="origFile">lam1 = unavg - rface + aavg</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi90" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi91" target="origFile">lam1d = -(unavgd+aavgd)</a>
<a name="riemannflux_spatial_di93"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi91" target="origFile">lam1 = -(unavg-rface+aavg)</a>
<a name="riemannflux_spatial_di95"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi90" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi93" target="origFile"><code class="keyword">IF</code> (unavg - rface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi95" target="origFile">lam2d = unavgd - aavgd</a>
<a name="riemannflux_spatial_di94"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi95" target="origFile">lam2 = unavg - rface - aavg</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi93" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi94" target="origFile">lam2d = -(unavgd-aavgd)</a>
<a name="riemannflux_spatial_di96"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi94" target="origFile">lam2 = -(unavg-rface-aavg)</a>
<a name="riemannflux_spatial_di98"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi93" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi96" target="origFile"><code class="keyword">IF</code> (unavg - rface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi98" target="origFile">lam3d = unavgd</a>
<a name="riemannflux_spatial_di97"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi98" target="origFile">lam3 = unavg - rface</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi96" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi97" target="origFile">lam3d = -unavgd</a>
<a name="riemannflux_spatial_di99"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi97" target="origFile">lam3 = -(unavg-rface)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi96" target="origFile"><code class="keyword">END IF</code></a>
<a name="riemannflux_spatial_di100"></a><a href="inviscidupwindflux_p.html#riemannfluxi99" target="origFile"><code class="comment">! Apply the entropy correction to the eigenvalues.</code></a>
<a name="riemannflux_spatial_di101"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi99" target="origFile">tmp = two*eta</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi100" target="origFile"><code class="keyword">IF</code> (lam1 .LT. tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi101" target="origFile">lam1d = etad + (fourth*(lam1d*lam1+lam1*lam1d)*eta-fourth*lam1<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi101" target="origFile"><code class="label">&            </code>**<code class="constant">2</code>*etad)/eta**<code class="constant">2</code></a>
<a name="riemannflux_spatial_di102"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi101" target="origFile">lam1 = eta + fourth*lam1*lam1/eta</a>
<a name="riemannflux_spatial_di103"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi100" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi102" target="origFile"><code class="keyword">IF</code> (lam2 .LT. tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi103" target="origFile">lam2d = etad + (fourth*(lam2d*lam2+lam2*lam2d)*eta-fourth*lam2<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi103" target="origFile"><code class="label">&            </code>**<code class="constant">2</code>*etad)/eta**<code class="constant">2</code></a>
<a name="riemannflux_spatial_di104"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi103" target="origFile">lam2 = eta + fourth*lam2*lam2/eta</a>
<a name="riemannflux_spatial_di105"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi102" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannfluxi104" target="origFile"><code class="keyword">IF</code> (lam3 .LT. tmp) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannfluxi105" target="origFile">lam3d = etad + (fourth*(lam3d*lam3+lam3*lam3d)*eta-fourth*lam3<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi105" target="origFile"><code class="label">&            </code>**<code class="constant">2</code>*etad)/eta**<code class="constant">2</code></a>
<a name="riemannflux_spatial_di106"></a>          <a href="inviscidupwindflux_p.html#riemannfluxi105" target="origFile">lam3 = eta + fourth*lam3*lam3/eta</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi104" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi106" target="origFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi106" target="origFile"><code class="comment">! the correct values for the dissipation term.</code></a>
<a name="riemannflux_spatial_di107"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi106" target="origFile">lam1d = area*lam1d</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi106" target="origFile">lam1 = lam1*area</a>
<a name="riemannflux_spatial_di108"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi107" target="origFile">lam2d = area*lam2d</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi107" target="origFile">lam2 = lam2*area</a>
<a name="riemannflux_spatial_di109"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi108" target="origFile">lam3d = area*lam3d</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi108" target="origFile">lam3 = lam3*area</a>
<a href="inviscidupwindflux_p.html#riemannfluxi109" target="origFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi109" target="origFile"><code class="comment">! dissipation terms.</code></a>
<a name="riemannflux_spatial_di110"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi109" target="origFile">abv1d = half*(lam1d+lam2d)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi109" target="origFile">abv1 = half*(lam1+lam2)</a>
<a name="riemannflux_spatial_di111"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi110" target="origFile">abv2d = half*(lam1d-lam2d)</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi110" target="origFile">abv2 = half*(lam1-lam2)</a>
<a name="riemannflux_spatial_di112"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi111" target="origFile">abv3d = abv1d - lam3d</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi111" target="origFile">abv3 = abv1 - lam3</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi112" target="origFile">abv4d = gm1*(alphaavgd*dr+alphaavg*drd-uavgd*dru-uavg*drud-vavgd<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi112" target="origFile"><code class="label">&          </code>*drv-vavg*drvd-wavgd*drw-wavg*drwd+dred) - gm53*drkd</a>
<a name="riemannflux_spatial_di113"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi112" target="origFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53*<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi112" target="origFile"><code class="label">&          </code>drk</a>
<a name="riemannflux_spatial_di114"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi113" target="origFile">abv5d = sx*drud + sy*drvd + sz*drwd - unavgd*dr - unavg*drd</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi113" target="origFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi114" target="origFile">abv6d = (abv3d*abv4+abv3*abv4d)*ova2avg + abv3*abv4*ova2avgd + (<code class="label">&</code></a>
<a name="riemannflux_spatial_di115"></a><a href="inviscidupwindflux_p.html#riemannfluxi114" target="origFile"><code class="label">&          </code>abv2d*abv5+abv2*abv5d)*ovaavg + abv2*abv5*ovaavgd</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi114" target="origFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi115" target="origFile">abv7d = (abv2d*abv4+abv2*abv4d)*ovaavg + abv2*abv4*ovaavgd + <code class="label">&</code></a>
<a name="riemannflux_spatial_di116"></a><a href="inviscidupwindflux_p.html#riemannfluxi115" target="origFile"><code class="label">&          </code>abv3d*abv5 + abv3*abv5d</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi115" target="origFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="inviscidupwindflux_p.html#riemannfluxi116" target="origFile"><code class="comment">! Compute the dissipation term, -|a| (wr - wl), which is</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi116" target="origFile"><code class="comment">! multiplied by porFlux. Note that porFlux is either</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi116" target="origFile"><code class="comment">! 0.0 or 0.5*rFil.</code></a>
<a name="riemannflux_spatial_di117"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi116" target="origFile">fluxd(irho) = -(porflux*(lam3d*dr+lam3*drd+abv6d))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi116" target="origFile">flux(irho) = -(porflux*(lam3*dr+abv6))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi117" target="origFile">fluxd(imx) = -(porflux*(lam3d*dru+lam3*drud+uavgd*abv6+uavg*<code class="label">&</code></a>
<a name="riemannflux_spatial_di118"></a><a href="inviscidupwindflux_p.html#riemannfluxi117" target="origFile"><code class="label">&          </code>abv6d+sx*abv7d))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi117" target="origFile">flux(imx) = -(porflux*(lam3*dru+uavg*abv6+sx*abv7))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi118" target="origFile">fluxd(imy) = -(porflux*(lam3d*drv+lam3*drvd+vavgd*abv6+vavg*<code class="label">&</code></a>
<a name="riemannflux_spatial_di119"></a><a href="inviscidupwindflux_p.html#riemannfluxi118" target="origFile"><code class="label">&          </code>abv6d+sy*abv7d))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi118" target="origFile">flux(imy) = -(porflux*(lam3*drv+vavg*abv6+sy*abv7))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi119" target="origFile">fluxd(imz) = -(porflux*(lam3d*drw+lam3*drwd+wavgd*abv6+wavg*<code class="label">&</code></a>
<a name="riemannflux_spatial_di120"></a><a href="inviscidupwindflux_p.html#riemannfluxi119" target="origFile"><code class="label">&          </code>abv6d+sz*abv7d))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi119" target="origFile">flux(imz) = -(porflux*(lam3*drw+wavg*abv6+sz*abv7))</a>
        <a href="inviscidupwindflux_p.html#riemannfluxi120" target="origFile">fluxd(irhoe) = -(porflux*(lam3d*dre+lam3*dred+havgd*abv6+havg*<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi120" target="origFile"><code class="label">&          </code>abv6d+unavgd*abv7+unavg*abv7d))</a>
<a name="p16"></a><a name="riemannflux_spatial_di121"></a>        <a href="inviscidupwindflux_p.html#riemannfluxi120" target="origFile">flux(irhoe) = -(porflux*(lam3*dre+havg*abv6+unavg*abv7))</a>
      <a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="keyword">CASE </code>(turkel) </a>
        <a href="msg.html#p16" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux_p.html#riemannfluxi121" target="origFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE_CD</code>(<code class="string">'riemannFlux'</code>, <code class="string">'Turkel preconditioner not '</code>, <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi121" target="origFile"><code class="label">&                    </code><code class="string">'implemented yet'</code>)</a>
<a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="comment">!          tmp = max(lam1,lam2,lam3)</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="comment">!          flux(irho)  = -porFlux*(tmp*dr)</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="comment">!          flux(imx)   = -porFlux*(tmp*dru)</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="comment">!          flux(imy)   = -porFlux*(tmp*drv)</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="comment">!          flux(imz)   = -porFlux*(tmp*drw)</code></a>
<a name="p17"></a><a name="riemannflux_spatial_di122"></a><a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="comment">!          flux(irhoE) = -porFlux*(tmp*drE)</code></a>
      <a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="keyword">CASE </code>(choimerkle) </a>
        <a href="msg.html#p17" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux_p.html#riemannfluxi122" target="origFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE_CD</code>(<code class="string">'riemannFlux'</code>, <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi122" target="origFile"><code class="label">&                    </code><code class="string">'choi merkle preconditioner not '</code>, <code class="string">'implemented yet'</code><code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannfluxi122" target="origFile"><code class="label">&                   </code>)</a>
<a name="riemannflux_spatial_di123"></a>      <a href="inviscidupwindflux_p.html#riemannfluxi23" target="origFile"><code class="keyword">END SELECT</code></a>
    <a href="inviscidupwindflux_p.html#riemannfluxi22" target="origFile"><code class="keyword">CASE </code>(vanleer) </a>
      <a href="inviscidupwindflux_p.html#riemannfluxi123" target="origFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE_CD</code>(<code class="string">'riemannFlux'</code>, <code class="label">&</code></a>
<a name="riemannflux_spatial_di124"></a><a href="inviscidupwindflux_p.html#riemannfluxi123" target="origFile"><code class="label">&                  </code><code class="string">'van leer fvs not implemented yet'</code>)</a>
    <a href="inviscidupwindflux_p.html#riemannfluxi22" target="origFile"><code class="keyword">CASE </code>(ausmdv) </a>
      <a href="inviscidupwindflux_p.html#riemannfluxi124" target="origFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE_CD</code>(<code class="string">'riemannFlux'</code>, <code class="string">'ausmdv fvs not implemented yet'</code>)</a>
<a name="riemannflux"></a>    <a href="inviscidupwindflux_p.html#riemannfluxi22" target="origFile"><code class="keyword">END SELECT</code></a>
  <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">RIEMANNFLUX_SPATIAL_D</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!        ================================================================</code></a>
  <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">RIEMANNFLUX</code>(<code class="vardecl">left</code>, <code class="vardecl">right</code>, <code class="vardecl">flux</code>)</a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!        Subroutine arguments.</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="keyword">*</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">left</code>, <code class="vardecl">right</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="keyword">*</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!        Local variables.</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">porflux</code>, <code class="vardecl">rface</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">etl</code>, <code class="vardecl">etr</code>, <code class="vardecl">z1l</code>, <code class="vardecl">z1r</code>, <code class="vardecl">tmp</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dr</code>, <code class="vardecl">dru</code>, <code class="vardecl">drv</code>, <code class="vardecl">drw</code>, <code class="vardecl">dre</code>, <code class="vardecl">drk</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ravg</code>, <code class="vardecl">uavg</code>, <code class="vardecl">vavg</code>, <code class="vardecl">wavg</code>, <code class="vardecl">havg</code>, <code class="vardecl">kavg</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">alphaavg</code>, <code class="vardecl">a2avg</code>, <code class="vardecl">aavg</code>, <code class="vardecl">unavg</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ovaavg</code>, <code class="vardecl">ova2avg</code>, <code class="vardecl">area</code>, <code class="vardecl">eta</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">gm1</code>, <code class="vardecl">gm53</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">lam1</code>, <code class="vardecl">lam2</code>, <code class="vardecl">lam3</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abv1</code>, <code class="vardecl">abv2</code>, <code class="vardecl">abv3</code>, <code class="vardecl">abv4</code>, <code class="vardecl">abv5</code>, <code class="vardecl">abv6</code>, <code class="vardecl">abv7</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">2</code><code class="typename">) </code>:: <code class="vardecl">rhotmp</code>, <code class="vardecl">utmp</code>, <code class="vardecl">vtmp</code>, <code class="vardecl">wtmp</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">2</code><code class="typename">) </code>:: <code class="vardecl">ptmp</code>, <code class="vardecl">ktmp</code>, <code class="vardecl">etmp</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">result1</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg2</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">result2</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs2</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs1</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!        * Begin execution.                                             *</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Set the porosity for the flux. The default value, 0.5*rFil, is</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! a scaling factor where an rFil != 1 is taken into account.</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">porflux = half*rfil</a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (por .EQ. noflux .OR. por .EQ. boundflux) porflux = zero</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Abbreviate some expressions in which gamma occurs.</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">gm1 = gammaface - one</a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">gm53 = gammaface - five*third</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Determine which riemann solver must be solved.</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">SELECT CASE </code> (riemannused) </a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CASE </code>(roe) </a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Determine the preconditioner used.</code></a>
      <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">SELECT CASE </code> (precond) </a>
      <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CASE </code>(noprecond) </a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! No preconditioner used. Use the Roe scheme of the</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! standard equations.</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute the square root of the left and right densities</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! and the inverse of the sum.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">z1l = <code class="funcname">SQRT</code>(left(irho))</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">z1r = <code class="funcname">SQRT</code>(right(irho))</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">tmp = one/(z1l+z1r)</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute some variables depending whether or not a</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! k-equation is present.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Store the left and right kinetic energy in ktmp,</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! which is needed to compute the total energy.</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">ktmp(<code class="constant">1</code>) = left(itu1)</a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">ktmp(<code class="constant">2</code>) = right(itu1)</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Store the difference of the turbulent kinetic energy</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! per unit volume, i.e. the conserved variable.</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">drk = right(irho)*right(itu1) - left(irho)*left(itu1)</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute the average turbulent energy per unit mass</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! using Roe averages.</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">kavg = tmp*(z1l*left(itu1)+z1r*right(itu1))</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">ELSE</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Set the difference of the turbulent kinetic energy</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! per unit volume and the averaged kinetic energy per</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! unit mass to zero.</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">drk = <code class="constant">0.0</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">kavg = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute the total energy of the left and right state.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">rhotmp(<code class="constant">1</code>) = left(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">rhotmp(<code class="constant">2</code>) = right(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">utmp(<code class="constant">1</code>) = left(ivx)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">utmp(<code class="constant">2</code>) = right(ivx)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">vtmp(<code class="constant">1</code>) = left(ivy)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">vtmp(<code class="constant">2</code>) = right(ivy)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">wtmp(<code class="constant">1</code>) = left(ivz)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">wtmp(<code class="constant">2</code>) = right(ivz)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">ptmp(<code class="constant">1</code>) = left(irhoe)</a>
<a name="p15"></a>        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">ptmp(<code class="constant">2</code>) = right(irhoe)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">ETOTARRAY_CD</code>(rhotmp, utmp, vtmp, wtmp, ptmp, ktmp, etmp, <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="label">&                    </code>correctfork, </a><a href="msg.html#p15" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="constant">2_intType</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">etl = etmp(<code class="constant">1</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">etr = etmp(<code class="constant">2</code>)</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute the difference of the conservative mean</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! flow variables.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">dr = right(irho) - left(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">dru = right(irho)*right(ivx) - left(irho)*left(ivx)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">drv = right(irho)*right(ivy) - left(irho)*left(ivy)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">drw = right(irho)*right(ivz) - left(irho)*left(ivz)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">dre = etr - etl</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute the Roe average variables, which can be</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! computed directly from the average Roe vector.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">ravg = fourth*(z1r+z1l)**<code class="constant">2</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">uavg = tmp*(z1l*left(ivx)+z1r*right(ivx))</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">vavg = tmp*(z1l*left(ivy)+z1r*right(ivy))</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">wavg = tmp*(z1l*left(ivz)+z1r*right(ivz))</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">havg = tmp*((etl+left(irhoe))/z1l+(etr+right(irhoe))/z1r)</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute the unit vector and store the area of the</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! normal. Also compute the unit normal velocity of the face.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">area = <code class="funcname">SQRT</code>(arg1)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">max2 = area</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">max2 = <code class="constant">1.e-25_realType</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">tmp = one/max2</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">sx = sx*tmp</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">sy = sy*tmp</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">sz = sz*tmp</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">rface = sface*tmp</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute some dependent variables at the Roe</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! average state.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (gm1*(havg-alphaavg) - gm53*kavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">a2avg = gm1*(havg-alphaavg) - gm53*kavg</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">a2avg = -(gm1*(havg-alphaavg)-gm53*kavg)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">ovaavg = one/aavg</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">ova2avg = one/a2avg</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Set for a boundary the normal velocity to rFace, the</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! normal velocity of the boundary.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (por .EQ. boundflux) unavg = rface</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">x1 = (left(ivx)-right(ivx))*sx + (left(ivy)-right(ivy))*sy + (<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="label">&          </code>left(ivz)-right(ivz))*sz</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (x1 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abs1 = x1</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abs1 = -x1</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">arg1 = gammaface*left(irhoe)/left(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">result1 = <code class="funcname">SQRT</code>(arg1)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">arg2 = gammaface*right(irhoe)/right(irho)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">result2 = <code class="funcname">SQRT</code>(arg2)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">x2 = result1 - result2</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (x2 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abs2 = x2</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abs2 = -x2</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute the coefficient eta for the entropy correction.</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! At the moment a 1D entropy correction is used, which</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! removes expansion shocks. Although it also reduces the</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! carbuncle phenomenon, it does not remove it completely.</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! In other to do that a multi-dimensional entropy fix is</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! needed, see Sanders et. al, JCP, vol. 145, 1998,</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! pp. 511 - 537. Although relatively easy to implement,</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! an efficient implementation requires the storage of</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! all the left and right states, which is rather</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! expensive in terms of memory.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">eta = half*(abs1+abs2)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (unavg - rface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">lam1 = unavg - rface + aavg</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">lam1 = -(unavg-rface+aavg)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (unavg - rface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">lam2 = unavg - rface - aavg</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">lam2 = -(unavg-rface-aavg)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (unavg - rface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">lam3 = unavg - rface</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">lam3 = -(unavg-rface)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Apply the entropy correction to the eigenvalues.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">tmp = two*eta</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (lam1 .LT. tmp) lam1 = eta + fourth*lam1*lam1/eta</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (lam2 .LT. tmp) lam2 = eta + fourth*lam2*lam2/eta</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">IF</code> (lam3 .LT. tmp) lam3 = eta + fourth*lam3*lam3/eta</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! the correct values for the dissipation term.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">lam1 = lam1*area</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">lam2 = lam2*area</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">lam3 = lam3*area</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! dissipation terms.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abv1 = half*(lam1+lam2)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abv2 = half*(lam1-lam2)</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abv3 = abv1 - lam3</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53*<code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="label">&          </code>drk</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! Compute the dissipation term, -|a| (wr - wl), which is</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! multiplied by porFlux. Note that porFlux is either</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">! 0.0 or 0.5*rFil.</code></a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">flux(irho) = -(porflux*(lam3*dr+abv6))</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">flux(imx) = -(porflux*(lam3*dru+uavg*abv6+sx*abv7))</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">flux(imy) = -(porflux*(lam3*drv+vavg*abv6+sy*abv7))</a>
        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">flux(imz) = -(porflux*(lam3*drw+wavg*abv6+sz*abv7))</a>
<a name="p16"></a>        <a href="inviscidupwindflux_p.html#riemannflux" target="origFile">flux(irhoe) = -(porflux*(lam3*dre+havg*abv6+unavg*abv7))</a>
      <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CASE </code>(turkel) </a>
        <a href="msg.html#p16" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE_CD</code>(<code class="string">'riemannFlux'</code>, <code class="string">'Turkel preconditioner not '</code>, <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="label">&                    </code><code class="string">'implemented yet'</code>)</a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!          tmp = max(lam1,lam2,lam3)</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!          flux(irho)  = -porFlux*(tmp*dr)</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!          flux(imx)   = -porFlux*(tmp*dru)</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!          flux(imy)   = -porFlux*(tmp*drv)</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!          flux(imz)   = -porFlux*(tmp*drw)</code></a>
<a name="p17"></a><a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="comment">!          flux(irhoE) = -porFlux*(tmp*drE)</code></a>
      <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CASE </code>(choimerkle) </a>
        <a href="msg.html#p17" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE_CD</code>(<code class="string">'riemannFlux'</code>, <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="label">&                    </code><code class="string">'choi merkle preconditioner not '</code>, <code class="string">'implemented yet'</code><code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="label">&                   </code>)</a>
      <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END SELECT</code></a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CASE </code>(vanleer) </a>
      <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE_CD</code>(<code class="string">'riemannFlux'</code>, <code class="label">&</code></a>
<a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="label">&                  </code><code class="string">'van leer fvs not implemented yet'</code>)</a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CASE </code>(ausmdv) </a>
      <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE_CD</code>(<code class="string">'riemannFlux'</code>, <code class="string">'ausmdv fvs not implemented yet'</code>)</a>
    <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END SELECT</code></a>
  <a href="inviscidupwindflux_p.html#riemannflux" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">RIEMANNFLUX</code></a>
<a href="inviscidupwindflux_p.html#inviscidupwindflux" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">INVISCIDUPWINDFLUX_SPATIAL_D</code></a>
</pre>
</body>
