<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="applyallturbbcthisblock"></a><a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      ==================================================================</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">APPLYALLTURBBCTHISBLOCK</code>(<code class="vardecl">secondhalo</code>)</a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS</code></a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS</code></a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE</code></a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">USE </code><code class="funcname">BCTYPES</code></a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      * applyAllTurbBCThisBlock sets the halo values of the            *</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      * turbulent variables and eddy viscosity for the block the       *</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      * variables in blockPointers currently point to.                 *</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      Subroutine arguments.</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!</code></a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">secondhalo</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      Local variables.</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!</code></a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">l</code>, <code class="vardecl">m</code></a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">bmt</code></a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">bvt</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">TURB2NDHALO</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">!</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! Loop over the boundary condition subfaces of this block.</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="label">bocos:</code><code class="keyword">DO </code>nn=<code class="constant">1</code>,nbocos</a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! Determine the block face on which this subface is located</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! and set some pointers accordingly.</code></a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">CASE </code>(imin) </a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bmt => bmti1</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bvt => bvti1</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww1 => w(<code class="constant">1</code>, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww2 => w(<code class="constant">2</code>, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">CASE </code>(imax) </a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bmt => bmti2</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bvt => bvti2</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww1 => w(ie, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww2 => w(il, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">CASE </code>(jmin) </a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bmt => bmtj1</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bvt => bvtj1</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww1 => w(<code class="constant">1</code>:, <code class="constant">1</code>, <code class="constant">1</code>:, :)</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww2 => w(<code class="constant">1</code>:, <code class="constant">2</code>, <code class="constant">1</code>:, :)</a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">CASE </code>(jmax) </a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bmt => bmtj2</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bvt => bvtj2</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww1 => w(<code class="constant">1</code>:, je, <code class="constant">1</code>:, :)</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww2 => w(<code class="constant">1</code>:, jl, <code class="constant">1</code>:, :)</a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">CASE </code>(kmin) </a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bmt => bmtk1</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bvt => bvtk1</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww1 => w(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">1</code>, :)</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww2 => w(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">2</code>, :)</a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">CASE </code>(kmax) </a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bmt => bmtk2</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bvt => bvtk2</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww1 => w(<code class="constant">1</code>:, <code class="constant">1</code>:, ke, :)</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww2 => w(<code class="constant">1</code>:, <code class="constant">1</code>:, kl, :)</a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END SELECT</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! Loop over the faces and set the state in</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! the turbulent halo cells.</code></a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">IF</code> (wallfunctions) <code class="keyword">THEN</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! Write an approximate value into the halo cell for</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! postprocessing (it is not used in computation).</code></a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
        <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
          <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">DO </code>l=nt1,nt2</a>
<a name="p37"></a>            <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww1(i, j, l) = bvt(i, j, l) - bmt(i, j, l, l)*ww2(i, j, l)</a>
            <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">DO </code>m=nt1,nt2</a>
              <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">IF</code> (m .NE. l .AND. </a><a href="msg.html#p37" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">bmt(i, j, l, m) .NE. zero) ww1(i, j, l)<code class="label">&</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="label">&</code> =                ww2(i, j, l)</a>
            <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END DO</code></a>
          <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
        <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
          <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">DO </code>l=nt1,nt2</a>
            <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww1(i, j, l) = bvt(i, j, l)</a>
            <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">DO </code>m=nt1,nt2</a>
              <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile">ww1(i, j, l) = ww1(i, j, l) - bmt(i, j, l, m)*ww2(i, j, m)</a>
            <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END DO</code></a>
          <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END IF</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! Set the value of the eddy viscosity, depending on the type of</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! boundary condition. Only if the turbulence model is an eddy</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! viscosity model of course.</code></a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">IF</code> (eddymodel) <code class="keyword">THEN</code></a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">IF</code> (bctype(nn) .EQ. nswalladiabatic .OR. bctype(nn) .EQ. <code class="label">&</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="label">&          </code>nswallisothermal) <code class="keyword">THEN</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! Viscous wall boundary condition. Eddy viscosity is</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! zero at the wall.</code></a>
        <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">CALL </code><code class="funcname">BCEDDYWALL</code>(nn)</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! Any boundary condition but viscous wall. A homogeneous</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! Neumann condition is applied to the eddy viscosity.</code></a>
        <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">CALL </code><code class="funcname">BCEDDYNOWALL</code>(nn)</a>
      <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END IF</code></a>
<a name="p38"></a><a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! Extrapolate the turbulent variables in case a second halo</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="comment">! is needed.</code></a>
    <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">IF</code> (secondhalo) <code class="keyword">CALL </code></a><a href="msg.html#p38" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="funcname">TURB2NDHALO</code>(nn)</a>
  <a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END DO </code><code class="label">bocos</code></a>
<a href="applyallturbbcthisblock.html#applyallturbbcthisblock" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">APPLYALLTURBBCTHISBLOCK</code></a>
</pre>
</body>
