<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="bcsymm_spatial_d"></a><a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!  Differentiation of bcsymm in forward (tangent) mode:</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!   variations   of useful results: *p *w</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!   with respect to varying inputs: *p *w</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!      * File:          bcSymm.f90                                      *</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!      * Starting date: 03-07-2003                                      *</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!      * Last modified: 06-12-2005                                      *</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="comment">!</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">BCSYMM_SPATIAL_D</code>(<code class="vardecl">secondhalo</code>)</a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">USE </code><code class="funcname">BCTYPES_SPATIAL_D</code></a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
<a name="bcsymm_spatial_di0"></a>  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      * bcSymm applies the symmetry boundary conditions to a block.    *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      * It is assumed that the pointers in blockPointers are already   *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      * set to the correct block on the correct grid level.            *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      * In case also the second halo must be set the loop over the     *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      * boundary subfaces is executed twice. This is the only correct  *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      * way in case the block contains only 1 cell between two         *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      * symmetry planes, i.e. a 2D problem.                            *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!</code></a>
<a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a name="bcsymm_spatial_di1"></a><a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="comment">!</code></a>
  <a href="bcsymm_p.html#bcsymmi0" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">secondhalo</code></a>
<a href="bcsymm_p.html#bcsymmi1" target="origFile"><code class="comment">!</code></a>
<a href="bcsymm_p.html#bcsymmi1" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="bcsymm_spatial_di2"></a><a href="bcsymm_p.html#bcsymmi1" target="origFile"><code class="comment">!</code></a>
  <a href="bcsymm_p.html#bcsymmi1" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">kk</code>, <code class="vardecl">mm</code>, <code class="vardecl">nn</code>, <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">l</code></a>
<a name="bcsymm_spatial_di3"></a>  <a href="bcsymm_p.html#bcsymmi2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">vn</code>, <code class="vardecl">nnx</code>, <code class="vardecl">nny</code>, <code class="vardecl">nnz</code></a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">vnd</code></a>
<a name="bcsymm_spatial_di4"></a>  <a href="bcsymm_p.html#bcsymmi3" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">ww1d</code>, <code class="vardecl">ww2d</code></a>
<a name="bcsymm_spatial_di5"></a>  <a href="bcsymm_p.html#bcsymmi4" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
<a name="bcsymm_spatial_di6"></a>  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">pp1d</code>, <code class="vardecl">pp2d</code></a>
<a name="bcsymm_spatial_di7"></a>  <a href="bcsymm_p.html#bcsymmi5" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">gamma1</code>, <code class="vardecl">gamma2</code></a>
  <a href="bcsymm_p.html#bcsymmi6" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
<a name="setbcpointers_spatial_d"></a>  <a href="bcsymm_p.html#bcsymmi7" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">INTERFACE </code></a>
      <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code>(<code class="vardecl">nn</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww1d</code>, <code class="vardecl">ww2</code>, <code class="vardecl">ww2d</code>, <code class="vardecl">pp1</code>, <code class="label">&</code></a>
<a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="label">&        </code><code class="vardecl">pp1d</code>, <code class="vardecl">pp2</code>, <code class="vardecl">pp2d</code>, <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code>, <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code>, <code class="vardecl">offset</code>)</a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">offset</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">ww1d</code>, <code class="vardecl">ww2d</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">pp1d</code>, <code class="vardecl">pp2d</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
      <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code></a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">END INTERFACE</code></a>
<a name="setbcpointers_cd"></a>
  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">INTERFACE </code></a>
      <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD</code>(<code class="vardecl">nn</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code>, <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code>, <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code>, <code class="label">&</code></a>
<a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="label">&        </code><code class="vardecl">rev1</code>, <code class="vardecl">rev2</code>, <code class="vardecl">offset</code>)</a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">offset</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
        <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
      <a href="bcsymm_p.html#setbcpointers" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD</code></a>
<a name="setbcpointers_cdi8"></a>  <a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">END INTERFACE</code></a>

<a href="bcsymm_p.html#i8" target="origFile"><code class="comment">!</code></a>
<a href="bcsymm_p.html#i8" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcsymm_p.html#i8" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcsymm_p.html#i8" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="bcsymm_p.html#i8" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcsymm_p.html#i8" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcsymm_p.html#i8" target="origFile"><code class="comment">!</code></a>
<a href="bcsymm_p.html#i8" target="origFile"><code class="comment">! Set the value of kk; kk == 0 means only single halo, kk == 1</code></a>
<a name="setbcpointers_cdi10"></a><a name="setbcpointers_cdi9"></a><a href="bcsymm_p.html#i8" target="origFile"><code class="comment">! double halo.</code></a>
<a name="setbcpointers_cdi11"></a>  <a href="bcsymm_p.html#i8" target="origFile">kk = <code class="constant">0</code></a>
  <a href="bcsymm_p.html#i9" target="origFile"><code class="keyword">IF</code> (secondhalo) </a><a href="bcsymm_p.html#i10" target="origFile">kk = <code class="constant">1</code></a>
<a name="setbcpointers_cdi12"></a><a href="bcsymm_p.html#i11" target="origFile"><code class="comment">! Loop over the number of times the halo computation must be done.</code></a>
<a href="bcsymm_p.html#i11" target="origFile"><code class="label">nhalo:</code><code class="keyword">DO </code>mm=<code class="constant">0</code>,kk</a>
<a name="setbcpointers_cdi13"></a><a href="bcsymm_p.html#i12" target="origFile"><code class="comment">! Loop over the boundary condition subfaces of this block.</code></a>
<a href="bcsymm_p.html#i12" target="origFile"><code class="label">bocos:</code><code class="keyword">DO </code>nn=<code class="constant">1</code>,nbocos</a>
<a name="setbcpointers_cdi14"></a><a href="bcsymm_p.html#i13" target="origFile"><code class="comment">! Check for symmetry boundary condition.</code></a>
      <a href="bcsymm_p.html#i13" target="origFile"><code class="keyword">IF</code> (bctype(nn) .EQ. symm) <code class="keyword">THEN</code></a>
<a href="bcsymm_p.html#i14" target="origFile"><code class="comment">! Nullify the pointers, because some compilers require that.</code></a>
<a href="bcsymm_p.html#i14" target="origFile"><code class="comment">!nullify(ww1, ww2, pp1, pp2, rlv1, rlv2, rev1, rev2)</code></a>
<a href="bcsymm_p.html#i14" target="origFile"><code class="comment">! Set the pointers to the correct subface.</code></a>
<a name="setbcpointers_cdi15"></a>        <a href="bcsymm_p.html#i14" target="origFile"><code class="keyword">CALL </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code>(nn, ww1, ww1d, ww2, ww2d, pp1, pp1d<code class="label">&</code></a>
<a href="bcsymm_p.html#i14" target="origFile"><code class="label">&                               </code>, pp2, pp2d, rlv1, rlv2, rev1, rev2, mm)</a>
<a href="bcsymm_p.html#i15" target="origFile"><code class="comment">! Set the additional pointers for gamma1 and gamma2.</code></a>
        <a href="bcsymm_p.html#i15" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
        <a href="bcsymm_p.html#i15" target="origFile"><code class="keyword">CASE </code>(imin) </a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma1 => gamma(<code class="constant">1</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma2 => gamma(<code class="constant">2</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bcsymm_p.html#i15" target="origFile"><code class="keyword">CASE </code>(imax) </a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma1 => gamma(ie, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma2 => gamma(il, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bcsymm_p.html#i15" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma1 => gamma(<code class="constant">1</code>:, <code class="constant">1</code>, <code class="constant">1</code>:)</a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma2 => gamma(<code class="constant">1</code>:, <code class="constant">2</code>, <code class="constant">1</code>:)</a>
        <a href="bcsymm_p.html#i15" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma1 => gamma(<code class="constant">1</code>:, je, <code class="constant">1</code>:)</a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma2 => gamma(<code class="constant">1</code>:, jl, <code class="constant">1</code>:)</a>
        <a href="bcsymm_p.html#i15" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma1 => gamma(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">1</code>)</a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma2 => gamma(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">2</code>)</a>
        <a href="bcsymm_p.html#i15" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
          <a href="bcsymm_p.html#i15" target="origFile">gamma1 => gamma(<code class="constant">1</code>:, <code class="constant">1</code>:, ke)</a>
<a name="setbcpointers_cdi28"></a>          <a href="bcsymm_p.html#i15" target="origFile">gamma2 => gamma(<code class="constant">1</code>:, <code class="constant">1</code>:, kl)</a>
        <a href="bcsymm_p.html#i15" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="bcsymm_p.html#i28" target="origFile"><code class="comment">! Loop over the generic subface to set the state in the</code></a>
<a name="setbcpointers_cdi29"></a><a href="bcsymm_p.html#i28" target="origFile"><code class="comment">! halo cells.</code></a>
<a name="setbcpointers_cdi30"></a>        <a href="bcsymm_p.html#i28" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
          <a href="bcsymm_p.html#i29" target="origFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
<a href="bcsymm_p.html#i30" target="origFile"><code class="comment">! Store the three components of the unit normal a</code></a>
<a name="setbcpointers_cdi31"></a><a href="bcsymm_p.html#i30" target="origFile"><code class="comment">! bit easier.</code></a>
<a name="setbcpointers_cdi32"></a>            <a href="bcsymm_p.html#i30" target="origFile">nnx = bcdata(nn)%norm(i, j, <code class="constant">1</code>)</a>
<a name="setbcpointers_cdi33"></a>            <a href="bcsymm_p.html#i31" target="origFile">nny = bcdata(nn)%norm(i, j, <code class="constant">2</code>)</a>
            <a href="bcsymm_p.html#i32" target="origFile">nnz = bcdata(nn)%norm(i, j, <code class="constant">3</code>)</a>
<a href="bcsymm_p.html#i33" target="origFile"><code class="comment">! Determine twice the normal velocity component,</code></a>
<a href="bcsymm_p.html#i33" target="origFile"><code class="comment">! which must be substracted from the donor velocity</code></a>
<a href="bcsymm_p.html#i33" target="origFile"><code class="comment">! to obtain the halo velocity.</code></a>
            <a href="bcsymm_p.html#i33" target="origFile">vnd = two*(nnx*ww2d(i, j, ivx)+nny*ww2d(i, j, ivy)+nnz*ww2d(<code class="label">&</code></a>
<a href="bcsymm_p.html#i33" target="origFile"><code class="label">&              </code>i, j, ivz))</a>
<a name="setbcpointers_cdi34"></a>            <a href="bcsymm_p.html#i33" target="origFile">vn = two*(ww2(i, j, ivx)*nnx+ww2(i, j, ivy)*nny+ww2(i, j, <code class="label">&</code></a>
<a href="bcsymm_p.html#i33" target="origFile"><code class="label">&              </code>ivz)*nnz)</a>
<a href="bcsymm_p.html#i34" target="origFile"><code class="comment">! Determine the flow variables in the halo cell.</code></a>
<a name="setbcpointers_cdi35"></a>            <a href="bcsymm_p.html#i34" target="origFile">ww1d(i, j, irho) = ww2d(i, j, irho)</a>
            <a href="bcsymm_p.html#i34" target="origFile">ww1(i, j, irho) = ww2(i, j, irho)</a>
<a href="bcsymm_p.html#i35" target="origFile"><code class="comment">!write(14, *),i,j,kk,irho,ww2(i,j,irho)</code></a>
<a name="setbcpointers_cdi36"></a>            <a href="bcsymm_p.html#i35" target="origFile">ww1d(i, j, ivx) = ww2d(i, j, ivx) - nnx*vnd</a>
            <a href="bcsymm_p.html#i35" target="origFile">ww1(i, j, ivx) = ww2(i, j, ivx) - vn*nnx</a>
<a name="setbcpointers_cdi37"></a>            <a href="bcsymm_p.html#i36" target="origFile">ww1d(i, j, ivy) = ww2d(i, j, ivy) - nny*vnd</a>
            <a href="bcsymm_p.html#i36" target="origFile">ww1(i, j, ivy) = ww2(i, j, ivy) - vn*nny</a>
<a name="setbcpointers_cdi38"></a>            <a href="bcsymm_p.html#i37" target="origFile">ww1d(i, j, ivz) = ww2d(i, j, ivz) - nnz*vnd</a>
            <a href="bcsymm_p.html#i37" target="origFile">ww1(i, j, ivz) = ww2(i, j, ivz) - vn*nnz</a>
<a name="setbcpointers_cdi39"></a>            <a href="bcsymm_p.html#i38" target="origFile">ww1d(i, j, irhoe) = ww2d(i, j, irhoe)</a>
            <a href="bcsymm_p.html#i38" target="origFile">ww1(i, j, irhoe) = ww2(i, j, irhoe)</a>
<a name="setbcpointers_cdi40"></a><a href="bcsymm_p.html#i39" target="origFile"><code class="comment">! Simply copy the turbulent variables.</code></a>
            <a href="bcsymm_p.html#i39" target="origFile"><code class="keyword">DO </code>l=nt1mg,nt2mg</a>
              <a href="bcsymm_p.html#i40" target="origFile">ww1d(i, j, l) = ww2d(i, j, l)</a>
<a name="setbcpointers_cdi41"></a>              <a href="bcsymm_p.html#i40" target="origFile">ww1(i, j, l) = ww2(i, j, l)</a>
            <a href="bcsymm_p.html#i39" target="origFile"><code class="keyword">END DO</code></a>
<a href="bcsymm_p.html#i41" target="origFile"><code class="comment">! Set the pressure and gamma and possibly the</code></a>
<a name="setbcpointers_cdi42"></a><a href="bcsymm_p.html#i41" target="origFile"><code class="comment">! laminar and eddy viscosity in the halo.</code></a>
            <a href="bcsymm_p.html#i41" target="origFile">gamma1(i, j) = gamma2(i, j)</a>
<a name="setbcpointers_cdi44"></a><a name="setbcpointers_cdi43"></a>            <a href="bcsymm_p.html#i42" target="origFile">pp1d(i, j) = pp2d(i, j)</a>
<a name="setbcpointers_cdi46"></a><a name="setbcpointers_cdi45"></a>            <a href="bcsymm_p.html#i42" target="origFile">pp1(i, j) = pp2(i, j)</a>
            <a href="bcsymm_p.html#i43" target="origFile"><code class="keyword">IF</code> (viscous) </a><a href="bcsymm_p.html#i44" target="origFile">rlv1(i, j) = rlv2(i, j)</a>
            <a href="bcsymm_p.html#i45" target="origFile"><code class="keyword">IF</code> (eddymodel) </a><a href="bcsymm_p.html#i46" target="origFile">rev1(i, j) = rev2(i, j)</a>
          <a href="bcsymm_p.html#i29" target="origFile"><code class="keyword">END DO</code></a>
        <a href="bcsymm_p.html#i28" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bcsymm_p.html#i13" target="origFile"><code class="keyword">END IF</code></a>
    <a href="bcsymm_p.html#i12" target="origFile"><code class="keyword">END DO </code><code class="label">bocos</code></a>
  <a href="bcsymm_p.html#i11" target="origFile"><code class="keyword">END DO </code><code class="label">nhalo</code></a>
<a href="bcsymm_p.html#bcsymm" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">BCSYMM_SPATIAL_D</code></a>
</pre>
</body>
