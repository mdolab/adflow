<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="bceulerwall_spatial_d"></a><a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!  Differentiation of bceulerwall in forward (tangent) mode:</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!   variations   of useful results: *p *gamma *w</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!   with respect to varying inputs: *p *gamma *w gammaconstant</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * File:          bcEulerWall.f90                                 *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * Starting date: 03-07-2003                                      *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      * Last modified: 06-12-2005                                      *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">BCEULERWALL_SPATIAL_D</code>(<code class="vardecl">secondhalo</code>, <code class="vardecl">correctfork</code>)</a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">BCTYPES_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTDISCRETIZATION_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
<a name="bceulerwall_spatial_di0"></a>  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!      * bcEulerWall applies the inviscid wall boundary condition to    *</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!      * a block. It is assumed that the pointers in blockPointers are  *</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!      * already set to the correct block on the correct grid level.    *</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a name="bceulerwall_spatial_di1"></a><a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="comment">!</code></a>
  <a href="bceulerwall_p.html#bceulerwalli0" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">secondhalo</code>, <code class="vardecl">correctfork</code></a>
<a href="bceulerwall_p.html#bceulerwalli1" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#bceulerwalli1" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="bceulerwall_spatial_di2"></a><a href="bceulerwall_p.html#bceulerwalli1" target="origFile"><code class="comment">!</code></a>
<a name="bceulerwall_spatial_di3"></a>  <a href="bceulerwall_p.html#bceulerwalli1" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">l</code></a>
<a name="bceulerwall_spatial_di4"></a>  <a href="bceulerwall_p.html#bceulerwalli2" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">jm1</code>, <code class="vardecl">jp1</code>, <code class="vardecl">km1</code>, <code class="vardecl">kp1</code></a>
<a name="bceulerwall_spatial_di5"></a>  <a href="bceulerwall_p.html#bceulerwalli3" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">walltreatment</code></a>
<a name="bceulerwall_spatial_di6"></a>  <a href="bceulerwall_p.html#bceulerwalli4" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sixa</code>, <code class="vardecl">siya</code>, <code class="vardecl">siza</code>, <code class="vardecl">sjxa</code>, <code class="vardecl">sjya</code>, <code class="vardecl">sjza</code></a>
<a name="bceulerwall_spatial_di7"></a>  <a href="bceulerwall_p.html#bceulerwalli5" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">skxa</code>, <code class="vardecl">skya</code>, <code class="vardecl">skza</code>, <code class="vardecl">a1</code>, <code class="vardecl">b1</code></a>
  <a href="bceulerwall_p.html#bceulerwalli6" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rxj</code>, <code class="vardecl">ryj</code>, <code class="vardecl">rzj</code>, <code class="vardecl">rxk</code>, <code class="vardecl">ryk</code>, <code class="vardecl">rzk</code></a>
<a name="bceulerwall_spatial_di8"></a>  <a href="bceulerwall_p.html#bceulerwalli7" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dpj</code>, <code class="vardecl">dpk</code>, <code class="vardecl">ri</code>, <code class="vardecl">rj</code>, <code class="vardecl">rk</code>, <code class="vardecl">qj</code>, <code class="vardecl">qk</code>, <code class="vardecl">vn</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dpjd</code>, <code class="vardecl">dpkd</code>, <code class="vardecl">qjd</code>, <code class="vardecl">qkd</code>, <code class="vardecl">vnd</code></a>
<a name="bceulerwall_spatial_di9"></a>  <a href="bceulerwall_p.html#bceulerwalli8" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ux</code>, <code class="vardecl">uy</code>, <code class="vardecl">uz</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">uxd</code>, <code class="vardecl">uyd</code>, <code class="vardecl">uzd</code></a>
<a name="bceulerwall_spatial_di10"></a>  <a href="bceulerwall_p.html#bceulerwalli9" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">ww1d</code>, <code class="vardecl">ww2d</code></a>
<a name="bceulerwall_spatial_di11"></a>  <a href="bceulerwall_p.html#bceulerwalli10" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">pp1d</code>, <code class="vardecl">pp2d</code></a>
<a name="bceulerwall_spatial_di12"></a>  <a href="bceulerwall_p.html#bceulerwalli11" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp3</code>, <code class="vardecl">pp4</code></a>
<a name="bceulerwall_spatial_di13"></a>  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">pp3d</code>, <code class="vardecl">pp4d</code></a>
<a name="bceulerwall_spatial_di14"></a>  <a href="bceulerwall_p.html#bceulerwalli12" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
<a name="bceulerwall_spatial_di15"></a>  <a href="bceulerwall_p.html#bceulerwalli13" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
<a name="bceulerwall_spatial_di16"></a>  <a href="bceulerwall_p.html#bceulerwalli14" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ssi</code>, <code class="vardecl">ssj</code>, <code class="vardecl">ssk</code></a>
<a name="bceulerwall_spatial_di17"></a>  <a href="bceulerwall_p.html#bceulerwalli15" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">norm</code></a>
  <a href="bceulerwall_p.html#bceulerwalli16" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rface</code></a>
  <a href="bceulerwall_p.html#bceulerwalli17" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ss</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="funcname">DIM_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="modifier">intType</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
<a name="setbcpointers_spatial_d"></a>  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="typename">REAL(</code><code class="modifier">intType</code><code class="typename">) </code>:: <code class="vardecl">max1</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">INTERFACE </code></a>
      <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code>(<code class="vardecl">nn</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww1d</code>, <code class="vardecl">ww2</code>, <code class="vardecl">ww2d</code>, <code class="vardecl">pp1</code>, <code class="label">&</code></a>
<a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="label">&        </code><code class="vardecl">pp1d</code>, <code class="vardecl">pp2</code>, <code class="vardecl">pp2d</code>, <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code>, <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code>, <code class="vardecl">offset</code>)</a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">offset</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">ww1d</code>, <code class="vardecl">ww2d</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :), <code class="modifier">POINTER </code>:: <code class="vardecl">pp1d</code>, <code class="vardecl">pp2d</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
      <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END INTERFACE</code></a>
<a name="setbcpointers_cd0"></a>
  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">INTERFACE </code></a>
      <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD0</code>(<code class="vardecl">nn</code>, <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code>, <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code>, <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code>, <code class="label">&</code></a>
<a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="label">&        </code><code class="vardecl">rev1</code>, <code class="vardecl">rev2</code>, <code class="vardecl">offset</code>)</a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">offset</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww1</code>, <code class="vardecl">ww2</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">pp1</code>, <code class="vardecl">pp2</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv1</code>, <code class="vardecl">rlv2</code></a>
        <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rev1</code>, <code class="vardecl">rev2</code></a>
      <a href="bceulerwall_p.html#setbcpointers" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">SETBCPOINTERS_CD0</code></a>
<a name="setbcpointers_cd0i18"></a>  <a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END INTERFACE</code></a>

<a href="bceulerwall_p.html#i18" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#i18" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#i18" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#i18" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="bceulerwall_p.html#i18" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bceulerwall_p.html#i18" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bceulerwall_p.html#i18" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#i18" target="origFile"><code class="comment">! Make sure that on the coarser grids the constant pressure</code></a>
<a name="setbcpointers_cd0i20"></a><a name="setbcpointers_cd0i19"></a><a href="bceulerwall_p.html#i18" target="origFile"><code class="comment">! boundary condition is used.</code></a>
<a name="setbcpointers_cd0i21"></a>  <a href="bceulerwall_p.html#i18" target="origFile">walltreatment = wallbctreatment</a>
  <a href="bceulerwall_p.html#i19" target="origFile"><code class="keyword">IF</code> (currentlevel .GT. groundlevel) </a><a href="bceulerwall_p.html#i20" target="origFile">walltreatment = constantpressure</a>
<a name="setbcpointers_cd0i22"></a><a href="bceulerwall_p.html#i21" target="origFile"><code class="comment">! Loop over the boundary condition subfaces of this block.</code></a>
<a href="bceulerwall_p.html#i21" target="origFile"><code class="label">bocos:</code><code class="keyword">DO </code>nn=<code class="constant">1</code>,nbocos</a>
<a href="bceulerwall_p.html#i22" target="origFile"><code class="comment">! Check for Euler wall boundary condition.</code></a>
    <a href="bceulerwall_p.html#i22" target="origFile"><code class="keyword">IF</code> (bctype(nn) .EQ. eulerwall) <code class="keyword">THEN</code></a>
<a href="bceulerwall_p.html#i22" target="origFile"><code class="comment">! Set the pointers for the unit normal and the normal</code></a>
<a href="bceulerwall_p.html#i22" target="origFile"><code class="comment">! velocity to make the code more readable.</code></a>
<a name="setbcpointers_cd0i25"></a>      <a href="bceulerwall_p.html#i22" target="origFile">norm => bcdata(nn)%norm</a>
      <a href="bceulerwall_p.html#i22" target="origFile">rface => bcdata(nn)%rface</a>
<a href="bceulerwall_p.html#i25" target="origFile"><code class="comment">! Nullify the pointers and set them to the correct subface.</code></a>
<a href="bceulerwall_p.html#i25" target="origFile"><code class="comment">! They are nullified first, because some compilers require</code></a>
<a href="bceulerwall_p.html#i25" target="origFile"><code class="comment">! that.</code></a>
<a name="p20"></a><a href="bceulerwall_p.html#i25" target="origFile"><code class="comment">!nullify(ww1, ww2, pp1, pp2, rlv1, rlv2, rev1, rev2)</code></a>
      <a href="bceulerwall_p.html#i25" target="origFile"><code class="keyword">CALL </code><code class="funcname">SETBCPOINTERS_SPATIAL_D</code>(nn, ww1, ww1d, ww2, ww2d, pp1, pp1d, <code class="label">&</code></a>
<a name="setbcpointers_cd0i26"></a><a href="bceulerwall_p.html#i25" target="origFile"><code class="label">&                             </code>pp2, pp2d, rlv1, rlv2, rev1, rev2, </a><a href="msg.html#p20" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="bceulerwall_p.html#i25" target="origFile"><code class="label">&</code></a>
<a href="bceulerwall_p.html#i25" target="origFile"><code class="label">&                             </code><code class="constant">0_intType</code>)</a>
<a href="bceulerwall_p.html#i26" target="origFile"><code class="comment">!</code></a>
<a href="bceulerwall_p.html#i26" target="origFile"><code class="comment">!          **************************************************************</code></a>
<a href="bceulerwall_p.html#i26" target="origFile"><code class="comment">!          *                                                            *</code></a>
<a href="bceulerwall_p.html#i26" target="origFile"><code class="comment">!          * Determine the boundary condition treatment and compute the *</code></a>
<a href="bceulerwall_p.html#i26" target="origFile"><code class="comment">!          * undivided pressure gradient accordingly. This gradient is  *</code></a>
<a href="bceulerwall_p.html#i26" target="origFile"><code class="comment">!          * temporarily stored in the halo pressure.                   *</code></a>
<a href="bceulerwall_p.html#i26" target="origFile"><code class="comment">!          *                                                            *</code></a>
<a href="bceulerwall_p.html#i26" target="origFile"><code class="comment">!          **************************************************************</code></a>
<a href="bceulerwall_p.html#i26" target="origFile"><code class="comment">!</code></a>
<a name="setbcpointers_cd0i27"></a>      <a href="bceulerwall_p.html#i26" target="origFile"><code class="keyword">SELECT CASE </code> (walltreatment) </a>
      <a href="bceulerwall_p.html#i26" target="origFile"><code class="keyword">CASE </code>(constantpressure) </a>
<a name="setbcpointers_cd0i28"></a><a href="bceulerwall_p.html#i27" target="origFile"><code class="comment">! Constant pressure. Set the gradient to zero.</code></a>
<a name="setbcpointers_cd0i29"></a>        <a href="bceulerwall_p.html#i27" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
          <a href="bceulerwall_p.html#i28" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
            <a href="bceulerwall_p.html#i29" target="origFile">pp1d(j, k) = <code class="constant">0.0</code></a>
            <a href="bceulerwall_p.html#i29" target="origFile">pp1(j, k) = zero</a>
          <a href="bceulerwall_p.html#i28" target="origFile"><code class="keyword">END DO</code></a>
<a name="setbcpointers_cd0i30"></a>        <a href="bceulerwall_p.html#i27" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#i26" target="origFile"><code class="keyword">CASE </code>(linextrapolpressure) </a>
<a href="bceulerwall_p.html#i30" target="origFile"><code class="comment">!===========================================================</code></a>
<a href="bceulerwall_p.html#i30" target="origFile"><code class="comment">! Linear extrapolation. First set the additional pointer</code></a>
<a href="bceulerwall_p.html#i30" target="origFile"><code class="comment">! for pp3, depending on the block face.</code></a>
        <a href="bceulerwall_p.html#i30" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
        <a href="bceulerwall_p.html#i30" target="origFile"><code class="keyword">CASE </code>(imin) </a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3d => pd(<code class="constant">3</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3 => p(<code class="constant">3</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#i30" target="origFile"><code class="keyword">CASE </code>(imax) </a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3d => pd(nx, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3 => p(nx, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#i30" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3d => pd(<code class="constant">1</code>:, <code class="constant">3</code>, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">3</code>, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#i30" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3d => pd(<code class="constant">1</code>:, ny, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3 => p(<code class="constant">1</code>:, ny, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#i30" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3d => pd(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">3</code>)</a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">3</code>)</a>
        <a href="bceulerwall_p.html#i30" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
          <a href="bceulerwall_p.html#i30" target="origFile">pp3d => pd(<code class="constant">1</code>:, <code class="constant">1</code>:, nz)</a>
<a name="setbcpointers_cd0i37"></a>          <a href="bceulerwall_p.html#i30" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, nz)</a>
        <a href="bceulerwall_p.html#i30" target="origFile"><code class="keyword">END SELECT</code></a>
<a name="setbcpointers_cd0i38"></a><a href="bceulerwall_p.html#i37" target="origFile"><code class="comment">! Compute the gradient.</code></a>
<a name="setbcpointers_cd0i39"></a>        <a href="bceulerwall_p.html#i37" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
          <a href="bceulerwall_p.html#i38" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
            <a href="bceulerwall_p.html#i39" target="origFile">pp1d(j, k) = pp3d(j, k) - pp2d(j, k)</a>
            <a href="bceulerwall_p.html#i39" target="origFile">pp1(j, k) = pp3(j, k) - pp2(j, k)</a>
          <a href="bceulerwall_p.html#i38" target="origFile"><code class="keyword">END DO</code></a>
<a name="setbcpointers_cd0i40"></a>        <a href="bceulerwall_p.html#i37" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#i26" target="origFile"><code class="keyword">CASE </code>(quadextrapolpressure) </a>
<a href="bceulerwall_p.html#i40" target="origFile"><code class="comment">!===========================================================</code></a>
<a href="bceulerwall_p.html#i40" target="origFile"><code class="comment">! Quadratic extrapolation. First set the additional</code></a>
<a href="bceulerwall_p.html#i40" target="origFile"><code class="comment">! pointers for pp3 and pp4, depending on the block face.</code></a>
        <a href="bceulerwall_p.html#i40" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
        <a href="bceulerwall_p.html#i40" target="origFile"><code class="keyword">CASE </code>(imin) </a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3d => pd(<code class="constant">3</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3 => p(<code class="constant">3</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4d => pd(<code class="constant">4</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4 => p(<code class="constant">4</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#i40" target="origFile"><code class="keyword">CASE </code>(imax) </a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3d => pd(nx, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3 => p(nx, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4d => pd(nx-<code class="constant">1</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4 => p(nx-<code class="constant">1</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#i40" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3d => pd(<code class="constant">1</code>:, <code class="constant">3</code>, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">3</code>, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4d => pd(<code class="constant">1</code>:, <code class="constant">4</code>, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4 => p(<code class="constant">1</code>:, <code class="constant">4</code>, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#i40" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3d => pd(<code class="constant">1</code>:, ny, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3 => p(<code class="constant">1</code>:, ny, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4d => pd(<code class="constant">1</code>:, ny-<code class="constant">1</code>, <code class="constant">1</code>:)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4 => p(<code class="constant">1</code>:, ny-<code class="constant">1</code>, <code class="constant">1</code>:)</a>
        <a href="bceulerwall_p.html#i40" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3d => pd(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">3</code>)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">3</code>)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4d => pd(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">4</code>)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">4</code>)</a>
        <a href="bceulerwall_p.html#i40" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3d => pd(<code class="constant">1</code>:, <code class="constant">1</code>:, nz)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp3 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, nz)</a>
          <a href="bceulerwall_p.html#i40" target="origFile">pp4d => pd(<code class="constant">1</code>:, <code class="constant">1</code>:, nz-<code class="constant">1</code>)</a>
<a name="setbcpointers_cd0i53"></a>          <a href="bceulerwall_p.html#i40" target="origFile">pp4 => p(<code class="constant">1</code>:, <code class="constant">1</code>:, nz-<code class="constant">1</code>)</a>
        <a href="bceulerwall_p.html#i40" target="origFile"><code class="keyword">END SELECT</code></a>
<a name="setbcpointers_cd0i54"></a><a href="bceulerwall_p.html#i53" target="origFile"><code class="comment">! Compute the gradient.</code></a>
<a name="setbcpointers_cd0i55"></a>        <a href="bceulerwall_p.html#i53" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
          <a href="bceulerwall_p.html#i54" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
            <a href="bceulerwall_p.html#i55" target="origFile">pp1d(j, k) = two*pp3d(j, k) - <code class="constant">1.5_realType</code>*pp2d(j, k) - half<code class="label">&</code></a>
<a href="bceulerwall_p.html#i55" target="origFile"><code class="label">&              </code>*pp4d(j, k)</a>
            <a href="bceulerwall_p.html#i55" target="origFile">pp1(j, k) = two*pp3(j, k) - <code class="constant">1.5_realType</code>*pp2(j, k) - half*<code class="label">&</code></a>
<a href="bceulerwall_p.html#i55" target="origFile"><code class="label">&              </code>pp4(j, k)</a>
          <a href="bceulerwall_p.html#i54" target="origFile"><code class="keyword">END DO</code></a>
<a name="setbcpointers_cd0i56"></a>        <a href="bceulerwall_p.html#i53" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#i26" target="origFile"><code class="keyword">CASE </code>(normalmomentum) </a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">!===========================================================</code></a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">! Pressure gradient is computed using the normal momentum</code></a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">! equation. First set a couple of additional variables for</code></a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">! the normals, depending on the block face. Note that the</code></a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">! construction 1: should not be used in these pointers,</code></a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">! because element 0 is needed. Consequently there will be</code></a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">! an offset of 1 for these normals. This is commented in</code></a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">! the code. For moving faces also the grid velocity of</code></a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">! the 1st cell center from the wall is needed.</code></a>
        <a href="bceulerwall_p.html#i56" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
        <a href="bceulerwall_p.html#i56" target="origFile"><code class="keyword">CASE </code>(imin) </a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssi => si(<code class="constant">1</code>, :, :, :)</a>
<a name="setbcpointers_cd0i60"></a>          <a href="bceulerwall_p.html#i56" target="origFile">ssj => sj(<code class="constant">2</code>, :, :, :)</a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssk => sk(<code class="constant">2</code>, :, :, :)</a>
          <a href="bceulerwall_p.html#i60" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#i60" target="origFile">ss => s(<code class="constant">2</code>, :, :, :)</a>
          <a href="bceulerwall_p.html#i60" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#i56" target="origFile"><code class="keyword">CASE </code>(imax) </a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssi => si(il, :, :, :)</a>
<a name="setbcpointers_cd0i65"></a>          <a href="bceulerwall_p.html#i56" target="origFile">ssj => sj(il, :, :, :)</a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssk => sk(il, :, :, :)</a>
          <a href="bceulerwall_p.html#i65" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#i65" target="origFile">ss => s(il, :, :, :)</a>
          <a href="bceulerwall_p.html#i65" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#i56" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssi => sj(:, <code class="constant">1</code>, :, :)</a>
<a name="setbcpointers_cd0i70"></a>          <a href="bceulerwall_p.html#i56" target="origFile">ssj => si(:, <code class="constant">2</code>, :, :)</a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssk => sk(:, <code class="constant">2</code>, :, :)</a>
          <a href="bceulerwall_p.html#i70" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#i70" target="origFile">ss => s(:, <code class="constant">2</code>, :, :)</a>
          <a href="bceulerwall_p.html#i70" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#i56" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssi => sj(:, jl, :, :)</a>
<a name="setbcpointers_cd0i75"></a>          <a href="bceulerwall_p.html#i56" target="origFile">ssj => si(:, jl, :, :)</a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssk => sk(:, jl, :, :)</a>
          <a href="bceulerwall_p.html#i75" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#i75" target="origFile">ss => s(:, jl, :, :)</a>
          <a href="bceulerwall_p.html#i75" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#i56" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssi => sk(:, :, <code class="constant">1</code>, :)</a>
<a name="setbcpointers_cd0i80"></a>          <a href="bceulerwall_p.html#i56" target="origFile">ssj => si(:, :, <code class="constant">2</code>, :)</a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssk => sj(:, :, <code class="constant">2</code>, :)</a>
          <a href="bceulerwall_p.html#i80" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#i80" target="origFile">ss => s(:, :, <code class="constant">2</code>, :)</a>
          <a href="bceulerwall_p.html#i80" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#i56" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
<a href="bceulerwall_p.html#i56" target="origFile"><code class="comment">!=======================================================</code></a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssi => sk(:, :, kl, :)</a>
<a name="setbcpointers_cd0i85"></a>          <a href="bceulerwall_p.html#i56" target="origFile">ssj => si(:, :, kl, :)</a>
          <a href="bceulerwall_p.html#i56" target="origFile">ssk => sj(:, :, kl, :)</a>
          <a href="bceulerwall_p.html#i85" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
            <a href="bceulerwall_p.html#i85" target="origFile">ss => s(:, :, kl, :)</a>
<a name="setbcpointers_cd0i87"></a>          <a href="bceulerwall_p.html#i85" target="origFile"><code class="keyword">END IF</code></a>
        <a href="bceulerwall_p.html#i56" target="origFile"><code class="keyword">END SELECT</code></a>
<a name="setbcpointers_cd0i88"></a><a href="bceulerwall_p.html#i87" target="origFile"><code class="comment">! Loop over the faces of the generic subface.</code></a>
        <a href="bceulerwall_p.html#i87" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
<a href="bceulerwall_p.html#i88" target="origFile"><code class="comment">! Store the indices k+1, k-1 a bit easier and make</code></a>
<a name="setbcpointers_cd0i89"></a><a href="bceulerwall_p.html#i88" target="origFile"><code class="comment">! sure that they do not exceed the range of the arrays.</code></a>
<a name="setbcpointers_cd0i91"></a>          <a href="bceulerwall_p.html#i88" target="origFile">km1 = k - <code class="constant">1</code></a>
          <a href="bceulerwall_p.html#i89" target="origFile"><code class="keyword">IF</code> (bcdata(nn)%jcbeg .LT. km1) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i90"></a>            <a href="bceulerwall_p.html#i91" target="origFile">km1 = km1</a>
          <a href="bceulerwall_p.html#i89" target="origFile"><code class="keyword">ELSE</code></a>
<a name="setbcpointers_cd0i92"></a>            <a href="bceulerwall_p.html#i90" target="origFile">km1 = bcdata(nn)%jcbeg</a>
<a name="setbcpointers_cd0i93"></a>          <a href="bceulerwall_p.html#i89" target="origFile"><code class="keyword">END IF</code></a>
<a name="setbcpointers_cd0i95"></a>          <a href="bceulerwall_p.html#i92" target="origFile">kp1 = k + <code class="constant">1</code></a>
          <a href="bceulerwall_p.html#i93" target="origFile"><code class="keyword">IF</code> (bcdata(nn)%jcend .GT. kp1) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i94"></a>            <a href="bceulerwall_p.html#i95" target="origFile">kp1 = kp1</a>
          <a href="bceulerwall_p.html#i93" target="origFile"><code class="keyword">ELSE</code></a>
<a name="setbcpointers_cd0i96"></a>            <a href="bceulerwall_p.html#i94" target="origFile">kp1 = bcdata(nn)%jcend</a>
<a name="setbcpointers_cd0i98"></a>          <a href="bceulerwall_p.html#i93" target="origFile"><code class="keyword">END IF</code></a>
          <a href="bceulerwall_p.html#i96" target="origFile"><code class="keyword">IF</code> (<code class="constant">1_intType </code>.LT. kp1 - km1) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i97"></a>            <a href="bceulerwall_p.html#i98" target="origFile">max1 = kp1 - km1</a>
          <a href="bceulerwall_p.html#i96" target="origFile"><code class="keyword">ELSE</code></a>
<a name="setbcpointers_cd0i99"></a>            <a href="bceulerwall_p.html#i97" target="origFile">max1 = <code class="constant">1_intType</code></a>
          <a href="bceulerwall_p.html#i96" target="origFile"><code class="keyword">END IF</code></a>
<a href="bceulerwall_p.html#i99" target="origFile"><code class="comment">! Compute the scaling factor for the central difference</code></a>
<a name="setbcpointers_cd0i100"></a><a href="bceulerwall_p.html#i99" target="origFile"><code class="comment">! in the k-direction.</code></a>
          <a href="bceulerwall_p.html#i99" target="origFile">b1 = one/max1</a>
<a name="setbcpointers_cd0i101"></a><a href="bceulerwall_p.html#i100" target="origFile"><code class="comment">! The j-loop.</code></a>
          <a href="bceulerwall_p.html#i100" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
<a href="bceulerwall_p.html#i101" target="origFile"><code class="comment">! The indices j+1 and j-1. Make sure that they</code></a>
<a name="setbcpointers_cd0i102"></a><a href="bceulerwall_p.html#i101" target="origFile"><code class="comment">! do not exceed the range of the arrays.</code></a>
<a name="setbcpointers_cd0i104"></a>            <a href="bceulerwall_p.html#i101" target="origFile">jm1 = j - <code class="constant">1</code></a>
            <a href="bceulerwall_p.html#i102" target="origFile"><code class="keyword">IF</code> (bcdata(nn)%icbeg .LT. jm1) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i103"></a>              <a href="bceulerwall_p.html#i104" target="origFile">jm1 = jm1</a>
            <a href="bceulerwall_p.html#i102" target="origFile"><code class="keyword">ELSE</code></a>
<a name="setbcpointers_cd0i105"></a>              <a href="bceulerwall_p.html#i103" target="origFile">jm1 = bcdata(nn)%icbeg</a>
<a name="setbcpointers_cd0i106"></a>            <a href="bceulerwall_p.html#i102" target="origFile"><code class="keyword">END IF</code></a>
<a name="setbcpointers_cd0i108"></a>            <a href="bceulerwall_p.html#i105" target="origFile">jp1 = j + <code class="constant">1</code></a>
            <a href="bceulerwall_p.html#i106" target="origFile"><code class="keyword">IF</code> (bcdata(nn)%icend .GT. jp1) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i107"></a>              <a href="bceulerwall_p.html#i108" target="origFile">jp1 = jp1</a>
            <a href="bceulerwall_p.html#i106" target="origFile"><code class="keyword">ELSE</code></a>
<a name="setbcpointers_cd0i109"></a>              <a href="bceulerwall_p.html#i107" target="origFile">jp1 = bcdata(nn)%icend</a>
<a name="setbcpointers_cd0i111"></a>            <a href="bceulerwall_p.html#i106" target="origFile"><code class="keyword">END IF</code></a>
            <a href="bceulerwall_p.html#i109" target="origFile"><code class="keyword">IF</code> (<code class="constant">1_intType </code>.LT. jp1 - jm1) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i110"></a>              <a href="bceulerwall_p.html#i111" target="origFile">max2 = jp1 - jm1</a>
            <a href="bceulerwall_p.html#i109" target="origFile"><code class="keyword">ELSE</code></a>
<a name="setbcpointers_cd0i112"></a>              <a href="bceulerwall_p.html#i110" target="origFile">max2 = <code class="constant">1_intType</code></a>
            <a href="bceulerwall_p.html#i109" target="origFile"><code class="keyword">END IF</code></a>
<a href="bceulerwall_p.html#i112" target="origFile"><code class="comment">! Compute the scaling factor for the central</code></a>
<a name="setbcpointers_cd0i113"></a><a href="bceulerwall_p.html#i112" target="origFile"><code class="comment">! difference in the j-direction.</code></a>
            <a href="bceulerwall_p.html#i112" target="origFile">a1 = one/max2</a>
<a href="bceulerwall_p.html#i113" target="origFile"><code class="comment">! Compute (twice) the average normal in the generic i,</code></a>
<a href="bceulerwall_p.html#i113" target="origFile"><code class="comment">! j and k-direction. Note that in j and k-direction</code></a>
<a href="bceulerwall_p.html#i113" target="origFile"><code class="comment">! the average in the original indices should be taken</code></a>
<a href="bceulerwall_p.html#i113" target="origFile"><code class="comment">! using j-1 and j (and k-1 and k). However due to the</code></a>
<a href="bceulerwall_p.html#i113" target="origFile"><code class="comment">! usage of pointers ssj and ssk there is an offset in</code></a>
<a href="bceulerwall_p.html#i113" target="origFile"><code class="comment">! the indices of 1 and therefore now the correct</code></a>
<a href="bceulerwall_p.html#i113" target="origFile"><code class="comment">! average is obtained with the indices j and j+1</code></a>
<a name="setbcpointers_cd0i114"></a><a href="bceulerwall_p.html#i113" target="origFile"><code class="comment">! (k and k+1).</code></a>
<a name="setbcpointers_cd0i115"></a>            <a href="bceulerwall_p.html#i113" target="origFile">sixa = two*ssi(j, k, <code class="constant">1</code>)</a>
<a name="setbcpointers_cd0i116"></a>            <a href="bceulerwall_p.html#i114" target="origFile">siya = two*ssi(j, k, <code class="constant">2</code>)</a>
<a name="setbcpointers_cd0i117"></a>            <a href="bceulerwall_p.html#i115" target="origFile">siza = two*ssi(j, k, <code class="constant">3</code>)</a>
<a name="setbcpointers_cd0i118"></a>            <a href="bceulerwall_p.html#i116" target="origFile">sjxa = ssj(j, k, <code class="constant">1</code>) + ssj(j+<code class="constant">1</code>, k, <code class="constant">1</code>)</a>
<a name="setbcpointers_cd0i119"></a>            <a href="bceulerwall_p.html#i117" target="origFile">sjya = ssj(j, k, <code class="constant">2</code>) + ssj(j+<code class="constant">1</code>, k, <code class="constant">2</code>)</a>
<a name="setbcpointers_cd0i120"></a>            <a href="bceulerwall_p.html#i118" target="origFile">sjza = ssj(j, k, <code class="constant">3</code>) + ssj(j+<code class="constant">1</code>, k, <code class="constant">3</code>)</a>
<a name="setbcpointers_cd0i121"></a>            <a href="bceulerwall_p.html#i119" target="origFile">skxa = ssk(j, k, <code class="constant">1</code>) + ssk(j, k+<code class="constant">1</code>, <code class="constant">1</code>)</a>
<a name="setbcpointers_cd0i122"></a>            <a href="bceulerwall_p.html#i120" target="origFile">skya = ssk(j, k, <code class="constant">2</code>) + ssk(j, k+<code class="constant">1</code>, <code class="constant">2</code>)</a>
            <a href="bceulerwall_p.html#i121" target="origFile">skza = ssk(j, k, <code class="constant">3</code>) + ssk(j, k+<code class="constant">1</code>, <code class="constant">3</code>)</a>
<a href="bceulerwall_p.html#i122" target="origFile"><code class="comment">! Compute the difference of the normal vector and</code></a>
<a href="bceulerwall_p.html#i122" target="origFile"><code class="comment">! pressure in j and k-direction. As the indices are</code></a>
<a href="bceulerwall_p.html#i122" target="origFile"><code class="comment">! restricted to the 1st halo-layer, the computation</code></a>
<a href="bceulerwall_p.html#i122" target="origFile"><code class="comment">! of the internal halo values is not consistent;</code></a>
<a href="bceulerwall_p.html#i122" target="origFile"><code class="comment">! however this is not really a problem, because these</code></a>
<a name="setbcpointers_cd0i123"></a><a href="bceulerwall_p.html#i122" target="origFile"><code class="comment">! values are overwritten in the communication pattern.</code></a>
<a name="setbcpointers_cd0i124"></a>            <a href="bceulerwall_p.html#i122" target="origFile">rxj = a1*(norm(jp1, k, <code class="constant">1</code>)-norm(jm1, k, <code class="constant">1</code>))</a>
<a name="setbcpointers_cd0i125"></a>            <a href="bceulerwall_p.html#i123" target="origFile">ryj = a1*(norm(jp1, k, <code class="constant">2</code>)-norm(jm1, k, <code class="constant">2</code>))</a>
            <a href="bceulerwall_p.html#i124" target="origFile">rzj = a1*(norm(jp1, k, <code class="constant">3</code>)-norm(jm1, k, <code class="constant">3</code>))</a>
<a name="setbcpointers_cd0i126"></a>            <a href="bceulerwall_p.html#i125" target="origFile">dpjd = a1*(pp2d(jp1, k)-pp2d(jm1, k))</a>
<a name="setbcpointers_cd0i127"></a>            <a href="bceulerwall_p.html#i125" target="origFile">dpj = a1*(pp2(jp1, k)-pp2(jm1, k))</a>
<a name="setbcpointers_cd0i128"></a>            <a href="bceulerwall_p.html#i126" target="origFile">rxk = b1*(norm(j, kp1, <code class="constant">1</code>)-norm(j, km1, <code class="constant">1</code>))</a>
<a name="setbcpointers_cd0i129"></a>            <a href="bceulerwall_p.html#i127" target="origFile">ryk = b1*(norm(j, kp1, <code class="constant">2</code>)-norm(j, km1, <code class="constant">2</code>))</a>
            <a href="bceulerwall_p.html#i128" target="origFile">rzk = b1*(norm(j, kp1, <code class="constant">3</code>)-norm(j, km1, <code class="constant">3</code>))</a>
<a name="setbcpointers_cd0i130"></a>            <a href="bceulerwall_p.html#i129" target="origFile">dpkd = b1*(pp2d(j, kp1)-pp2d(j, km1))</a>
            <a href="bceulerwall_p.html#i129" target="origFile">dpk = b1*(pp2(j, kp1)-pp2(j, km1))</a>
<a href="bceulerwall_p.html#i130" target="origFile"><code class="comment">! Compute the dot product between the unit vector</code></a>
<a href="bceulerwall_p.html#i130" target="origFile"><code class="comment">! and the normal vectors in i, j and k-direction.</code></a>
<a name="setbcpointers_cd0i131"></a>            <a href="bceulerwall_p.html#i130" target="origFile">ri = norm(j, k, <code class="constant">1</code>)*sixa + norm(j, k, <code class="constant">2</code>)*siya + norm(j, k, <code class="constant">3</code>)<code class="label">&</code></a>
<a href="bceulerwall_p.html#i130" target="origFile"><code class="label">&              </code>*siza</a>
<a name="setbcpointers_cd0i132"></a>            <a href="bceulerwall_p.html#i131" target="origFile">rj = norm(j, k, <code class="constant">1</code>)*sjxa + norm(j, k, <code class="constant">2</code>)*sjya + norm(j, k, <code class="constant">3</code>)<code class="label">&</code></a>
<a href="bceulerwall_p.html#i131" target="origFile"><code class="label">&              </code>*sjza</a>
<a name="setbcpointers_cd0i133"></a>            <a href="bceulerwall_p.html#i132" target="origFile">rk = norm(j, k, <code class="constant">1</code>)*skxa + norm(j, k, <code class="constant">2</code>)*skya + norm(j, k, <code class="constant">3</code>)<code class="label">&</code></a>
<a href="bceulerwall_p.html#i132" target="origFile"><code class="label">&              </code>*skza</a>
<a href="bceulerwall_p.html#i133" target="origFile"><code class="comment">! Store the velocity components in ux, uy and uz and</code></a>
<a href="bceulerwall_p.html#i133" target="origFile"><code class="comment">! subtract the mesh velocity if the face is moving.</code></a>
<a name="setbcpointers_cd0i134"></a>            <a href="bceulerwall_p.html#i133" target="origFile">uxd = ww2d(j, k, ivx)</a>
            <a href="bceulerwall_p.html#i133" target="origFile">ux = ww2(j, k, ivx)</a>
<a name="setbcpointers_cd0i135"></a>            <a href="bceulerwall_p.html#i134" target="origFile">uyd = ww2d(j, k, ivy)</a>
            <a href="bceulerwall_p.html#i134" target="origFile">uy = ww2(j, k, ivy)</a>
<a name="setbcpointers_cd0i136"></a>            <a href="bceulerwall_p.html#i135" target="origFile">uzd = ww2d(j, k, ivz)</a>
<a name="setbcpointers_cd0i137"></a>            <a href="bceulerwall_p.html#i135" target="origFile">uz = ww2(j, k, ivz)</a>
<a name="setbcpointers_cd0i138"></a>            <a href="bceulerwall_p.html#i136" target="origFile"><code class="keyword">IF</code> (addgridvelocities) <code class="keyword">THEN</code></a>
<a name="setbcpointers_cd0i139"></a>              <a href="bceulerwall_p.html#i137" target="origFile">ux = ux - ss(j, k, <code class="constant">1</code>)</a>
              <a href="bceulerwall_p.html#i138" target="origFile">uy = uy - ss(j, k, <code class="constant">2</code>)</a>
<a name="setbcpointers_cd0i140"></a>              <a href="bceulerwall_p.html#i139" target="origFile">uz = uz - ss(j, k, <code class="constant">3</code>)</a>
            <a href="bceulerwall_p.html#i136" target="origFile"><code class="keyword">END IF</code></a>
<a href="bceulerwall_p.html#i140" target="origFile"><code class="comment">! Compute the velocity components in j and</code></a>
<a href="bceulerwall_p.html#i140" target="origFile"><code class="comment">! k-direction.</code></a>
<a name="setbcpointers_cd0i141"></a>            <a href="bceulerwall_p.html#i140" target="origFile">qjd = sjxa*uxd + sjya*uyd + sjza*uzd</a>
            <a href="bceulerwall_p.html#i140" target="origFile">qj = ux*sjxa + uy*sjya + uz*sjza</a>
<a name="setbcpointers_cd0i142"></a>            <a href="bceulerwall_p.html#i141" target="origFile">qkd = skxa*uxd + skya*uyd + skza*uzd</a>
            <a href="bceulerwall_p.html#i141" target="origFile">qk = ux*skxa + uy*skya + uz*skza</a>
<a href="bceulerwall_p.html#i142" target="origFile"><code class="comment">! Compute the pressure gradient, which is stored</code></a>
<a href="bceulerwall_p.html#i142" target="origFile"><code class="comment">! in pp1. I'm not entirely sure whether this</code></a>
<a href="bceulerwall_p.html#i142" target="origFile"><code class="comment">! formulation is correct for moving meshes. It could</code></a>
<a href="bceulerwall_p.html#i142" target="origFile"><code class="comment">! be that an additional term is needed there.</code></a>
            <a href="bceulerwall_p.html#i142" target="origFile">pp1d(j, k) = ((qjd*(ux*rxj+uy*ryj+uz*rzj)+qj*(rxj*uxd+ryj*<code class="label">&</code></a>
<a href="bceulerwall_p.html#i142" target="origFile"><code class="label">&              </code>uyd+rzj*uzd)+qkd*(ux*rxk+uy*ryk+uz*rzk)+qk*(rxk*uxd+ryk*<code class="label">&</code></a>
<a href="bceulerwall_p.html#i142" target="origFile"><code class="label">&              </code>uyd+rzk*uzd))*ww2(j, k, irho)+(qj*(ux*rxj+uy*ryj+uz*rzj)+<code class="label">&</code></a>
<a href="bceulerwall_p.html#i142" target="origFile"><code class="label">&              </code>qk*(ux*rxk+uy*ryk+uz*rzk))*ww2d(j, k, irho)-rj*dpjd-rk*<code class="label">&</code></a>
<a href="bceulerwall_p.html#i142" target="origFile"><code class="label">&              </code>dpkd)/ri</a>
            <a href="bceulerwall_p.html#i142" target="origFile">pp1(j, k) = ((qj*(ux*rxj+uy*ryj+uz*rzj)+qk*(ux*rxk+uy*ryk+uz<code class="label">&</code></a>
<a href="bceulerwall_p.html#i142" target="origFile"><code class="label">&              </code>*rzk))*ww2(j, k, irho)-rj*dpj-rk*dpk)/ri</a>
          <a href="bceulerwall_p.html#i100" target="origFile"><code class="keyword">END DO</code></a>
<a name="setbcpointers_cd0i143"></a>        <a href="bceulerwall_p.html#i87" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#i26" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="bceulerwall_p.html#i143" target="origFile"><code class="comment">! Determine the state in the halo cell. Again loop over</code></a>
<a name="setbcpointers_cd0i144"></a><a href="bceulerwall_p.html#i143" target="origFile"><code class="comment">! the cell range for this subface.</code></a>
<a name="setbcpointers_cd0i145"></a>      <a href="bceulerwall_p.html#i143" target="origFile"><code class="keyword">DO </code>k=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
        <a href="bceulerwall_p.html#i144" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
<a href="bceulerwall_p.html#i145" target="origFile"><code class="comment">! Compute the pressure density and velocity in the</code></a>
<a href="bceulerwall_p.html#i145" target="origFile"><code class="comment">! halo cell. Note that rface is the grid velocity</code></a>
<a href="bceulerwall_p.html#i145" target="origFile"><code class="comment">! component in the direction of norm, i.e. outward</code></a>
<a href="bceulerwall_p.html#i145" target="origFile"><code class="comment">! pointing.</code></a>
<a name="setbcpointers_cd0i146"></a>          <a href="bceulerwall_p.html#i145" target="origFile">pp1d(j, k) = <code class="funcname">DIM_SPATIAL_D</code>(pp2(j, k), pp2d(j, k), pp1(j, k), <code class="label">&</code></a>
<a href="bceulerwall_p.html#i145" target="origFile"><code class="label">&            </code>pp1d(j, k), pp1(j, k))</a>
          <a href="bceulerwall_p.html#i146" target="origFile">vnd = two*(-(norm(j, k, <code class="constant">1</code>)*ww2d(j, k, ivx))-norm(j, k, <code class="constant">2</code>)*ww2d<code class="label">&</code></a>
<a href="bceulerwall_p.html#i146" target="origFile"><code class="label">&            </code>(j, k, ivy)-norm(j, k, <code class="constant">3</code>)*ww2d(j, k, ivz))</a>
<a name="setbcpointers_cd0i147"></a>          <a href="bceulerwall_p.html#i146" target="origFile">vn = two*(rface(j, k)-ww2(j, k, ivx)*norm(j, k, <code class="constant">1</code>)-ww2(j, k, <code class="label">&</code></a>
<a href="bceulerwall_p.html#i146" target="origFile"><code class="label">&            </code>ivy)*norm(j, k, <code class="constant">2</code>)-ww2(j, k, ivz)*norm(j, k, <code class="constant">3</code>))</a>
<a name="setbcpointers_cd0i148"></a>          <a href="bceulerwall_p.html#i147" target="origFile">ww1d(j, k, irho) = ww2d(j, k, irho)</a>
          <a href="bceulerwall_p.html#i147" target="origFile">ww1(j, k, irho) = ww2(j, k, irho)</a>
<a name="setbcpointers_cd0i149"></a>          <a href="bceulerwall_p.html#i148" target="origFile">ww1d(j, k, ivx) = ww2d(j, k, ivx) + norm(j, k, <code class="constant">1</code>)*vnd</a>
          <a href="bceulerwall_p.html#i148" target="origFile">ww1(j, k, ivx) = ww2(j, k, ivx) + vn*norm(j, k, <code class="constant">1</code>)</a>
<a name="setbcpointers_cd0i150"></a>          <a href="bceulerwall_p.html#i149" target="origFile">ww1d(j, k, ivy) = ww2d(j, k, ivy) + norm(j, k, <code class="constant">2</code>)*vnd</a>
          <a href="bceulerwall_p.html#i149" target="origFile">ww1(j, k, ivy) = ww2(j, k, ivy) + vn*norm(j, k, <code class="constant">2</code>)</a>
<a name="setbcpointers_cd0i151"></a>          <a href="bceulerwall_p.html#i150" target="origFile">ww1d(j, k, ivz) = ww2d(j, k, ivz) + norm(j, k, <code class="constant">3</code>)*vnd</a>
          <a href="bceulerwall_p.html#i150" target="origFile">ww1(j, k, ivz) = ww2(j, k, ivz) + vn*norm(j, k, <code class="constant">3</code>)</a>
<a name="setbcpointers_cd0i152"></a><a href="bceulerwall_p.html#i151" target="origFile"><code class="comment">! Just copy the turbulent variables.</code></a>
          <a href="bceulerwall_p.html#i151" target="origFile"><code class="keyword">DO </code>l=nt1mg,nt2mg</a>
            <a href="bceulerwall_p.html#i152" target="origFile">ww1d(j, k, l) = ww2d(j, k, l)</a>
<a name="setbcpointers_cd0i153"></a>            <a href="bceulerwall_p.html#i152" target="origFile">ww1(j, k, l) = ww2(j, k, l)</a>
<a name="setbcpointers_cd0i154"></a>          <a href="bceulerwall_p.html#i151" target="origFile"><code class="keyword">END DO</code></a>
<a name="setbcpointers_cd0i156"></a><a name="setbcpointers_cd0i155"></a><a href="bceulerwall_p.html#i153" target="origFile"><code class="comment">! The laminar and eddy viscosity, if present.</code></a>
          <a href="bceulerwall_p.html#i153" target="origFile"><code class="keyword">IF</code> (viscous) </a><a href="bceulerwall_p.html#i154" target="origFile">rlv1(j, k) = rlv2(j, k)</a>
          <a href="bceulerwall_p.html#i155" target="origFile"><code class="keyword">IF</code> (eddymodel) </a><a href="bceulerwall_p.html#i156" target="origFile">rev1(j, k) = rev2(j, k)</a>
<a name="setbcpointers_cd0i157"></a>        <a href="bceulerwall_p.html#i144" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bceulerwall_p.html#i143" target="origFile"><code class="keyword">END DO</code></a>
<a href="bceulerwall_p.html#i157" target="origFile"><code class="comment">! Compute the energy for these halo's.</code></a>
<a name="setbcpointers_cd0i158"></a>      <a href="bceulerwall_p.html#i157" target="origFile"><code class="keyword">CALL </code><code class="funcname">COMPUTEETOT_SPATIAL_D</code>(icbeg(nn), icend(nn), jcbeg(nn), jcend(<code class="label">&</code></a>
<a href="bceulerwall_p.html#i157" target="origFile"><code class="label">&                           </code>nn), kcbeg(nn), kcend(nn), correctfork)</a>
<a name="setbcpointers_cd0i159"></a><a href="bceulerwall_p.html#i158" target="origFile"><code class="comment">! Extrapolate the state vectors in case a second halo</code></a>
<a href="bceulerwall_p.html#i158" target="origFile"><code class="comment">! is needed.</code></a>
      <a href="bceulerwall_p.html#i158" target="origFile"><code class="keyword">IF</code> (secondhalo) </a><a href="bceulerwall_p.html#i159" target="origFile"><code class="keyword">CALL </code><code class="funcname">EXTRAPOLATE2NDHALO_SPATIAL_D</code>(nn, correctfork)</a>
    <a href="bceulerwall_p.html#i22" target="origFile"><code class="keyword">END IF</code></a>
  <a href="bceulerwall_p.html#i21" target="origFile"><code class="keyword">END DO </code><code class="label">bocos</code></a>
<a href="bceulerwall_p.html#bceulerwall" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">BCEULERWALL_SPATIAL_D</code></a>
</pre>
</body>
