<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="prodwmag2"></a><a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      * File:          prodWmag2.f90                                   *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      * Author:        Georgi Kalitzin, Edwin van der Weide            *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      * Starting date: 06-23-2003                                      *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      * Last modified: 06-12-2005                                      *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">PRODWMAG2</code>()</a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">USE </code><code class="funcname">SECTION</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">USE </code><code class="funcname">TURBMOD</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      * prodWmag2 computes the term:                                   *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      *    2*oij*oij  with oij=0.5*(duidxj - dujdxi).                  *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      * This is equal to the magnitude squared of the vorticity.       *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      * It is assumed that the pointer vort, stored in turbMod, is     *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      * already set to the correct entry.                              *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      Local variables.</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">uy</code>, <code class="vardecl">uz</code>, <code class="vardecl">vx</code>, <code class="vardecl">vz</code>, <code class="vardecl">wx</code>, <code class="vardecl">wy</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">fact</code>, <code class="vardecl">vortx</code>, <code class="vardecl">vorty</code>, <code class="vardecl">vortz</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">omegax</code>, <code class="vardecl">omegay</code>, <code class="vardecl">omegaz</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! Determine the non-dimensional wheel speed of this block.</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile">omegax = timeref*sections(sectionid)%rotrate(<code class="constant">1</code>)</a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile">omegay = timeref*sections(sectionid)%rotrate(<code class="constant">2</code>)</a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile">omegaz = timeref*sections(sectionid)%rotrate(<code class="constant">3</code>)</a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! Loop over the cell centers of the given block. It may be more</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! efficient to loop over the faces and to scatter the gradient,</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! but in that case the gradients for u, v and w must be stored.</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! In the current approach no extra memory is needed.</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
    <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
      <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! Compute the necessary derivatives of u in the cell center.</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! Use is made of the fact that the surrounding normals sum up</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! to zero, such that the cell i,j,k does not give a</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! contribution. The gradient is scaled by a factor 2*vol.</code></a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">uy = w(i+<code class="constant">1</code>, j, k, ivx)*si(i, j, k, <code class="constant">2</code>) - w(i-<code class="constant">1</code>, j, k, ivx)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">2</code>) + w(i, j+<code class="constant">1</code>, k, ivx)*sj(i, j, k, <code class="constant">2</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>ivx)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">2</code>) + w(i, j, k+<code class="constant">1</code>, ivx)*sk(i, j, k, <code class="constant">2</code>) - w(i<code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivx)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">2</code>)</a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">uz = w(i+<code class="constant">1</code>, j, k, ivx)*si(i, j, k, <code class="constant">3</code>) - w(i-<code class="constant">1</code>, j, k, ivx)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">3</code>) + w(i, j+<code class="constant">1</code>, k, ivx)*sj(i, j, k, <code class="constant">3</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>ivx)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">3</code>) + w(i, j, k+<code class="constant">1</code>, ivx)*sk(i, j, k, <code class="constant">3</code>) - w(i<code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivx)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">3</code>)</a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! Idem for the gradient of v.</code></a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">vx = w(i+<code class="constant">1</code>, j, k, ivy)*si(i, j, k, <code class="constant">1</code>) - w(i-<code class="constant">1</code>, j, k, ivy)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">1</code>) + w(i, j+<code class="constant">1</code>, k, ivy)*sj(i, j, k, <code class="constant">1</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>ivy)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">1</code>) + w(i, j, k+<code class="constant">1</code>, ivy)*sk(i, j, k, <code class="constant">1</code>) - w(i<code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivy)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">1</code>)</a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">vz = w(i+<code class="constant">1</code>, j, k, ivy)*si(i, j, k, <code class="constant">3</code>) - w(i-<code class="constant">1</code>, j, k, ivy)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">3</code>) + w(i, j+<code class="constant">1</code>, k, ivy)*sj(i, j, k, <code class="constant">3</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>ivy)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">3</code>) + w(i, j, k+<code class="constant">1</code>, ivy)*sk(i, j, k, <code class="constant">3</code>) - w(i<code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivy)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">3</code>)</a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! And for the gradient of w.</code></a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">wx = w(i+<code class="constant">1</code>, j, k, ivz)*si(i, j, k, <code class="constant">1</code>) - w(i-<code class="constant">1</code>, j, k, ivz)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">1</code>) + w(i, j+<code class="constant">1</code>, k, ivz)*sj(i, j, k, <code class="constant">1</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>ivz)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">1</code>) + w(i, j, k+<code class="constant">1</code>, ivz)*sk(i, j, k, <code class="constant">1</code>) - w(i<code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivz)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">1</code>)</a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">wy = w(i+<code class="constant">1</code>, j, k, ivz)*si(i, j, k, <code class="constant">2</code>) - w(i-<code class="constant">1</code>, j, k, ivz)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">2</code>) + w(i, j+<code class="constant">1</code>, k, ivz)*sj(i, j, k, <code class="constant">2</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>ivz)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">2</code>) + w(i, j, k+<code class="constant">1</code>, ivz)*sk(i, j, k, <code class="constant">2</code>) - w(i<code class="label">&</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivz)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">2</code>)</a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! Compute the three components of the vorticity vector.</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! Substract the part coming from the rotating frame.</code></a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">fact = half/vol(i, j, k)</a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">vortx = fact*(wy-vz) - two*omegax</a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">vorty = fact*(uz-wx) - two*omegay</a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">vortz = fact*(vx-uy) - two*omegaz</a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="comment">! Compute the magnitude squared of the vorticity.</code></a>
        <a href="prodwmag2.html#prodwmag2" target="diffFile">vort(i, j, k) = vortx**<code class="constant">2 </code>+ vorty**<code class="constant">2 </code>+ vortz**<code class="constant">2</code></a>
      <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">END DO</code></a>
<a href="prodwmag2.html#prodwmag2" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">PRODWMAG2</code></a>
</pre>
</body>
