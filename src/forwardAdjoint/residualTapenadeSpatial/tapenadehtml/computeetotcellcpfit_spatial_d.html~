<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="computeetotcellcpfit_spatial_d"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="comment">!</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="comment">!  Differentiation of computeetotcellcpfit in forward (tangent) mode:</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="comment">!   variations   of useful results: *gamma *w</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="comment">!   with respect to varying inputs: *p *gamma *w cv0 *cptrange</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="comment">!                *cpeint *(*cptempfit.constants) *cptempfit.eint0</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="comment">!                cvn</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="comment">!      ==================================================================</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COMPUTEETOTCELLCPFIT_SPATIAL_D</code>(<code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">scale</code>, <code class="vardecl">correctfork</code>)</a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="keyword">USE </code><code class="funcname">CPCURVEFITS_SPATIAL_D</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
<a name="computeetotcellcpfit_spatial_di0"></a>  <a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!      * ComputeEtotCellCpfit will compute the total energy for the     *</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!      * given cell of the block given by the current pointers with the *</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!      * cp temperature curve fit model.                                *</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!      Local parameter.</code></a>
<a name="computeetotcellcpfit_spatial_di1"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="comment">!</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti0" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">twothird</code>=<code class="vardecl">two</code>*<code class="vardecl">third</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti1" target="origFile"><code class="comment">!</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti1" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a name="computeetotcellcpfit_spatial_di2"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti1" target="origFile"><code class="comment">!</code></a>
<a name="computeetotcellcpfit_spatial_di3"></a>  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti1" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code></a>
<a name="computeetotcellcpfit_spatial_di4"></a>  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">scale</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti3" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">correctfork</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti4" target="origFile"><code class="comment">!</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti4" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="computeetotcellcpfit_spatial_di5"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti4" target="origFile"><code class="comment">!</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti4" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">nn</code>, <code class="vardecl">mm</code>, <code class="vardecl">ii</code>, <code class="vardecl">start</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti5" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">pp</code>, <code class="vardecl">t</code>, <code class="vardecl">t2</code>, <code class="vardecl">cv</code>, <code class="vardecl">eint</code></a>
<a name="computeetotcellcpfit_spatial_di6"></a>  <a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ppd</code>, <code class="vardecl">td</code>, <code class="vardecl">t2d</code>, <code class="vardecl">cvd</code>, <code class="vardecl">eintd</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">LOG</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile"><code class="comment">!</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile"><code class="comment">!</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile"><code class="comment">! Compute the dimensional temperature.</code></a>
<a name="computeetotcellcpfit_spatial_di7"></a>  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile">ppd = pd(i, j, k)</a>
<a name="computeetotcellcpfit_spatial_di8"></a>  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti6" target="origFile">pp = p(i, j, k)</a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti7" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti8" target="origFile">ppd = ppd - twothird*(wd(i, j, k, irho)*w(i, j, k, itu1)+w(i, j, k, <code class="label">&</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti8" target="origFile"><code class="label">&      </code>irho)*wd(i, j, k, itu1))</a>
<a name="computeetotcellcpfit_spatial_di9"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti8" target="origFile">pp = pp - twothird*w(i, j, k, irho)*w(i, j, k, itu1)</a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti7" target="origFile"><code class="keyword">END IF</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti9" target="origFile">td = (tref*ppd*rgas*w(i, j, k, irho)-tref*pp*rgas*wd(i, j, k, irho))/(<code class="label">&</code></a>
<a name="computeetotcellcpfit_spatial_di10"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti9" target="origFile"><code class="label">&    </code>rgas*w(i, j, k, irho))**<code class="constant">2</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti9" target="origFile">t = tref*pp/(rgas*w(i, j, k, irho))</a>
<a name="computeetotcellcpfit_spatial_di11"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti10" target="origFile"><code class="comment">! Determine the case we are having here.</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti10" target="origFile"><code class="keyword">IF</code> (t .LE. cptrange(<code class="constant">0</code>)) <code class="keyword">THEN</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti11" target="origFile"><code class="comment">! Temperature is less than the smallest temperature</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti11" target="origFile"><code class="comment">! in the curve fits. Use extrapolation using</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti11" target="origFile"><code class="comment">! constant cv.</code></a>
<a name="computeetotcellcpfit_spatial_di12"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti11" target="origFile">eintd = scale*cv0*td</a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti11" target="origFile">eint = scale*(cpeint(<code class="constant">0</code>)+cv0*(t-cptrange(<code class="constant">0</code>)))</a>
<a name="computeetotcellcpfit_spatial_di13"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti12" target="origFile">gammad(i, j, k) = <code class="constant">0.0</code></a>
<a name="computeetotcellcpfit_spatial_di14"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti12" target="origFile">gamma(i, j, k) = (cv0+one)/cv0</a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti10" target="origFile"><code class="keyword">ELSE </code></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti13" target="origFile"><code class="keyword">IF</code> (t .GE. cptrange(cpnparts)) <code class="keyword">THEN</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti14" target="origFile"><code class="comment">! Temperature is larger than the largest temperature</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti14" target="origFile"><code class="comment">! in the curve fits. Use extrapolation using</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti14" target="origFile"><code class="comment">! constant cv.</code></a>
<a name="computeetotcellcpfit_spatial_di15"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti14" target="origFile">eintd = scale*cvn*td</a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti14" target="origFile">eint = scale*(cpeint(cpnparts)+cvn*(t-cptrange(cpnparts)))</a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti15" target="origFile">gammad(i, j, k) = <code class="constant">0.0</code></a>
<a name="computeetotcellcpfit_spatial_di16"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti15" target="origFile">gamma(i, j, k) = (cvn+one)/cvn</a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti13" target="origFile"><code class="keyword">ELSE</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti16" target="origFile"><code class="comment">! Temperature is in the curve fit range.</code></a>
<a name="computeetotcellcpfit_spatial_di17"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti16" target="origFile"><code class="comment">! First find the valid range.</code></a>
<a name="computeetotcellcpfit_spatial_di18"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti16" target="origFile">ii = cpnparts</a>
<a name="computeetotcellcpfit_spatial_di19"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti17" target="origFile">start = <code class="constant">1</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti18" target="origFile"><code class="label">interval:</code><code class="keyword">DO </code></a>
<a name="computeetotcellcpfit_spatial_di20"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti19" target="origFile"><code class="comment">! Next guess for the interval.</code></a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti19" target="origFile">nn = start + ii/<code class="constant">2</code></a>
<a name="computeetotcellcpfit_spatial_di21"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti20" target="origFile"><code class="comment">! Determine the situation we are having here.</code></a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti20" target="origFile"><code class="keyword">IF</code> (t .GT. cptrange(nn)) <code class="keyword">THEN</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti21" target="origFile"><code class="comment">! Temperature is larger than the upper boundary of</code></a>
<a name="computeetotcellcpfit_spatial_di22"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti21" target="origFile"><code class="comment">! the current interval. Update the lower boundary.</code></a>
<a name="computeetotcellcpfit_spatial_di23"></a>        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti21" target="origFile">start = nn + <code class="constant">1</code></a>
        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti22" target="origFile">ii = ii - <code class="constant">1</code></a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti20" target="origFile"><code class="keyword">ELSE </code></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti23" target="origFile"><code class="keyword">IF</code> (t .GE. cptrange(nn-<code class="constant">1</code>)) <code class="keyword">THEN</code></a>
<a name="computeetotcellcpfit_spatial_di24"></a>        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti23" target="origFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti20" target="origFile"><code class="keyword">END IF</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti24" target="origFile"><code class="comment">! This is the correct range. Exit the do-loop.</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti24" target="origFile"><code class="comment">! Modify ii for the next branch to search.</code></a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti24" target="origFile">ii = ii/<code class="constant">2</code></a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti18" target="origFile"><code class="keyword">END DO </code><code class="label">interval</code></a>
<a name="computeetotcellcpfit_spatial_di25"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti13" target="origFile"><code class="comment">! Nn contains the correct curve fit interval.</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti13" target="origFile"><code class="comment">! Integrate cv to compute eint.</code></a>
<a name="computeetotcellcpfit_spatial_di26"></a> <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti13" target="origFile"><code class="label">100 </code></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti25" target="origFile">eintd = -td</a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti25" target="origFile">eint = cptempfit(nn)%eint0 - t</a>
<a name="computeetotcellcpfit_spatial_di27"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti26" target="origFile">cv = -one</a>
<a name="computeetotcellcpfit_spatial_di28"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti13" target="origFile">cvd = <code class="constant">0.0</code></a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti27" target="origFile"><code class="keyword">DO </code>ii=<code class="constant">1</code>,cptempfit(nn)%nterm</a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile"><code class="keyword">IF</code> (t .GT. <code class="constant">0.0 </code>.OR. (t .LT. <code class="constant">0.0 </code>.AND. cptempfit(nn)%exponents(ii) <code class="label">&</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile"><code class="label">&          </code>.EQ. <code class="funcname">INT</code>(cptempfit(nn)%exponents(ii)))) <code class="keyword">THEN</code></a>
        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile">t2d = cptempfit(nn)%exponents(ii)*t**(cptempfit(nn)%exponents(ii<code class="label">&</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile"><code class="label">&          </code>)-<code class="constant">1</code>)*td</a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile"><code class="keyword">ELSE IF</code> (t .EQ. <code class="constant">0.0 </code>.AND. cptempfit(nn)%exponents(ii) .EQ. <code class="constant">1.0</code>) <code class="label">&</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile"><code class="label">&      </code><code class="keyword">THEN</code></a>
        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile">t2d = td</a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile">t2d = <code class="constant">0.0</code></a>
<a name="computeetotcellcpfit_spatial_di29"></a>      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile"><code class="keyword">END IF</code></a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti28" target="origFile">t2 = t**cptempfit(nn)%exponents(ii)</a>
<a name="p40"></a><a name="computeetotcellcpfit_spatial_di30"></a>      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti29" target="origFile">cvd = cvd + cptempfit(nn)%constants(ii)*t2d</a>
<a name="computeetotcellcpfit_spatial_di31"></a>      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti29" target="origFile">cv = cv + cptempfit(nn)%constants(ii)*t2</a>
      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti30" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p40" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti30" target="origFile">cptempfit(nn)%exponents(ii) .EQ. -<code class="constant">1_intType</code>) <code class="keyword">THEN</code></a>
        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti31" target="origFile">eintd = eintd + cptempfit(nn)%constants(ii)*td/t</a>
<a name="computeetotcellcpfit_spatial_di32"></a>        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti31" target="origFile">eint = eint + cptempfit(nn)%constants(ii)*<code class="funcname">LOG</code>(t)</a>
<a name="computeetotcellcpfit_spatial_di33"></a>      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti30" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti32" target="origFile">mm = cptempfit(nn)%exponents(ii) + <code class="constant">1</code></a>
<a name="computeetotcellcpfit_spatial_di34"></a>        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti33" target="origFile">t2d = td*t2 + t*t2d</a>
        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti33" target="origFile">t2 = t*t2</a>
        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti34" target="origFile">eintd = eintd + cptempfit(nn)%constants(ii)*t2d/mm</a>
        <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti34" target="origFile">eint = eint + cptempfit(nn)%constants(ii)*t2/mm</a>
<a name="computeetotcellcpfit_spatial_di35"></a>      <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti30" target="origFile"><code class="keyword">END IF</code></a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti27" target="origFile"><code class="keyword">END DO</code></a>
<a name="computeetotcellcpfit_spatial_di36"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti35" target="origFile">eintd = scale*eintd</a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti35" target="origFile">eint = scale*eint</a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti36" target="origFile">gammad(i, j, k) = (cvd*cv-(cv+one)*cvd)/cv**<code class="constant">2</code></a>
<a name="computeetotcellcpfit_spatial_di37"></a>    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti36" target="origFile">gamma(i, j, k) = (cv+one)/cv</a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti10" target="origFile"><code class="keyword">END IF</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti37" target="origFile"><code class="comment">! Compute the total energy per unit volume.</code></a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti37" target="origFile">wd(i, j, k, irhoe) = wd(i, j, k, irho)*(eint+half*(w(i, j, k, ivx)**<code class="constant">2</code>+<code class="label">&</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti37" target="origFile"><code class="label">&    </code>w(i, j, k, ivy)**<code class="constant">2</code>+w(i, j, k, ivz)**<code class="constant">2</code>)) + w(i, j, k, irho)*(eintd+<code class="label">&</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti37" target="origFile"><code class="label">&    </code>half*(<code class="constant">2</code>*w(i, j, k, ivx)*wd(i, j, k, ivx)+<code class="constant">2</code>*w(i, j, k, ivy)*wd(i, j, <code class="label">&</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti37" target="origFile"><code class="label">&    </code>k, ivy)+<code class="constant">2</code>*w(i, j, k, ivz)*wd(i, j, k, ivz)))</a>
<a name="computeetotcellcpfit_spatial_di38"></a>  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti37" target="origFile">w(i, j, k, irhoe) = w(i, j, k, irho)*(eint+half*(w(i, j, k, ivx)**<code class="constant">2</code>+w(<code class="label">&</code></a>
<a name="computeetotcellcpfit_spatial_di39"></a><a href="computeetotcellcpfit_p.html#computeetotcellcpfiti37" target="origFile"><code class="label">&    </code>i, j, k, ivy)**<code class="constant">2</code>+w(i, j, k, ivz)**<code class="constant">2</code>))</a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti38" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti39" target="origFile">wd(i, j, k, irhoe) = wd(i, j, k, irhoe) + wd(i, j, k, irho)*w(i, j, <code class="label">&</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti39" target="origFile"><code class="label">&      </code>k, itu1) + w(i, j, k, irho)*wd(i, j, k, itu1)</a>
    <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti39" target="origFile">w(i, j, k, irhoe) = w(i, j, k, irhoe) + w(i, j, k, irho)*w(i, j, k, <code class="label">&</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfiti39" target="origFile"><code class="label">&      </code>itu1)</a>
  <a href="computeetotcellcpfit_p.html#computeetotcellcpfiti38" target="origFile"><code class="keyword">END IF</code></a>
<a href="computeetotcellcpfit_p.html#computeetotcellcpfit" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COMPUTEETOTCELLCPFIT_SPATIAL_D</code></a>
</pre>
</body>
