<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="invisciddissfluxmatrix_cd"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * File:          inviscidDissFluxMatrix.f90                      *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Starting date: 03-25-2003                                      *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Last modified: 10-29-2007                                      *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">INVISCIDDISSFLUXMATRIX_CD</code>()</a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">CGNSGRID_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTDISCRETIZATION_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * inviscidDissFluxMatrix computes the matrix artificial          *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * dissipation term. Instead of the spectral radius, as used in   *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * the scalar dissipation scheme, the absolute value of the flux  *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * jacobian is used. This leads to a less diffusive and           *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * consequently more accurate scheme. It is assumed that the      *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * pointers in blockPointers already point to the correct block.  *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      Local parameters.</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">dpmax</code>=<code class="constant">0.25_realType</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">epsacoustic</code>=<code class="constant">0.25_realType</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">epsshear</code>=<code class="constant">0.025_realType</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">omega</code>=<code class="constant">0.5_realType</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">oneminomega</code>=<code class="vardecl">one</code>-<code class="vardecl">omega</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      Local variables.</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">ind</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">plim</code>, <code class="vardecl">sface</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sfil</code>, <code class="vardecl">fis2</code>, <code class="vardecl">fis4</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">gammaavg</code>, <code class="vardecl">gm1</code>, <code class="vardecl">ovgm1</code>, <code class="vardecl">gm53</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ppor</code>, <code class="vardecl">rrad</code>, <code class="vardecl">dis2</code>, <code class="vardecl">dis4</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dp1</code>, <code class="vardecl">dp2</code>, <code class="vardecl">ddw</code>, <code class="vardecl">tmp</code>, <code class="vardecl">fs</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dr</code>, <code class="vardecl">dru</code>, <code class="vardecl">drv</code>, <code class="vardecl">drw</code>, <code class="vardecl">dre</code>, <code class="vardecl">drk</code>, <code class="vardecl">sx</code>, <code class="vardecl">sy</code>, <code class="vardecl">sz</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">uavg</code>, <code class="vardecl">vavg</code>, <code class="vardecl">wavg</code>, <code class="vardecl">a2avg</code>, <code class="vardecl">aavg</code>, <code class="vardecl">havg</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">alphaavg</code>, <code class="vardecl">unavg</code>, <code class="vardecl">ovaavg</code>, <code class="vardecl">ova2avg</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">kavg</code>, <code class="vardecl">lam1</code>, <code class="vardecl">lam2</code>, <code class="vardecl">lam3</code>, <code class="vardecl">area</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abv1</code>, <code class="vardecl">abv2</code>, <code class="vardecl">abv3</code>, <code class="vardecl">abv4</code>, <code class="vardecl">abv5</code>, <code class="vardecl">abv6</code>, <code class="vardecl">abv7</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">correctfork</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="funcname">DIM_CD</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">min3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">min2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">min1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x6</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x5</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x4</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs12</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs11</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs10</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs9</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs8</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs7</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs6</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs5</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs4</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max1</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y3</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y2</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y1</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a name="p10"></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Check if rFil == 0. If so, the dissipative flux needs not to</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! be computed.</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p10" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">rfil .EQ. zero) <code class="keyword">THEN</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">RETURN</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Set the value of plim. To be fully consistent this must have</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! the dimension of a pressure. Therefore a fraction of pInfCorr</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! is used.</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">plim = <code class="constant">0.001_realType</code>*pinfcorr</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Determine whether or not the total energy must be corrected</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! for the presence of the turbulent kinetic energy.</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (kpresent) <code class="keyword">THEN</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (currentlevel .EQ. groundlevel .OR. turbcoupled) <code class="keyword">THEN</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">correctfork = <code class="constant">.true.</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">correctfork = <code class="constant">.false.</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">correctfork = <code class="constant">.false.</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Initialize sface to zero. This value will be used if the</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! block is not moving.</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sface = zero</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Set a couple of constants for the scheme.</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fis2 = rfil*vis2</a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fis4 = rfil*vis4</a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sfil = one - rfil</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Initialize the dissipative residual to a certain times,</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! possibly zero, the previously stored value. Owned cells</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! only, because the halo values do not matter.</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, irho) = sfil*fw(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imx) = sfil*fw(i, j, k, imx)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imy) = sfil*fw(i, j, k, imy)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imz) = sfil*fw(i, j, k, imz)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, irhoe) = sfil*fw(i, j, k, irhoe)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Dissipative fluxes in the i-direction.                         *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(<code class="constant">2</code>, j, k) - p(<code class="constant">1</code>, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs1 = p(<code class="constant">2</code>, j, k) - p(<code class="constant">1</code>, j, k)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs1 = -(p(<code class="constant">2</code>, j, k)-p(<code class="constant">1</code>, j, k))</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(<code class="constant">1</code>, j, k) - p(<code class="constant">0</code>, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs7 = p(<code class="constant">1</code>, j, k) - p(<code class="constant">0</code>, j, k)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs7 = -(p(<code class="constant">1</code>, j, k)-p(<code class="constant">0</code>, j, k))</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">x1 = (p(<code class="constant">2</code>, j, k)-two*p(<code class="constant">1</code>, j, k)+p(<code class="constant">0</code>, j, k))/(omega*(p(<code class="constant">2</code>, j, k)+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&          </code>two*p(<code class="constant">1</code>, j, k)+p(<code class="constant">0</code>, j, k))+oneminomega*(abs1+abs7)+plim)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (x1 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp1 = x1</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp1 = -x1</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Loop in i-direction.</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i+<code class="constant">2</code>, j, k) - p(i+<code class="constant">1</code>, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs2 = p(i+<code class="constant">2</code>, j, k) - p(i+<code class="constant">1</code>, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs2 = -(p(i+<code class="constant">2</code>, j, k)-p(i+<code class="constant">1</code>, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i+<code class="constant">1</code>, j, k) - p(i, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs8 = p(i+<code class="constant">1</code>, j, k) - p(i, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs8 = -(p(i+<code class="constant">1</code>, j, k)-p(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">x2 = (p(i+<code class="constant">2</code>, j, k)-two*p(i+<code class="constant">1</code>, j, k)+p(i, j, k))/(omega*(p(i+<code class="constant">2</code><code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>, j, k)+two*p(i+<code class="constant">1</code>, j, k)+p(i, j, k))+oneminomega*(abs2+abs8)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>+plim)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (x2 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp2 = x2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp2 = -x2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute the dissipation coefficients for this face.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ppor = zero</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (pori(i, j, k) .EQ. normalflux) ppor = one</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (dp1 .LT. dp2) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">y1 = dp2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">y1 = dp1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (dpmax .GT. y1) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">min1 = y1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">min1 = dpmax</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dis2 = ppor*fis2*min1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dis4 = <code class="funcname">DIM_CD</code>(ppor*fis4, dis2)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Construct the vector of the first and third differences</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! multiplied by the appropriate constants.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho) - w(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dr = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)-w(i-<code class="constant">1</code>, j, k, irho)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivx) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>w(i, j, k, ivx)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dru = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, ivx)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, ivx)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivy) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>w(i, j, k, ivy)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drv = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, ivy)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, ivy)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivz) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>w(i, j, k, ivz)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drw = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, ivz)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, ivz)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irhoe) - w(i, j, k, irhoe)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dre = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irhoe)-w(i-<code class="constant">1</code>, j, k, irhoe)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>-three*ddw)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! In case a k-equation is present, compute the difference</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! of rhok and store the average value of k. If not present,</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! set both these values to zero, such that later on no</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! decision needs to be made anymore.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, itu1) - w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&              </code>irho)*w(i, j, k, itu1)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drk = dis2*ddw - dis4*(w(i+<code class="constant">2</code>, j, k, irho)*w(i+<code class="constant">2</code>, j, k, itu1)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&              </code>-w(i-<code class="constant">1</code>, j, k, irho)*w(i-<code class="constant">1</code>, j, k, itu1)-three*ddw)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">kavg = half*(w(i, j, k, itu1)+w(i+<code class="constant">1</code>, j, k, itu1))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drk = zero</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">kavg = zero</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute the average value of gamma and compute some</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! expressions in which it occurs.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">gammaavg = half*(gamma(i+<code class="constant">1</code>, j, k)+gamma(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">gm1 = gammaavg - one</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ovgm1 = one/gm1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">gm53 = gammaavg - five*third</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute the average state at the interface.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">uavg = half*(w(i+<code class="constant">1</code>, j, k, ivx)+w(i, j, k, ivx))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">vavg = half*(w(i+<code class="constant">1</code>, j, k, ivy)+w(i, j, k, ivy))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">wavg = half*(w(i+<code class="constant">1</code>, j, k, ivz)+w(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">a2avg = half*(gamma(i+<code class="constant">1</code>, j, k)*p(i+<code class="constant">1</code>, j, k)/w(i+<code class="constant">1</code>, j, k, irho)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>+gamma(i, j, k)*p(i, j, k)/w(i, j, k, irho))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sx = si(i, j, k, <code class="constant">1</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sy = si(i, j, k, <code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sz = si(i, j, k, <code class="constant">3</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">area = <code class="funcname">SQRT</code>(arg1)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">max1 = area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">max1 = <code class="constant">1.e-25_realType</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">tmp = one/max1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sx = sx*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sy = sy*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sz = sz*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">havg = alphaavg + ovgm1*(a2avg-gm53*kavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ovaavg = one/aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ova2avg = one/a2avg</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! The mesh velocity if the face is moving. It must be</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! divided by the area to obtain a true velocity.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (addgridvelocities) sface = sfacei(i, j, k)*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (unavg - sface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = unavg - sface + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = -(unavg-sface+aavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (unavg - sface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = unavg - sface - aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = -(unavg-sface-aavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (unavg - sface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = unavg - sface</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = -(unavg-sface)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">rrad = lam3 + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (lam1 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = lam1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (lam2 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = lam2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (lam3 .LT. epsshear*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = epsshear*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! the correct values for the dissipation term.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = lam1*area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = lam2*area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = lam3*area</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! dissipation terms.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv1 = half*(lam1+lam2)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv2 = half*(lam1-lam2)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv3 = abv1 - lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>*drk</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Density.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*dr + abv6</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ind = indfamilyi(i, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(ind<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>, spectralsol) - factfamilyi(i, j, k)*fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! X-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*dru + uavg*abv6 + sx*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Y-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*drv + vavg*abv6 + sy*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Z-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*drw + wavg*abv6 + sz*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Energy.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*dre + havg*abv6 + unavg*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Set dp1 to dp2 for the next face.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp1 = dp2</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Dissipative fluxes in the j-direction.                         *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i, <code class="constant">2</code>, k) - p(i, <code class="constant">1</code>, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs3 = p(i, <code class="constant">2</code>, k) - p(i, <code class="constant">1</code>, k)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs3 = -(p(i, <code class="constant">2</code>, k)-p(i, <code class="constant">1</code>, k))</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i, <code class="constant">1</code>, k) - p(i, <code class="constant">0</code>, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs9 = p(i, <code class="constant">1</code>, k) - p(i, <code class="constant">0</code>, k)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs9 = -(p(i, <code class="constant">1</code>, k)-p(i, <code class="constant">0</code>, k))</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">x3 = (p(i, <code class="constant">2</code>, k)-two*p(i, <code class="constant">1</code>, k)+p(i, <code class="constant">0</code>, k))/(omega*(p(i, <code class="constant">2</code>, k)+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&          </code>two*p(i, <code class="constant">1</code>, k)+p(i, <code class="constant">0</code>, k))+oneminomega*(abs3+abs9)+plim)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (x3 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp1 = x3</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp1 = -x3</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Loop in j-direction.</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i, j+<code class="constant">2</code>, k) - p(i, j+<code class="constant">1</code>, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs4 = p(i, j+<code class="constant">2</code>, k) - p(i, j+<code class="constant">1</code>, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs4 = -(p(i, j+<code class="constant">2</code>, k)-p(i, j+<code class="constant">1</code>, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i, j+<code class="constant">1</code>, k) - p(i, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs10 = p(i, j+<code class="constant">1</code>, k) - p(i, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs10 = -(p(i, j+<code class="constant">1</code>, k)-p(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">x4 = (p(i, j+<code class="constant">2</code>, k)-two*p(i, j+<code class="constant">1</code>, k)+p(i, j, k))/(omega*(p(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>+<code class="constant">2</code>, k)+two*p(i, j+<code class="constant">1</code>, k)+p(i, j, k))+oneminomega*(abs4+abs10)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>+plim)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (x4 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp2 = x4</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp2 = -x4</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute the dissipation coefficients for this face.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ppor = zero</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (porj(i, j, k) .EQ. normalflux) ppor = one</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (dp1 .LT. dp2) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">y2 = dp2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">y2 = dp1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (dpmax .GT. y2) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">min2 = y2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">min2 = dpmax</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dis2 = ppor*fis2*min2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dis4 = <code class="funcname">DIM_CD</code>(ppor*fis4, dis2)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Construct the vector of the first and third differences</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! multiplied by the appropriate constants.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho) - w(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dr = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)-w(i, j-<code class="constant">1</code>, k, irho)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivx) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>w(i, j, k, ivx)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dru = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, ivx)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, ivx)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivy) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>w(i, j, k, ivy)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drv = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, ivy)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, ivy)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivz) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>w(i, j, k, ivz)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drw = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, ivz)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, ivz)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irhoe) - w(i, j, k, irhoe)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dre = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irhoe)-w(i, j-<code class="constant">1</code>, k, irhoe)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>-three*ddw)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! In case a k-equation is present, compute the difference</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! of rhok and store the average value of k. If not present,</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! set both these values to zero, such that later on no</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! decision needs to be made anymore.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, itu1) - w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&              </code>irho)*w(i, j, k, itu1)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drk = dis2*ddw - dis4*(w(i, j+<code class="constant">2</code>, k, irho)*w(i, j+<code class="constant">2</code>, k, itu1)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&              </code>-w(i, j-<code class="constant">1</code>, k, irho)*w(i, j-<code class="constant">1</code>, k, itu1)-three*ddw)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">kavg = half*(w(i, j, k, itu1)+w(i, j+<code class="constant">1</code>, k, itu1))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drk = zero</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">kavg = zero</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute the average value of gamma and compute some</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! expressions in which it occurs.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">gammaavg = half*(gamma(i, j+<code class="constant">1</code>, k)+gamma(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">gm1 = gammaavg - one</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ovgm1 = one/gm1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">gm53 = gammaavg - five*third</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute the average state at the interface.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">uavg = half*(w(i, j+<code class="constant">1</code>, k, ivx)+w(i, j, k, ivx))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">vavg = half*(w(i, j+<code class="constant">1</code>, k, ivy)+w(i, j, k, ivy))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">wavg = half*(w(i, j+<code class="constant">1</code>, k, ivz)+w(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">a2avg = half*(gamma(i, j+<code class="constant">1</code>, k)*p(i, j+<code class="constant">1</code>, k)/w(i, j+<code class="constant">1</code>, k, irho)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>+gamma(i, j, k)*p(i, j, k)/w(i, j, k, irho))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sx = sj(i, j, k, <code class="constant">1</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sy = sj(i, j, k, <code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sz = sj(i, j, k, <code class="constant">3</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">area = <code class="funcname">SQRT</code>(arg1)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">max2 = area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">max2 = <code class="constant">1.e-25_realType</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">tmp = one/max2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sx = sx*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sy = sy*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sz = sz*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">havg = alphaavg + ovgm1*(a2avg-gm53*kavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ovaavg = one/aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ova2avg = one/a2avg</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! The mesh velocity if the face is moving. It must be</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! divided by the area to obtain a true velocity.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (addgridvelocities) sface = sfacej(i, j, k)*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (unavg - sface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = unavg - sface + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = -(unavg-sface+aavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (unavg - sface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = unavg - sface - aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = -(unavg-sface-aavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (unavg - sface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = unavg - sface</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = -(unavg-sface)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">rrad = lam3 + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (lam1 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = lam1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (lam2 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = lam2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (lam3 .LT. epsshear*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = epsshear*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! the correct values for the dissipation term.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = lam1*area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = lam2*area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = lam3*area</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! dissipation terms.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv1 = half*(lam1+lam2)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv2 = half*(lam1-lam2)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv3 = abv1 - lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>*drk</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Density.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*dr + abv6</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ind = indfamilyj(i, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(ind<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>, spectralsol) - factfamilyj(i, j, k)*fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! X-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*dru + uavg*abv6 + sx*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Y-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*drv + vavg*abv6 + sy*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Z-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*drw + wavg*abv6 + sz*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Energy.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*dre + havg*abv6 + unavg*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Set dp1 to dp2 for the next face.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp1 = dp2</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      * Dissipative fluxes in the k-direction.                         *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">!</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i, j, <code class="constant">2</code>) - p(i, j, <code class="constant">1</code>) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs5 = p(i, j, <code class="constant">2</code>) - p(i, j, <code class="constant">1</code>)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs5 = -(p(i, j, <code class="constant">2</code>)-p(i, j, <code class="constant">1</code>))</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i, j, <code class="constant">1</code>) - p(i, j, <code class="constant">0</code>) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs11 = p(i, j, <code class="constant">1</code>) - p(i, j, <code class="constant">0</code>)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs11 = -(p(i, j, <code class="constant">1</code>)-p(i, j, <code class="constant">0</code>))</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">x5 = (p(i, j, <code class="constant">2</code>)-two*p(i, j, <code class="constant">1</code>)+p(i, j, <code class="constant">0</code>))/(omega*(p(i, j, <code class="constant">2</code>)+<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&          </code>two*p(i, j, <code class="constant">1</code>)+p(i, j, <code class="constant">0</code>))+oneminomega*(abs5+abs11)+plim)</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (x5 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp1 = x5</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp1 = -x5</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Loop in k-direction.</code></a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i, j, k+<code class="constant">2</code>) - p(i, j, k+<code class="constant">1</code>) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs6 = p(i, j, k+<code class="constant">2</code>) - p(i, j, k+<code class="constant">1</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs6 = -(p(i, j, k+<code class="constant">2</code>)-p(i, j, k+<code class="constant">1</code>))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (p(i, j, k+<code class="constant">1</code>) - p(i, j, k) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs12 = p(i, j, k+<code class="constant">1</code>) - p(i, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abs12 = -(p(i, j, k+<code class="constant">1</code>)-p(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">x6 = (p(i, j, k+<code class="constant">2</code>)-two*p(i, j, k+<code class="constant">1</code>)+p(i, j, k))/(omega*(p(i, j<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>, k+<code class="constant">2</code>)+two*p(i, j, k+<code class="constant">1</code>)+p(i, j, k))+oneminomega*(abs6+abs12)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>+plim)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (x6 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp2 = x6</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp2 = -x6</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute the dissipation coefficients for this face.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ppor = zero</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (pork(i, j, k) .EQ. normalflux) ppor = one</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (dp1 .LT. dp2) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">y3 = dp2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">y3 = dp1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (dpmax .GT. y3) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">min3 = y3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">min3 = dpmax</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dis2 = ppor*fis2*min3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dis4 = <code class="funcname">DIM_CD</code>(ppor*fis4, dis2)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Construct the vector of the first and third differences</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! multiplied by the appropriate constants.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho) - w(i, j, k, irho)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dr = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)-w(i, j, k-<code class="constant">1</code>, irho)-<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivx) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>w(i, j, k, ivx)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dru = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, ivx)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, ivx)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivy) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>w(i, j, k, ivy)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drv = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, ivy)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, ivy)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivz) - w(i, j, k, irho)*<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>w(i, j, k, ivz)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drw = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, ivz)-w(<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, ivz)-three*ddw)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irhoe) - w(i, j, k, irhoe)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dre = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irhoe)-w(i, j, k-<code class="constant">1</code>, irhoe)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>-three*ddw)</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! In case a k-equation is present, compute the difference</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! of rhok and store the average value of k. If not present,</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! set both these values to zero, such that later on no</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! decision needs to be made anymore.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ddw = w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, itu1) - w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&              </code>irho)*w(i, j, k, itu1)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drk = dis2*ddw - dis4*(w(i, j, k+<code class="constant">2</code>, irho)*w(i, j, k+<code class="constant">2</code>, itu1)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&              </code>-w(i, j, k-<code class="constant">1</code>, irho)*w(i, j, k-<code class="constant">1</code>, itu1)-three*ddw)</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">kavg = half*(w(i, j, k+<code class="constant">1</code>, itu1)+w(i, j, k, itu1))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">drk = zero</a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">kavg = zero</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute the average value of gamma and compute some</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! expressions in which it occurs.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">gammaavg = half*(gamma(i, j, k+<code class="constant">1</code>)+gamma(i, j, k))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">gm1 = gammaavg - one</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ovgm1 = one/gm1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">gm53 = gammaavg - five*third</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute the average state at the interface.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">uavg = half*(w(i, j, k+<code class="constant">1</code>, ivx)+w(i, j, k, ivx))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">vavg = half*(w(i, j, k+<code class="constant">1</code>, ivy)+w(i, j, k, ivy))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">wavg = half*(w(i, j, k+<code class="constant">1</code>, ivz)+w(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">a2avg = half*(gamma(i, j, k+<code class="constant">1</code>)*p(i, j, k+<code class="constant">1</code>)/w(i, j, k+<code class="constant">1</code>, irho)<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>+gamma(i, j, k)*p(i, j, k)/w(i, j, k, irho))</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sx = sk(i, j, k, <code class="constant">1</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sy = sk(i, j, k, <code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sz = sk(i, j, k, <code class="constant">3</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">area = <code class="funcname">SQRT</code>(arg1)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">max3 = area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">max3 = <code class="constant">1.e-25_realType</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">tmp = one/max3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sx = sx*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sy = sy*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">sz = sz*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">havg = alphaavg + ovgm1*(a2avg-gm53*kavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ovaavg = one/aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ova2avg = one/a2avg</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! The mesh velocity if the face is moving. It must be</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! divided by the area to obtain a true velocity.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (addgridvelocities) sface = sfacek(i, j, k)*tmp</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (unavg - sface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = unavg - sface + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = -(unavg-sface+aavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (unavg - sface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = unavg - sface - aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = -(unavg-sface-aavg)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (unavg - sface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = unavg - sface</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = -(unavg-sface)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">rrad = lam3 + aavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (lam1 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = lam1</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (lam2 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = lam2</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">IF</code> (lam3 .LT. epsshear*rrad) <code class="keyword">THEN</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = epsshear*rrad</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! the correct values for the dissipation term.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam1 = lam1*area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam2 = lam2*area</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">lam3 = lam3*area</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! dissipation terms.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv1 = half*(lam1+lam2)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv2 = half*(lam1-lam2)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv3 = abv1 - lam3</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>*drk</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Density.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*dr + abv6</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">ind = indfamilyk(i, j, k)</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(ind<code class="label">&</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="label">&            </code>, spectralsol) - factfamilyk(i, j, k)*fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! X-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*dru + uavg*abv6 + sx*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Y-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*drv + vavg*abv6 + sy*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Z-momentum.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*drw + wavg*abv6 + sz*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Energy.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fs = lam3*dre + havg*abv6 + unavg*abv7</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) + fs</a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="comment">! Set dp1 to dp2 for the next face.</code></a>
          <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile">dp1 = dp2</a>
        <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
      <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END DO</code></a>
  <a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrix_p.html#invisciddissfluxmatrix" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">INVISCIDDISSFLUXMATRIX_CD</code></a>
</pre>
</body>
