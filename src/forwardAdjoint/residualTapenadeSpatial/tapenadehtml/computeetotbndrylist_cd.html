<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="computeetotbndrylist_cd"></a><a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      ==================================================================</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COMPUTEETOTBNDRYLIST_CD</code>(<code class="vardecl">correctfork</code>)</a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      * ComputeEtotBndryList is identical to computeEtot except        *</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      * it computes total energy for the overset bndry index list.     *</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!</code></a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">correctfork</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      Local variables.</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!</code></a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">mm</code></a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ovgm1</code>, <code class="vardecl">factk</code>, <code class="vardecl">scale</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! Determine the cp model used in the computation.</code></a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">SELECT CASE </code> (cpmodel) </a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">CASE </code>(cpconstant) </a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! Constant cp and thus constant gamma.</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! Abbreviate 1/(gamma -1) a bit easier.</code></a>
    <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">ovgm1 = one/(gammaconstant-one)</a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! Loop over the given indices of the block and compute the first</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! step of the energy.</code></a>
    <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">DO </code>mm=<code class="constant">1</code>,ncellsoversetall</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">i = ibndry(<code class="constant">1</code>, mm)</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">j = ibndry(<code class="constant">2</code>, mm)</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">k = ibndry(<code class="constant">3</code>, mm)</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">w(i, j, k, irhoe) = ovgm1*p(i, j, k) + half*w(i, j, k, irho)*(w(i<code class="label">&</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="label">&        </code>, j, k, ivx)**<code class="constant">2</code>+w(i, j, k, ivy)**<code class="constant">2</code>+w(i, j, k, ivz)**<code class="constant">2</code>)</a>
    <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">END DO</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! Second step. Correct the energy in case a turbulent kinetic</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! energy is present.</code></a>
    <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">factk = ovgm1*(five*third-gammaconstant)</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">DO </code>mm=<code class="constant">1</code>,ncellsoversetall</a>
        <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">i = ibndry(<code class="constant">1</code>, mm)</a>
        <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">j = ibndry(<code class="constant">2</code>, mm)</a>
        <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">k = ibndry(<code class="constant">3</code>, mm)</a>
        <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">w(i, j, k, irhoe) = w(i, j, k, irhoe) - factk*w(i, j, k, irho)*w<code class="label">&</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="label">&          </code>(i, j, k, itu1)</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">END DO</code></a>
    <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">END IF</code></a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">CASE </code>(cptempcurvefits) </a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">!        ================================================================</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! Cp as function of the temperature is given via curve fits.</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! Store a scale factor to compute the nonDimensional</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! internal energy.</code></a>
    <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">scale = rgas/tref</a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="comment">! Loop over the given range of the block.</code></a>
    <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">DO </code>mm=<code class="constant">1</code>,ncellsoversetall</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">i = ibndry(<code class="constant">1</code>, mm)</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">j = ibndry(<code class="constant">2</code>, mm)</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile">k = ibndry(<code class="constant">3</code>, mm)</a>
      <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">CALL </code><code class="funcname">COMPUTEETOTCELLCPFIT_CD</code>(i, j, k, scale, correctfork)</a>
    <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">END DO</code></a>
  <a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="computeetotbndrylist_p.html#computeetotbndrylist" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COMPUTEETOTBNDRYLIST_CD</code></a>
</pre>
</body>
