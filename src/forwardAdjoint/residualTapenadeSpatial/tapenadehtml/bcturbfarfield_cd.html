<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="bcturbfarfield_cd"></a><a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * File:          bcTurbFarfield.f90                              *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * Author:        Georgi Kalitzin, Edwin van der Weide            *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * Starting date: 06-15-2003                                      *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * Last modified: 06-12-2005                                      *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">BCTURBFARFIELD_CD</code>(<code class="vardecl">nn</code>)</a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">BCTYPES_SPATIAL_D</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * bcTurbFarfield applies the implicit treatment of the           *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * farfield boundary condition to subface nn. As the farfield     *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * boundary condition is independent of the turbulence model,     *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * this routine is valid for all models. It is assumed that the   *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * pointers in blockPointers are already set to the correct       *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * block on the correct grid level.                               *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      Local variables.</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">l</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">nnx</code>, <code class="vardecl">nny</code>, <code class="vardecl">nnz</code>, <code class="vardecl">dot</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">bmt</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">bvt</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">!</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! Set the pointers for bmt and bvt, depending on the block face</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! on which the subface is located.</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">CASE </code>(imin) </a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bmt => bmti1</a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bvt => bvti1</a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">CASE </code>(imax) </a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bmt => bmti2</a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bvt => bvti2</a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">CASE </code>(jmin) </a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bmt => bmtj1</a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bvt => bvtj1</a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">CASE </code>(jmax) </a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bmt => bmtj2</a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bvt => bvtj2</a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">CASE </code>(kmin) </a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bmt => bmtk1</a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bvt => bvtk1</a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">CASE </code>(kmax) </a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bmt => bmtk2</a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bvt => bvtk2</a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! Loop over the faces of the subfaces and set the values of</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! bmt and bvt for an implicit treatment.</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! Store the three components of the unit normal a bit easier.</code></a>
      <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">nnx = bcdata(nn)%norm(i, j, <code class="constant">1</code>)</a>
      <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">nny = bcdata(nn)%norm(i, j, <code class="constant">2</code>)</a>
      <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">nnz = bcdata(nn)%norm(i, j, <code class="constant">3</code>)</a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! Determine the dot product between the outward pointing</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! normal and the free stream velocity direction and add the</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! possible grid velocity.</code></a>
      <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">dot = nnx*winf(ivx) + nny*winf(ivy) + nnz*winf(ivz) - bcdata(nn)%<code class="label">&</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="label">&        </code>rface(i, j)</a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! Determine whether we are dealing with an inflow or</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! outflow boundary here.</code></a>
      <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">IF</code> (dot .GT. zero) <code class="keyword">THEN</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! Outflow. Simply extrapolation or zero Neumann BC</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! of the turbulent variables.</code></a>
        <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">DO </code>l=nt1,nt2</a>
          <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bmt(i, j, l, l) = -one</a>
        <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">ELSE</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="comment">! Inflow. Turbulent variables are prescribed.</code></a>
        <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">DO </code>l=nt1,nt2</a>
          <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile">bvt(i, j, l) = winf(l)</a>
        <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">END DO</code></a>
      <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">END IF</code></a>
    <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">END DO</code></a>
  <a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">END DO</code></a>
<a href="bcturbfarfield_p.html#bcturbfarfield" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">BCTURBFARFIELD_CD</code></a>
</pre>
</body>
