<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="curveupre"></a><a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!      * File:          curveFit.f90                                    *</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!      * Author:        Georgi Kalitzin, Edwin van der Weide            *</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!      * Starting date: 03-02-2004                                      *</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!      * Last modified: 04-12-2005                                      *</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="comment">!</code></a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="keyword">FUNCTION </code><code class="funcname">CURVEUPRE</code>(<code class="vardecl">re</code>)</a>
<a name="curveuprei0"></a>  <a href="curveupre.html#curveupre" target="diffFile"><code class="keyword">USE </code><code class="funcname">PARAMTURB</code></a>
  <a href="curveupre.html#curveupre" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!      * curveUpRe determines the value of the nonDimensional           *</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!      * tangential velocity (made nonDimensional with the skin         *</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!      * friction velocity) for the given Reynolds number.              *</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!      * This data has been curve fitted with cubic splines.            *</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!</code></a>
<a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!      Function type.</code></a>
<a name="curveuprei1"></a><a href="curveupre.html#curveuprei0" target="diffFile"><code class="comment">!</code></a>
  <a href="curveupre.html#curveuprei0" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">curveupre</code></a>
<a href="curveupre.html#curveuprei1" target="diffFile"><code class="comment">!</code></a>
<a href="curveupre.html#curveuprei1" target="diffFile"><code class="comment">!      Function arguments.</code></a>
<a name="curveuprei2"></a><a href="curveupre.html#curveuprei1" target="diffFile"><code class="comment">!</code></a>
  <a href="curveupre.html#curveuprei1" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">re</code></a>
<a href="curveupre.html#curveuprei2" target="diffFile"><code class="comment">!</code></a>
<a href="curveupre.html#curveuprei2" target="diffFile"><code class="comment">!      Local variables.</code></a>
<a name="curveuprei3"></a><a href="curveupre.html#curveuprei2" target="diffFile"><code class="comment">!</code></a>
<a name="curveuprei4"></a>  <a href="curveupre.html#curveuprei2" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">ii</code>, <code class="vardecl">nn</code>, <code class="vardecl">start</code></a>
  <a href="curveupre.html#curveuprei3" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x</code>, <code class="vardecl">x2</code>, <code class="vardecl">x3</code>, <code class="vardecl">upre</code></a>
<a name="curveuprei5"></a>  <a href="curveupre.html#curveuprei4" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
  <a href="curveupre.html#curveupre" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
<a href="curveupre.html#curveuprei5" target="diffFile"><code class="comment">!</code></a>
<a href="curveupre.html#curveuprei5" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre.html#curveuprei5" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre.html#curveuprei5" target="diffFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="curveupre.html#curveuprei5" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="curveupre.html#curveuprei5" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="curveupre.html#curveuprei5" target="diffFile"><code class="comment">!</code></a>
<a name="curveuprei6"></a><a href="curveupre.html#curveuprei5" target="diffFile"><code class="comment">! Determine the situation we are dealing with.</code></a>
  <a href="curveupre.html#curveuprei5" target="diffFile"><code class="keyword">IF</code> (re .LE. ret(<code class="constant">0</code>)) <code class="keyword">THEN</code></a>
<a href="curveupre.html#curveuprei6" target="diffFile"><code class="comment">! Reynolds number is less than the smallest number in the curve</code></a>
<a name="curveuprei7"></a><a href="curveupre.html#curveuprei6" target="diffFile"><code class="comment">! fit. Use extrapolation.</code></a>
<a name="curveuprei8"></a>    <a href="curveupre.html#curveuprei6" target="diffFile">arg1 = re/ret(<code class="constant">0</code>)</a>
<a name="curveuprei9"></a>    <a href="curveupre.html#curveuprei7" target="diffFile">x = <code class="funcname">SQRT</code>(arg1)</a>
<a name="curveuprei10"></a>    <a href="curveupre.html#curveuprei8" target="diffFile">upre = x*up0(<code class="constant">1</code>)</a>
  <a href="curveupre.html#curveuprei5" target="diffFile"><code class="keyword">ELSE </code></a><a href="curveupre.html#curveuprei9" target="diffFile"><code class="keyword">IF</code> (re .GE. ret(nfit)) <code class="keyword">THEN</code></a>
<a href="curveupre.html#curveuprei10" target="diffFile"><code class="comment">! Reynolds number is larger than the largest number in the curve</code></a>
<a name="curveuprei11"></a><a href="curveupre.html#curveuprei10" target="diffFile"><code class="comment">! fit. Set upRe to the largest value available.</code></a>
<a name="curveuprei12"></a>    <a href="curveupre.html#curveuprei10" target="diffFile">nn = nfit</a>
<a name="curveuprei13"></a>    <a href="curveupre.html#curveuprei11" target="diffFile">x = ret(nn) - ret(nn-<code class="constant">1</code>)</a>
<a name="curveuprei14"></a>    <a href="curveupre.html#curveuprei12" target="diffFile">x2 = x*x</a>
    <a href="curveupre.html#curveuprei13" target="diffFile">x3 = x*x2</a>
<a name="curveuprei15"></a>    <a href="curveupre.html#curveuprei14" target="diffFile">upre = up0(nn) + up1(nn)*x + up2(nn)*x2 + up3(nn)*x3</a>
  <a href="curveupre.html#curveuprei9" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="curveupre.html#curveuprei15" target="diffFile"><code class="comment">! Reynolds number is in the range of the curve fits.</code></a>
<a name="curveuprei16"></a><a href="curveupre.html#curveuprei15" target="diffFile"><code class="comment">! First find the correct interval.</code></a>
<a name="curveuprei17"></a>    <a href="curveupre.html#curveuprei15" target="diffFile">ii = nfit</a>
<a name="curveuprei18"></a>    <a href="curveupre.html#curveuprei16" target="diffFile">start = <code class="constant">1</code></a>
<a href="curveupre.html#curveuprei17" target="diffFile"><code class="label">interval:</code><code class="keyword">DO </code></a>
<a name="curveuprei19"></a><a href="curveupre.html#curveuprei18" target="diffFile"><code class="comment">! Next guess for the interval.</code></a>
      <a href="curveupre.html#curveuprei18" target="diffFile">nn = start + ii/<code class="constant">2</code></a>
<a name="curveuprei20"></a><a href="curveupre.html#curveuprei19" target="diffFile"><code class="comment">! Determine the situation we are having here.</code></a>
      <a href="curveupre.html#curveuprei19" target="diffFile"><code class="keyword">IF</code> (re .GT. ret(nn)) <code class="keyword">THEN</code></a>
<a href="curveupre.html#curveuprei20" target="diffFile"><code class="comment">! Reynoldls number is larger than the upper boundary of</code></a>
<a name="curveuprei21"></a><a href="curveupre.html#curveuprei20" target="diffFile"><code class="comment">! the current interval. Update the lower boundary.</code></a>
<a name="curveuprei22"></a>        <a href="curveupre.html#curveuprei20" target="diffFile">start = nn + <code class="constant">1</code></a>
        <a href="curveupre.html#curveuprei21" target="diffFile">ii = ii - <code class="constant">1</code></a>
      <a href="curveupre.html#curveuprei19" target="diffFile"><code class="keyword">ELSE </code></a><a href="curveupre.html#curveuprei22" target="diffFile"><code class="keyword">IF</code> (re .GE. ret(nn-<code class="constant">1</code>)) <code class="keyword">THEN</code></a>
<a name="curveuprei23"></a>        <a href="curveupre.html#curveuprei22" target="diffFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
      <a href="curveupre.html#curveuprei19" target="diffFile"><code class="keyword">END IF</code></a>
<a href="curveupre.html#curveuprei23" target="diffFile"><code class="comment">! This is the correct range. Exit the do-loop.</code></a>
<a href="curveupre.html#curveuprei23" target="diffFile"><code class="comment">! Modify ii for the next branch to search.</code></a>
      <a href="curveupre.html#curveuprei23" target="diffFile">ii = ii/<code class="constant">2</code></a>
<a name="curveuprei24"></a>    <a href="curveupre.html#curveuprei17" target="diffFile"><code class="keyword">END DO </code><code class="label">interval</code></a>
<a name="curveuprei25"></a><a href="curveupre.html#curveuprei9" target="diffFile"><code class="comment">! Compute upRe using the cubic polynomial for this interval.</code></a>
<a name="curveuprei26"></a> <a href="curveupre.html#curveuprei9" target="diffFile"><code class="label">100 </code></a><a href="curveupre.html#curveuprei24" target="diffFile">x = re - ret(nn-<code class="constant">1</code>)</a>
<a name="curveuprei27"></a>    <a href="curveupre.html#curveuprei25" target="diffFile">x2 = x*x</a>
    <a href="curveupre.html#curveuprei26" target="diffFile">x3 = x*x2</a>
<a name="curveuprei28"></a>    <a href="curveupre.html#curveuprei27" target="diffFile">upre = up0(nn) + up1(nn)*x + up2(nn)*x2 + up3(nn)*x3</a>
  <a href="curveupre.html#curveuprei5" target="diffFile"><code class="keyword">END IF</code></a>
<a href="curveupre.html#curveuprei28" target="diffFile"><code class="comment">! And set the function value.</code></a>
  <a href="curveupre.html#curveuprei28" target="diffFile">curveupre = upre</a>
<a href="curveupre.html#curveupre" target="diffFile"><code class="keyword">END FUNCTION </code><code class="funcname">CURVEUPRE</code></a>
</pre>
</body>
