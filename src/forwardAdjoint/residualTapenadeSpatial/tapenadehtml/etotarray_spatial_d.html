<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="etotarray_spatial_d"></a><a href="etotarray_p.html#etotarray" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="etotarray_p.html#etotarray" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="etotarray_p.html#etotarray" target="origFile"><code class="comment">!</code></a>
<a href="etotarray_p.html#etotarray" target="origFile"><code class="comment">!  Differentiation of etotarray in forward (tangent) mode:</code></a>
<a href="etotarray_p.html#etotarray" target="origFile"><code class="comment">!   variations   of useful results: etot</code></a>
<a href="etotarray_p.html#etotarray" target="origFile"><code class="comment">!   with respect to varying inputs: k p u v w rho</code></a>
<a href="etotarray_p.html#etotarray" target="origFile"><code class="comment">!      ==================================================================</code></a>
<a href="etotarray_p.html#etotarray" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">ETOTARRAY_SPATIAL_D</code>(<code class="vardecl">rho</code>, <code class="vardecl">rhod</code>, <code class="vardecl">u</code>, <code class="vardecl">ud</code>, <code class="vardecl">v</code>, <code class="vardecl">vd</code>, <code class="vardecl">w</code>, <code class="vardecl">wd</code>, <code class="vardecl">p</code>, <code class="vardecl">pd</code>, <code class="vardecl">k</code><code class="label">&</code></a>
<a href="etotarray_p.html#etotarray" target="origFile"><code class="label">&  </code>, <code class="vardecl">kd</code>, <code class="vardecl">etot</code>, <code class="vardecl">etotd</code>, <code class="vardecl">correctfork</code>, <code class="vardecl">kk</code>)</a>
<a name="etotarray_spatial_di0"></a>  <a href="etotarray_p.html#etotarray" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
  <a href="etotarray_p.html#etotarray" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      * EtotArray computes the total energy from the given density,    *</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      * velocity and presssure for the given kk elements of the arrays.*</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      * First the internal energy per unit mass is computed and after  *</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      * that the kinetic energy is added as well the conversion to     *</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      * energy per unit volume.                                        *</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="comment">!</code></a>
<a name="etotarray_spatial_di1"></a>  <a href="etotarray_p.html#etotarrayi0" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="keyword">*</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">rho</code>, <code class="vardecl">p</code>, <code class="vardecl">k</code></a>
  <a href="etotarray_p.html#etotarray" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(<code class="keyword">*</code>), <code class="typename">INTENT(IN) </code>:: <code class="vardecl">rhod</code>, <code class="vardecl">pd</code>, <code class="vardecl">kd</code></a>
<a name="etotarray_spatial_di2"></a>  <a href="etotarray_p.html#etotarrayi1" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="keyword">*</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">u</code>, <code class="vardecl">v</code>, <code class="vardecl">w</code></a>
  <a href="etotarray_p.html#etotarray" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(<code class="keyword">*</code>), <code class="typename">INTENT(IN) </code>:: <code class="vardecl">ud</code>, <code class="vardecl">vd</code>, <code class="vardecl">wd</code></a>
<a name="etotarray_spatial_di3"></a>  <a href="etotarray_p.html#etotarrayi2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="keyword">*</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">etot</code></a>
<a name="etotarray_spatial_di4"></a>  <a href="etotarray_p.html#etotarray" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(<code class="keyword">*</code>), <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">etotd</code></a>
<a name="etotarray_spatial_di5"></a>  <a href="etotarray_p.html#etotarrayi3" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">correctfork</code></a>
  <a href="etotarray_p.html#etotarrayi4" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kk</code></a>
<a href="etotarray_p.html#etotarrayi5" target="origFile"><code class="comment">!</code></a>
<a href="etotarray_p.html#etotarrayi5" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="etotarray_spatial_di6"></a><a href="etotarray_p.html#etotarrayi5" target="origFile"><code class="comment">!</code></a>
  <a href="etotarray_p.html#etotarrayi5" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code></a>
<a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="comment">!</code></a>
<a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="comment">!</code></a>
<a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="comment">! Compute the internal energy for unit mass.</code></a>
<a name="etotarray_spatial_di7"></a>  <a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="keyword">CALL </code><code class="funcname">EINTARRAY_SPATIAL_D</code>(rho, rhod, p, pd, k, kd, etot, etotd, <code class="label">&</code></a>
<a href="etotarray_p.html#etotarrayi6" target="origFile"><code class="label">&                     </code>correctfork, kk)</a>
<a name="etotarray_spatial_di8"></a><a href="etotarray_p.html#etotarrayi7" target="origFile"><code class="comment">! Add the kinetic energy.</code></a>
  <a href="etotarray_p.html#etotarrayi7" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,kk</a>
    <a href="etotarray_p.html#etotarrayi8" target="origFile">etotd(i) = rhod(i)*(etot(i)+half*(u(i)*u(i)+v(i)*v(i)+w(i)*w(i))) + <code class="label">&</code></a>
<a href="etotarray_p.html#etotarrayi8" target="origFile"><code class="label">&      </code>rho(i)*(etotd(i)+half*(ud(i)*u(i)+u(i)*ud(i)+vd(i)*v(i)+v(i)*vd(i)<code class="label">&</code></a>
<a href="etotarray_p.html#etotarrayi8" target="origFile"><code class="label">&      </code>+wd(i)*w(i)+w(i)*wd(i)))</a>
    <a href="etotarray_p.html#etotarrayi8" target="origFile">etot(i) = rho(i)*(etot(i)+half*(u(i)*u(i)+v(i)*v(i)+w(i)*w(i)))</a>
  <a href="etotarray_p.html#etotarrayi7" target="origFile"><code class="keyword">END DO</code></a>
<a href="etotarray_p.html#etotarray" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">ETOTARRAY_SPATIAL_D</code></a>
</pre>
</body>
