<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="invisciddissfluxmatrixcoarse"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!      * File:          inviscidDissFluxMatrixCoarse.f90                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!      * Starting date: 03-25-2003                                      *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!      * Last modified: 08-25-2005                                      *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">INVISCIDDISSFLUXMATRIXCOARSE</code>()</a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">USE </code><code class="funcname">INPUTDISCRETIZATION</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE</code></a>
<a name="invisciddissfluxmatrixcoarsei0"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">USE </code><code class="funcname">ITERATION</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      * inviscidDissFluxMatrixCoarse computes the matrix artificial    *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      * dissipation term. Instead of the spectral radius, as used in   *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      * the scalar dissipation scheme, the absolute value of the flux  *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      * jacobian is used. This routine is used on the coarser grids in *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      * the multigrid cycle and only computes the first order          *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      * dissipation term. It is assumed that the pointers in           *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      * blockPointers already point to the correct block.              *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!      Local parameters.</code></a>
<a name="invisciddissfluxmatrixcoarsei1"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="comment">!</code></a>
<a name="invisciddissfluxmatrixcoarsei2"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei0" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">epsacoustic</code>=<code class="constant">0.25_realType</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei1" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">epsshear</code>=<code class="constant">0.025_realType</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei2" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei2" target="diffFile"><code class="comment">!      Local variables.</code></a>
<a name="invisciddissfluxmatrixcoarsei3"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei2" target="diffFile"><code class="comment">!</code></a>
<a name="invisciddissfluxmatrixcoarsei4"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei2" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code></a>
<a name="invisciddissfluxmatrixcoarsei5"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei3" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sfil</code>, <code class="vardecl">fis0</code>, <code class="vardecl">dis0</code>, <code class="vardecl">ppor</code>, <code class="vardecl">rrad</code>, <code class="vardecl">sface</code></a>
<a name="invisciddissfluxmatrixcoarsei6"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei4" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">gammaavg</code>, <code class="vardecl">gm1</code>, <code class="vardecl">ovgm1</code>, <code class="vardecl">gm53</code>, <code class="vardecl">tmp</code>, <code class="vardecl">fs</code></a>
<a name="invisciddissfluxmatrixcoarsei7"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei5" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dr</code>, <code class="vardecl">dru</code>, <code class="vardecl">drv</code>, <code class="vardecl">drw</code>, <code class="vardecl">dre</code>, <code class="vardecl">drk</code>, <code class="vardecl">sx</code>, <code class="vardecl">sy</code>, <code class="vardecl">sz</code></a>
<a name="invisciddissfluxmatrixcoarsei8"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei6" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">uavg</code>, <code class="vardecl">vavg</code>, <code class="vardecl">wavg</code>, <code class="vardecl">a2avg</code>, <code class="vardecl">aavg</code>, <code class="vardecl">havg</code></a>
<a name="invisciddissfluxmatrixcoarsei9"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei7" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">alphaavg</code>, <code class="vardecl">unavg</code>, <code class="vardecl">ovaavg</code>, <code class="vardecl">ova2avg</code></a>
<a name="invisciddissfluxmatrixcoarsei10"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei8" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">kavg</code>, <code class="vardecl">lam1</code>, <code class="vardecl">lam2</code>, <code class="vardecl">lam3</code>, <code class="vardecl">area</code></a>
<a name="invisciddissfluxmatrixcoarsei11"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei9" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abv1</code>, <code class="vardecl">abv2</code>, <code class="vardecl">abv3</code>, <code class="vardecl">abv4</code>, <code class="vardecl">abv5</code>, <code class="vardecl">abv6</code>, <code class="vardecl">abv7</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei10" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">correctfork</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei11" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max3</code></a>
<a name="invisciddissfluxmatrixcoarsei12"></a>  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max1</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="comment">!</code></a>
<a name="p11"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="comment">! Check if rFil == 0. If so, the dissipative flux needs not to</code></a>
<a name="invisciddissfluxmatrixcoarsei13"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="comment">! be computed.</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p11" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile">rfil .EQ. zero) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei14"></a>    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei13" target="diffFile"><code class="keyword">RETURN</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei14" target="diffFile"><code class="comment">! Determine whether or not the total energy must be corrected</code></a>
<a name="invisciddissfluxmatrixcoarsei15"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei14" target="diffFile"><code class="comment">! for the presence of the turbulent kinetic energy.</code></a>
<a name="invisciddissfluxmatrixcoarsei16"></a>    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei14" target="diffFile"><code class="keyword">IF</code> (kpresent) <code class="keyword">THEN</code></a>
      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei15" target="diffFile"><code class="keyword">IF</code> (currentlevel .EQ. groundlevel .OR. turbcoupled) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei17"></a>        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei16" target="diffFile">correctfork = <code class="constant">.true.</code></a>
      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei15" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei17" target="diffFile">correctfork = <code class="constant">.false.</code></a>
<a name="invisciddissfluxmatrixcoarsei18"></a>      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei15" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei14" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei19"></a>      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei18" target="diffFile">correctfork = <code class="constant">.false.</code></a>
    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei14" target="diffFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei19" target="diffFile"><code class="comment">! Initialize sface to zero. This value will be used if the</code></a>
<a name="invisciddissfluxmatrixcoarsei20"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei19" target="diffFile"><code class="comment">! block is not moving.</code></a>
    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei19" target="diffFile">sface = zero</a>
<a name="invisciddissfluxmatrixcoarsei21"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei20" target="diffFile"><code class="comment">! Set a couple of constants for the scheme.</code></a>
<a name="invisciddissfluxmatrixcoarsei22"></a>    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei20" target="diffFile">fis0 = rfil*vis2coarse</a>
    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei21" target="diffFile">sfil = one - rfil</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei22" target="diffFile"><code class="comment">! Initialize the dissipative residual to a certain times,</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei22" target="diffFile"><code class="comment">! possibly zero, the previously stored value. Owned cells</code></a>
<a name="invisciddissfluxmatrixcoarsei23"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei22" target="diffFile"><code class="comment">! only, because the halo values do not matter.</code></a>
<a name="invisciddissfluxmatrixcoarsei24"></a>    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei22" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="invisciddissfluxmatrixcoarsei25"></a>      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei23" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
<a name="invisciddissfluxmatrixcoarsei26"></a>        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei24" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="invisciddissfluxmatrixcoarsei27"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei25" target="diffFile">fw(i, j, k, irho) = sfil*fw(i, j, k, irho)</a>
<a name="invisciddissfluxmatrixcoarsei28"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei26" target="diffFile">fw(i, j, k, imx) = sfil*fw(i, j, k, imx)</a>
<a name="invisciddissfluxmatrixcoarsei29"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei27" target="diffFile">fw(i, j, k, imy) = sfil*fw(i, j, k, imy)</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei28" target="diffFile">fw(i, j, k, imz) = sfil*fw(i, j, k, imz)</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei29" target="diffFile">fw(i, j, k, irhoe) = sfil*fw(i, j, k, irhoe)</a>
        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei24" target="diffFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxmatrixcoarsei30"></a>      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei23" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei22" target="diffFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei30" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei30" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei30" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei30" target="diffFile"><code class="comment">!      * Dissipative fluxes in the i-direction.                         *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei30" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei30" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a name="invisciddissfluxmatrixcoarsei31"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei30" target="diffFile"><code class="comment">!</code></a>
<a name="invisciddissfluxmatrixcoarsei32"></a>    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei30" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="invisciddissfluxmatrixcoarsei33"></a>      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei31" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei32" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
<a name="invisciddissfluxmatrixcoarsei35"></a><a name="invisciddissfluxmatrixcoarsei34"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei33" target="diffFile"><code class="comment">! Compute the dissipation coefficient for this face.</code></a>
<a name="invisciddissfluxmatrixcoarsei36"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei33" target="diffFile">ppor = zero</a>
<a name="invisciddissfluxmatrixcoarsei37"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei34" target="diffFile"><code class="keyword">IF</code> (pori(i, j, k) .EQ. normalflux) </a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei35" target="diffFile">ppor = one</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei36" target="diffFile">dis0 = fis0*ppor</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei37" target="diffFile"><code class="comment">! Construct the vector of the first differences multiplied</code></a>
<a name="invisciddissfluxmatrixcoarsei38"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei37" target="diffFile"><code class="comment">! by dis0.</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei37" target="diffFile">dr = dis0*(w(i+<code class="constant">1</code>, j, k, irho)-w(i, j, k, irho))</a>
<a name="invisciddissfluxmatrixcoarsei39"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei38" target="diffFile">dru = dis0*(w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivx)-w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei38" target="diffFile"><code class="label">&            </code>irho)*w(i, j, k, ivx))</a>
<a name="invisciddissfluxmatrixcoarsei40"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei39" target="diffFile">drv = dis0*(w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivy)-w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei39" target="diffFile"><code class="label">&            </code>irho)*w(i, j, k, ivy))</a>
<a name="invisciddissfluxmatrixcoarsei41"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei40" target="diffFile">drw = dis0*(w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, ivz)-w(i, j, k, <code class="label">&</code></a>
<a name="invisciddissfluxmatrixcoarsei42"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei40" target="diffFile"><code class="label">&            </code>irho)*w(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei41" target="diffFile">dre = dis0*(w(i+<code class="constant">1</code>, j, k, irhoe)-w(i, j, k, irhoe))</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei42" target="diffFile"><code class="comment">! In case a k-equation is present, compute the difference</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei42" target="diffFile"><code class="comment">! of rhok and store the average value of k. If not present,</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei42" target="diffFile"><code class="comment">! set both these values to zero, such that later on no</code></a>
<a name="invisciddissfluxmatrixcoarsei43"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei42" target="diffFile"><code class="comment">! decision needs to be made anymore.</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei42" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei44"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei43" target="diffFile">drk = dis0*(w(i+<code class="constant">1</code>, j, k, irho)*w(i+<code class="constant">1</code>, j, k, itu1)-w(i, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei43" target="diffFile"><code class="label">&              </code>, irho)*w(i, j, k, itu1))</a>
<a name="invisciddissfluxmatrixcoarsei45"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei44" target="diffFile">kavg = half*(w(i+<code class="constant">1</code>, j, k, itu1)+w(i, j, k, itu1))</a>
<a name="invisciddissfluxmatrixcoarsei46"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei42" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei45" target="diffFile">drk = zero</a>
<a name="invisciddissfluxmatrixcoarsei47"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei46" target="diffFile">kavg = zero</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei42" target="diffFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei47" target="diffFile"><code class="comment">! Compute the average value of gamma and compute some</code></a>
<a name="invisciddissfluxmatrixcoarsei48"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei47" target="diffFile"><code class="comment">! expressions in which it occurs.</code></a>
<a name="invisciddissfluxmatrixcoarsei49"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei47" target="diffFile">gammaavg = half*(gamma(i+<code class="constant">1</code>, j, k)+gamma(i, j, k))</a>
<a name="invisciddissfluxmatrixcoarsei50"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei48" target="diffFile">gm1 = gammaavg - one</a>
<a name="invisciddissfluxmatrixcoarsei51"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei49" target="diffFile">ovgm1 = one/gm1</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei50" target="diffFile">gm53 = gammaavg - five*third</a>
<a name="invisciddissfluxmatrixcoarsei52"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei51" target="diffFile"><code class="comment">! Compute the average state at the interface.</code></a>
<a name="invisciddissfluxmatrixcoarsei53"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei51" target="diffFile">uavg = half*(w(i+<code class="constant">1</code>, j, k, ivx)+w(i, j, k, ivx))</a>
<a name="invisciddissfluxmatrixcoarsei54"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei52" target="diffFile">vavg = half*(w(i+<code class="constant">1</code>, j, k, ivy)+w(i, j, k, ivy))</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei53" target="diffFile">wavg = half*(w(i+<code class="constant">1</code>, j, k, ivz)+w(i, j, k, ivz))</a>
<a name="invisciddissfluxmatrixcoarsei55"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei54" target="diffFile">a2avg = half*(gamma(i+<code class="constant">1</code>, j, k)*p(i+<code class="constant">1</code>, j, k)/w(i+<code class="constant">1</code>, j, k, irho)<code class="label">&</code></a>
<a name="invisciddissfluxmatrixcoarsei56"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei54" target="diffFile"><code class="label">&            </code>+gamma(i, j, k)*p(i, j, k)/w(i, j, k, irho))</a>
<a name="invisciddissfluxmatrixcoarsei57"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei55" target="diffFile">sx = si(i, j, k, <code class="constant">1</code>)</a>
<a name="invisciddissfluxmatrixcoarsei58"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei56" target="diffFile">sy = si(i, j, k, <code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrixcoarsei59"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei57" target="diffFile">sz = si(i, j, k, <code class="constant">3</code>)</a>
<a name="invisciddissfluxmatrixcoarsei60"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei58" target="diffFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
<a name="invisciddissfluxmatrixcoarsei62"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei59" target="diffFile">area = <code class="funcname">SQRT</code>(arg1)</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei60" target="diffFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei61"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei62" target="diffFile">max1 = area</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei60" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei63"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei61" target="diffFile">max1 = <code class="constant">1.e-25_realType</code></a>
<a name="invisciddissfluxmatrixcoarsei64"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei60" target="diffFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrixcoarsei65"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei63" target="diffFile">tmp = one/max1</a>
<a name="invisciddissfluxmatrixcoarsei66"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei64" target="diffFile">sx = sx*tmp</a>
<a name="invisciddissfluxmatrixcoarsei67"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei65" target="diffFile">sy = sy*tmp</a>
<a name="invisciddissfluxmatrixcoarsei68"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei66" target="diffFile">sz = sz*tmp</a>
<a name="invisciddissfluxmatrixcoarsei69"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei67" target="diffFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrixcoarsei70"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei68" target="diffFile">havg = alphaavg + ovgm1*(a2avg-gm53*kavg)</a>
<a name="invisciddissfluxmatrixcoarsei71"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei69" target="diffFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
<a name="invisciddissfluxmatrixcoarsei72"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei70" target="diffFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
<a name="invisciddissfluxmatrixcoarsei73"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei71" target="diffFile">ovaavg = one/aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei72" target="diffFile">ova2avg = one/a2avg</a>
<a name="invisciddissfluxmatrixcoarsei74"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei73" target="diffFile"><code class="comment">! The mesh velocity if the face is moving. It must be</code></a>
<a name="invisciddissfluxmatrixcoarsei75"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei73" target="diffFile"><code class="comment">! divided by the area to obtain a true velocity.</code></a>
<a name="invisciddissfluxmatrixcoarsei77"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei73" target="diffFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei74" target="diffFile">sface = sfacei(i, j, k)*tmp</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei75" target="diffFile"><code class="keyword">IF</code> (unavg - sface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei76"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei77" target="diffFile">lam1 = unavg - sface + aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei75" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei78"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei76" target="diffFile">lam1 = -(unavg-sface+aavg)</a>
<a name="invisciddissfluxmatrixcoarsei80"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei75" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei78" target="diffFile"><code class="keyword">IF</code> (unavg - sface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei79"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei80" target="diffFile">lam2 = unavg - sface - aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei78" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei81"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei79" target="diffFile">lam2 = -(unavg-sface-aavg)</a>
<a name="invisciddissfluxmatrixcoarsei83"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei78" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei81" target="diffFile"><code class="keyword">IF</code> (unavg - sface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei82"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei83" target="diffFile">lam3 = unavg - sface</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei81" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei84"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei82" target="diffFile">lam3 = -(unavg-sface)</a>
<a name="invisciddissfluxmatrixcoarsei85"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei81" target="diffFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrixcoarsei87"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei84" target="diffFile">rrad = lam3 + aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei85" target="diffFile"><code class="keyword">IF</code> (lam1 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei86"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei87" target="diffFile">lam1 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei85" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei88"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei86" target="diffFile">lam1 = lam1</a>
<a name="invisciddissfluxmatrixcoarsei90"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei85" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei88" target="diffFile"><code class="keyword">IF</code> (lam2 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei89"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei90" target="diffFile">lam2 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei88" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei91"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei89" target="diffFile">lam2 = lam2</a>
<a name="invisciddissfluxmatrixcoarsei93"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei88" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei91" target="diffFile"><code class="keyword">IF</code> (lam3 .LT. epsshear*rrad) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei92"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei93" target="diffFile">lam3 = epsshear*rrad</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei91" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei94"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei92" target="diffFile">lam3 = lam3</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei91" target="diffFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei94" target="diffFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a name="invisciddissfluxmatrixcoarsei95"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei94" target="diffFile"><code class="comment">! the correct values for the dissipation term.</code></a>
<a name="invisciddissfluxmatrixcoarsei96"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei94" target="diffFile">lam1 = lam1*area</a>
<a name="invisciddissfluxmatrixcoarsei97"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei95" target="diffFile">lam2 = lam2*area</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei96" target="diffFile">lam3 = lam3*area</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei97" target="diffFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a name="invisciddissfluxmatrixcoarsei98"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei97" target="diffFile"><code class="comment">! dissipation terms.</code></a>
<a name="invisciddissfluxmatrixcoarsei99"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei97" target="diffFile">abv1 = half*(lam1+lam2)</a>
<a name="invisciddissfluxmatrixcoarsei100"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei98" target="diffFile">abv2 = half*(lam1-lam2)</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei99" target="diffFile">abv3 = abv1 - lam3</a>
<a name="invisciddissfluxmatrixcoarsei101"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei100" target="diffFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53<code class="label">&</code></a>
<a name="invisciddissfluxmatrixcoarsei102"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei100" target="diffFile"><code class="label">&            </code>*drk</a>
<a name="invisciddissfluxmatrixcoarsei103"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei101" target="diffFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
<a name="invisciddissfluxmatrixcoarsei104"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei102" target="diffFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei103" target="diffFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei104" target="diffFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a name="invisciddissfluxmatrixcoarsei105"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei104" target="diffFile"><code class="comment">! Density.</code></a>
<a name="invisciddissfluxmatrixcoarsei106"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei104" target="diffFile">fs = lam3*dr + abv6</a>
<a name="invisciddissfluxmatrixcoarsei107"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei105" target="diffFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei106" target="diffFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
<a name="invisciddissfluxmatrixcoarsei108"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei107" target="diffFile"><code class="comment">! X-momentum.</code></a>
<a name="invisciddissfluxmatrixcoarsei109"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei107" target="diffFile">fs = lam3*dru + uavg*abv6 + sx*abv7</a>
<a name="invisciddissfluxmatrixcoarsei110"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei108" target="diffFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei109" target="diffFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a name="invisciddissfluxmatrixcoarsei111"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei110" target="diffFile"><code class="comment">! Y-momentum.</code></a>
<a name="invisciddissfluxmatrixcoarsei112"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei110" target="diffFile">fs = lam3*drv + vavg*abv6 + sy*abv7</a>
<a name="invisciddissfluxmatrixcoarsei113"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei111" target="diffFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei112" target="diffFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a name="invisciddissfluxmatrixcoarsei114"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei113" target="diffFile"><code class="comment">! Z-momentum.</code></a>
<a name="invisciddissfluxmatrixcoarsei115"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei113" target="diffFile">fs = lam3*drw + wavg*abv6 + sz*abv7</a>
<a name="invisciddissfluxmatrixcoarsei116"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei114" target="diffFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei115" target="diffFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a name="invisciddissfluxmatrixcoarsei117"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei116" target="diffFile"><code class="comment">! Energy.</code></a>
<a name="invisciddissfluxmatrixcoarsei118"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei116" target="diffFile">fs = lam3*dre + havg*abv6 + unavg*abv7</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei117" target="diffFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei118" target="diffFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei32" target="diffFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxmatrixcoarsei119"></a>      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei31" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei30" target="diffFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei119" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei119" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei119" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei119" target="diffFile"><code class="comment">!      * Dissipative fluxes in the j-direction.                         *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei119" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei119" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a name="invisciddissfluxmatrixcoarsei120"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei119" target="diffFile"><code class="comment">!</code></a>
<a name="invisciddissfluxmatrixcoarsei121"></a>    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei119" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="invisciddissfluxmatrixcoarsei122"></a>      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei120" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei121" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="invisciddissfluxmatrixcoarsei124"></a><a name="invisciddissfluxmatrixcoarsei123"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei122" target="diffFile"><code class="comment">! Compute the dissipation coefficient for this face.</code></a>
<a name="invisciddissfluxmatrixcoarsei125"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei122" target="diffFile">ppor = zero</a>
<a name="invisciddissfluxmatrixcoarsei126"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei123" target="diffFile"><code class="keyword">IF</code> (porj(i, j, k) .EQ. normalflux) </a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei124" target="diffFile">ppor = one</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei125" target="diffFile">dis0 = fis0*ppor</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei126" target="diffFile"><code class="comment">! Construct the vector of the first differences multiplied</code></a>
<a name="invisciddissfluxmatrixcoarsei127"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei126" target="diffFile"><code class="comment">! by dis0.</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei126" target="diffFile">dr = dis0*(w(i, j+<code class="constant">1</code>, k, irho)-w(i, j, k, irho))</a>
<a name="invisciddissfluxmatrixcoarsei128"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei127" target="diffFile">dru = dis0*(w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivx)-w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei127" target="diffFile"><code class="label">&            </code>irho)*w(i, j, k, ivx))</a>
<a name="invisciddissfluxmatrixcoarsei129"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei128" target="diffFile">drv = dis0*(w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivy)-w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei128" target="diffFile"><code class="label">&            </code>irho)*w(i, j, k, ivy))</a>
<a name="invisciddissfluxmatrixcoarsei130"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei129" target="diffFile">drw = dis0*(w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, ivz)-w(i, j, k, <code class="label">&</code></a>
<a name="invisciddissfluxmatrixcoarsei131"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei129" target="diffFile"><code class="label">&            </code>irho)*w(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei130" target="diffFile">dre = dis0*(w(i, j+<code class="constant">1</code>, k, irhoe)-w(i, j, k, irhoe))</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei131" target="diffFile"><code class="comment">! In case a k-equation is present, compute the difference</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei131" target="diffFile"><code class="comment">! of rhok and store the average value of k. If not present,</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei131" target="diffFile"><code class="comment">! set both these values to zero, such that later on no</code></a>
<a name="invisciddissfluxmatrixcoarsei132"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei131" target="diffFile"><code class="comment">! decision needs to be made anymore.</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei131" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei133"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei132" target="diffFile">drk = dis0*(w(i, j+<code class="constant">1</code>, k, irho)*w(i, j+<code class="constant">1</code>, k, itu1)-w(i, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei132" target="diffFile"><code class="label">&              </code>, irho)*w(i, j, k, itu1))</a>
<a name="invisciddissfluxmatrixcoarsei134"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei133" target="diffFile">kavg = half*(w(i, j+<code class="constant">1</code>, k, itu1)+w(i, j, k, itu1))</a>
<a name="invisciddissfluxmatrixcoarsei135"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei131" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei134" target="diffFile">drk = zero</a>
<a name="invisciddissfluxmatrixcoarsei136"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei135" target="diffFile">kavg = zero</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei131" target="diffFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei136" target="diffFile"><code class="comment">! Compute the average value of gamma and compute some</code></a>
<a name="invisciddissfluxmatrixcoarsei137"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei136" target="diffFile"><code class="comment">! expressions in which it occurs.</code></a>
<a name="invisciddissfluxmatrixcoarsei138"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei136" target="diffFile">gammaavg = half*(gamma(i, j+<code class="constant">1</code>, k)+gamma(i, j, k))</a>
<a name="invisciddissfluxmatrixcoarsei139"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei137" target="diffFile">gm1 = gammaavg - one</a>
<a name="invisciddissfluxmatrixcoarsei140"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei138" target="diffFile">ovgm1 = one/gm1</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei139" target="diffFile">gm53 = gammaavg - five*third</a>
<a name="invisciddissfluxmatrixcoarsei141"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei140" target="diffFile"><code class="comment">! Compute the average state at the interface.</code></a>
<a name="invisciddissfluxmatrixcoarsei142"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei140" target="diffFile">uavg = half*(w(i, j+<code class="constant">1</code>, k, ivx)+w(i, j, k, ivx))</a>
<a name="invisciddissfluxmatrixcoarsei143"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei141" target="diffFile">vavg = half*(w(i, j+<code class="constant">1</code>, k, ivy)+w(i, j, k, ivy))</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei142" target="diffFile">wavg = half*(w(i, j+<code class="constant">1</code>, k, ivz)+w(i, j, k, ivz))</a>
<a name="invisciddissfluxmatrixcoarsei144"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei143" target="diffFile">a2avg = half*(gamma(i, j+<code class="constant">1</code>, k)*p(i, j+<code class="constant">1</code>, k)/w(i, j+<code class="constant">1</code>, k, irho)<code class="label">&</code></a>
<a name="invisciddissfluxmatrixcoarsei145"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei143" target="diffFile"><code class="label">&            </code>+gamma(i, j, k)*p(i, j, k)/w(i, j, k, irho))</a>
<a name="invisciddissfluxmatrixcoarsei146"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei144" target="diffFile">sx = sj(i, j, k, <code class="constant">1</code>)</a>
<a name="invisciddissfluxmatrixcoarsei147"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei145" target="diffFile">sy = sj(i, j, k, <code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrixcoarsei148"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei146" target="diffFile">sz = sj(i, j, k, <code class="constant">3</code>)</a>
<a name="invisciddissfluxmatrixcoarsei149"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei147" target="diffFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
<a name="invisciddissfluxmatrixcoarsei151"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei148" target="diffFile">area = <code class="funcname">SQRT</code>(arg1)</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei149" target="diffFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei150"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei151" target="diffFile">max2 = area</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei149" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei152"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei150" target="diffFile">max2 = <code class="constant">1.e-25_realType</code></a>
<a name="invisciddissfluxmatrixcoarsei153"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei149" target="diffFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrixcoarsei154"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei152" target="diffFile">tmp = one/max2</a>
<a name="invisciddissfluxmatrixcoarsei155"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei153" target="diffFile">sx = sx*tmp</a>
<a name="invisciddissfluxmatrixcoarsei156"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei154" target="diffFile">sy = sy*tmp</a>
<a name="invisciddissfluxmatrixcoarsei157"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei155" target="diffFile">sz = sz*tmp</a>
<a name="invisciddissfluxmatrixcoarsei158"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei156" target="diffFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrixcoarsei159"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei157" target="diffFile">havg = alphaavg + ovgm1*(a2avg-gm53*kavg)</a>
<a name="invisciddissfluxmatrixcoarsei160"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei158" target="diffFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
<a name="invisciddissfluxmatrixcoarsei161"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei159" target="diffFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
<a name="invisciddissfluxmatrixcoarsei162"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei160" target="diffFile">ovaavg = one/aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei161" target="diffFile">ova2avg = one/a2avg</a>
<a name="invisciddissfluxmatrixcoarsei163"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei162" target="diffFile"><code class="comment">! The mesh velocity if the face is moving. It must be</code></a>
<a name="invisciddissfluxmatrixcoarsei164"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei162" target="diffFile"><code class="comment">! divided by the area to obtain a true velocity.</code></a>
<a name="invisciddissfluxmatrixcoarsei166"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei162" target="diffFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei163" target="diffFile">sface = sfacej(i, j, k)*tmp</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei164" target="diffFile"><code class="keyword">IF</code> (unavg - sface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei165"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei166" target="diffFile">lam1 = unavg - sface + aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei164" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei167"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei165" target="diffFile">lam1 = -(unavg-sface+aavg)</a>
<a name="invisciddissfluxmatrixcoarsei169"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei164" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei167" target="diffFile"><code class="keyword">IF</code> (unavg - sface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei168"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei169" target="diffFile">lam2 = unavg - sface - aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei167" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei170"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei168" target="diffFile">lam2 = -(unavg-sface-aavg)</a>
<a name="invisciddissfluxmatrixcoarsei172"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei167" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei170" target="diffFile"><code class="keyword">IF</code> (unavg - sface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei171"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei172" target="diffFile">lam3 = unavg - sface</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei170" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei173"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei171" target="diffFile">lam3 = -(unavg-sface)</a>
<a name="invisciddissfluxmatrixcoarsei174"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei170" target="diffFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrixcoarsei176"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei173" target="diffFile">rrad = lam3 + aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei174" target="diffFile"><code class="keyword">IF</code> (lam1 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei175"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei176" target="diffFile">lam1 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei174" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei177"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei175" target="diffFile">lam1 = lam1</a>
<a name="invisciddissfluxmatrixcoarsei179"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei174" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei177" target="diffFile"><code class="keyword">IF</code> (lam2 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei178"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei179" target="diffFile">lam2 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei177" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei180"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei178" target="diffFile">lam2 = lam2</a>
<a name="invisciddissfluxmatrixcoarsei182"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei177" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei180" target="diffFile"><code class="keyword">IF</code> (lam3 .LT. epsshear*rrad) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei181"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei182" target="diffFile">lam3 = epsshear*rrad</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei180" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei183"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei181" target="diffFile">lam3 = lam3</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei180" target="diffFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei183" target="diffFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a name="invisciddissfluxmatrixcoarsei184"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei183" target="diffFile"><code class="comment">! the correct values for the dissipation term.</code></a>
<a name="invisciddissfluxmatrixcoarsei185"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei183" target="diffFile">lam1 = lam1*area</a>
<a name="invisciddissfluxmatrixcoarsei186"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei184" target="diffFile">lam2 = lam2*area</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei185" target="diffFile">lam3 = lam3*area</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei186" target="diffFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a name="invisciddissfluxmatrixcoarsei187"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei186" target="diffFile"><code class="comment">! dissipation terms.</code></a>
<a name="invisciddissfluxmatrixcoarsei188"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei186" target="diffFile">abv1 = half*(lam1+lam2)</a>
<a name="invisciddissfluxmatrixcoarsei189"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei187" target="diffFile">abv2 = half*(lam1-lam2)</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei188" target="diffFile">abv3 = abv1 - lam3</a>
<a name="invisciddissfluxmatrixcoarsei190"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei189" target="diffFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53<code class="label">&</code></a>
<a name="invisciddissfluxmatrixcoarsei191"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei189" target="diffFile"><code class="label">&            </code>*drk</a>
<a name="invisciddissfluxmatrixcoarsei192"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei190" target="diffFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
<a name="invisciddissfluxmatrixcoarsei193"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei191" target="diffFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei192" target="diffFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei193" target="diffFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a name="invisciddissfluxmatrixcoarsei194"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei193" target="diffFile"><code class="comment">! Density.</code></a>
<a name="invisciddissfluxmatrixcoarsei195"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei193" target="diffFile">fs = lam3*dr + abv6</a>
<a name="invisciddissfluxmatrixcoarsei196"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei194" target="diffFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei195" target="diffFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
<a name="invisciddissfluxmatrixcoarsei197"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei196" target="diffFile"><code class="comment">! X-momentum.</code></a>
<a name="invisciddissfluxmatrixcoarsei198"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei196" target="diffFile">fs = lam3*dru + uavg*abv6 + sx*abv7</a>
<a name="invisciddissfluxmatrixcoarsei199"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei197" target="diffFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei198" target="diffFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a name="invisciddissfluxmatrixcoarsei200"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei199" target="diffFile"><code class="comment">! Y-momentum.</code></a>
<a name="invisciddissfluxmatrixcoarsei201"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei199" target="diffFile">fs = lam3*drv + vavg*abv6 + sy*abv7</a>
<a name="invisciddissfluxmatrixcoarsei202"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei200" target="diffFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei201" target="diffFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a name="invisciddissfluxmatrixcoarsei203"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei202" target="diffFile"><code class="comment">! Z-momentum.</code></a>
<a name="invisciddissfluxmatrixcoarsei204"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei202" target="diffFile">fs = lam3*drw + wavg*abv6 + sz*abv7</a>
<a name="invisciddissfluxmatrixcoarsei205"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei203" target="diffFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei204" target="diffFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a name="invisciddissfluxmatrixcoarsei206"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei205" target="diffFile"><code class="comment">! Energy.</code></a>
<a name="invisciddissfluxmatrixcoarsei207"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei205" target="diffFile">fs = lam3*dre + havg*abv6 + unavg*abv7</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei206" target="diffFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei207" target="diffFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei121" target="diffFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxmatrixcoarsei208"></a>      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei120" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei119" target="diffFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei208" target="diffFile"><code class="comment">!</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei208" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei208" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei208" target="diffFile"><code class="comment">!      * Dissipative fluxes in the k-direction.                         *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei208" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei208" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a name="invisciddissfluxmatrixcoarsei209"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei208" target="diffFile"><code class="comment">!</code></a>
<a name="invisciddissfluxmatrixcoarsei210"></a>    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei208" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
<a name="invisciddissfluxmatrixcoarsei211"></a>      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei209" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei210" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="invisciddissfluxmatrixcoarsei213"></a><a name="invisciddissfluxmatrixcoarsei212"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei211" target="diffFile"><code class="comment">! Compute the dissipation coefficient for this face.</code></a>
<a name="invisciddissfluxmatrixcoarsei214"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei211" target="diffFile">ppor = zero</a>
<a name="invisciddissfluxmatrixcoarsei215"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei212" target="diffFile"><code class="keyword">IF</code> (pork(i, j, k) .EQ. normalflux) </a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei213" target="diffFile">ppor = one</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei214" target="diffFile">dis0 = fis0*ppor</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei215" target="diffFile"><code class="comment">! Construct the vector of the first differences multiplied</code></a>
<a name="invisciddissfluxmatrixcoarsei216"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei215" target="diffFile"><code class="comment">! by dis0.</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei215" target="diffFile">dr = dis0*(w(i, j, k+<code class="constant">1</code>, irho)-w(i, j, k, irho))</a>
<a name="invisciddissfluxmatrixcoarsei217"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei216" target="diffFile">dru = dis0*(w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivx)-w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei216" target="diffFile"><code class="label">&            </code>irho)*w(i, j, k, ivx))</a>
<a name="invisciddissfluxmatrixcoarsei218"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei217" target="diffFile">drv = dis0*(w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivy)-w(i, j, k, <code class="label">&</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei217" target="diffFile"><code class="label">&            </code>irho)*w(i, j, k, ivy))</a>
<a name="invisciddissfluxmatrixcoarsei219"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei218" target="diffFile">drw = dis0*(w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, ivz)-w(i, j, k, <code class="label">&</code></a>
<a name="invisciddissfluxmatrixcoarsei220"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei218" target="diffFile"><code class="label">&            </code>irho)*w(i, j, k, ivz))</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei219" target="diffFile">dre = dis0*(w(i, j, k+<code class="constant">1</code>, irhoe)-w(i, j, k, irhoe))</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei220" target="diffFile"><code class="comment">! In case a k-equation is present, compute the difference</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei220" target="diffFile"><code class="comment">! of rhok and store the average value of k. If not present,</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei220" target="diffFile"><code class="comment">! set both these values to zero, such that later on no</code></a>
<a name="invisciddissfluxmatrixcoarsei221"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei220" target="diffFile"><code class="comment">! decision needs to be made anymore.</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei220" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei222"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei221" target="diffFile">drk = dis0*(w(i, j, k+<code class="constant">1</code>, irho)*w(i, j, k+<code class="constant">1</code>, itu1)-w(i, j, k<code class="label">&</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei221" target="diffFile"><code class="label">&              </code>, irho)*w(i, j, k, itu1))</a>
<a name="invisciddissfluxmatrixcoarsei223"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei222" target="diffFile">kavg = half*(w(i, j, k+<code class="constant">1</code>, itu1)+w(i, j, k, itu1))</a>
<a name="invisciddissfluxmatrixcoarsei224"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei220" target="diffFile"><code class="keyword">ELSE</code></a>
            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei223" target="diffFile">drk = zero</a>
<a name="invisciddissfluxmatrixcoarsei225"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei224" target="diffFile">kavg = zero</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei220" target="diffFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei225" target="diffFile"><code class="comment">! Compute the average value of gamma and compute some</code></a>
<a name="invisciddissfluxmatrixcoarsei226"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei225" target="diffFile"><code class="comment">! expressions in which it occurs.</code></a>
<a name="invisciddissfluxmatrixcoarsei227"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei225" target="diffFile">gammaavg = half*(gamma(i, j, k+<code class="constant">1</code>)+gamma(i, j, k))</a>
<a name="invisciddissfluxmatrixcoarsei228"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei226" target="diffFile">gm1 = gammaavg - one</a>
<a name="invisciddissfluxmatrixcoarsei229"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei227" target="diffFile">ovgm1 = one/gm1</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei228" target="diffFile">gm53 = gammaavg - five*third</a>
<a name="invisciddissfluxmatrixcoarsei230"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei229" target="diffFile"><code class="comment">! Compute the average state at the interface.</code></a>
<a name="invisciddissfluxmatrixcoarsei231"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei229" target="diffFile">uavg = half*(w(i, j, k+<code class="constant">1</code>, ivx)+w(i, j, k, ivx))</a>
<a name="invisciddissfluxmatrixcoarsei232"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei230" target="diffFile">vavg = half*(w(i, j, k+<code class="constant">1</code>, ivy)+w(i, j, k, ivy))</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei231" target="diffFile">wavg = half*(w(i, j, k+<code class="constant">1</code>, ivz)+w(i, j, k, ivz))</a>
<a name="invisciddissfluxmatrixcoarsei233"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei232" target="diffFile">a2avg = half*(gamma(i, j, k+<code class="constant">1</code>)*p(i, j, k+<code class="constant">1</code>)/w(i, j, k+<code class="constant">1</code>, irho)<code class="label">&</code></a>
<a name="invisciddissfluxmatrixcoarsei234"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei232" target="diffFile"><code class="label">&            </code>+gamma(i, j, k)*p(i, j, k)/w(i, j, k, irho))</a>
<a name="invisciddissfluxmatrixcoarsei235"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei233" target="diffFile">sx = sk(i, j, k, <code class="constant">1</code>)</a>
<a name="invisciddissfluxmatrixcoarsei236"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei234" target="diffFile">sy = sk(i, j, k, <code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrixcoarsei237"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei235" target="diffFile">sz = sk(i, j, k, <code class="constant">3</code>)</a>
<a name="invisciddissfluxmatrixcoarsei238"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei236" target="diffFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
<a name="invisciddissfluxmatrixcoarsei240"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei237" target="diffFile">area = <code class="funcname">SQRT</code>(arg1)</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei238" target="diffFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei239"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei240" target="diffFile">max3 = area</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei238" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei241"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei239" target="diffFile">max3 = <code class="constant">1.e-25_realType</code></a>
<a name="invisciddissfluxmatrixcoarsei242"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei238" target="diffFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrixcoarsei243"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei241" target="diffFile">tmp = one/max3</a>
<a name="invisciddissfluxmatrixcoarsei244"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei242" target="diffFile">sx = sx*tmp</a>
<a name="invisciddissfluxmatrixcoarsei245"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei243" target="diffFile">sy = sy*tmp</a>
<a name="invisciddissfluxmatrixcoarsei246"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei244" target="diffFile">sz = sz*tmp</a>
<a name="invisciddissfluxmatrixcoarsei247"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei245" target="diffFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
<a name="invisciddissfluxmatrixcoarsei248"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei246" target="diffFile">havg = alphaavg + ovgm1*(a2avg-gm53*kavg)</a>
<a name="invisciddissfluxmatrixcoarsei249"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei247" target="diffFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
<a name="invisciddissfluxmatrixcoarsei250"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei248" target="diffFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
<a name="invisciddissfluxmatrixcoarsei251"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei249" target="diffFile">ovaavg = one/aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei250" target="diffFile">ova2avg = one/a2avg</a>
<a name="invisciddissfluxmatrixcoarsei252"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei251" target="diffFile"><code class="comment">! The mesh velocity if the face is moving. It must be</code></a>
<a name="invisciddissfluxmatrixcoarsei253"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei251" target="diffFile"><code class="comment">! divided by the area to obtain a true velocity.</code></a>
<a name="invisciddissfluxmatrixcoarsei255"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei251" target="diffFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei252" target="diffFile">sface = sfacek(i, j, k)*tmp</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei253" target="diffFile"><code class="keyword">IF</code> (unavg - sface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei254"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei255" target="diffFile">lam1 = unavg - sface + aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei253" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei256"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei254" target="diffFile">lam1 = -(unavg-sface+aavg)</a>
<a name="invisciddissfluxmatrixcoarsei258"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei253" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei256" target="diffFile"><code class="keyword">IF</code> (unavg - sface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei257"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei258" target="diffFile">lam2 = unavg - sface - aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei256" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei259"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei257" target="diffFile">lam2 = -(unavg-sface-aavg)</a>
<a name="invisciddissfluxmatrixcoarsei261"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei256" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei259" target="diffFile"><code class="keyword">IF</code> (unavg - sface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei260"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei261" target="diffFile">lam3 = unavg - sface</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei259" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei262"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei260" target="diffFile">lam3 = -(unavg-sface)</a>
<a name="invisciddissfluxmatrixcoarsei263"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei259" target="diffFile"><code class="keyword">END IF</code></a>
<a name="invisciddissfluxmatrixcoarsei265"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei262" target="diffFile">rrad = lam3 + aavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei263" target="diffFile"><code class="keyword">IF</code> (lam1 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei264"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei265" target="diffFile">lam1 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei263" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei266"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei264" target="diffFile">lam1 = lam1</a>
<a name="invisciddissfluxmatrixcoarsei268"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei263" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei266" target="diffFile"><code class="keyword">IF</code> (lam2 .LT. epsacoustic*rrad) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei267"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei268" target="diffFile">lam2 = epsacoustic*rrad</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei266" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei269"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei267" target="diffFile">lam2 = lam2</a>
<a name="invisciddissfluxmatrixcoarsei271"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei266" target="diffFile"><code class="keyword">END IF</code></a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei269" target="diffFile"><code class="keyword">IF</code> (lam3 .LT. epsshear*rrad) <code class="keyword">THEN</code></a>
<a name="invisciddissfluxmatrixcoarsei270"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei271" target="diffFile">lam3 = epsshear*rrad</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei269" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxmatrixcoarsei272"></a>            <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei270" target="diffFile">lam3 = lam3</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei269" target="diffFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei272" target="diffFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a name="invisciddissfluxmatrixcoarsei273"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei272" target="diffFile"><code class="comment">! the correct values for the dissipation term.</code></a>
<a name="invisciddissfluxmatrixcoarsei274"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei272" target="diffFile">lam1 = lam1*area</a>
<a name="invisciddissfluxmatrixcoarsei275"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei273" target="diffFile">lam2 = lam2*area</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei274" target="diffFile">lam3 = lam3*area</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei275" target="diffFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a name="invisciddissfluxmatrixcoarsei276"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei275" target="diffFile"><code class="comment">! dissipation terms.</code></a>
<a name="invisciddissfluxmatrixcoarsei277"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei275" target="diffFile">abv1 = half*(lam1+lam2)</a>
<a name="invisciddissfluxmatrixcoarsei278"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei276" target="diffFile">abv2 = half*(lam1-lam2)</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei277" target="diffFile">abv3 = abv1 - lam3</a>
<a name="invisciddissfluxmatrixcoarsei279"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei278" target="diffFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53<code class="label">&</code></a>
<a name="invisciddissfluxmatrixcoarsei280"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei278" target="diffFile"><code class="label">&            </code>*drk</a>
<a name="invisciddissfluxmatrixcoarsei281"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei279" target="diffFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
<a name="invisciddissfluxmatrixcoarsei282"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei280" target="diffFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei281" target="diffFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei282" target="diffFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a name="invisciddissfluxmatrixcoarsei283"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei282" target="diffFile"><code class="comment">! Density.</code></a>
<a name="invisciddissfluxmatrixcoarsei284"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei282" target="diffFile">fs = lam3*dr + abv6</a>
<a name="invisciddissfluxmatrixcoarsei285"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei283" target="diffFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei284" target="diffFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
<a name="invisciddissfluxmatrixcoarsei286"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei285" target="diffFile"><code class="comment">! X-momentum.</code></a>
<a name="invisciddissfluxmatrixcoarsei287"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei285" target="diffFile">fs = lam3*dru + uavg*abv6 + sx*abv7</a>
<a name="invisciddissfluxmatrixcoarsei288"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei286" target="diffFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei287" target="diffFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a name="invisciddissfluxmatrixcoarsei289"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei288" target="diffFile"><code class="comment">! Y-momentum.</code></a>
<a name="invisciddissfluxmatrixcoarsei290"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei288" target="diffFile">fs = lam3*drv + vavg*abv6 + sy*abv7</a>
<a name="invisciddissfluxmatrixcoarsei291"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei289" target="diffFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei290" target="diffFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a name="invisciddissfluxmatrixcoarsei292"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei291" target="diffFile"><code class="comment">! Z-momentum.</code></a>
<a name="invisciddissfluxmatrixcoarsei293"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei291" target="diffFile">fs = lam3*drw + wavg*abv6 + sz*abv7</a>
<a name="invisciddissfluxmatrixcoarsei294"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei292" target="diffFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei293" target="diffFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a name="invisciddissfluxmatrixcoarsei295"></a><a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei294" target="diffFile"><code class="comment">! Energy.</code></a>
<a name="invisciddissfluxmatrixcoarsei296"></a>          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei294" target="diffFile">fs = lam3*dre + havg*abv6 + unavg*abv7</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei295" target="diffFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) + fs</a>
          <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei296" target="diffFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
        <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei210" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei209" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei208" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarsei12" target="diffFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxmatrixcoarse.html#invisciddissfluxmatrixcoarse" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">INVISCIDDISSFLUXMATRIXCOARSE</code></a>
</pre>
</body>
