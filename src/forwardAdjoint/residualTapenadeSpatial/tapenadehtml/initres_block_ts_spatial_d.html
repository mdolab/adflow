<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="initres_block_ts_spatial_d"></a><a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!  Differentiation of initres_block_ts in forward (tangent) mode:</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!   variations   of useful results: *dw</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!   with respect to varying inputs: *dw *w_offtimeinstance</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!      * File:          initres.f90                                     *</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!      * Starting date: 03-18-2003                                      *</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!      * Last modified: 06-28-2005                                      *</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="comment">!</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">INITRES_BLOCK_TS_SPATIAL_D</code>(<code class="vardecl">varstart</code>, <code class="vardecl">varend</code>, <code class="vardecl">nn</code>, <code class="vardecl">sps</code>, <code class="vardecl">mm</code>)</a>
  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTITERATION_SPATIAL_D</code></a>
  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTTIMESPECTRAL_SPATIAL_D</code></a>
  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTUNSTEADY_SPATIAL_D</code></a>
<a name="initres_block_ts_spatial_di0"></a>  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!      * initres initializes the given range of the residual. Either to *</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!      * zero, steady computation, or to an unsteady term for the time  *</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!      * spectral and unsteady modes. For the coarser grid levels the   *</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!      * residual forcing term is taken into account.                   *</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a name="initres_block_ts_spatial_di1"></a><a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="comment">!</code></a>
  <a href="initres_block_ts_p.html#initres_block_tsi0" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">varstart</code>, <code class="vardecl">varend</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi1" target="origFile"><code class="comment">!</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi1" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="initres_block_ts_spatial_di2"></a><a href="initres_block_ts_p.html#initres_block_tsi1" target="origFile"><code class="comment">!</code></a>
  <a href="initres_block_ts_p.html#initres_block_tsi1" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">sps</code>, <code class="vardecl">nn</code>, <code class="vardecl">mm</code>, <code class="vardecl">ll</code>, <code class="vardecl">ii</code>, <code class="vardecl">jj</code>, <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">l</code>, <code class="vardecl">m</code></a>
<a name="initres_block_ts_spatial_di3"></a>  <a href="initres_block_ts_p.html#initres_block_tsi2" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">oneoverdt</code>, <code class="vardecl">tmp</code></a>
  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">tmpd</code></a>
<a name="initres_block_ts_spatial_di4"></a>  <a href="initres_block_ts_p.html#initres_block_tsi3" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">ww</code>, <code class="vardecl">wsp1</code>, <code class="vardecl">wsp</code></a>
<a name="initres_block_ts_spatial_di5"></a>  <a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, DIMENSION(:, :, :, :), <code class="modifier">POINTER </code>:: <code class="vardecl">wspd</code></a>
  <a href="initres_block_ts_p.html#initres_block_tsi4" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">volsp</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="comment">!</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="comment">!</code></a>
<a name="initres_block_ts_spatial_di6"></a><a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="comment">! Return immediately of no variables are in the range.</code></a>
  <a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="keyword">IF</code> (varend .LT. varstart) <code class="keyword">THEN</code></a>
<a name="initres_block_ts_spatial_di7"></a>    <a href="initres_block_ts_p.html#initres_block_tsi6" target="origFile"><code class="keyword">RETURN</code></a>
  <a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="keyword">ELSE</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! Determine the equation mode and act accordingly.</code></a>
<a name="initres_block_ts_spatial_di8"></a>    <a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="keyword">SELECT CASE </code> (equationmode) </a>
    <a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="keyword">CASE </code>(timespectral) </a>
<a href="initres_block_ts_p.html#initres_block_tsi8" target="origFile"><code class="comment">! Time spectral computation. The time derivative of the</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi8" target="origFile"><code class="comment">! current solution is given by a linear combination of</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi8" target="origFile"><code class="comment">! all other solutions, i.e. a matrix vector product.</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi8" target="origFile"><code class="comment">! First store the section to which this block belongs</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi8" target="origFile"><code class="comment">! in jj.</code></a>
      <a href="initres_block_ts_p.html#initres_block_tsi8" target="origFile">jj = sectionid</a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! Determine the currently active multigrid level.</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! Finest multigrid level. The residual must be</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! initialized to the time derivative.</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! Initialize it to zero.</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! Loop over the number of terms which contribute</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! to the time derivative.</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! Store the pointer for the variable to be used to</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! compute the unsteady source term and the volume.</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! Also store in ii the offset needed for vector</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">! quantities.</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">!wsp   => flowDoms(nn,currentLevel,mm)%w</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="comment">!volsp => flowDoms(nn,currentLevel,mm)%vol</code></a>
      <a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile">wspd => w_offtimeinstanced</a>
<a name="initres_block_ts_spatial_di11"></a>      <a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile">wsp => w_offtimeinstance</a>
<a name="initres_block_ts_spatial_di12"></a>      <a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile">volsp => vol_offtimeinstance</a>
      <a href="initres_block_ts_p.html#initres_block_tsi11" target="origFile">ii = <code class="constant">3</code>*(mm-<code class="constant">1</code>)</a>
<a name="initres_block_ts_spatial_di13"></a><a href="initres_block_ts_p.html#initres_block_tsi12" target="origFile"><code class="comment">! Loop over the number of variables to be set.</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi12" target="origFile"><code class="label">varloopfine:</code><code class="keyword">DO </code>l=varstart,varend</a>
<a name="initres_block_ts_spatial_di14"></a><a href="initres_block_ts_p.html#initres_block_tsi13" target="origFile"><code class="comment">! Test for a momentum variable.</code></a>
        <a href="initres_block_ts_p.html#initres_block_tsi13" target="origFile"><code class="keyword">IF</code> ((l .EQ. ivx .OR. l .EQ. ivy) .OR. l .EQ. ivz) <code class="keyword">THEN</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi14" target="origFile"><code class="comment">! Momentum variable. A special treatment is</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi14" target="origFile"><code class="comment">! needed because it is a vector and the velocities</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi14" target="origFile"><code class="comment">! are stored instead of the momentum. Set the</code></a>
<a name="initres_block_ts_spatial_di15"></a><a href="initres_block_ts_p.html#initres_block_tsi14" target="origFile"><code class="comment">! coefficient ll, which defines the row of the</code></a>
<a name="initres_block_ts_spatial_di17"></a><a name="initres_block_ts_spatial_di16"></a><a href="initres_block_ts_p.html#initres_block_tsi14" target="origFile"><code class="comment">! matrix used later on.</code></a>
<a name="initres_block_ts_spatial_di19"></a><a name="initres_block_ts_spatial_di18"></a>          <a href="initres_block_ts_p.html#initres_block_tsi14" target="origFile"><code class="keyword">IF</code> (l .EQ. ivx) </a><a href="initres_block_ts_p.html#initres_block_tsi15" target="origFile">ll = <code class="constant">3</code>*sps - <code class="constant">2</code></a>
<a name="initres_block_ts_spatial_di20"></a>          <a href="initres_block_ts_p.html#initres_block_tsi16" target="origFile"><code class="keyword">IF</code> (l .EQ. ivy) </a><a href="initres_block_ts_p.html#initres_block_tsi17" target="origFile">ll = <code class="constant">3</code>*sps - <code class="constant">1</code></a>
          <a href="initres_block_ts_p.html#initres_block_tsi18" target="origFile"><code class="keyword">IF</code> (l .EQ. ivz) </a><a href="initres_block_ts_p.html#initres_block_tsi19" target="origFile">ll = <code class="constant">3</code>*sps</a>
<a href="initres_block_ts_p.html#initres_block_tsi20" target="origFile"><code class="comment">! Loop over the owned cell centers to add the</code></a>
<a name="initres_block_ts_spatial_di21"></a><a href="initres_block_ts_p.html#initres_block_tsi20" target="origFile"><code class="comment">! contribution from wsp.</code></a>
<a name="initres_block_ts_spatial_di22"></a>          <a href="initres_block_ts_p.html#initres_block_tsi20" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="initres_block_ts_spatial_di23"></a>            <a href="initres_block_ts_p.html#initres_block_tsi21" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
              <a href="initres_block_ts_p.html#initres_block_tsi22" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="initres_block_ts_p.html#initres_block_tsi23" target="origFile"><code class="comment">! Store the matrix vector product with the</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi23" target="origFile"><code class="comment">! velocity in tmp.</code></a>
                <a href="initres_block_ts_p.html#initres_block_tsi23" target="origFile">tmpd = dvector(jj, ll, ii+<code class="constant">1</code>)*wspd(i, j, k, ivx) + <code class="label">&</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi23" target="origFile"><code class="label">&                  </code>dvector(jj, ll, ii+<code class="constant">2</code>)*wspd(i, j, k, ivy) + dvector(jj<code class="label">&</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi23" target="origFile"><code class="label">&                  </code>, ll, ii+<code class="constant">3</code>)*wspd(i, j, k, ivz)</a>
                <a href="initres_block_ts_p.html#initres_block_tsi23" target="origFile">tmp = dvector(jj, ll, ii+<code class="constant">1</code>)*wsp(i, j, k, ivx) + dvector(<code class="label">&</code></a>
<a name="initres_block_ts_spatial_di24"></a><a href="initres_block_ts_p.html#initres_block_tsi23" target="origFile"><code class="label">&                  </code>jj, ll, ii+<code class="constant">2</code>)*wsp(i, j, k, ivy) + dvector(jj, ll, ii+<code class="constant">3</code><code class="label">&</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi23" target="origFile"><code class="label">&                  </code>)*wsp(i, j, k, ivz)</a>
<a href="initres_block_ts_p.html#initres_block_tsi24" target="origFile"><code class="comment">! Update the residual. Note the</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi24" target="origFile"><code class="comment">! multiplication with the density to obtain</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi24" target="origFile"><code class="comment">! the correct time derivative for the</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi24" target="origFile"><code class="comment">! momentum variable.</code></a>
                <a href="initres_block_ts_p.html#initres_block_tsi24" target="origFile">dwd(i, j, k, l) = dwd(i, j, k, l) + volsp(i, j, k)*(tmpd<code class="label">&</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi24" target="origFile"><code class="label">&                  </code>*wsp(i, j, k, irho)+tmp*wspd(i, j, k, irho))</a>
                <a href="initres_block_ts_p.html#initres_block_tsi24" target="origFile">dw(i, j, k, l) = dw(i, j, k, l) + tmp*volsp(i, j, k)*wsp<code class="label">&</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi24" target="origFile"><code class="label">&                  </code>(i, j, k, irho)</a>
              <a href="initres_block_ts_p.html#initres_block_tsi22" target="origFile"><code class="keyword">END DO</code></a>
            <a href="initres_block_ts_p.html#initres_block_tsi21" target="origFile"><code class="keyword">END DO</code></a>
<a name="initres_block_ts_spatial_di25"></a>          <a href="initres_block_ts_p.html#initres_block_tsi20" target="origFile"><code class="keyword">END DO</code></a>
        <a href="initres_block_ts_p.html#initres_block_tsi13" target="origFile"><code class="keyword">ELSE</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi25" target="origFile"><code class="comment">! Scalar variable.  Loop over the owned cells to</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi25" target="origFile"><code class="comment">! add the contribution of wsp to the time</code></a>
<a name="initres_block_ts_spatial_di26"></a><a href="initres_block_ts_p.html#initres_block_tsi25" target="origFile"><code class="comment">! derivative.</code></a>
<a name="initres_block_ts_spatial_di27"></a>          <a href="initres_block_ts_p.html#initres_block_tsi25" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="initres_block_ts_spatial_di28"></a>            <a href="initres_block_ts_p.html#initres_block_tsi26" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
              <a href="initres_block_ts_p.html#initres_block_tsi27" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
                <a href="initres_block_ts_p.html#initres_block_tsi28" target="origFile">dwd(i, j, k, l) = dwd(i, j, k, l) + dscalar(jj, sps, mm)<code class="label">&</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi28" target="origFile"><code class="label">&                  </code>*volsp(i, j, k)*wspd(i, j, k, l)</a>
                <a href="initres_block_ts_p.html#initres_block_tsi28" target="origFile">dw(i, j, k, l) = dw(i, j, k, l) + dscalar(jj, sps, mm)*<code class="label">&</code></a>
<a href="initres_block_ts_p.html#initres_block_tsi28" target="origFile"><code class="label">&                  </code>volsp(i, j, k)*wsp(i, j, k, l)</a>
              <a href="initres_block_ts_p.html#initres_block_tsi27" target="origFile"><code class="keyword">END DO</code></a>
            <a href="initres_block_ts_p.html#initres_block_tsi26" target="origFile"><code class="keyword">END DO</code></a>
          <a href="initres_block_ts_p.html#initres_block_tsi25" target="origFile"><code class="keyword">END DO</code></a>
        <a href="initres_block_ts_p.html#initres_block_tsi13" target="origFile"><code class="keyword">END IF</code></a>
      <a href="initres_block_ts_p.html#initres_block_tsi12" target="origFile"><code class="keyword">END DO </code><code class="label">varloopfine</code></a>
    <a href="initres_block_ts_p.html#initres_block_tsi7" target="origFile"><code class="keyword">END SELECT</code></a>
  <a href="initres_block_ts_p.html#initres_block_tsi5" target="origFile"><code class="keyword">END IF</code></a>
<a href="initres_block_ts_p.html#initres_block_ts" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">INITRES_BLOCK_TS_SPATIAL_D</code></a>
</pre>
</body>
