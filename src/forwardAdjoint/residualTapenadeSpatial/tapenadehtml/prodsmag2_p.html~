<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="prodsmag2"></a><a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      * File:          prodSmag2.f90                                   *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      * Author:        Georgi Kalitzin, Edwin van der Weide            *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      * Starting date: 08-01-2003                                      *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      * Last modified: 04-12-2005                                      *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">PRODSMAG2</code>()</a>
  <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS</code></a>
  <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">USE </code><code class="funcname">TURBMOD</code></a>
  <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      * prodSmag2 computes the term:                                   *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      *        2*sij*sij - 2/3 div(u)**2 with  sij=0.5*(duidxj+dujdxi) *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      * which is used for the turbulence equations.                    *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      * It is assumed that the pointer prod, stored in turbMod, is     *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      * already set to the correct entry.                              *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      Local parameter</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
  <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">f23</code>=<code class="vardecl">two</code>*<code class="vardecl">third</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      Local variables.</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
  <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code></a>
  <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ux</code>, <code class="vardecl">uy</code>, <code class="vardecl">uz</code>, <code class="vardecl">vx</code>, <code class="vardecl">vy</code>, <code class="vardecl">vz</code>, <code class="vardecl">wx</code>, <code class="vardecl">wy</code>, <code class="vardecl">wz</code></a>
  <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">div2</code>, <code class="vardecl">fact</code>, <code class="vardecl">sxx</code>, <code class="vardecl">syy</code>, <code class="vardecl">szz</code>, <code class="vardecl">sxy</code>, <code class="vardecl">sxz</code>, <code class="vardecl">syz</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">!</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! Loop over the cell centers of the given block. It may be more</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! efficient to loop over the faces and to scatter the gradient,</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! but in that case the gradients for u, v and w must be stored.</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! In the current approach no extra memory is needed.</code></a>
  <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
    <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
      <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! Compute the gradient of u in the cell center. Use is made</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! of the fact that the surrounding normals sum up to zero,</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! such that the cell i,j,k does not give a contribution.</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! The gradient is scaled by the factor 2*vol.</code></a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">ux = w(i+<code class="constant">1</code>, j, k, ivx)*si(i, j, k, <code class="constant">1</code>) - w(i-<code class="constant">1</code>, j, k, ivx)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">1</code>) + w(i, j+<code class="constant">1</code>, k, ivx)*sj(i, j, k, <code class="constant">1</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>ivx)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">1</code>) + w(i, j, k+<code class="constant">1</code>, ivx)*sk(i, j, k, <code class="constant">1</code>) - w(i<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivx)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">1</code>)</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">uy = w(i+<code class="constant">1</code>, j, k, ivx)*si(i, j, k, <code class="constant">2</code>) - w(i-<code class="constant">1</code>, j, k, ivx)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">2</code>) + w(i, j+<code class="constant">1</code>, k, ivx)*sj(i, j, k, <code class="constant">2</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>ivx)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">2</code>) + w(i, j, k+<code class="constant">1</code>, ivx)*sk(i, j, k, <code class="constant">2</code>) - w(i<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivx)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">2</code>)</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">uz = w(i+<code class="constant">1</code>, j, k, ivx)*si(i, j, k, <code class="constant">3</code>) - w(i-<code class="constant">1</code>, j, k, ivx)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">3</code>) + w(i, j+<code class="constant">1</code>, k, ivx)*sj(i, j, k, <code class="constant">3</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>ivx)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">3</code>) + w(i, j, k+<code class="constant">1</code>, ivx)*sk(i, j, k, <code class="constant">3</code>) - w(i<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivx)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">3</code>)</a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! Idem for the gradient of v.</code></a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">vx = w(i+<code class="constant">1</code>, j, k, ivy)*si(i, j, k, <code class="constant">1</code>) - w(i-<code class="constant">1</code>, j, k, ivy)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">1</code>) + w(i, j+<code class="constant">1</code>, k, ivy)*sj(i, j, k, <code class="constant">1</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>ivy)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">1</code>) + w(i, j, k+<code class="constant">1</code>, ivy)*sk(i, j, k, <code class="constant">1</code>) - w(i<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivy)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">1</code>)</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">vy = w(i+<code class="constant">1</code>, j, k, ivy)*si(i, j, k, <code class="constant">2</code>) - w(i-<code class="constant">1</code>, j, k, ivy)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">2</code>) + w(i, j+<code class="constant">1</code>, k, ivy)*sj(i, j, k, <code class="constant">2</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>ivy)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">2</code>) + w(i, j, k+<code class="constant">1</code>, ivy)*sk(i, j, k, <code class="constant">2</code>) - w(i<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivy)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">2</code>)</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">vz = w(i+<code class="constant">1</code>, j, k, ivy)*si(i, j, k, <code class="constant">3</code>) - w(i-<code class="constant">1</code>, j, k, ivy)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">3</code>) + w(i, j+<code class="constant">1</code>, k, ivy)*sj(i, j, k, <code class="constant">3</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>ivy)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">3</code>) + w(i, j, k+<code class="constant">1</code>, ivy)*sk(i, j, k, <code class="constant">3</code>) - w(i<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivy)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">3</code>)</a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! And for the gradient of w.</code></a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">wx = w(i+<code class="constant">1</code>, j, k, ivz)*si(i, j, k, <code class="constant">1</code>) - w(i-<code class="constant">1</code>, j, k, ivz)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">1</code>) + w(i, j+<code class="constant">1</code>, k, ivz)*sj(i, j, k, <code class="constant">1</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>ivz)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">1</code>) + w(i, j, k+<code class="constant">1</code>, ivz)*sk(i, j, k, <code class="constant">1</code>) - w(i<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivz)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">1</code>)</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">wy = w(i+<code class="constant">1</code>, j, k, ivz)*si(i, j, k, <code class="constant">2</code>) - w(i-<code class="constant">1</code>, j, k, ivz)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">2</code>) + w(i, j+<code class="constant">1</code>, k, ivz)*sj(i, j, k, <code class="constant">2</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>ivz)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">2</code>) + w(i, j, k+<code class="constant">1</code>, ivz)*sk(i, j, k, <code class="constant">2</code>) - w(i<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivz)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">2</code>)</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">wz = w(i+<code class="constant">1</code>, j, k, ivz)*si(i, j, k, <code class="constant">3</code>) - w(i-<code class="constant">1</code>, j, k, ivz)*si(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k, <code class="constant">3</code>) + w(i, j+<code class="constant">1</code>, k, ivz)*sj(i, j, k, <code class="constant">3</code>) - w(i, j-<code class="constant">1</code>, k, <code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>ivz)*sj(i, j-<code class="constant">1</code>, k, <code class="constant">3</code>) + w(i, j, k+<code class="constant">1</code>, ivz)*sk(i, j, k, <code class="constant">3</code>) - w(i<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>, j, k-<code class="constant">1</code>, ivz)*sk(i, j, k-<code class="constant">1</code>, <code class="constant">3</code>)</a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! Compute the components of the stress tensor.</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! The combination of the current scaling of the velocity</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! gradients (2*vol) and the definition of the stress tensor,</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! leads to the factor 1/(4*vol).</code></a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">fact = fourth/vol(i, j, k)</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">sxx = two*fact*ux</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">syy = two*fact*vy</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">szz = two*fact*wz</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">sxy = fact*(uy+vx)</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">sxz = fact*(uz+wx)</a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">syz = fact*(vz+wy)</a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! Compute 2/3 * divergence of velocity squared</code></a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">div2 = f23*(sxx+syy+szz)**<code class="constant">2</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="comment">! Store the square of strain as the production term.</code></a>
        <a href="prodsmag2.html#prodsmag2" target="diffFile">prod(i, j, k) = two*(two*(sxy**<code class="constant">2</code>+sxz**<code class="constant">2</code>+syz**<code class="constant">2</code>)+sxx**<code class="constant">2</code>+syy**<code class="constant">2</code>+<code class="label">&</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="label">&          </code>szz**<code class="constant">2</code>) - div2</a>
      <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">END DO</code></a>
<a href="prodsmag2.html#prodsmag2" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">PRODSMAG2</code></a>
</pre>
</body>
