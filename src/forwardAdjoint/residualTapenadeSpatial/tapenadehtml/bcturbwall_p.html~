<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="bcturbwall"></a><a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * File:          bcTurbWall.F90                                  *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * Author:        Georgi Kalitzin, Edwin van der Weide            *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * Starting date: 06-26-2003                                      *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * Last modified: 06-12-2005                                      *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">BCTURBWALL</code>(<code class="vardecl">nn</code>)</a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">USE </code><code class="funcname">BCTYPES</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">USE </code><code class="funcname">PARAMTURB</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * bcTurbWall applies the implicit treatment of the viscous       *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * wall boundary condition for the turbulence model used to the   *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * given subface nn.                                              *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * It is assumed that the pointers in blockPointers are           *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * already set to the correct block.                              *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      Subroutine arguments.</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">nn</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      Local variables.</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">ii</code>, <code class="vardecl">jj</code>, <code class="vardecl">iimax</code>, <code class="vardecl">jjmax</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">tmpd</code>, <code class="vardecl">tmpe</code>, <code class="vardecl">tmpf</code>, <code class="vardecl">nu</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">bmt</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">bvt</code>, <code class="vardecl">ww2</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rlv2</code>, <code class="vardecl">dd2wall</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs1</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">REAL(</code><code class="modifier">intType</code><code class="typename">) </code>:: <code class="vardecl">y4</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">REAL(</code><code class="modifier">intType</code><code class="typename">) </code>:: <code class="vardecl">y3</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">REAL(</code><code class="modifier">intType</code><code class="typename">) </code>:: <code class="vardecl">y2</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="typename">REAL(</code><code class="modifier">intType</code><code class="typename">) </code>:: <code class="vardecl">y1</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! Set some variables depending on the block face on which the</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! subface is located. Needed for a general treatment.</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">SELECT CASE </code> (bcfaceid(nn)) </a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(imin) </a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">iimax = jl</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">jjmax = kl</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt => bmti1</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bvt => bvti1</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">ww2 => w(<code class="constant">2</code>, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">rlv2 => rlv(<code class="constant">2</code>, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">dd2wall => d2wall(<code class="constant">2</code>, :, :)</a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(imax) </a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">iimax = jl</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">jjmax = kl</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt => bmti2</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bvt => bvti2</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">ww2 => w(il, <code class="constant">1</code>:, <code class="constant">1</code>:, :)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">rlv2 => rlv(il, <code class="constant">1</code>:, <code class="constant">1</code>:)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">dd2wall => d2wall(il, :, :)</a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(jmin) </a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">iimax = il</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">jjmax = kl</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt => bmtj1</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bvt => bvtj1</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">ww2 => w(<code class="constant">1</code>:, <code class="constant">2</code>, <code class="constant">1</code>:, :)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">rlv2 => rlv(<code class="constant">1</code>:, <code class="constant">2</code>, <code class="constant">1</code>:)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">dd2wall => d2wall(:, <code class="constant">2</code>, :)</a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(jmax) </a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">iimax = il</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">jjmax = kl</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt => bmtj2</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bvt => bvtj2</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">ww2 => w(<code class="constant">1</code>:, jl, <code class="constant">1</code>:, :)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">rlv2 => rlv(<code class="constant">1</code>:, jl, <code class="constant">1</code>:)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">dd2wall => d2wall(:, jl, :)</a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(kmin) </a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">iimax = il</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">jjmax = jl</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt => bmtk1</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bvt => bvtk1</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">ww2 => w(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">2</code>, :)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">rlv2 => rlv(<code class="constant">1</code>:, <code class="constant">1</code>:, <code class="constant">2</code>)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">dd2wall => d2wall(:, :, <code class="constant">2</code>)</a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(kmax) </a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">iimax = il</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">jjmax = jl</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt => bmtk2</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">bvt => bvtk2</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">ww2 => w(<code class="constant">1</code>:, <code class="constant">1</code>:, kl, :)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">rlv2 => rlv(<code class="constant">1</code>:, <code class="constant">1</code>:, kl)</a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile">dd2wall => d2wall(:, :, kl)</a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END SELECT</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! Determine the turbulence model used and loop over the faces</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! of the subface and set the values of bmt and bvt for an</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! implicit treatment.</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">SELECT CASE </code> (turbmodel) </a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(spalartallmaras, spalartallmarasedwards) </a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! Spalart-allmaras type of model. Value at the wall is zero,</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! so simply negate the internal value.</code></a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu1, itu1) = one</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(komegawilcox, komegamodified, mentersst) </a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!        ================================================================</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! K-omega type of models. K is zero on the wall and thus the</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! halo value is the negative of the first internal cell.</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! For omega the situation is a bit more complicated.</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! Theoretically omega is infinity, but it is set to a large</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! value, see menter's paper. The halo value is constructed</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! such that the wall value is correct. Make sure that i and j</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! are limited to physical dimensions of the face for the wall</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! distance. Due to the usage of the dd2Wall pointer and the</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! fact that the original d2Wall array starts at 2, there is</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! an offset of -1 present in dd2Wall.</code></a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (j .GT. jjmax) <code class="keyword">THEN</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">y1 = jjmax</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">y1 = j</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (<code class="constant">2_intType </code>.LT. y1) <code class="keyword">THEN</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">jj = y1</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">jj = <code class="constant">2_intType</code></a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (i .GT. iimax) <code class="keyword">THEN</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">y2 = iimax</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">y2 = i</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (<code class="constant">2_intType </code>.LT. y2) <code class="keyword">THEN</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">ii = y2</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">ii = <code class="constant">2_intType</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">nu = rlv2(i, j)/ww2(i, j, irho)</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">tmpd = one/(rkwbeta1*dd2wall(ii-<code class="constant">1</code>, jj-<code class="constant">1</code>)**<code class="constant">2</code>)</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu1, itu1) = one</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu2, itu2) = one</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bvt(i, j, itu2) = two*<code class="constant">60.0_realType</code>*nu*tmpd</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(ktau) </a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!        ================================================================</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! K-tau model. Both k and tau are zero at the wall, so the</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! negative value of the internal cell is taken for the halo.</code></a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu1, itu1) = one</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu2, itu2) = one</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE </code>(v2f) </a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">!        ================================================================</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! V2f turbulence model. Same story for the wall distance as</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! for k-omega. For this model there is a coupling between the</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="comment">! equations via the boundary conditions.</code></a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">DO </code>j=bcdata(nn)%jcbeg,bcdata(nn)%jcend</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (j .GT. jjmax) <code class="keyword">THEN</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">y3 = jjmax</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">y3 = j</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (<code class="constant">2_intType </code>.LT. y3) <code class="keyword">THEN</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">jj = y3</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">jj = <code class="constant">2_intType</code></a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">DO </code>i=bcdata(nn)%icbeg,bcdata(nn)%icend</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (i .GT. iimax) <code class="keyword">THEN</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">y4 = iimax</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">y4 = i</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (<code class="constant">2_intType </code>.LT. y4) <code class="keyword">THEN</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">ii = y4</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">ii = <code class="constant">2_intType</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">nu = rlv2(i, j)/ww2(i, j, irho)</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">tmpd = one/dd2wall(ii-<code class="constant">1</code>, jj-<code class="constant">1</code>)**<code class="constant">2</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">tmpe = two*nu*tmpd</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (tmpe*ww2(i, j, itu1) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">abs1 = tmpe*ww2(i, j, itu1)</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="bcturbwall.html#bcturbwall" target="diffFile">abs1 = -(tmpe*ww2(i, j, itu1))</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">tmpf = -(<code class="constant">20.0_realType</code>*(nu*tmpd)**<code class="constant">2</code>/abs1)</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">IF</code> (rvfn .EQ. <code class="constant">6</code>) tmpf = zero</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu1, itu1) = one</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu2, itu2) = one</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu3, itu3) = one</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu4, itu4) = one</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu2, itu1) = -(two*tmpe)</a>
        <a href="bcturbwall.html#bcturbwall" target="diffFile">bmt(i, j, itu4, itu3) = -(two*tmpf)</a>
      <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CASE DEFAULT</code></a>
    <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE</code>(<code class="string">'bcTurbWall'</code>, <code class="string">'Turbulence model not implemented yet'</code>)</a>
  <a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END SELECT</code></a>
<a href="bcturbwall.html#bcturbwall" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">BCTURBWALL</code></a>
</pre>
</body>
