<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="inviscidupwindflux"></a><a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!      * File:          inviscidUpwindFlux.f90                          *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!      * Starting date: 03-25-2003                                      *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!      * Last modified: 10-29-2007                                      *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">INVISCIDUPWINDFLUX</code>(<code class="vardecl">finegrid</code>)</a>
  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">USE </code><code class="funcname">INPUTDISCRETIZATION</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">USE </code><code class="funcname">CGNSGRID</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE</code></a>
<a name="inviscidupwindfluxi0"></a>  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">USE </code><code class="funcname">ITERATION</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      * inviscidUpwindFlux computes the artificial dissipation part of *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      * the Euler fluxes by means of an approximate solution of the 1D *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      * Riemann problem on the face. For first order schemes,          *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      * fineGrid == .false., the states in the cells are assumed to    *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      * be constant; for the second order schemes on the fine grid a   *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      * nonlinear reconstruction of the left and right state is done   *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      * for which several options exist.                               *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      * It is assumed that the pointers in blockPointers already       *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      * point to the correct block.                                    *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!      Subroutine arguments.</code></a>
<a name="inviscidupwindfluxi1"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="comment">!</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindfluxi0" target="diffFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">finegrid</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi1" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi1" target="diffFile"><code class="comment">!      Local variables.</code></a>
<a name="inviscidupwindfluxi2"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi1" target="diffFile"><code class="comment">!</code></a>
<a name="inviscidupwindfluxi3"></a>  <a href="inviscidupwindflux.html#inviscidupwindfluxi1" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">portype</code><code class="typename">) </code>:: <code class="vardecl">por</code></a>
<a name="inviscidupwindfluxi4"></a>  <a href="inviscidupwindflux.html#inviscidupwindfluxi2" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">nwint</code></a>
<a name="inviscidupwindfluxi5"></a>  <a href="inviscidupwindflux.html#inviscidupwindfluxi3" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code>, <code class="vardecl">ind</code></a>
<a name="inviscidupwindfluxi6"></a>  <a href="inviscidupwindflux.html#inviscidupwindfluxi4" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">limused</code>, <code class="vardecl">riemannused</code></a>
<a name="inviscidupwindfluxi7"></a>  <a href="inviscidupwindflux.html#inviscidupwindfluxi5" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sx</code>, <code class="vardecl">sy</code>, <code class="vardecl">sz</code>, <code class="vardecl">omk</code>, <code class="vardecl">opk</code>, <code class="vardecl">sfil</code>, <code class="vardecl">gammaface</code></a>
<a name="inviscidupwindfluxi8"></a>  <a href="inviscidupwindflux.html#inviscidupwindfluxi6" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">factminmod</code>, <code class="vardecl">sface</code></a>
<a name="inviscidupwindfluxi9"></a>  <a href="inviscidupwindflux.html#inviscidupwindfluxi7" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>nw<code class="typename">) </code>:: <code class="vardecl">left</code>, <code class="vardecl">right</code></a>
<a name="inviscidupwindfluxi10"></a>  <a href="inviscidupwindflux.html#inviscidupwindfluxi8" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>nw<code class="typename">) </code>:: <code class="vardecl">du1</code>, <code class="vardecl">du2</code>, <code class="vardecl">du3</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindfluxi9" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>nwf<code class="typename">) </code>:: <code class="vardecl">flux</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindfluxi10" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">firstorderk</code>, <code class="vardecl">correctfork</code>, <code class="vardecl">rotationalperiodic</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
<a name="inviscidupwindfluxi11"></a>  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ASSOCIATED</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max1</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="comment">!</code></a>
<a name="p14"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="comment">! Check if rFil == 0. If so, the dissipative flux needs not to</code></a>
<a name="inviscidupwindfluxi12"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="comment">! be computed.</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p14" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile">rfil .EQ. zero) <code class="keyword">THEN</code></a>
<a name="inviscidupwindfluxi13"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi12" target="diffFile"><code class="keyword">RETURN</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi13" target="diffFile"><code class="comment">! Check if the formulation for rotational periodic problems</code></a>
<a name="inviscidupwindfluxi14"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi13" target="diffFile"><code class="comment">! must be used.</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi13" target="diffFile"><code class="keyword">IF</code> (<code class="funcname">ASSOCIATED</code>(rotmatrixi)) <code class="keyword">THEN</code></a>
<a name="inviscidupwindfluxi15"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi14" target="diffFile">rotationalperiodic = <code class="constant">.true.</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi13" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="inviscidupwindfluxi16"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi15" target="diffFile">rotationalperiodic = <code class="constant">.false.</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi13" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi16" target="diffFile"><code class="comment">! Initialize the dissipative residual to a certain times,</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi16" target="diffFile"><code class="comment">! possibly zero, the previously stored value. Owned cells</code></a>
<a name="inviscidupwindfluxi17"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi16" target="diffFile"><code class="comment">! only, because the halo values do not matter.</code></a>
<a name="inviscidupwindfluxi18"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi16" target="diffFile">sfil = one - rfil</a>
<a name="inviscidupwindfluxi19"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi17" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindfluxi20"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi18" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
<a name="inviscidupwindfluxi21"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi19" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="inviscidupwindfluxi22"></a>          <a href="inviscidupwindflux.html#inviscidupwindfluxi20" target="diffFile">fw(i, j, k, irho) = sfil*fw(i, j, k, irho)</a>
<a name="inviscidupwindfluxi23"></a>          <a href="inviscidupwindflux.html#inviscidupwindfluxi21" target="diffFile">fw(i, j, k, imx) = sfil*fw(i, j, k, imx)</a>
<a name="inviscidupwindfluxi24"></a>          <a href="inviscidupwindflux.html#inviscidupwindfluxi22" target="diffFile">fw(i, j, k, imy) = sfil*fw(i, j, k, imy)</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi23" target="diffFile">fw(i, j, k, imz) = sfil*fw(i, j, k, imz)</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi24" target="diffFile">fw(i, j, k, irhoe) = sfil*fw(i, j, k, irhoe)</a>
        <a href="inviscidupwindflux.html#inviscidupwindfluxi19" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi25"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi18" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi17" target="diffFile"><code class="keyword">END DO</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi25" target="diffFile"><code class="comment">! Determine whether or not the total energy must be corrected</code></a>
<a name="inviscidupwindfluxi26"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi25" target="diffFile"><code class="comment">! for the presence of the turbulent kinetic energy.</code></a>
<a name="inviscidupwindfluxi27"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi25" target="diffFile"><code class="keyword">IF</code> (kpresent) <code class="keyword">THEN</code></a>
      <a href="inviscidupwindflux.html#inviscidupwindfluxi26" target="diffFile"><code class="keyword">IF</code> (currentlevel .EQ. groundlevel .OR. turbcoupled) <code class="keyword">THEN</code></a>
<a name="inviscidupwindfluxi28"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi27" target="diffFile">correctfork = <code class="constant">.true.</code></a>
      <a href="inviscidupwindflux.html#inviscidupwindfluxi26" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="inviscidupwindflux.html#inviscidupwindfluxi28" target="diffFile">correctfork = <code class="constant">.false.</code></a>
<a name="inviscidupwindfluxi29"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi26" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi25" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="inviscidupwindfluxi30"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi29" target="diffFile">correctfork = <code class="constant">.false.</code></a>
<a name="inviscidupwindfluxi32"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi25" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi30" target="diffFile"><code class="keyword">IF</code> (<code class="constant">1.e-10_realType </code>.LT. one - kappacoef) <code class="keyword">THEN</code></a>
<a name="inviscidupwindfluxi31"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi32" target="diffFile">max1 = one - kappacoef</a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi30" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="inviscidupwindfluxi33"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi31" target="diffFile">max1 = <code class="constant">1.e-10_realType</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi30" target="diffFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindfluxi34"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi33" target="diffFile"><code class="comment">! Compute the factor used in the minmod limiter.</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi33" target="diffFile">factminmod = (three-kappacoef)/max1</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi34" target="diffFile"><code class="comment">! Determine the limiter scheme to be used. On the fine grid the</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi34" target="diffFile"><code class="comment">! user specified scheme is used; on the coarse grid a first order</code></a>
<a name="inviscidupwindfluxi36"></a><a name="inviscidupwindfluxi35"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi34" target="diffFile"><code class="comment">! scheme is computed.</code></a>
<a name="inviscidupwindfluxi37"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi34" target="diffFile">limused = firstorder</a>
<a name="inviscidupwindfluxi38"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi35" target="diffFile"><code class="keyword">IF</code> (finegrid) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi36" target="diffFile">limused = limiter</a>
<a name="inviscidupwindfluxi39"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi37" target="diffFile"><code class="comment">! Lumped diss is true for doing approx PC</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi37" target="diffFile"><code class="keyword">IF</code> (lumpeddiss) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi38" target="diffFile">limused = firstorder</a>
<a name="inviscidupwindfluxi41"></a><a name="inviscidupwindfluxi40"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi39" target="diffFile"><code class="comment">! Determine the riemann solver which must be used.</code></a>
<a name="inviscidupwindfluxi42"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi39" target="diffFile">riemannused = riemanncoarse</a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi40" target="diffFile"><code class="keyword">IF</code> (finegrid) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi41" target="diffFile">riemannused = riemann</a>
<a name="inviscidupwindfluxi43"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi42" target="diffFile"><code class="comment">! Store 1-kappa and 1+kappa a bit easier and multiply it by 0.25.</code></a>
<a name="inviscidupwindfluxi44"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi42" target="diffFile">omk = fourth*(one-kappacoef)</a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi43" target="diffFile">opk = fourth*(one+kappacoef)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi44" target="diffFile"><code class="comment">! Initialize sFace to zero. This value will be used if the</code></a>
<a name="inviscidupwindfluxi45"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi44" target="diffFile"><code class="comment">! block is not moving.</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi44" target="diffFile">sface = zero</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi45" target="diffFile"><code class="comment">! Set the number of variables to be interpolated depending</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi45" target="diffFile"><code class="comment">! whether or not a k-equation is present. If a k-equation is</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi45" target="diffFile"><code class="comment">! present also set the logical firstOrderK. This indicates</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi45" target="diffFile"><code class="comment">! whether or not only a first order approximation is to be used</code></a>
<a name="inviscidupwindfluxi46"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi45" target="diffFile"><code class="comment">! for the turbulent kinetic energy.</code></a>
<a name="inviscidupwindfluxi47"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi45" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindfluxi48"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi46" target="diffFile"><code class="keyword">IF</code> (orderturb .EQ. firstorder) <code class="keyword">THEN</code></a>
        <a href="inviscidupwindflux.html#inviscidupwindfluxi47" target="diffFile">nwint = nwf</a>
<a name="inviscidupwindfluxi49"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi48" target="diffFile">firstorderk = <code class="constant">.true.</code></a>
<a name="inviscidupwindfluxi50"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi46" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="inviscidupwindflux.html#inviscidupwindfluxi49" target="diffFile">nwint = itu1</a>
        <a href="inviscidupwindflux.html#inviscidupwindfluxi50" target="diffFile">firstorderk = <code class="constant">.false.</code></a>
<a name="inviscidupwindfluxi51"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi46" target="diffFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindfluxi52"></a>    <a href="inviscidupwindflux.html#inviscidupwindfluxi45" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="inviscidupwindflux.html#inviscidupwindfluxi51" target="diffFile">nwint = nwf</a>
<a name="inviscidupwindfluxi53"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi52" target="diffFile">firstorderk = <code class="constant">.false.</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi45" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="comment">!      * Flux computation. A distinction is made between first and      *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="comment">!      * second order schemes to avoid the overhead for the first order *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="comment">!      * scheme.                                                        *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="comment">!      *                                                                *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="comment">!      ******************************************************************</code></a>
<a name="inviscidupwindfluxi54"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="keyword">IF</code> (limused .EQ. firstorder) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="comment">!        * First order reconstruction. The states in the cells are      *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="comment">!        * constant. The left and right states are constructed easily.  *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="comment">!</code></a>
<a name="inviscidupwindfluxi55"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="comment">! Fluxes in the i-direction.</code></a>
<a name="inviscidupwindfluxi56"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindfluxi57"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi55" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi56" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi57" target="diffFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindfluxi58"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi57" target="diffFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindfluxi59"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi57" target="diffFile">sx = si(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindfluxi60"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi58" target="diffFile">sy = si(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindfluxi62"></a><a name="inviscidupwindfluxi61"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi59" target="diffFile">sz = si(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindfluxi63"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi60" target="diffFile">por = pori(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi61" target="diffFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi62" target="diffFile">sface = sfacei(i, j, k)</a>
<a name="inviscidupwindfluxi64"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi63" target="diffFile"><code class="comment">! Determine the left and right state.</code></a>
<a name="inviscidupwindfluxi65"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi63" target="diffFile">left(irho) = w(i, j, k, irho)</a>
<a name="inviscidupwindfluxi66"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi64" target="diffFile">left(ivx) = w(i, j, k, ivx)</a>
<a name="inviscidupwindfluxi67"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi65" target="diffFile">left(ivy) = w(i, j, k, ivy)</a>
<a name="inviscidupwindfluxi69"></a><a name="inviscidupwindfluxi68"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi66" target="diffFile">left(ivz) = w(i, j, k, ivz)</a>
<a name="inviscidupwindfluxi70"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi67" target="diffFile">left(irhoe) = p(i, j, k)</a>
<a name="inviscidupwindfluxi71"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi68" target="diffFile"><code class="keyword">IF</code> (correctfork) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi69" target="diffFile">left(itu1) = w(i, j, k, itu1)</a>
<a name="inviscidupwindfluxi72"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi70" target="diffFile">right(irho) = w(i+<code class="constant">1</code>, j, k, irho)</a>
<a name="inviscidupwindfluxi73"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi71" target="diffFile">right(ivx) = w(i+<code class="constant">1</code>, j, k, ivx)</a>
<a name="inviscidupwindfluxi74"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi72" target="diffFile">right(ivy) = w(i+<code class="constant">1</code>, j, k, ivy)</a>
<a name="inviscidupwindfluxi76"></a><a name="inviscidupwindfluxi75"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi73" target="diffFile">right(ivz) = w(i+<code class="constant">1</code>, j, k, ivz)</a>
<a name="inviscidupwindfluxi77"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi74" target="diffFile">right(irhoe) = p(i+<code class="constant">1</code>, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi75" target="diffFile"><code class="keyword">IF</code> (correctfork) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi76" target="diffFile">right(itu1) = w(i+<code class="constant">1</code>, j, k, itu1)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi77" target="diffFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindfluxi78"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi77" target="diffFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi77" target="diffFile">gammaface = half*(gamma(i, j, k)+gamma(i+<code class="constant">1</code>, j, k))</a>
<a name="inviscidupwindfluxi79"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi78" target="diffFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi78" target="diffFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a name="inviscidupwindfluxi80"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi79" target="diffFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindfluxi81"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi79" target="diffFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindfluxi82"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi80" target="diffFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindfluxi83"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi81" target="diffFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindfluxi84"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi82" target="diffFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindfluxi85"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi83" target="diffFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindfluxi86"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi84" target="diffFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) - flux(irho)</a>
<a name="inviscidupwindfluxi87"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi85" target="diffFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) - flux(imx)</a>
<a name="inviscidupwindfluxi88"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi86" target="diffFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) - flux(imy)</a>
<a name="inviscidupwindfluxi89"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi87" target="diffFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) - flux(imz)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi88" target="diffFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi89" target="diffFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindfluxi90"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi89" target="diffFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi89" target="diffFile">ind = indfamilyi(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi90" target="diffFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi90" target="diffFile"><code class="label">&              </code>ind, spectralsol) + factfamilyi(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi56" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi91"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi55" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux.html#inviscidupwindfluxi54" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi92"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi91" target="diffFile"><code class="comment">! Fluxes in j-direction.</code></a>
<a name="inviscidupwindfluxi93"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi91" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindfluxi94"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi92" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi93" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi94" target="diffFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindfluxi95"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi94" target="diffFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindfluxi96"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi94" target="diffFile">sx = sj(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindfluxi97"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi95" target="diffFile">sy = sj(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindfluxi99"></a><a name="inviscidupwindfluxi98"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi96" target="diffFile">sz = sj(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindfluxi100"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi97" target="diffFile">por = porj(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi98" target="diffFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi99" target="diffFile">sface = sfacej(i, j, k)</a>
<a name="inviscidupwindfluxi101"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi100" target="diffFile"><code class="comment">! Determine the left and right state.</code></a>
<a name="inviscidupwindfluxi102"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi100" target="diffFile">left(irho) = w(i, j, k, irho)</a>
<a name="inviscidupwindfluxi103"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi101" target="diffFile">left(ivx) = w(i, j, k, ivx)</a>
<a name="inviscidupwindfluxi104"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi102" target="diffFile">left(ivy) = w(i, j, k, ivy)</a>
<a name="inviscidupwindfluxi106"></a><a name="inviscidupwindfluxi105"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi103" target="diffFile">left(ivz) = w(i, j, k, ivz)</a>
<a name="inviscidupwindfluxi107"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi104" target="diffFile">left(irhoe) = p(i, j, k)</a>
<a name="inviscidupwindfluxi108"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi105" target="diffFile"><code class="keyword">IF</code> (correctfork) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi106" target="diffFile">left(itu1) = w(i, j, k, itu1)</a>
<a name="inviscidupwindfluxi109"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi107" target="diffFile">right(irho) = w(i, j+<code class="constant">1</code>, k, irho)</a>
<a name="inviscidupwindfluxi110"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi108" target="diffFile">right(ivx) = w(i, j+<code class="constant">1</code>, k, ivx)</a>
<a name="inviscidupwindfluxi111"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi109" target="diffFile">right(ivy) = w(i, j+<code class="constant">1</code>, k, ivy)</a>
<a name="inviscidupwindfluxi113"></a><a name="inviscidupwindfluxi112"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi110" target="diffFile">right(ivz) = w(i, j+<code class="constant">1</code>, k, ivz)</a>
<a name="inviscidupwindfluxi114"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi111" target="diffFile">right(irhoe) = p(i, j+<code class="constant">1</code>, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi112" target="diffFile"><code class="keyword">IF</code> (correctfork) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi113" target="diffFile">right(itu1) = w(i, j+<code class="constant">1</code>, k, itu1)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi114" target="diffFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindfluxi115"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi114" target="diffFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi114" target="diffFile">gammaface = half*(gamma(i, j, k)+gamma(i, j+<code class="constant">1</code>, k))</a>
<a name="inviscidupwindfluxi116"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi115" target="diffFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi115" target="diffFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a name="inviscidupwindfluxi117"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi116" target="diffFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindfluxi118"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi116" target="diffFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindfluxi119"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi117" target="diffFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindfluxi120"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi118" target="diffFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindfluxi121"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi119" target="diffFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindfluxi122"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi120" target="diffFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindfluxi123"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi121" target="diffFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) - flux(irho)</a>
<a name="inviscidupwindfluxi124"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi122" target="diffFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) - flux(imx)</a>
<a name="inviscidupwindfluxi125"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi123" target="diffFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) - flux(imy)</a>
<a name="inviscidupwindfluxi126"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi124" target="diffFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) - flux(imz)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi125" target="diffFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi126" target="diffFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindfluxi127"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi126" target="diffFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi126" target="diffFile">ind = indfamilyj(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi127" target="diffFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi127" target="diffFile"><code class="label">&              </code>ind, spectralsol) + factfamilyj(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi93" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi128"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi92" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux.html#inviscidupwindfluxi91" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi129"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi128" target="diffFile"><code class="comment">! Fluxes in k-direction.</code></a>
<a name="inviscidupwindfluxi130"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi128" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
<a name="inviscidupwindfluxi131"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi129" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi130" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi131" target="diffFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindfluxi132"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi131" target="diffFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindfluxi133"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi131" target="diffFile">sx = sk(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindfluxi134"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi132" target="diffFile">sy = sk(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindfluxi136"></a><a name="inviscidupwindfluxi135"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi133" target="diffFile">sz = sk(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindfluxi137"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi134" target="diffFile">por = pork(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi135" target="diffFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi136" target="diffFile">sface = sfacek(i, j, k)</a>
<a name="inviscidupwindfluxi138"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi137" target="diffFile"><code class="comment">! Determine the left and right state.</code></a>
<a name="inviscidupwindfluxi139"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi137" target="diffFile">left(irho) = w(i, j, k, irho)</a>
<a name="inviscidupwindfluxi140"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi138" target="diffFile">left(ivx) = w(i, j, k, ivx)</a>
<a name="inviscidupwindfluxi141"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi139" target="diffFile">left(ivy) = w(i, j, k, ivy)</a>
<a name="inviscidupwindfluxi143"></a><a name="inviscidupwindfluxi142"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi140" target="diffFile">left(ivz) = w(i, j, k, ivz)</a>
<a name="inviscidupwindfluxi144"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi141" target="diffFile">left(irhoe) = p(i, j, k)</a>
<a name="inviscidupwindfluxi145"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi142" target="diffFile"><code class="keyword">IF</code> (correctfork) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi143" target="diffFile">left(itu1) = w(i, j, k, itu1)</a>
<a name="inviscidupwindfluxi146"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi144" target="diffFile">right(irho) = w(i, j, k+<code class="constant">1</code>, irho)</a>
<a name="inviscidupwindfluxi147"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi145" target="diffFile">right(ivx) = w(i, j, k+<code class="constant">1</code>, ivx)</a>
<a name="inviscidupwindfluxi148"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi146" target="diffFile">right(ivy) = w(i, j, k+<code class="constant">1</code>, ivy)</a>
<a name="inviscidupwindfluxi150"></a><a name="inviscidupwindfluxi149"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi147" target="diffFile">right(ivz) = w(i, j, k+<code class="constant">1</code>, ivz)</a>
<a name="inviscidupwindfluxi151"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi148" target="diffFile">right(irhoe) = p(i, j, k+<code class="constant">1</code>)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi149" target="diffFile"><code class="keyword">IF</code> (correctfork) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi150" target="diffFile">right(itu1) = w(i, j, k+<code class="constant">1</code>, itu1)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi151" target="diffFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindfluxi152"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi151" target="diffFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi151" target="diffFile">gammaface = half*(gamma(i, j, k)+gamma(i, j, k+<code class="constant">1</code>))</a>
<a name="inviscidupwindfluxi153"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi152" target="diffFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi152" target="diffFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a name="inviscidupwindfluxi154"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi153" target="diffFile"><code class="comment">! And scatter it the left and right.</code></a>
<a name="inviscidupwindfluxi155"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi153" target="diffFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindfluxi156"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi154" target="diffFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindfluxi157"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi155" target="diffFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindfluxi158"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi156" target="diffFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindfluxi159"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi157" target="diffFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindfluxi160"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi158" target="diffFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) - flux(irho)</a>
<a name="inviscidupwindfluxi161"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi159" target="diffFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) - flux(imx)</a>
<a name="inviscidupwindfluxi162"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi160" target="diffFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) - flux(imy)</a>
<a name="inviscidupwindfluxi163"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi161" target="diffFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) - flux(imz)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi162" target="diffFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi163" target="diffFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindfluxi164"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi163" target="diffFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi163" target="diffFile">ind = indfamilyk(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi164" target="diffFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi164" target="diffFile"><code class="label">&              </code>ind, spectralsol) + factfamilyk(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi130" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux.html#inviscidupwindfluxi129" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi165"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi128" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!      ==================================================================</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!      ==================================================================</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        * Second order reconstruction of the left and right state.     *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        * The three differences used in the, possibly nonlinear,       *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        * interpolation are constructed here; the actual left and      *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        * right states, or at least the differences from the first     *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        * order interpolation, are computed in the subroutine          *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        * leftRightState.                                              *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">!</code></a>
<a name="inviscidupwindfluxi166"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="comment">! Fluxes in the i-direction.</code></a>
<a name="inviscidupwindfluxi167"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindfluxi168"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi166" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi167" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi168" target="diffFile"><code class="comment">! Store the three differences used in the interpolation</code></a>
<a name="inviscidupwindfluxi169"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi168" target="diffFile"><code class="comment">! in du1, du2, du3.</code></a>
<a name="inviscidupwindfluxi170"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi168" target="diffFile">du1(irho) = w(i, j, k, irho) - w(i-<code class="constant">1</code>, j, k, irho)</a>
<a name="inviscidupwindfluxi171"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi169" target="diffFile">du2(irho) = w(i+<code class="constant">1</code>, j, k, irho) - w(i, j, k, irho)</a>
<a name="inviscidupwindfluxi172"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi170" target="diffFile">du3(irho) = w(i+<code class="constant">2</code>, j, k, irho) - w(i+<code class="constant">1</code>, j, k, irho)</a>
<a name="inviscidupwindfluxi173"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi171" target="diffFile">du1(ivx) = w(i, j, k, ivx) - w(i-<code class="constant">1</code>, j, k, ivx)</a>
<a name="inviscidupwindfluxi174"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi172" target="diffFile">du2(ivx) = w(i+<code class="constant">1</code>, j, k, ivx) - w(i, j, k, ivx)</a>
<a name="inviscidupwindfluxi175"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi173" target="diffFile">du3(ivx) = w(i+<code class="constant">2</code>, j, k, ivx) - w(i+<code class="constant">1</code>, j, k, ivx)</a>
<a name="inviscidupwindfluxi176"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi174" target="diffFile">du1(ivy) = w(i, j, k, ivy) - w(i-<code class="constant">1</code>, j, k, ivy)</a>
<a name="inviscidupwindfluxi177"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi175" target="diffFile">du2(ivy) = w(i+<code class="constant">1</code>, j, k, ivy) - w(i, j, k, ivy)</a>
<a name="inviscidupwindfluxi178"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi176" target="diffFile">du3(ivy) = w(i+<code class="constant">2</code>, j, k, ivy) - w(i+<code class="constant">1</code>, j, k, ivy)</a>
<a name="inviscidupwindfluxi179"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi177" target="diffFile">du1(ivz) = w(i, j, k, ivz) - w(i-<code class="constant">1</code>, j, k, ivz)</a>
<a name="inviscidupwindfluxi180"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi178" target="diffFile">du2(ivz) = w(i+<code class="constant">1</code>, j, k, ivz) - w(i, j, k, ivz)</a>
<a name="inviscidupwindfluxi181"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi179" target="diffFile">du3(ivz) = w(i+<code class="constant">2</code>, j, k, ivz) - w(i+<code class="constant">1</code>, j, k, ivz)</a>
<a name="inviscidupwindfluxi182"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi180" target="diffFile">du1(irhoe) = p(i, j, k) - p(i-<code class="constant">1</code>, j, k)</a>
<a name="inviscidupwindfluxi183"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi181" target="diffFile">du2(irhoe) = p(i+<code class="constant">1</code>, j, k) - p(i, j, k)</a>
<a name="inviscidupwindfluxi184"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi182" target="diffFile">du3(irhoe) = p(i+<code class="constant">2</code>, j, k) - p(i+<code class="constant">1</code>, j, k)</a>
<a name="inviscidupwindfluxi185"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi183" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindfluxi186"></a>              <a href="inviscidupwindflux.html#inviscidupwindfluxi184" target="diffFile">du1(itu1) = w(i, j, k, itu1) - w(i-<code class="constant">1</code>, j, k, itu1)</a>
              <a href="inviscidupwindflux.html#inviscidupwindfluxi185" target="diffFile">du2(itu1) = w(i+<code class="constant">1</code>, j, k, itu1) - w(i, j, k, itu1)</a>
<a name="inviscidupwindfluxi187"></a>              <a href="inviscidupwindflux.html#inviscidupwindfluxi186" target="diffFile">du3(itu1) = w(i+<code class="constant">2</code>, j, k, itu1) - w(i+<code class="constant">1</code>, j, k, itu1)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi183" target="diffFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindfluxi188"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi187" target="diffFile"><code class="comment">! Compute the differences from the first order scheme.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi187" target="diffFile"><code class="keyword">CALL </code><code class="funcname">LEFTRIGHTSTATE</code>(du1, du2, du3, rotmatrixi, left, right)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi188" target="diffFile"><code class="comment">! Add the first order part to the currently stored</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi188" target="diffFile"><code class="comment">! differences, such that the correct state vector</code></a>
<a name="inviscidupwindfluxi189"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi188" target="diffFile"><code class="comment">! is stored.</code></a>
<a name="inviscidupwindfluxi190"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi188" target="diffFile">left(irho) = left(irho) + w(i, j, k, irho)</a>
<a name="inviscidupwindfluxi191"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi189" target="diffFile">left(ivx) = left(ivx) + w(i, j, k, ivx)</a>
<a name="inviscidupwindfluxi192"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi190" target="diffFile">left(ivy) = left(ivy) + w(i, j, k, ivy)</a>
<a name="inviscidupwindfluxi193"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi191" target="diffFile">left(ivz) = left(ivz) + w(i, j, k, ivz)</a>
<a name="inviscidupwindfluxi194"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi192" target="diffFile">left(irhoe) = left(irhoe) + p(i, j, k)</a>
<a name="inviscidupwindfluxi195"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi193" target="diffFile">right(irho) = right(irho) + w(i+<code class="constant">1</code>, j, k, irho)</a>
<a name="inviscidupwindfluxi196"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi194" target="diffFile">right(ivx) = right(ivx) + w(i+<code class="constant">1</code>, j, k, ivx)</a>
<a name="inviscidupwindfluxi197"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi195" target="diffFile">right(ivy) = right(ivy) + w(i+<code class="constant">1</code>, j, k, ivy)</a>
<a name="inviscidupwindfluxi198"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi196" target="diffFile">right(ivz) = right(ivz) + w(i+<code class="constant">1</code>, j, k, ivz)</a>
<a name="inviscidupwindfluxi199"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi197" target="diffFile">right(irhoe) = right(irhoe) + p(i+<code class="constant">1</code>, j, k)</a>
<a name="inviscidupwindfluxi200"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi198" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux.html#inviscidupwindfluxi199" target="diffFile">left(itu1) = left(itu1) + w(i, j, k, itu1)</a>
<a name="inviscidupwindfluxi201"></a>              <a href="inviscidupwindflux.html#inviscidupwindfluxi200" target="diffFile">right(itu1) = right(itu1) + w(i+<code class="constant">1</code>, j, k, itu1)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi198" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi201" target="diffFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindfluxi202"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi201" target="diffFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindfluxi203"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi201" target="diffFile">sx = si(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindfluxi204"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi202" target="diffFile">sy = si(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindfluxi206"></a><a name="inviscidupwindfluxi205"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi203" target="diffFile">sz = si(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindfluxi207"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi204" target="diffFile">por = pori(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi205" target="diffFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi206" target="diffFile">sface = sfacei(i, j, k)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi207" target="diffFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindfluxi208"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi207" target="diffFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi207" target="diffFile">gammaface = half*(gamma(i, j, k)+gamma(i+<code class="constant">1</code>, j, k))</a>
<a name="inviscidupwindfluxi209"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi208" target="diffFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi208" target="diffFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a name="inviscidupwindfluxi210"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi209" target="diffFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindfluxi211"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi209" target="diffFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindfluxi212"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi210" target="diffFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindfluxi213"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi211" target="diffFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindfluxi214"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi212" target="diffFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindfluxi215"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi213" target="diffFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindfluxi216"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi214" target="diffFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) - flux(irho)</a>
<a name="inviscidupwindfluxi217"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi215" target="diffFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) - flux(imx)</a>
<a name="inviscidupwindfluxi218"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi216" target="diffFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) - flux(imy)</a>
<a name="inviscidupwindfluxi219"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi217" target="diffFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) - flux(imz)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi218" target="diffFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi219" target="diffFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindfluxi220"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi219" target="diffFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi219" target="diffFile">ind = indfamilyi(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi220" target="diffFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi220" target="diffFile"><code class="label">&              </code>ind, spectralsol) + factfamilyi(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi167" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi221"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi166" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux.html#inviscidupwindfluxi165" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi222"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi221" target="diffFile"><code class="comment">! Fluxes in the j-direction.</code></a>
<a name="inviscidupwindfluxi223"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi221" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="inviscidupwindfluxi224"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi222" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi223" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi224" target="diffFile"><code class="comment">! Store the three differences used in the interpolation</code></a>
<a name="inviscidupwindfluxi225"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi224" target="diffFile"><code class="comment">! in du1, du2, du3.</code></a>
<a name="inviscidupwindfluxi226"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi224" target="diffFile">du1(irho) = w(i, j, k, irho) - w(i, j-<code class="constant">1</code>, k, irho)</a>
<a name="inviscidupwindfluxi227"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi225" target="diffFile">du2(irho) = w(i, j+<code class="constant">1</code>, k, irho) - w(i, j, k, irho)</a>
<a name="inviscidupwindfluxi228"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi226" target="diffFile">du3(irho) = w(i, j+<code class="constant">2</code>, k, irho) - w(i, j+<code class="constant">1</code>, k, irho)</a>
<a name="inviscidupwindfluxi229"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi227" target="diffFile">du1(ivx) = w(i, j, k, ivx) - w(i, j-<code class="constant">1</code>, k, ivx)</a>
<a name="inviscidupwindfluxi230"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi228" target="diffFile">du2(ivx) = w(i, j+<code class="constant">1</code>, k, ivx) - w(i, j, k, ivx)</a>
<a name="inviscidupwindfluxi231"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi229" target="diffFile">du3(ivx) = w(i, j+<code class="constant">2</code>, k, ivx) - w(i, j+<code class="constant">1</code>, k, ivx)</a>
<a name="inviscidupwindfluxi232"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi230" target="diffFile">du1(ivy) = w(i, j, k, ivy) - w(i, j-<code class="constant">1</code>, k, ivy)</a>
<a name="inviscidupwindfluxi233"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi231" target="diffFile">du2(ivy) = w(i, j+<code class="constant">1</code>, k, ivy) - w(i, j, k, ivy)</a>
<a name="inviscidupwindfluxi234"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi232" target="diffFile">du3(ivy) = w(i, j+<code class="constant">2</code>, k, ivy) - w(i, j+<code class="constant">1</code>, k, ivy)</a>
<a name="inviscidupwindfluxi235"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi233" target="diffFile">du1(ivz) = w(i, j, k, ivz) - w(i, j-<code class="constant">1</code>, k, ivz)</a>
<a name="inviscidupwindfluxi236"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi234" target="diffFile">du2(ivz) = w(i, j+<code class="constant">1</code>, k, ivz) - w(i, j, k, ivz)</a>
<a name="inviscidupwindfluxi237"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi235" target="diffFile">du3(ivz) = w(i, j+<code class="constant">2</code>, k, ivz) - w(i, j+<code class="constant">1</code>, k, ivz)</a>
<a name="inviscidupwindfluxi238"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi236" target="diffFile">du1(irhoe) = p(i, j, k) - p(i, j-<code class="constant">1</code>, k)</a>
<a name="inviscidupwindfluxi239"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi237" target="diffFile">du2(irhoe) = p(i, j+<code class="constant">1</code>, k) - p(i, j, k)</a>
<a name="inviscidupwindfluxi240"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi238" target="diffFile">du3(irhoe) = p(i, j+<code class="constant">2</code>, k) - p(i, j+<code class="constant">1</code>, k)</a>
<a name="inviscidupwindfluxi241"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi239" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindfluxi242"></a>              <a href="inviscidupwindflux.html#inviscidupwindfluxi240" target="diffFile">du1(itu1) = w(i, j, k, itu1) - w(i, j-<code class="constant">1</code>, k, itu1)</a>
              <a href="inviscidupwindflux.html#inviscidupwindfluxi241" target="diffFile">du2(itu1) = w(i, j+<code class="constant">1</code>, k, itu1) - w(i, j, k, itu1)</a>
<a name="inviscidupwindfluxi243"></a>              <a href="inviscidupwindflux.html#inviscidupwindfluxi242" target="diffFile">du3(itu1) = w(i, j+<code class="constant">2</code>, k, itu1) - w(i, j+<code class="constant">1</code>, k, itu1)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi239" target="diffFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindfluxi244"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi243" target="diffFile"><code class="comment">! Compute the differences from the first order scheme.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi243" target="diffFile"><code class="keyword">CALL </code><code class="funcname">LEFTRIGHTSTATE</code>(du1, du2, du3, rotmatrixj, left, right)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi244" target="diffFile"><code class="comment">! Add the first order part to the currently stored</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi244" target="diffFile"><code class="comment">! differences, such that the correct state vector</code></a>
<a name="inviscidupwindfluxi245"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi244" target="diffFile"><code class="comment">! is stored.</code></a>
<a name="inviscidupwindfluxi246"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi244" target="diffFile">left(irho) = left(irho) + w(i, j, k, irho)</a>
<a name="inviscidupwindfluxi247"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi245" target="diffFile">left(ivx) = left(ivx) + w(i, j, k, ivx)</a>
<a name="inviscidupwindfluxi248"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi246" target="diffFile">left(ivy) = left(ivy) + w(i, j, k, ivy)</a>
<a name="inviscidupwindfluxi249"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi247" target="diffFile">left(ivz) = left(ivz) + w(i, j, k, ivz)</a>
<a name="inviscidupwindfluxi250"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi248" target="diffFile">left(irhoe) = left(irhoe) + p(i, j, k)</a>
<a name="inviscidupwindfluxi251"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi249" target="diffFile">right(irho) = right(irho) + w(i, j+<code class="constant">1</code>, k, irho)</a>
<a name="inviscidupwindfluxi252"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi250" target="diffFile">right(ivx) = right(ivx) + w(i, j+<code class="constant">1</code>, k, ivx)</a>
<a name="inviscidupwindfluxi253"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi251" target="diffFile">right(ivy) = right(ivy) + w(i, j+<code class="constant">1</code>, k, ivy)</a>
<a name="inviscidupwindfluxi254"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi252" target="diffFile">right(ivz) = right(ivz) + w(i, j+<code class="constant">1</code>, k, ivz)</a>
<a name="inviscidupwindfluxi255"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi253" target="diffFile">right(irhoe) = right(irhoe) + p(i, j+<code class="constant">1</code>, k)</a>
<a name="inviscidupwindfluxi256"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi254" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux.html#inviscidupwindfluxi255" target="diffFile">left(itu1) = left(itu1) + w(i, j, k, itu1)</a>
<a name="inviscidupwindfluxi257"></a>              <a href="inviscidupwindflux.html#inviscidupwindfluxi256" target="diffFile">right(itu1) = right(itu1) + w(i, j+<code class="constant">1</code>, k, itu1)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi254" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi257" target="diffFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindfluxi258"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi257" target="diffFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindfluxi259"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi257" target="diffFile">sx = sj(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindfluxi260"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi258" target="diffFile">sy = sj(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindfluxi262"></a><a name="inviscidupwindfluxi261"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi259" target="diffFile">sz = sj(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindfluxi263"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi260" target="diffFile">por = porj(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi261" target="diffFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi262" target="diffFile">sface = sfacej(i, j, k)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi263" target="diffFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindfluxi264"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi263" target="diffFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi263" target="diffFile">gammaface = half*(gamma(i, j, k)+gamma(i, j+<code class="constant">1</code>, k))</a>
<a name="inviscidupwindfluxi265"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi264" target="diffFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi264" target="diffFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a name="inviscidupwindfluxi266"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi265" target="diffFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindfluxi267"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi265" target="diffFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindfluxi268"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi266" target="diffFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindfluxi269"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi267" target="diffFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindfluxi270"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi268" target="diffFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindfluxi271"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi269" target="diffFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindfluxi272"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi270" target="diffFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) - flux(irho)</a>
<a name="inviscidupwindfluxi273"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi271" target="diffFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) - flux(imx)</a>
<a name="inviscidupwindfluxi274"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi272" target="diffFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) - flux(imy)</a>
<a name="inviscidupwindfluxi275"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi273" target="diffFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) - flux(imz)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi274" target="diffFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi275" target="diffFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindfluxi276"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi275" target="diffFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi275" target="diffFile">ind = indfamilyj(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi276" target="diffFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi276" target="diffFile"><code class="label">&              </code>ind, spectralsol) + factfamilyj(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi223" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi277"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi222" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux.html#inviscidupwindfluxi221" target="diffFile"><code class="keyword">END DO</code></a>
<a name="inviscidupwindfluxi278"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi277" target="diffFile"><code class="comment">! Fluxes in the k-direction.</code></a>
<a name="inviscidupwindfluxi279"></a>      <a href="inviscidupwindflux.html#inviscidupwindfluxi277" target="diffFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
<a name="inviscidupwindfluxi280"></a>        <a href="inviscidupwindflux.html#inviscidupwindfluxi278" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi279" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi280" target="diffFile"><code class="comment">! Store the three differences used in the interpolation</code></a>
<a name="inviscidupwindfluxi281"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi280" target="diffFile"><code class="comment">! in du1, du2, du3.</code></a>
<a name="inviscidupwindfluxi282"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi280" target="diffFile">du1(irho) = w(i, j, k, irho) - w(i, j, k-<code class="constant">1</code>, irho)</a>
<a name="inviscidupwindfluxi283"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi281" target="diffFile">du2(irho) = w(i, j, k+<code class="constant">1</code>, irho) - w(i, j, k, irho)</a>
<a name="inviscidupwindfluxi284"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi282" target="diffFile">du3(irho) = w(i, j, k+<code class="constant">2</code>, irho) - w(i, j, k+<code class="constant">1</code>, irho)</a>
<a name="inviscidupwindfluxi285"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi283" target="diffFile">du1(ivx) = w(i, j, k, ivx) - w(i, j, k-<code class="constant">1</code>, ivx)</a>
<a name="inviscidupwindfluxi286"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi284" target="diffFile">du2(ivx) = w(i, j, k+<code class="constant">1</code>, ivx) - w(i, j, k, ivx)</a>
<a name="inviscidupwindfluxi287"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi285" target="diffFile">du3(ivx) = w(i, j, k+<code class="constant">2</code>, ivx) - w(i, j, k+<code class="constant">1</code>, ivx)</a>
<a name="inviscidupwindfluxi288"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi286" target="diffFile">du1(ivy) = w(i, j, k, ivy) - w(i, j, k-<code class="constant">1</code>, ivy)</a>
<a name="inviscidupwindfluxi289"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi287" target="diffFile">du2(ivy) = w(i, j, k+<code class="constant">1</code>, ivy) - w(i, j, k, ivy)</a>
<a name="inviscidupwindfluxi290"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi288" target="diffFile">du3(ivy) = w(i, j, k+<code class="constant">2</code>, ivy) - w(i, j, k+<code class="constant">1</code>, ivy)</a>
<a name="inviscidupwindfluxi291"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi289" target="diffFile">du1(ivz) = w(i, j, k, ivz) - w(i, j, k-<code class="constant">1</code>, ivz)</a>
<a name="inviscidupwindfluxi292"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi290" target="diffFile">du2(ivz) = w(i, j, k+<code class="constant">1</code>, ivz) - w(i, j, k, ivz)</a>
<a name="inviscidupwindfluxi293"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi291" target="diffFile">du3(ivz) = w(i, j, k+<code class="constant">2</code>, ivz) - w(i, j, k+<code class="constant">1</code>, ivz)</a>
<a name="inviscidupwindfluxi294"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi292" target="diffFile">du1(irhoe) = p(i, j, k) - p(i, j, k-<code class="constant">1</code>)</a>
<a name="inviscidupwindfluxi295"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi293" target="diffFile">du2(irhoe) = p(i, j, k+<code class="constant">1</code>) - p(i, j, k)</a>
<a name="inviscidupwindfluxi296"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi294" target="diffFile">du3(irhoe) = p(i, j, k+<code class="constant">2</code>) - p(i, j, k+<code class="constant">1</code>)</a>
<a name="inviscidupwindfluxi297"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi295" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="inviscidupwindfluxi298"></a>              <a href="inviscidupwindflux.html#inviscidupwindfluxi296" target="diffFile">du1(itu1) = w(i, j, k, itu1) - w(i, j, k-<code class="constant">1</code>, itu1)</a>
              <a href="inviscidupwindflux.html#inviscidupwindfluxi297" target="diffFile">du2(itu1) = w(i, j, k+<code class="constant">1</code>, itu1) - w(i, j, k, itu1)</a>
<a name="inviscidupwindfluxi299"></a>              <a href="inviscidupwindflux.html#inviscidupwindfluxi298" target="diffFile">du3(itu1) = w(i, j, k+<code class="constant">2</code>, itu1) - w(i, j, k+<code class="constant">1</code>, itu1)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi295" target="diffFile"><code class="keyword">END IF</code></a>
<a name="inviscidupwindfluxi300"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi299" target="diffFile"><code class="comment">! Compute the differences from the first order scheme.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi299" target="diffFile"><code class="keyword">CALL </code><code class="funcname">LEFTRIGHTSTATE</code>(du1, du2, du3, rotmatrixk, left, right)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi300" target="diffFile"><code class="comment">! Add the first order part to the currently stored</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi300" target="diffFile"><code class="comment">! differences, such that the correct state vector</code></a>
<a name="inviscidupwindfluxi301"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi300" target="diffFile"><code class="comment">! is stored.</code></a>
<a name="inviscidupwindfluxi302"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi300" target="diffFile">left(irho) = left(irho) + w(i, j, k, irho)</a>
<a name="inviscidupwindfluxi303"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi301" target="diffFile">left(ivx) = left(ivx) + w(i, j, k, ivx)</a>
<a name="inviscidupwindfluxi304"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi302" target="diffFile">left(ivy) = left(ivy) + w(i, j, k, ivy)</a>
<a name="inviscidupwindfluxi305"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi303" target="diffFile">left(ivz) = left(ivz) + w(i, j, k, ivz)</a>
<a name="inviscidupwindfluxi306"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi304" target="diffFile">left(irhoe) = left(irhoe) + p(i, j, k)</a>
<a name="inviscidupwindfluxi307"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi305" target="diffFile">right(irho) = right(irho) + w(i, j, k+<code class="constant">1</code>, irho)</a>
<a name="inviscidupwindfluxi308"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi306" target="diffFile">right(ivx) = right(ivx) + w(i, j, k+<code class="constant">1</code>, ivx)</a>
<a name="inviscidupwindfluxi309"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi307" target="diffFile">right(ivy) = right(ivy) + w(i, j, k+<code class="constant">1</code>, ivy)</a>
<a name="inviscidupwindfluxi310"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi308" target="diffFile">right(ivz) = right(ivz) + w(i, j, k+<code class="constant">1</code>, ivz)</a>
<a name="inviscidupwindfluxi311"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi309" target="diffFile">right(irhoe) = right(irhoe) + p(i, j, k+<code class="constant">1</code>)</a>
<a name="inviscidupwindfluxi312"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi310" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
              <a href="inviscidupwindflux.html#inviscidupwindfluxi311" target="diffFile">left(itu1) = left(itu1) + w(i, j, k, itu1)</a>
<a name="inviscidupwindfluxi313"></a>              <a href="inviscidupwindflux.html#inviscidupwindfluxi312" target="diffFile">right(itu1) = right(itu1) + w(i, j, k+<code class="constant">1</code>, itu1)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi310" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi313" target="diffFile"><code class="comment">! Store the normal vector, the porosity and the</code></a>
<a name="inviscidupwindfluxi314"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi313" target="diffFile"><code class="comment">! mesh velocity if present.</code></a>
<a name="inviscidupwindfluxi315"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi313" target="diffFile">sx = sk(i, j, k, <code class="constant">1</code>)</a>
<a name="inviscidupwindfluxi316"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi314" target="diffFile">sy = sk(i, j, k, <code class="constant">2</code>)</a>
<a name="inviscidupwindfluxi318"></a><a name="inviscidupwindfluxi317"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi315" target="diffFile">sz = sk(i, j, k, <code class="constant">3</code>)</a>
<a name="inviscidupwindfluxi319"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi316" target="diffFile">por = pork(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi317" target="diffFile"><code class="keyword">IF</code> (addgridvelocities) </a><a href="inviscidupwindflux.html#inviscidupwindfluxi318" target="diffFile">sface = sfacek(i, j, k)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi319" target="diffFile"><code class="comment">! Compute the value of gamma on the face. Take an</code></a>
<a name="inviscidupwindfluxi320"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi319" target="diffFile"><code class="comment">! arithmetic average of the two states.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi319" target="diffFile">gammaface = half*(gamma(i, j, k)+gamma(i, j, k+<code class="constant">1</code>))</a>
<a name="inviscidupwindfluxi321"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi320" target="diffFile"><code class="comment">! Compute the dissipative flux across the interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi320" target="diffFile"><code class="keyword">CALL </code><code class="funcname">RIEMANNFLUX</code>(left, right, flux)</a>
<a name="inviscidupwindfluxi322"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi321" target="diffFile"><code class="comment">! And scatter it to the left and right.</code></a>
<a name="inviscidupwindfluxi323"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi321" target="diffFile">fw(i, j, k, irho) = fw(i, j, k, irho) + flux(irho)</a>
<a name="inviscidupwindfluxi324"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi322" target="diffFile">fw(i, j, k, imx) = fw(i, j, k, imx) + flux(imx)</a>
<a name="inviscidupwindfluxi325"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi323" target="diffFile">fw(i, j, k, imy) = fw(i, j, k, imy) + flux(imy)</a>
<a name="inviscidupwindfluxi326"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi324" target="diffFile">fw(i, j, k, imz) = fw(i, j, k, imz) + flux(imz)</a>
<a name="inviscidupwindfluxi327"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi325" target="diffFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) + flux(irhoe)</a>
<a name="inviscidupwindfluxi328"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi326" target="diffFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) - flux(irho)</a>
<a name="inviscidupwindfluxi329"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi327" target="diffFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) - flux(imx)</a>
<a name="inviscidupwindfluxi330"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi328" target="diffFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) - flux(imy)</a>
<a name="inviscidupwindfluxi331"></a>            <a href="inviscidupwindflux.html#inviscidupwindfluxi329" target="diffFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) - flux(imz)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi330" target="diffFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) - flux(irhoe)</a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi331" target="diffFile"><code class="comment">! Store the density flux in the mass flow of the</code></a>
<a name="inviscidupwindfluxi332"></a><a href="inviscidupwindflux.html#inviscidupwindfluxi331" target="diffFile"><code class="comment">! appropriate sliding mesh interface.</code></a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi331" target="diffFile">ind = indfamilyk(i, j, k)</a>
            <a href="inviscidupwindflux.html#inviscidupwindfluxi332" target="diffFile">massflowfamilydiss(ind, spectralsol) = massflowfamilydiss(<code class="label">&</code></a>
<a href="inviscidupwindflux.html#inviscidupwindfluxi332" target="diffFile"><code class="label">&              </code>ind, spectralsol) + factfamilyk(i, j, k)*flux(irho)</a>
          <a href="inviscidupwindflux.html#inviscidupwindfluxi279" target="diffFile"><code class="keyword">END DO</code></a>
        <a href="inviscidupwindflux.html#inviscidupwindfluxi278" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="inviscidupwindflux.html#inviscidupwindfluxi277" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux.html#inviscidupwindfluxi53" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="inviscidupwindflux.html#inviscidupwindfluxi11" target="diffFile"><code class="keyword">END IF</code></a>
<a name="leftrightstate"></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">CONTAINS</code></a>
<a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="comment">!      ==================================================================</code></a>
<a name="leftrightstatei0"></a>  <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">LEFTRIGHTSTATE</code>(<code class="vardecl">du1</code>, <code class="vardecl">du2</code>, <code class="vardecl">du3</code>, <code class="vardecl">rotmatrix</code>, <code class="vardecl">left</code>, <code class="vardecl">right</code>)</a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidupwindflux.html#leftrightstatei0" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#leftrightstatei0" target="diffFile"><code class="comment">!        Local parameter.</code></a>
<a name="leftrightstatei1"></a><a href="inviscidupwindflux.html#leftrightstatei0" target="diffFile"><code class="comment">!</code></a>
    <a href="inviscidupwindflux.html#leftrightstatei0" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">PARAMETER </code>:: <code class="vardecl">epslim</code>=<code class="constant">1.e-10_realType</code></a>
<a href="inviscidupwindflux.html#leftrightstatei1" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#leftrightstatei1" target="diffFile"><code class="comment">!        Subroutine arguments.</code></a>
<a name="leftrightstatei2"></a><a href="inviscidupwindflux.html#leftrightstatei1" target="diffFile"><code class="comment">!</code></a>
<a name="leftrightstatei3"></a>    <a href="inviscidupwindflux.html#leftrightstatei1" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">du1</code>, <code class="vardecl">du2</code>, <code class="vardecl">du3</code></a>
<a name="leftrightstatei4"></a>    <a href="inviscidupwindflux.html#leftrightstatei2" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">left</code>, <code class="vardecl">right</code></a>
    <a href="inviscidupwindflux.html#leftrightstatei3" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:, :, :, :, :<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">rotmatrix</code></a>
<a href="inviscidupwindflux.html#leftrightstatei4" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#leftrightstatei4" target="diffFile"><code class="comment">!        Local variables.</code></a>
<a name="leftrightstatei5"></a><a href="inviscidupwindflux.html#leftrightstatei4" target="diffFile"><code class="comment">!</code></a>
<a name="leftrightstatei6"></a>    <a href="inviscidupwindflux.html#leftrightstatei4" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">l</code></a>
    <a href="inviscidupwindflux.html#leftrightstatei5" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">rl1</code>, <code class="vardecl">rl2</code>, <code class="vardecl">rr1</code>, <code class="vardecl">rr2</code>, <code class="vardecl">tmp</code>, <code class="vardecl">dvx</code>, <code class="vardecl">dvy</code>, <code class="vardecl">dvz</code></a>
    <a href="inviscidupwindflux.html#leftrightstatei6" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">3</code>, <code class="constant">3</code><code class="typename">) </code>:: <code class="vardecl">rot</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x6</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SIGN</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x5</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x4</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x3</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MIN</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max7</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max6</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max5</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max4</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max3</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y4</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y3</code></a>
<a name="leftrightstatei7"></a>    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y2</code></a>
    <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">y1</code></a>
<a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="comment">!        * Begin execution.                                             *</code></a>
<a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="comment">! Check if the velocity components should be transformed to</code></a>
<a name="leftrightstatei8"></a><a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="comment">! the cylindrical frame.</code></a>
    <a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="keyword">IF</code> (rotationalperiodic) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux.html#leftrightstatei8" target="diffFile"><code class="comment">! Store the rotation matrix a bit easier. Note that the i,j,k</code></a>
<a name="leftrightstatei9"></a><a href="inviscidupwindflux.html#leftrightstatei8" target="diffFile"><code class="comment">! come from the main subroutine.</code></a>
<a name="leftrightstatei10"></a>      <a href="inviscidupwindflux.html#leftrightstatei8" target="diffFile">rot(<code class="constant">1</code>, <code class="constant">1</code>) = rotmatrix(i, j, k, <code class="constant">1</code>, <code class="constant">1</code>)</a>
<a name="leftrightstatei11"></a>      <a href="inviscidupwindflux.html#leftrightstatei9" target="diffFile">rot(<code class="constant">1</code>, <code class="constant">2</code>) = rotmatrix(i, j, k, <code class="constant">1</code>, <code class="constant">2</code>)</a>
<a name="leftrightstatei12"></a>      <a href="inviscidupwindflux.html#leftrightstatei10" target="diffFile">rot(<code class="constant">1</code>, <code class="constant">3</code>) = rotmatrix(i, j, k, <code class="constant">1</code>, <code class="constant">3</code>)</a>
<a name="leftrightstatei13"></a>      <a href="inviscidupwindflux.html#leftrightstatei11" target="diffFile">rot(<code class="constant">2</code>, <code class="constant">1</code>) = rotmatrix(i, j, k, <code class="constant">2</code>, <code class="constant">1</code>)</a>
<a name="leftrightstatei14"></a>      <a href="inviscidupwindflux.html#leftrightstatei12" target="diffFile">rot(<code class="constant">2</code>, <code class="constant">2</code>) = rotmatrix(i, j, k, <code class="constant">2</code>, <code class="constant">2</code>)</a>
<a name="leftrightstatei15"></a>      <a href="inviscidupwindflux.html#leftrightstatei13" target="diffFile">rot(<code class="constant">2</code>, <code class="constant">3</code>) = rotmatrix(i, j, k, <code class="constant">2</code>, <code class="constant">3</code>)</a>
<a name="leftrightstatei16"></a>      <a href="inviscidupwindflux.html#leftrightstatei14" target="diffFile">rot(<code class="constant">3</code>, <code class="constant">1</code>) = rotmatrix(i, j, k, <code class="constant">3</code>, <code class="constant">1</code>)</a>
<a name="leftrightstatei17"></a>      <a href="inviscidupwindflux.html#leftrightstatei15" target="diffFile">rot(<code class="constant">3</code>, <code class="constant">2</code>) = rotmatrix(i, j, k, <code class="constant">3</code>, <code class="constant">2</code>)</a>
      <a href="inviscidupwindflux.html#leftrightstatei16" target="diffFile">rot(<code class="constant">3</code>, <code class="constant">3</code>) = rotmatrix(i, j, k, <code class="constant">3</code>, <code class="constant">3</code>)</a>
<a href="inviscidupwindflux.html#leftrightstatei17" target="diffFile"><code class="comment">! Apply the transformation to the velocity components</code></a>
<a name="leftrightstatei18"></a><a href="inviscidupwindflux.html#leftrightstatei17" target="diffFile"><code class="comment">! of du1, du2 and du3.</code></a>
<a name="leftrightstatei19"></a>      <a href="inviscidupwindflux.html#leftrightstatei17" target="diffFile">dvx = du1(ivx)</a>
<a name="leftrightstatei20"></a>      <a href="inviscidupwindflux.html#leftrightstatei18" target="diffFile">dvy = du1(ivy)</a>
<a name="leftrightstatei21"></a>      <a href="inviscidupwindflux.html#leftrightstatei19" target="diffFile">dvz = du1(ivz)</a>
<a name="leftrightstatei22"></a>      <a href="inviscidupwindflux.html#leftrightstatei20" target="diffFile">du1(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstatei23"></a>      <a href="inviscidupwindflux.html#leftrightstatei21" target="diffFile">du1(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstatei24"></a>      <a href="inviscidupwindflux.html#leftrightstatei22" target="diffFile">du1(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstatei25"></a>      <a href="inviscidupwindflux.html#leftrightstatei23" target="diffFile">dvx = du2(ivx)</a>
<a name="leftrightstatei26"></a>      <a href="inviscidupwindflux.html#leftrightstatei24" target="diffFile">dvy = du2(ivy)</a>
<a name="leftrightstatei27"></a>      <a href="inviscidupwindflux.html#leftrightstatei25" target="diffFile">dvz = du2(ivz)</a>
<a name="leftrightstatei28"></a>      <a href="inviscidupwindflux.html#leftrightstatei26" target="diffFile">du2(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstatei29"></a>      <a href="inviscidupwindflux.html#leftrightstatei27" target="diffFile">du2(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstatei30"></a>      <a href="inviscidupwindflux.html#leftrightstatei28" target="diffFile">du2(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstatei31"></a>      <a href="inviscidupwindflux.html#leftrightstatei29" target="diffFile">dvx = du3(ivx)</a>
<a name="leftrightstatei32"></a>      <a href="inviscidupwindflux.html#leftrightstatei30" target="diffFile">dvy = du3(ivy)</a>
<a name="leftrightstatei33"></a>      <a href="inviscidupwindflux.html#leftrightstatei31" target="diffFile">dvz = du3(ivz)</a>
<a name="leftrightstatei34"></a>      <a href="inviscidupwindflux.html#leftrightstatei32" target="diffFile">du3(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvz</a>
      <a href="inviscidupwindflux.html#leftrightstatei33" target="diffFile">du3(ivy) = rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstatei35"></a>      <a href="inviscidupwindflux.html#leftrightstatei34" target="diffFile">du3(ivz) = rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
    <a href="inviscidupwindflux.html#leftrightstatei7" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#leftrightstatei35" target="diffFile"><code class="comment">! Determine the limiter used.</code></a>
<a name="leftrightstatei36"></a>    <a href="inviscidupwindflux.html#leftrightstatei35" target="diffFile"><code class="keyword">SELECT CASE </code> (limused) </a>
    <a href="inviscidupwindflux.html#leftrightstatei35" target="diffFile"><code class="keyword">CASE </code>(nolimiter) </a>
<a href="inviscidupwindflux.html#leftrightstatei36" target="diffFile"><code class="comment">! Linear interpolation; no limiter.</code></a>
<a name="leftrightstatei37"></a><a href="inviscidupwindflux.html#leftrightstatei36" target="diffFile"><code class="comment">! Loop over the number of variables to be interpolated.</code></a>
<a name="leftrightstatei38"></a>      <a href="inviscidupwindflux.html#leftrightstatei36" target="diffFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,nwint</a>
        <a href="inviscidupwindflux.html#leftrightstatei37" target="diffFile">left(l) = omk*du1(l) + opk*du2(l)</a>
        <a href="inviscidupwindflux.html#leftrightstatei38" target="diffFile">right(l) = -(omk*du3(l)) - opk*du2(l)</a>
<a name="leftrightstatei39"></a>      <a href="inviscidupwindflux.html#leftrightstatei36" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux.html#leftrightstatei35" target="diffFile"><code class="keyword">CASE </code>(vanalbeda) </a>
<a href="inviscidupwindflux.html#leftrightstatei39" target="diffFile"><code class="comment">!          ==============================================================</code></a>
<a href="inviscidupwindflux.html#leftrightstatei39" target="diffFile"><code class="comment">! Nonlinear interpolation using the van albeda limiter.</code></a>
<a name="leftrightstatei40"></a><a href="inviscidupwindflux.html#leftrightstatei39" target="diffFile"><code class="comment">! Loop over the number of variables to be interpolated.</code></a>
<a name="leftrightstatei42"></a>      <a href="inviscidupwindflux.html#leftrightstatei39" target="diffFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,nwint</a>
        <a href="inviscidupwindflux.html#leftrightstatei40" target="diffFile"><code class="keyword">IF</code> (du2(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="leftrightstatei41"></a>          <a href="inviscidupwindflux.html#leftrightstatei42" target="diffFile">x1 = du2(l)</a>
        <a href="inviscidupwindflux.html#leftrightstatei40" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei43"></a>          <a href="inviscidupwindflux.html#leftrightstatei41" target="diffFile">x1 = -du2(l)</a>
<a name="leftrightstatei44"></a>        <a href="inviscidupwindflux.html#leftrightstatei40" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei43" target="diffFile"><code class="keyword">IF</code> (x1 .LT. epslim) <code class="keyword">THEN</code></a>
<a name="leftrightstatei45"></a>          <a href="inviscidupwindflux.html#leftrightstatei44" target="diffFile">max2 = epslim</a>
        <a href="inviscidupwindflux.html#leftrightstatei43" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei46"></a>          <a href="inviscidupwindflux.html#leftrightstatei45" target="diffFile">max2 = x1</a>
        <a href="inviscidupwindflux.html#leftrightstatei43" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#leftrightstatei46" target="diffFile"><code class="comment">! Compute the limiter argument rl1, rl2, rr1 and rr2.</code></a>
<a name="leftrightstatei47"></a><a href="inviscidupwindflux.html#leftrightstatei46" target="diffFile"><code class="comment">! Note the cut off to 0.0.</code></a>
<a name="leftrightstatei49"></a>        <a href="inviscidupwindflux.html#leftrightstatei46" target="diffFile">tmp = one/<code class="funcname">SIGN</code>(max2, du2(l))</a>
        <a href="inviscidupwindflux.html#leftrightstatei47" target="diffFile"><code class="keyword">IF</code> (du1(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="leftrightstatei48"></a>          <a href="inviscidupwindflux.html#leftrightstatei49" target="diffFile">x3 = du1(l)</a>
        <a href="inviscidupwindflux.html#leftrightstatei47" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei50"></a>          <a href="inviscidupwindflux.html#leftrightstatei48" target="diffFile">x3 = -du1(l)</a>
<a name="leftrightstatei51"></a>        <a href="inviscidupwindflux.html#leftrightstatei47" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei50" target="diffFile"><code class="keyword">IF</code> (x3 .LT. epslim) <code class="keyword">THEN</code></a>
<a name="leftrightstatei52"></a>          <a href="inviscidupwindflux.html#leftrightstatei51" target="diffFile">max4 = epslim</a>
        <a href="inviscidupwindflux.html#leftrightstatei50" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei53"></a>          <a href="inviscidupwindflux.html#leftrightstatei52" target="diffFile">max4 = x3</a>
<a name="leftrightstatei54"></a>        <a href="inviscidupwindflux.html#leftrightstatei50" target="diffFile"><code class="keyword">END IF</code></a>
<a name="leftrightstatei55"></a>        <a href="inviscidupwindflux.html#leftrightstatei53" target="diffFile">y1 = du2(l)/<code class="funcname">SIGN</code>(max4, du1(l))</a>
        <a href="inviscidupwindflux.html#leftrightstatei54" target="diffFile"><code class="keyword">IF</code> (zero .LT. y1) <code class="keyword">THEN</code></a>
<a name="leftrightstatei56"></a>          <a href="inviscidupwindflux.html#leftrightstatei55" target="diffFile">rl1 = y1</a>
        <a href="inviscidupwindflux.html#leftrightstatei54" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei57"></a>          <a href="inviscidupwindflux.html#leftrightstatei56" target="diffFile">rl1 = zero</a>
<a name="leftrightstatei59"></a>        <a href="inviscidupwindflux.html#leftrightstatei54" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei57" target="diffFile"><code class="keyword">IF</code> (zero .LT. du1(l)*tmp) <code class="keyword">THEN</code></a>
<a name="leftrightstatei58"></a>          <a href="inviscidupwindflux.html#leftrightstatei59" target="diffFile">rl2 = du1(l)*tmp</a>
        <a href="inviscidupwindflux.html#leftrightstatei57" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei60"></a>          <a href="inviscidupwindflux.html#leftrightstatei58" target="diffFile">rl2 = zero</a>
<a name="leftrightstatei62"></a>        <a href="inviscidupwindflux.html#leftrightstatei57" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei60" target="diffFile"><code class="keyword">IF</code> (zero .LT. du3(l)*tmp) <code class="keyword">THEN</code></a>
<a name="leftrightstatei61"></a>          <a href="inviscidupwindflux.html#leftrightstatei62" target="diffFile">rr1 = du3(l)*tmp</a>
        <a href="inviscidupwindflux.html#leftrightstatei60" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei63"></a>          <a href="inviscidupwindflux.html#leftrightstatei61" target="diffFile">rr1 = zero</a>
<a name="leftrightstatei65"></a>        <a href="inviscidupwindflux.html#leftrightstatei60" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei63" target="diffFile"><code class="keyword">IF</code> (du3(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="leftrightstatei64"></a>          <a href="inviscidupwindflux.html#leftrightstatei65" target="diffFile">x4 = du3(l)</a>
        <a href="inviscidupwindflux.html#leftrightstatei63" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei66"></a>          <a href="inviscidupwindflux.html#leftrightstatei64" target="diffFile">x4 = -du3(l)</a>
<a name="leftrightstatei67"></a>        <a href="inviscidupwindflux.html#leftrightstatei63" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei66" target="diffFile"><code class="keyword">IF</code> (x4 .LT. epslim) <code class="keyword">THEN</code></a>
<a name="leftrightstatei68"></a>          <a href="inviscidupwindflux.html#leftrightstatei67" target="diffFile">max5 = epslim</a>
        <a href="inviscidupwindflux.html#leftrightstatei66" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei69"></a>          <a href="inviscidupwindflux.html#leftrightstatei68" target="diffFile">max5 = x4</a>
<a name="leftrightstatei70"></a>        <a href="inviscidupwindflux.html#leftrightstatei66" target="diffFile"><code class="keyword">END IF</code></a>
<a name="leftrightstatei71"></a>        <a href="inviscidupwindflux.html#leftrightstatei69" target="diffFile">y2 = du2(l)/<code class="funcname">SIGN</code>(max5, du3(l))</a>
        <a href="inviscidupwindflux.html#leftrightstatei70" target="diffFile"><code class="keyword">IF</code> (zero .LT. y2) <code class="keyword">THEN</code></a>
<a name="leftrightstatei72"></a>          <a href="inviscidupwindflux.html#leftrightstatei71" target="diffFile">rr2 = y2</a>
        <a href="inviscidupwindflux.html#leftrightstatei70" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei73"></a>          <a href="inviscidupwindflux.html#leftrightstatei72" target="diffFile">rr2 = zero</a>
        <a href="inviscidupwindflux.html#leftrightstatei70" target="diffFile"><code class="keyword">END IF</code></a>
<a name="leftrightstatei74"></a><a href="inviscidupwindflux.html#leftrightstatei73" target="diffFile"><code class="comment">! Compute the corresponding limiter values.</code></a>
<a name="leftrightstatei75"></a>        <a href="inviscidupwindflux.html#leftrightstatei73" target="diffFile">rl1 = rl1*(rl1+one)/(rl1*rl1+one)</a>
<a name="leftrightstatei76"></a>        <a href="inviscidupwindflux.html#leftrightstatei74" target="diffFile">rl2 = rl2*(rl2+one)/(rl2*rl2+one)</a>
<a name="leftrightstatei77"></a>        <a href="inviscidupwindflux.html#leftrightstatei75" target="diffFile">rr1 = rr1*(rr1+one)/(rr1*rr1+one)</a>
        <a href="inviscidupwindflux.html#leftrightstatei76" target="diffFile">rr2 = rr2*(rr2+one)/(rr2*rr2+one)</a>
<a href="inviscidupwindflux.html#leftrightstatei77" target="diffFile"><code class="comment">! Compute the nonlinear corrections to the first order</code></a>
<a name="leftrightstatei78"></a><a href="inviscidupwindflux.html#leftrightstatei77" target="diffFile"><code class="comment">! scheme.</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei77" target="diffFile">left(l) = omk*rl1*du1(l) + opk*rl2*du2(l)</a>
        <a href="inviscidupwindflux.html#leftrightstatei78" target="diffFile">right(l) = -(opk*rr1*du2(l)) - omk*rr2*du3(l)</a>
<a name="leftrightstatei79"></a>      <a href="inviscidupwindflux.html#leftrightstatei39" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux.html#leftrightstatei35" target="diffFile"><code class="keyword">CASE </code>(minmod) </a>
<a href="inviscidupwindflux.html#leftrightstatei79" target="diffFile"><code class="comment">!          ==============================================================</code></a>
<a href="inviscidupwindflux.html#leftrightstatei79" target="diffFile"><code class="comment">! Nonlinear interpolation using the minmod limiter.</code></a>
<a name="leftrightstatei80"></a><a href="inviscidupwindflux.html#leftrightstatei79" target="diffFile"><code class="comment">! Loop over the number of variables to be interpolated.</code></a>
<a name="leftrightstatei82"></a>      <a href="inviscidupwindflux.html#leftrightstatei79" target="diffFile"><code class="keyword">DO </code>l=<code class="constant">1</code>,nwint</a>
        <a href="inviscidupwindflux.html#leftrightstatei80" target="diffFile"><code class="keyword">IF</code> (du2(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="leftrightstatei81"></a>          <a href="inviscidupwindflux.html#leftrightstatei82" target="diffFile">x2 = du2(l)</a>
        <a href="inviscidupwindflux.html#leftrightstatei80" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei83"></a>          <a href="inviscidupwindflux.html#leftrightstatei81" target="diffFile">x2 = -du2(l)</a>
<a name="leftrightstatei84"></a>        <a href="inviscidupwindflux.html#leftrightstatei80" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei83" target="diffFile"><code class="keyword">IF</code> (x2 .LT. epslim) <code class="keyword">THEN</code></a>
<a name="leftrightstatei85"></a>          <a href="inviscidupwindflux.html#leftrightstatei84" target="diffFile">max3 = epslim</a>
        <a href="inviscidupwindflux.html#leftrightstatei83" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei86"></a>          <a href="inviscidupwindflux.html#leftrightstatei85" target="diffFile">max3 = x2</a>
        <a href="inviscidupwindflux.html#leftrightstatei83" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#leftrightstatei86" target="diffFile"><code class="comment">! Compute the limiter argument rl1, rl2, rr1 and rr2.</code></a>
<a name="leftrightstatei87"></a><a href="inviscidupwindflux.html#leftrightstatei86" target="diffFile"><code class="comment">! Note the cut off to 0.0.</code></a>
<a name="leftrightstatei89"></a>        <a href="inviscidupwindflux.html#leftrightstatei86" target="diffFile">tmp = one/<code class="funcname">SIGN</code>(max3, du2(l))</a>
        <a href="inviscidupwindflux.html#leftrightstatei87" target="diffFile"><code class="keyword">IF</code> (du1(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="leftrightstatei88"></a>          <a href="inviscidupwindflux.html#leftrightstatei89" target="diffFile">x5 = du1(l)</a>
        <a href="inviscidupwindflux.html#leftrightstatei87" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei90"></a>          <a href="inviscidupwindflux.html#leftrightstatei88" target="diffFile">x5 = -du1(l)</a>
<a name="leftrightstatei91"></a>        <a href="inviscidupwindflux.html#leftrightstatei87" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei90" target="diffFile"><code class="keyword">IF</code> (x5 .LT. epslim) <code class="keyword">THEN</code></a>
<a name="leftrightstatei92"></a>          <a href="inviscidupwindflux.html#leftrightstatei91" target="diffFile">max6 = epslim</a>
        <a href="inviscidupwindflux.html#leftrightstatei90" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei93"></a>          <a href="inviscidupwindflux.html#leftrightstatei92" target="diffFile">max6 = x5</a>
<a name="leftrightstatei94"></a>        <a href="inviscidupwindflux.html#leftrightstatei90" target="diffFile"><code class="keyword">END IF</code></a>
<a name="leftrightstatei95"></a>        <a href="inviscidupwindflux.html#leftrightstatei93" target="diffFile">y3 = du2(l)/<code class="funcname">SIGN</code>(max6, du1(l))</a>
        <a href="inviscidupwindflux.html#leftrightstatei94" target="diffFile"><code class="keyword">IF</code> (zero .LT. y3) <code class="keyword">THEN</code></a>
<a name="leftrightstatei96"></a>          <a href="inviscidupwindflux.html#leftrightstatei95" target="diffFile">rl1 = y3</a>
        <a href="inviscidupwindflux.html#leftrightstatei94" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei97"></a>          <a href="inviscidupwindflux.html#leftrightstatei96" target="diffFile">rl1 = zero</a>
<a name="leftrightstatei99"></a>        <a href="inviscidupwindflux.html#leftrightstatei94" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei97" target="diffFile"><code class="keyword">IF</code> (zero .LT. du1(l)*tmp) <code class="keyword">THEN</code></a>
<a name="leftrightstatei98"></a>          <a href="inviscidupwindflux.html#leftrightstatei99" target="diffFile">rl2 = du1(l)*tmp</a>
        <a href="inviscidupwindflux.html#leftrightstatei97" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei100"></a>          <a href="inviscidupwindflux.html#leftrightstatei98" target="diffFile">rl2 = zero</a>
<a name="leftrightstatei102"></a>        <a href="inviscidupwindflux.html#leftrightstatei97" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei100" target="diffFile"><code class="keyword">IF</code> (zero .LT. du3(l)*tmp) <code class="keyword">THEN</code></a>
<a name="leftrightstatei101"></a>          <a href="inviscidupwindflux.html#leftrightstatei102" target="diffFile">rr1 = du3(l)*tmp</a>
        <a href="inviscidupwindflux.html#leftrightstatei100" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei103"></a>          <a href="inviscidupwindflux.html#leftrightstatei101" target="diffFile">rr1 = zero</a>
<a name="leftrightstatei105"></a>        <a href="inviscidupwindflux.html#leftrightstatei100" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei103" target="diffFile"><code class="keyword">IF</code> (du3(l) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="leftrightstatei104"></a>          <a href="inviscidupwindflux.html#leftrightstatei105" target="diffFile">x6 = du3(l)</a>
        <a href="inviscidupwindflux.html#leftrightstatei103" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei106"></a>          <a href="inviscidupwindflux.html#leftrightstatei104" target="diffFile">x6 = -du3(l)</a>
<a name="leftrightstatei107"></a>        <a href="inviscidupwindflux.html#leftrightstatei103" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei106" target="diffFile"><code class="keyword">IF</code> (x6 .LT. epslim) <code class="keyword">THEN</code></a>
<a name="leftrightstatei108"></a>          <a href="inviscidupwindflux.html#leftrightstatei107" target="diffFile">max7 = epslim</a>
        <a href="inviscidupwindflux.html#leftrightstatei106" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei109"></a>          <a href="inviscidupwindflux.html#leftrightstatei108" target="diffFile">max7 = x6</a>
<a name="leftrightstatei110"></a>        <a href="inviscidupwindflux.html#leftrightstatei106" target="diffFile"><code class="keyword">END IF</code></a>
<a name="leftrightstatei111"></a>        <a href="inviscidupwindflux.html#leftrightstatei109" target="diffFile">y4 = du2(l)/<code class="funcname">SIGN</code>(max7, du3(l))</a>
        <a href="inviscidupwindflux.html#leftrightstatei110" target="diffFile"><code class="keyword">IF</code> (zero .LT. y4) <code class="keyword">THEN</code></a>
<a name="leftrightstatei112"></a>          <a href="inviscidupwindflux.html#leftrightstatei111" target="diffFile">rr2 = y4</a>
        <a href="inviscidupwindflux.html#leftrightstatei110" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei113"></a>          <a href="inviscidupwindflux.html#leftrightstatei112" target="diffFile">rr2 = zero</a>
<a name="leftrightstatei115"></a>        <a href="inviscidupwindflux.html#leftrightstatei110" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei113" target="diffFile"><code class="keyword">IF</code> (one .GT. factminmod*rl1) <code class="keyword">THEN</code></a>
<a name="leftrightstatei114"></a>          <a href="inviscidupwindflux.html#leftrightstatei115" target="diffFile">rl1 = factminmod*rl1</a>
        <a href="inviscidupwindflux.html#leftrightstatei113" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei116"></a>          <a href="inviscidupwindflux.html#leftrightstatei114" target="diffFile">rl1 = one</a>
<a name="leftrightstatei118"></a>        <a href="inviscidupwindflux.html#leftrightstatei113" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei116" target="diffFile"><code class="keyword">IF</code> (one .GT. factminmod*rl2) <code class="keyword">THEN</code></a>
<a name="leftrightstatei117"></a>          <a href="inviscidupwindflux.html#leftrightstatei118" target="diffFile">rl2 = factminmod*rl2</a>
        <a href="inviscidupwindflux.html#leftrightstatei116" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei119"></a>          <a href="inviscidupwindflux.html#leftrightstatei117" target="diffFile">rl2 = one</a>
<a name="leftrightstatei121"></a>        <a href="inviscidupwindflux.html#leftrightstatei116" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei119" target="diffFile"><code class="keyword">IF</code> (one .GT. factminmod*rr1) <code class="keyword">THEN</code></a>
<a name="leftrightstatei120"></a>          <a href="inviscidupwindflux.html#leftrightstatei121" target="diffFile">rr1 = factminmod*rr1</a>
        <a href="inviscidupwindflux.html#leftrightstatei119" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei122"></a>          <a href="inviscidupwindflux.html#leftrightstatei120" target="diffFile">rr1 = one</a>
<a name="leftrightstatei124"></a>        <a href="inviscidupwindflux.html#leftrightstatei119" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei122" target="diffFile"><code class="keyword">IF</code> (one .GT. factminmod*rr2) <code class="keyword">THEN</code></a>
<a name="leftrightstatei123"></a>          <a href="inviscidupwindflux.html#leftrightstatei124" target="diffFile">rr2 = factminmod*rr2</a>
        <a href="inviscidupwindflux.html#leftrightstatei122" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="leftrightstatei125"></a>          <a href="inviscidupwindflux.html#leftrightstatei123" target="diffFile">rr2 = one</a>
        <a href="inviscidupwindflux.html#leftrightstatei122" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#leftrightstatei125" target="diffFile"><code class="comment">! Compute the nonlinear corrections to the first order</code></a>
<a name="leftrightstatei126"></a><a href="inviscidupwindflux.html#leftrightstatei125" target="diffFile"><code class="comment">! scheme.</code></a>
        <a href="inviscidupwindflux.html#leftrightstatei125" target="diffFile">left(l) = omk*rl1*du1(l) + opk*rl2*du2(l)</a>
        <a href="inviscidupwindflux.html#leftrightstatei126" target="diffFile">right(l) = -(opk*rr1*du2(l)) - omk*rr2*du3(l)</a>
<a name="leftrightstatei127"></a>      <a href="inviscidupwindflux.html#leftrightstatei79" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="inviscidupwindflux.html#leftrightstatei35" target="diffFile"><code class="keyword">END SELECT</code></a>
<a href="inviscidupwindflux.html#leftrightstatei127" target="diffFile"><code class="comment">! In case only a first order scheme must be used for the</code></a>
<a href="inviscidupwindflux.html#leftrightstatei127" target="diffFile"><code class="comment">! turbulent transport equations, set the correction for the</code></a>
<a name="leftrightstatei128"></a><a href="inviscidupwindflux.html#leftrightstatei127" target="diffFile"><code class="comment">! turbulent kinetic energy to 0.</code></a>
<a name="leftrightstatei129"></a>    <a href="inviscidupwindflux.html#leftrightstatei127" target="diffFile"><code class="keyword">IF</code> (firstorderk) <code class="keyword">THEN</code></a>
      <a href="inviscidupwindflux.html#leftrightstatei128" target="diffFile">left(itu1) = zero</a>
<a name="leftrightstatei130"></a>      <a href="inviscidupwindflux.html#leftrightstatei129" target="diffFile">right(itu1) = zero</a>
    <a href="inviscidupwindflux.html#leftrightstatei127" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#leftrightstatei130" target="diffFile"><code class="comment">! For rotational periodic problems transform the velocity</code></a>
<a href="inviscidupwindflux.html#leftrightstatei130" target="diffFile"><code class="comment">! differences back to Cartesian again. Note that now the</code></a>
<a name="leftrightstatei131"></a><a href="inviscidupwindflux.html#leftrightstatei130" target="diffFile"><code class="comment">! transpose of the rotation matrix must be used.</code></a>
    <a href="inviscidupwindflux.html#leftrightstatei130" target="diffFile"><code class="keyword">IF</code> (rotationalperiodic) <code class="keyword">THEN</code></a>
<a name="leftrightstatei132"></a><a href="inviscidupwindflux.html#leftrightstatei131" target="diffFile"><code class="comment">! Left state.</code></a>
<a name="leftrightstatei133"></a>      <a href="inviscidupwindflux.html#leftrightstatei131" target="diffFile">dvx = left(ivx)</a>
<a name="leftrightstatei134"></a>      <a href="inviscidupwindflux.html#leftrightstatei132" target="diffFile">dvy = left(ivy)</a>
<a name="leftrightstatei135"></a>      <a href="inviscidupwindflux.html#leftrightstatei133" target="diffFile">dvz = left(ivz)</a>
<a name="leftrightstatei136"></a>      <a href="inviscidupwindflux.html#leftrightstatei134" target="diffFile">left(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvz</a>
<a name="leftrightstatei137"></a>      <a href="inviscidupwindflux.html#leftrightstatei135" target="diffFile">left(ivy) = rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvz</a>
      <a href="inviscidupwindflux.html#leftrightstatei136" target="diffFile">left(ivz) = rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a name="leftrightstatei138"></a><a href="inviscidupwindflux.html#leftrightstatei137" target="diffFile"><code class="comment">! Right state.</code></a>
<a name="leftrightstatei139"></a>      <a href="inviscidupwindflux.html#leftrightstatei137" target="diffFile">dvx = right(ivx)</a>
<a name="leftrightstatei140"></a>      <a href="inviscidupwindflux.html#leftrightstatei138" target="diffFile">dvy = right(ivy)</a>
<a name="leftrightstatei141"></a>      <a href="inviscidupwindflux.html#leftrightstatei139" target="diffFile">dvz = right(ivz)</a>
<a name="leftrightstatei142"></a>      <a href="inviscidupwindflux.html#leftrightstatei140" target="diffFile">right(ivx) = rot(<code class="constant">1</code>, <code class="constant">1</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">1</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">1</code>)*dvz</a>
      <a href="inviscidupwindflux.html#leftrightstatei141" target="diffFile">right(ivy) = rot(<code class="constant">1</code>, <code class="constant">2</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">2</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">2</code>)*dvz</a>
      <a href="inviscidupwindflux.html#leftrightstatei142" target="diffFile">right(ivz) = rot(<code class="constant">1</code>, <code class="constant">3</code>)*dvx + rot(<code class="constant">2</code>, <code class="constant">3</code>)*dvy + rot(<code class="constant">3</code>, <code class="constant">3</code>)*dvz</a>
<a name="riemannflux"></a>    <a href="inviscidupwindflux.html#leftrightstatei130" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="inviscidupwindflux.html#leftrightstate" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">LEFTRIGHTSTATE</code></a>
<a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="comment">!        ================================================================</code></a>
<a name="riemannfluxi0"></a>  <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">RIEMANNFLUX</code>(<code class="vardecl">left</code>, <code class="vardecl">right</code>, <code class="vardecl">flux</code>)</a>
    <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="inviscidupwindflux.html#riemannfluxi0" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#riemannfluxi0" target="diffFile"><code class="comment">!        Subroutine arguments.</code></a>
<a name="riemannfluxi1"></a><a href="inviscidupwindflux.html#riemannfluxi0" target="diffFile"><code class="comment">!</code></a>
<a name="riemannfluxi2"></a>    <a href="inviscidupwindflux.html#riemannfluxi0" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="keyword">*</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">left</code>, <code class="vardecl">right</code></a>
    <a href="inviscidupwindflux.html#riemannfluxi1" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="keyword">*</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">flux</code></a>
<a href="inviscidupwindflux.html#riemannfluxi2" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#riemannfluxi2" target="diffFile"><code class="comment">!        Local variables.</code></a>
<a name="riemannfluxi3"></a><a href="inviscidupwindflux.html#riemannfluxi2" target="diffFile"><code class="comment">!</code></a>
<a name="riemannfluxi4"></a>    <a href="inviscidupwindflux.html#riemannfluxi2" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">porflux</code>, <code class="vardecl">rface</code></a>
<a name="riemannfluxi5"></a>    <a href="inviscidupwindflux.html#riemannfluxi3" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">etl</code>, <code class="vardecl">etr</code>, <code class="vardecl">z1l</code>, <code class="vardecl">z1r</code>, <code class="vardecl">tmp</code></a>
<a name="riemannfluxi6"></a>    <a href="inviscidupwindflux.html#riemannfluxi4" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dr</code>, <code class="vardecl">dru</code>, <code class="vardecl">drv</code>, <code class="vardecl">drw</code>, <code class="vardecl">dre</code>, <code class="vardecl">drk</code></a>
<a name="riemannfluxi7"></a>    <a href="inviscidupwindflux.html#riemannfluxi5" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ravg</code>, <code class="vardecl">uavg</code>, <code class="vardecl">vavg</code>, <code class="vardecl">wavg</code>, <code class="vardecl">havg</code>, <code class="vardecl">kavg</code></a>
<a name="riemannfluxi8"></a>    <a href="inviscidupwindflux.html#riemannfluxi6" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">alphaavg</code>, <code class="vardecl">a2avg</code>, <code class="vardecl">aavg</code>, <code class="vardecl">unavg</code></a>
<a name="riemannfluxi9"></a>    <a href="inviscidupwindflux.html#riemannfluxi7" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ovaavg</code>, <code class="vardecl">ova2avg</code>, <code class="vardecl">area</code>, <code class="vardecl">eta</code></a>
<a name="riemannfluxi10"></a>    <a href="inviscidupwindflux.html#riemannfluxi8" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">gm1</code>, <code class="vardecl">gm53</code></a>
<a name="riemannfluxi11"></a>    <a href="inviscidupwindflux.html#riemannfluxi9" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">lam1</code>, <code class="vardecl">lam2</code>, <code class="vardecl">lam3</code></a>
<a name="riemannfluxi12"></a>    <a href="inviscidupwindflux.html#riemannfluxi10" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abv1</code>, <code class="vardecl">abv2</code>, <code class="vardecl">abv3</code>, <code class="vardecl">abv4</code>, <code class="vardecl">abv5</code>, <code class="vardecl">abv6</code>, <code class="vardecl">abv7</code></a>
<a name="riemannfluxi13"></a>    <a href="inviscidupwindflux.html#riemannfluxi11" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">2</code><code class="typename">) </code>:: <code class="vardecl">rhotmp</code>, <code class="vardecl">utmp</code>, <code class="vardecl">vtmp</code>, <code class="vardecl">wtmp</code></a>
<a name="riemannfluxi14"></a>    <a href="inviscidupwindflux.html#riemannfluxi12" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code><code class="constant">2</code><code class="typename">) </code>:: <code class="vardecl">ptmp</code>, <code class="vardecl">ktmp</code>, <code class="vardecl">etmp</code></a>
<a name="riemannfluxi15"></a>    <a href="inviscidupwindflux.html#riemannfluxi13" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg1</code></a>
<a name="riemannfluxi16"></a>    <a href="inviscidupwindflux.html#riemannfluxi14" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">result1</code></a>
    <a href="inviscidupwindflux.html#riemannfluxi15" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">arg2</code></a>
    <a href="inviscidupwindflux.html#riemannfluxi16" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">result2</code></a>
    <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">MAX</code></a>
    <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
    <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x2</code></a>
    <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">x1</code></a>
    <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs2</code></a>
    <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">abs1</code></a>
<a name="riemannfluxi17"></a>    <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
    <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="typename">REAL(</code><code class="modifier">realType</code><code class="typename">) </code>:: <code class="vardecl">max2</code></a>
<a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile"><code class="comment">!        * Begin execution.                                             *</code></a>
<a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile"><code class="comment">!        *                                                              *</code></a>
<a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile"><code class="comment">!        ****************************************************************</code></a>
<a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile"><code class="comment">!</code></a>
<a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile"><code class="comment">! Set the porosity for the flux. The default value, 0.5*rFil, is</code></a>
<a name="riemannfluxi19"></a><a name="riemannfluxi18"></a><a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile"><code class="comment">! a scaling factor where an rFil != 1 is taken into account.</code></a>
<a name="riemannfluxi20"></a>    <a href="inviscidupwindflux.html#riemannfluxi17" target="diffFile">porflux = half*rfil</a>
    <a href="inviscidupwindflux.html#riemannfluxi18" target="diffFile"><code class="keyword">IF</code> (por .EQ. noflux .OR. por .EQ. boundflux) </a><a href="inviscidupwindflux.html#riemannfluxi19" target="diffFile">porflux = zero</a>
<a name="riemannfluxi21"></a><a href="inviscidupwindflux.html#riemannfluxi20" target="diffFile"><code class="comment">! Abbreviate some expressions in which gamma occurs.</code></a>
<a name="riemannfluxi22"></a>    <a href="inviscidupwindflux.html#riemannfluxi20" target="diffFile">gm1 = gammaface - one</a>
    <a href="inviscidupwindflux.html#riemannfluxi21" target="diffFile">gm53 = gammaface - five*third</a>
<a href="inviscidupwindflux.html#riemannfluxi22" target="diffFile"><code class="comment">! Determine which riemann solver must be solved.</code></a>
<a name="riemannfluxi23"></a>    <a href="inviscidupwindflux.html#riemannfluxi22" target="diffFile"><code class="keyword">SELECT CASE </code> (riemannused) </a>
    <a href="inviscidupwindflux.html#riemannfluxi22" target="diffFile"><code class="keyword">CASE </code>(roe) </a>
<a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="comment">! Determine the preconditioner used.</code></a>
<a name="riemannfluxi24"></a>      <a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="keyword">SELECT CASE </code> (precond) </a>
      <a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="keyword">CASE </code>(noprecond) </a>
<a href="inviscidupwindflux.html#riemannfluxi24" target="diffFile"><code class="comment">! No preconditioner used. Use the Roe scheme of the</code></a>
<a href="inviscidupwindflux.html#riemannfluxi24" target="diffFile"><code class="comment">! standard equations.</code></a>
<a href="inviscidupwindflux.html#riemannfluxi24" target="diffFile"><code class="comment">! Compute the square root of the left and right densities</code></a>
<a name="riemannfluxi25"></a><a href="inviscidupwindflux.html#riemannfluxi24" target="diffFile"><code class="comment">! and the inverse of the sum.</code></a>
<a name="riemannfluxi26"></a>        <a href="inviscidupwindflux.html#riemannfluxi24" target="diffFile">z1l = <code class="funcname">SQRT</code>(left(irho))</a>
<a name="riemannfluxi27"></a>        <a href="inviscidupwindflux.html#riemannfluxi25" target="diffFile">z1r = <code class="funcname">SQRT</code>(right(irho))</a>
        <a href="inviscidupwindflux.html#riemannfluxi26" target="diffFile">tmp = one/(z1l+z1r)</a>
<a href="inviscidupwindflux.html#riemannfluxi27" target="diffFile"><code class="comment">! Compute some variables depending whether or not a</code></a>
<a name="riemannfluxi28"></a><a href="inviscidupwindflux.html#riemannfluxi27" target="diffFile"><code class="comment">! k-equation is present.</code></a>
        <a href="inviscidupwindflux.html#riemannfluxi27" target="diffFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a href="inviscidupwindflux.html#riemannfluxi28" target="diffFile"><code class="comment">! Store the left and right kinetic energy in ktmp,</code></a>
<a name="riemannfluxi29"></a><a href="inviscidupwindflux.html#riemannfluxi28" target="diffFile"><code class="comment">! which is needed to compute the total energy.</code></a>
<a name="riemannfluxi30"></a>          <a href="inviscidupwindflux.html#riemannfluxi28" target="diffFile">ktmp(<code class="constant">1</code>) = left(itu1)</a>
          <a href="inviscidupwindflux.html#riemannfluxi29" target="diffFile">ktmp(<code class="constant">2</code>) = right(itu1)</a>
<a href="inviscidupwindflux.html#riemannfluxi30" target="diffFile"><code class="comment">! Store the difference of the turbulent kinetic energy</code></a>
<a name="riemannfluxi31"></a><a href="inviscidupwindflux.html#riemannfluxi30" target="diffFile"><code class="comment">! per unit volume, i.e. the conserved variable.</code></a>
          <a href="inviscidupwindflux.html#riemannfluxi30" target="diffFile">drk = right(irho)*right(itu1) - left(irho)*left(itu1)</a>
<a href="inviscidupwindflux.html#riemannfluxi31" target="diffFile"><code class="comment">! Compute the average turbulent energy per unit mass</code></a>
<a href="inviscidupwindflux.html#riemannfluxi31" target="diffFile"><code class="comment">! using Roe averages.</code></a>
<a name="riemannfluxi32"></a>          <a href="inviscidupwindflux.html#riemannfluxi31" target="diffFile">kavg = tmp*(z1l*left(itu1)+z1r*right(itu1))</a>
        <a href="inviscidupwindflux.html#riemannfluxi27" target="diffFile"><code class="keyword">ELSE</code></a>
<a href="inviscidupwindflux.html#riemannfluxi32" target="diffFile"><code class="comment">! Set the difference of the turbulent kinetic energy</code></a>
<a href="inviscidupwindflux.html#riemannfluxi32" target="diffFile"><code class="comment">! per unit volume and the averaged kinetic energy per</code></a>
<a name="riemannfluxi33"></a><a href="inviscidupwindflux.html#riemannfluxi32" target="diffFile"><code class="comment">! unit mass to zero.</code></a>
          <a href="inviscidupwindflux.html#riemannfluxi32" target="diffFile">drk = <code class="constant">0.0</code></a>
<a name="riemannfluxi34"></a>          <a href="inviscidupwindflux.html#riemannfluxi33" target="diffFile">kavg = <code class="constant">0.0</code></a>
        <a href="inviscidupwindflux.html#riemannfluxi27" target="diffFile"><code class="keyword">END IF</code></a>
<a name="riemannfluxi35"></a><a href="inviscidupwindflux.html#riemannfluxi34" target="diffFile"><code class="comment">! Compute the total energy of the left and right state.</code></a>
<a name="riemannfluxi36"></a>        <a href="inviscidupwindflux.html#riemannfluxi34" target="diffFile">rhotmp(<code class="constant">1</code>) = left(irho)</a>
<a name="riemannfluxi37"></a>        <a href="inviscidupwindflux.html#riemannfluxi35" target="diffFile">rhotmp(<code class="constant">2</code>) = right(irho)</a>
<a name="riemannfluxi38"></a>        <a href="inviscidupwindflux.html#riemannfluxi36" target="diffFile">utmp(<code class="constant">1</code>) = left(ivx)</a>
<a name="riemannfluxi39"></a>        <a href="inviscidupwindflux.html#riemannfluxi37" target="diffFile">utmp(<code class="constant">2</code>) = right(ivx)</a>
<a name="riemannfluxi40"></a>        <a href="inviscidupwindflux.html#riemannfluxi38" target="diffFile">vtmp(<code class="constant">1</code>) = left(ivy)</a>
<a name="riemannfluxi41"></a>        <a href="inviscidupwindflux.html#riemannfluxi39" target="diffFile">vtmp(<code class="constant">2</code>) = right(ivy)</a>
<a name="riemannfluxi42"></a>        <a href="inviscidupwindflux.html#riemannfluxi40" target="diffFile">wtmp(<code class="constant">1</code>) = left(ivz)</a>
<a name="riemannfluxi43"></a>        <a href="inviscidupwindflux.html#riemannfluxi41" target="diffFile">wtmp(<code class="constant">2</code>) = right(ivz)</a>
<a name="riemannfluxi44"></a>        <a href="inviscidupwindflux.html#riemannfluxi42" target="diffFile">ptmp(<code class="constant">1</code>) = left(irhoe)</a>
<a name="p15"></a>        <a href="inviscidupwindflux.html#riemannfluxi43" target="diffFile">ptmp(<code class="constant">2</code>) = right(irhoe)</a>
<a name="riemannfluxi45"></a>        <a href="inviscidupwindflux.html#riemannfluxi44" target="diffFile"><code class="keyword">CALL </code><code class="funcname">ETOTARRAY</code>(rhotmp, utmp, vtmp, wtmp, ptmp, ktmp, etmp, <code class="label">&</code></a>
<a name="riemannfluxi46"></a><a href="inviscidupwindflux.html#riemannfluxi44" target="diffFile"><code class="label">&                 </code>correctfork, </a><a href="msg.html#p15" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux.html#riemannfluxi44" target="diffFile"><code class="constant">2_intType</code>)</a>
<a name="riemannfluxi47"></a>        <a href="inviscidupwindflux.html#riemannfluxi45" target="diffFile">etl = etmp(<code class="constant">1</code>)</a>
        <a href="inviscidupwindflux.html#riemannfluxi46" target="diffFile">etr = etmp(<code class="constant">2</code>)</a>
<a href="inviscidupwindflux.html#riemannfluxi47" target="diffFile"><code class="comment">! Compute the difference of the conservative mean</code></a>
<a name="riemannfluxi48"></a><a href="inviscidupwindflux.html#riemannfluxi47" target="diffFile"><code class="comment">! flow variables.</code></a>
<a name="riemannfluxi49"></a>        <a href="inviscidupwindflux.html#riemannfluxi47" target="diffFile">dr = right(irho) - left(irho)</a>
<a name="riemannfluxi50"></a>        <a href="inviscidupwindflux.html#riemannfluxi48" target="diffFile">dru = right(irho)*right(ivx) - left(irho)*left(ivx)</a>
<a name="riemannfluxi51"></a>        <a href="inviscidupwindflux.html#riemannfluxi49" target="diffFile">drv = right(irho)*right(ivy) - left(irho)*left(ivy)</a>
<a name="riemannfluxi52"></a>        <a href="inviscidupwindflux.html#riemannfluxi50" target="diffFile">drw = right(irho)*right(ivz) - left(irho)*left(ivz)</a>
        <a href="inviscidupwindflux.html#riemannfluxi51" target="diffFile">dre = etr - etl</a>
<a href="inviscidupwindflux.html#riemannfluxi52" target="diffFile"><code class="comment">! Compute the Roe average variables, which can be</code></a>
<a name="riemannfluxi53"></a><a href="inviscidupwindflux.html#riemannfluxi52" target="diffFile"><code class="comment">! computed directly from the average Roe vector.</code></a>
<a name="riemannfluxi54"></a>        <a href="inviscidupwindflux.html#riemannfluxi52" target="diffFile">ravg = fourth*(z1r+z1l)**<code class="constant">2</code></a>
<a name="riemannfluxi55"></a>        <a href="inviscidupwindflux.html#riemannfluxi53" target="diffFile">uavg = tmp*(z1l*left(ivx)+z1r*right(ivx))</a>
<a name="riemannfluxi56"></a>        <a href="inviscidupwindflux.html#riemannfluxi54" target="diffFile">vavg = tmp*(z1l*left(ivy)+z1r*right(ivy))</a>
<a name="riemannfluxi57"></a>        <a href="inviscidupwindflux.html#riemannfluxi55" target="diffFile">wavg = tmp*(z1l*left(ivz)+z1r*right(ivz))</a>
        <a href="inviscidupwindflux.html#riemannfluxi56" target="diffFile">havg = tmp*((etl+left(irhoe))/z1l+(etr+right(irhoe))/z1r)</a>
<a href="inviscidupwindflux.html#riemannfluxi57" target="diffFile"><code class="comment">! Compute the unit vector and store the area of the</code></a>
<a name="riemannfluxi58"></a><a href="inviscidupwindflux.html#riemannfluxi57" target="diffFile"><code class="comment">! normal. Also compute the unit normal velocity of the face.</code></a>
<a name="riemannfluxi59"></a>        <a href="inviscidupwindflux.html#riemannfluxi57" target="diffFile">arg1 = sx**<code class="constant">2 </code>+ sy**<code class="constant">2 </code>+ sz**<code class="constant">2</code></a>
<a name="riemannfluxi61"></a>        <a href="inviscidupwindflux.html#riemannfluxi58" target="diffFile">area = <code class="funcname">SQRT</code>(arg1)</a>
        <a href="inviscidupwindflux.html#riemannfluxi59" target="diffFile"><code class="keyword">IF</code> (<code class="constant">1.e-25_realType </code>.LT. area) <code class="keyword">THEN</code></a>
<a name="riemannfluxi60"></a>          <a href="inviscidupwindflux.html#riemannfluxi61" target="diffFile">max2 = area</a>
        <a href="inviscidupwindflux.html#riemannfluxi59" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="riemannfluxi62"></a>          <a href="inviscidupwindflux.html#riemannfluxi60" target="diffFile">max2 = <code class="constant">1.e-25_realType</code></a>
<a name="riemannfluxi63"></a>        <a href="inviscidupwindflux.html#riemannfluxi59" target="diffFile"><code class="keyword">END IF</code></a>
<a name="riemannfluxi64"></a>        <a href="inviscidupwindflux.html#riemannfluxi62" target="diffFile">tmp = one/max2</a>
<a name="riemannfluxi65"></a>        <a href="inviscidupwindflux.html#riemannfluxi63" target="diffFile">sx = sx*tmp</a>
<a name="riemannfluxi66"></a>        <a href="inviscidupwindflux.html#riemannfluxi64" target="diffFile">sy = sy*tmp</a>
<a name="riemannfluxi67"></a>        <a href="inviscidupwindflux.html#riemannfluxi65" target="diffFile">sz = sz*tmp</a>
        <a href="inviscidupwindflux.html#riemannfluxi66" target="diffFile">rface = sface*tmp</a>
<a href="inviscidupwindflux.html#riemannfluxi67" target="diffFile"><code class="comment">! Compute some dependent variables at the Roe</code></a>
<a name="riemannfluxi68"></a><a href="inviscidupwindflux.html#riemannfluxi67" target="diffFile"><code class="comment">! average state.</code></a>
<a name="riemannfluxi70"></a>        <a href="inviscidupwindflux.html#riemannfluxi67" target="diffFile">alphaavg = half*(uavg**<code class="constant">2</code>+vavg**<code class="constant">2</code>+wavg**<code class="constant">2</code>)</a>
        <a href="inviscidupwindflux.html#riemannfluxi68" target="diffFile"><code class="keyword">IF</code> (gm1*(havg-alphaavg) - gm53*kavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="riemannfluxi69"></a>          <a href="inviscidupwindflux.html#riemannfluxi70" target="diffFile">a2avg = gm1*(havg-alphaavg) - gm53*kavg</a>
        <a href="inviscidupwindflux.html#riemannfluxi68" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="riemannfluxi71"></a>          <a href="inviscidupwindflux.html#riemannfluxi69" target="diffFile">a2avg = -(gm1*(havg-alphaavg)-gm53*kavg)</a>
<a name="riemannfluxi72"></a>        <a href="inviscidupwindflux.html#riemannfluxi68" target="diffFile"><code class="keyword">END IF</code></a>
<a name="riemannfluxi73"></a>        <a href="inviscidupwindflux.html#riemannfluxi71" target="diffFile">aavg = <code class="funcname">SQRT</code>(a2avg)</a>
<a name="riemannfluxi74"></a>        <a href="inviscidupwindflux.html#riemannfluxi72" target="diffFile">unavg = uavg*sx + vavg*sy + wavg*sz</a>
<a name="riemannfluxi75"></a>        <a href="inviscidupwindflux.html#riemannfluxi73" target="diffFile">ovaavg = one/aavg</a>
        <a href="inviscidupwindflux.html#riemannfluxi74" target="diffFile">ova2avg = one/a2avg</a>
<a name="riemannfluxi76"></a><a href="inviscidupwindflux.html#riemannfluxi75" target="diffFile"><code class="comment">! Set for a boundary the normal velocity to rFace, the</code></a>
<a name="riemannfluxi77"></a><a href="inviscidupwindflux.html#riemannfluxi75" target="diffFile"><code class="comment">! normal velocity of the boundary.</code></a>
        <a href="inviscidupwindflux.html#riemannfluxi75" target="diffFile"><code class="keyword">IF</code> (por .EQ. boundflux) </a><a href="inviscidupwindflux.html#riemannfluxi76" target="diffFile">unavg = rface</a>
<a name="riemannfluxi78"></a>        <a href="inviscidupwindflux.html#riemannfluxi77" target="diffFile">x1 = (left(ivx)-right(ivx))*sx + (left(ivy)-right(ivy))*sy + (<code class="label">&</code></a>
<a name="riemannfluxi80"></a><a href="inviscidupwindflux.html#riemannfluxi77" target="diffFile"><code class="label">&          </code>left(ivz)-right(ivz))*sz</a>
        <a href="inviscidupwindflux.html#riemannfluxi78" target="diffFile"><code class="keyword">IF</code> (x1 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="riemannfluxi79"></a>          <a href="inviscidupwindflux.html#riemannfluxi80" target="diffFile">abs1 = x1</a>
        <a href="inviscidupwindflux.html#riemannfluxi78" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="riemannfluxi81"></a>          <a href="inviscidupwindflux.html#riemannfluxi79" target="diffFile">abs1 = -x1</a>
<a name="riemannfluxi82"></a>        <a href="inviscidupwindflux.html#riemannfluxi78" target="diffFile"><code class="keyword">END IF</code></a>
<a name="riemannfluxi83"></a>        <a href="inviscidupwindflux.html#riemannfluxi81" target="diffFile">arg1 = gammaface*left(irhoe)/left(irho)</a>
<a name="riemannfluxi84"></a>        <a href="inviscidupwindflux.html#riemannfluxi82" target="diffFile">result1 = <code class="funcname">SQRT</code>(arg1)</a>
<a name="riemannfluxi85"></a>        <a href="inviscidupwindflux.html#riemannfluxi83" target="diffFile">arg2 = gammaface*right(irhoe)/right(irho)</a>
<a name="riemannfluxi86"></a>        <a href="inviscidupwindflux.html#riemannfluxi84" target="diffFile">result2 = <code class="funcname">SQRT</code>(arg2)</a>
<a name="riemannfluxi88"></a>        <a href="inviscidupwindflux.html#riemannfluxi85" target="diffFile">x2 = result1 - result2</a>
        <a href="inviscidupwindflux.html#riemannfluxi86" target="diffFile"><code class="keyword">IF</code> (x2 .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="riemannfluxi87"></a>          <a href="inviscidupwindflux.html#riemannfluxi88" target="diffFile">abs2 = x2</a>
        <a href="inviscidupwindflux.html#riemannfluxi86" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="riemannfluxi89"></a>          <a href="inviscidupwindflux.html#riemannfluxi87" target="diffFile">abs2 = -x2</a>
        <a href="inviscidupwindflux.html#riemannfluxi86" target="diffFile"><code class="keyword">END IF</code></a>
<a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! Compute the coefficient eta for the entropy correction.</code></a>
<a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! At the moment a 1D entropy correction is used, which</code></a>
<a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! removes expansion shocks. Although it also reduces the</code></a>
<a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! carbuncle phenomenon, it does not remove it completely.</code></a>
<a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! In other to do that a multi-dimensional entropy fix is</code></a>
<a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! needed, see Sanders et. al, JCP, vol. 145, 1998,</code></a>
<a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! pp. 511 - 537. Although relatively easy to implement,</code></a>
<a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! an efficient implementation requires the storage of</code></a>
<a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! all the left and right states, which is rather</code></a>
<a name="riemannfluxi90"></a><a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile"><code class="comment">! expensive in terms of memory.</code></a>
<a name="riemannfluxi92"></a>        <a href="inviscidupwindflux.html#riemannfluxi89" target="diffFile">eta = half*(abs1+abs2)</a>
        <a href="inviscidupwindflux.html#riemannfluxi90" target="diffFile"><code class="keyword">IF</code> (unavg - rface + aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="riemannfluxi91"></a>          <a href="inviscidupwindflux.html#riemannfluxi92" target="diffFile">lam1 = unavg - rface + aavg</a>
        <a href="inviscidupwindflux.html#riemannfluxi90" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="riemannfluxi93"></a>          <a href="inviscidupwindflux.html#riemannfluxi91" target="diffFile">lam1 = -(unavg-rface+aavg)</a>
<a name="riemannfluxi95"></a>        <a href="inviscidupwindflux.html#riemannfluxi90" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#riemannfluxi93" target="diffFile"><code class="keyword">IF</code> (unavg - rface - aavg .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="riemannfluxi94"></a>          <a href="inviscidupwindflux.html#riemannfluxi95" target="diffFile">lam2 = unavg - rface - aavg</a>
        <a href="inviscidupwindflux.html#riemannfluxi93" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="riemannfluxi96"></a>          <a href="inviscidupwindflux.html#riemannfluxi94" target="diffFile">lam2 = -(unavg-rface-aavg)</a>
<a name="riemannfluxi98"></a>        <a href="inviscidupwindflux.html#riemannfluxi93" target="diffFile"><code class="keyword">END IF</code></a>
        <a href="inviscidupwindflux.html#riemannfluxi96" target="diffFile"><code class="keyword">IF</code> (unavg - rface .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
<a name="riemannfluxi97"></a>          <a href="inviscidupwindflux.html#riemannfluxi98" target="diffFile">lam3 = unavg - rface</a>
        <a href="inviscidupwindflux.html#riemannfluxi96" target="diffFile"><code class="keyword">ELSE</code></a>
<a name="riemannfluxi99"></a>          <a href="inviscidupwindflux.html#riemannfluxi97" target="diffFile">lam3 = -(unavg-rface)</a>
        <a href="inviscidupwindflux.html#riemannfluxi96" target="diffFile"><code class="keyword">END IF</code></a>
<a name="riemannfluxi101"></a><a name="riemannfluxi100"></a><a href="inviscidupwindflux.html#riemannfluxi99" target="diffFile"><code class="comment">! Apply the entropy correction to the eigenvalues.</code></a>
<a name="riemannfluxi103"></a><a name="riemannfluxi102"></a>        <a href="inviscidupwindflux.html#riemannfluxi99" target="diffFile">tmp = two*eta</a>
<a name="riemannfluxi105"></a><a name="riemannfluxi104"></a>        <a href="inviscidupwindflux.html#riemannfluxi100" target="diffFile"><code class="keyword">IF</code> (lam1 .LT. tmp) </a><a href="inviscidupwindflux.html#riemannfluxi101" target="diffFile">lam1 = eta + fourth*lam1*lam1/eta</a>
<a name="riemannfluxi106"></a>        <a href="inviscidupwindflux.html#riemannfluxi102" target="diffFile"><code class="keyword">IF</code> (lam2 .LT. tmp) </a><a href="inviscidupwindflux.html#riemannfluxi103" target="diffFile">lam2 = eta + fourth*lam2*lam2/eta</a>
        <a href="inviscidupwindflux.html#riemannfluxi104" target="diffFile"><code class="keyword">IF</code> (lam3 .LT. tmp) </a><a href="inviscidupwindflux.html#riemannfluxi105" target="diffFile">lam3 = eta + fourth*lam3*lam3/eta</a>
<a href="inviscidupwindflux.html#riemannfluxi106" target="diffFile"><code class="comment">! Multiply the eigenvalues by the area to obtain</code></a>
<a name="riemannfluxi107"></a><a href="inviscidupwindflux.html#riemannfluxi106" target="diffFile"><code class="comment">! the correct values for the dissipation term.</code></a>
<a name="riemannfluxi108"></a>        <a href="inviscidupwindflux.html#riemannfluxi106" target="diffFile">lam1 = lam1*area</a>
<a name="riemannfluxi109"></a>        <a href="inviscidupwindflux.html#riemannfluxi107" target="diffFile">lam2 = lam2*area</a>
        <a href="inviscidupwindflux.html#riemannfluxi108" target="diffFile">lam3 = lam3*area</a>
<a href="inviscidupwindflux.html#riemannfluxi109" target="diffFile"><code class="comment">! Some abbreviations, which occur quite often in the</code></a>
<a name="riemannfluxi110"></a><a href="inviscidupwindflux.html#riemannfluxi109" target="diffFile"><code class="comment">! dissipation terms.</code></a>
<a name="riemannfluxi111"></a>        <a href="inviscidupwindflux.html#riemannfluxi109" target="diffFile">abv1 = half*(lam1+lam2)</a>
<a name="riemannfluxi112"></a>        <a href="inviscidupwindflux.html#riemannfluxi110" target="diffFile">abv2 = half*(lam1-lam2)</a>
        <a href="inviscidupwindflux.html#riemannfluxi111" target="diffFile">abv3 = abv1 - lam3</a>
<a name="riemannfluxi113"></a>        <a href="inviscidupwindflux.html#riemannfluxi112" target="diffFile">abv4 = gm1*(alphaavg*dr-uavg*dru-vavg*drv-wavg*drw+dre) - gm53*<code class="label">&</code></a>
<a name="riemannfluxi114"></a><a href="inviscidupwindflux.html#riemannfluxi112" target="diffFile"><code class="label">&          </code>drk</a>
<a name="riemannfluxi115"></a>        <a href="inviscidupwindflux.html#riemannfluxi113" target="diffFile">abv5 = sx*dru + sy*drv + sz*drw - unavg*dr</a>
<a name="riemannfluxi116"></a>        <a href="inviscidupwindflux.html#riemannfluxi114" target="diffFile">abv6 = abv3*abv4*ova2avg + abv2*abv5*ovaavg</a>
        <a href="inviscidupwindflux.html#riemannfluxi115" target="diffFile">abv7 = abv2*abv4*ovaavg + abv3*abv5</a>
<a href="inviscidupwindflux.html#riemannfluxi116" target="diffFile"><code class="comment">! Compute the dissipation term, -|a| (wr - wl), which is</code></a>
<a href="inviscidupwindflux.html#riemannfluxi116" target="diffFile"><code class="comment">! multiplied by porFlux. Note that porFlux is either</code></a>
<a name="riemannfluxi117"></a><a href="inviscidupwindflux.html#riemannfluxi116" target="diffFile"><code class="comment">! 0.0 or 0.5*rFil.</code></a>
<a name="riemannfluxi118"></a>        <a href="inviscidupwindflux.html#riemannfluxi116" target="diffFile">flux(irho) = -(porflux*(lam3*dr+abv6))</a>
<a name="riemannfluxi119"></a>        <a href="inviscidupwindflux.html#riemannfluxi117" target="diffFile">flux(imx) = -(porflux*(lam3*dru+uavg*abv6+sx*abv7))</a>
<a name="riemannfluxi120"></a>        <a href="inviscidupwindflux.html#riemannfluxi118" target="diffFile">flux(imy) = -(porflux*(lam3*drv+vavg*abv6+sy*abv7))</a>
        <a href="inviscidupwindflux.html#riemannfluxi119" target="diffFile">flux(imz) = -(porflux*(lam3*drw+wavg*abv6+sz*abv7))</a>
<a name="p16"></a><a name="riemannfluxi121"></a>        <a href="inviscidupwindflux.html#riemannfluxi120" target="diffFile">flux(irhoe) = -(porflux*(lam3*dre+havg*abv6+unavg*abv7))</a>
      <a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="keyword">CASE </code>(turkel) </a>
        <a href="msg.html#p16" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux.html#riemannfluxi121" target="diffFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE</code>(<code class="string">'riemannFlux'</code>, <code class="string">'Turkel preconditioner not '</code>, <code class="label">&</code></a>
<a href="inviscidupwindflux.html#riemannfluxi121" target="diffFile"><code class="label">&                 </code><code class="string">'implemented yet'</code>)</a>
<a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="comment">!          tmp = max(lam1,lam2,lam3)</code></a>
<a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="comment">!          flux(irho)  = -porFlux*(tmp*dr)</code></a>
<a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="comment">!          flux(imx)   = -porFlux*(tmp*dru)</code></a>
<a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="comment">!          flux(imy)   = -porFlux*(tmp*drv)</code></a>
<a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="comment">!          flux(imz)   = -porFlux*(tmp*drw)</code></a>
<a name="p17"></a><a name="riemannfluxi122"></a><a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="comment">!          flux(irhoE) = -porFlux*(tmp*drE)</code></a>
      <a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="keyword">CASE </code>(choimerkle) </a>
        <a href="msg.html#p17" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="inviscidupwindflux.html#riemannfluxi122" target="diffFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE</code>(<code class="string">'riemannFlux'</code>, <code class="string">'choi merkle preconditioner not '</code><code class="label">&</code></a>
<a href="inviscidupwindflux.html#riemannfluxi122" target="diffFile"><code class="label">&                 </code>, <code class="string">'implemented yet'</code>)</a>
<a name="riemannfluxi123"></a>      <a href="inviscidupwindflux.html#riemannfluxi23" target="diffFile"><code class="keyword">END SELECT</code></a>
    <a href="inviscidupwindflux.html#riemannfluxi22" target="diffFile"><code class="keyword">CASE </code>(vanleer) </a>
<a name="riemannfluxi124"></a>      <a href="inviscidupwindflux.html#riemannfluxi123" target="diffFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE</code>(<code class="string">'riemannFlux'</code>, <code class="string">'van leer fvs not implemented yet'</code>)</a>
    <a href="inviscidupwindflux.html#riemannfluxi22" target="diffFile"><code class="keyword">CASE </code>(ausmdv) </a>
      <a href="inviscidupwindflux.html#riemannfluxi124" target="diffFile"><code class="keyword">CALL </code><code class="funcname">TERMINATE</code>(<code class="string">'riemannFlux'</code>, <code class="string">'ausmdv fvs not implemented yet'</code>)</a>
    <a href="inviscidupwindflux.html#riemannfluxi22" target="diffFile"><code class="keyword">END SELECT</code></a>
  <a href="inviscidupwindflux.html#riemannflux" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">RIEMANNFLUX</code></a>
<a href="inviscidupwindflux.html#inviscidupwindflux" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">INVISCIDUPWINDFLUX</code></a>
</pre>
</body>
