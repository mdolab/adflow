<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="computeetot_spatial_d"></a><a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!  Differentiation of computeetot in forward (tangent) mode:</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!   variations   of useful results: *gamma *w</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!   with respect to varying inputs: *p *gamma *w</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * File:          computeEtot.F90                                 *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide, Steve Repsher              *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * Starting date: 08-13-2003                                      *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * Last modified: 10-14-2005                                      *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COMPUTEETOT_SPATIAL_D</code>(<code class="vardecl">istart</code>, <code class="vardecl">iend</code>, <code class="vardecl">jstart</code>, <code class="vardecl">jend</code>, <code class="vardecl">kstart</code>, <code class="label">&</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="label">&  </code><code class="vardecl">kend</code>, <code class="vardecl">correctfork</code>)</a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
<a name="computeetot_spatial_di0"></a>  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      * ComputeEtot computes the total energy from the given density,  *</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      * velocity and presssure. For a calorically and thermally        *</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      * perfect gas the well-known expression is used; for only a      *</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      * thermally perfect gas, cp is a function of temperature, curve  *</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      * fits are used and a more complex expression is obtained.       *</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      * It is assumed that the pointers in blockPointers already       *</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      * point to the correct block.                                    *</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a name="computeetot_spatial_di1"></a><a href="computeetot_p.html#computeetoti0" target="origFile"><code class="comment">!</code></a>
<a name="computeetot_spatial_di2"></a>  <a href="computeetot_p.html#computeetoti0" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">istart</code>, <code class="vardecl">iend</code>, <code class="vardecl">jstart</code>, <code class="vardecl">jend</code></a>
<a name="computeetot_spatial_di3"></a>  <a href="computeetot_p.html#computeetoti1" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kstart</code>, <code class="vardecl">kend</code></a>
  <a href="computeetot_p.html#computeetoti2" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">correctfork</code></a>
<a href="computeetot_p.html#computeetoti3" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetoti3" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="computeetot_spatial_di4"></a><a href="computeetot_p.html#computeetoti3" target="origFile"><code class="comment">!</code></a>
<a name="computeetot_spatial_di5"></a>  <a href="computeetot_p.html#computeetoti3" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code></a>
  <a href="computeetot_p.html#computeetoti4" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ovgm1</code>, <code class="vardecl">factk</code>, <code class="vardecl">scale</code></a>
<a href="computeetot_p.html#computeetoti5" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetoti5" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetoti5" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="computeetot_p.html#computeetoti5" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetoti5" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetoti5" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetoti5" target="origFile"><code class="comment">! Determine the cp model used in the computation.</code></a>
<a name="computeetot_spatial_di6"></a>  <a href="computeetot_p.html#computeetoti5" target="origFile"><code class="keyword">SELECT CASE </code> (cpmodel) </a>
  <a href="computeetot_p.html#computeetoti5" target="origFile"><code class="keyword">CASE </code>(cpconstant) </a>
<a href="computeetot_p.html#computeetoti6" target="origFile"><code class="comment">! Constant cp and thus constant gamma.</code></a>
<a name="computeetot_spatial_di7"></a><a href="computeetot_p.html#computeetoti6" target="origFile"><code class="comment">! Abbreviate 1/(gamma -1) a bit easier.</code></a>
    <a href="computeetot_p.html#computeetoti6" target="origFile">ovgm1 = one/(gammaconstant-one)</a>
<a href="computeetot_p.html#computeetoti7" target="origFile"><code class="comment">! Loop over the given range of the block and compute the first</code></a>
<a name="computeetot_spatial_di8"></a><a href="computeetot_p.html#computeetoti7" target="origFile"><code class="comment">! step of the energy.</code></a>
<a name="computeetot_spatial_di9"></a>    <a href="computeetot_p.html#computeetoti7" target="origFile"><code class="keyword">DO </code>k=kstart,kend</a>
<a name="computeetot_spatial_di10"></a>      <a href="computeetot_p.html#computeetoti8" target="origFile"><code class="keyword">DO </code>j=jstart,jend</a>
        <a href="computeetot_p.html#computeetoti9" target="origFile"><code class="keyword">DO </code>i=istart,iend</a>
          <a href="computeetot_p.html#computeetoti10" target="origFile">wd(i, j, k, irhoe) = ovgm1*pd(i, j, k) + half*(wd(i, j, k, <code class="label">&</code></a>
<a href="computeetot_p.html#computeetoti10" target="origFile"><code class="label">&            </code>irho)*(w(i, j, k, ivx)**<code class="constant">2</code>+w(i, j, k, ivy)**<code class="constant">2</code>+w(i, j, k, ivz)<code class="label">&</code></a>
<a href="computeetot_p.html#computeetoti10" target="origFile"><code class="label">&            </code>**<code class="constant">2</code>)+w(i, j, k, irho)*(<code class="constant">2</code>*w(i, j, k, ivx)*wd(i, j, k, ivx)+<code class="constant">2</code>*<code class="label">&</code></a>
<a href="computeetot_p.html#computeetoti10" target="origFile"><code class="label">&            </code>w(i, j, k, ivy)*wd(i, j, k, ivy)+<code class="constant">2</code>*w(i, j, k, ivz)*wd(i, j, <code class="label">&</code></a>
<a href="computeetot_p.html#computeetoti10" target="origFile"><code class="label">&            </code>k, ivz)))</a>
          <a href="computeetot_p.html#computeetoti10" target="origFile">w(i, j, k, irhoe) = ovgm1*p(i, j, k) + half*w(i, j, k, irho)*(<code class="label">&</code></a>
<a href="computeetot_p.html#computeetoti10" target="origFile"><code class="label">&            </code>w(i, j, k, ivx)**<code class="constant">2</code>+w(i, j, k, ivy)**<code class="constant">2</code>+w(i, j, k, ivz)**<code class="constant">2</code>)</a>
        <a href="computeetot_p.html#computeetoti9" target="origFile"><code class="keyword">END DO</code></a>
<a name="computeetot_spatial_di11"></a>      <a href="computeetot_p.html#computeetoti8" target="origFile"><code class="keyword">END DO</code></a>
    <a href="computeetot_p.html#computeetoti7" target="origFile"><code class="keyword">END DO</code></a>
<a href="computeetot_p.html#computeetoti11" target="origFile"><code class="comment">!write(14,40),i,j,k,w(i,j,k,irhoe)</code></a>
<a href="computeetot_p.html#computeetoti11" target="origFile"><code class="comment">! Second step. Correct the energy in case a turbulent kinetic</code></a>
<a name="computeetot_spatial_di12"></a><a href="computeetot_p.html#computeetoti11" target="origFile"><code class="comment">! energy is present.</code></a>
<a name="computeetot_spatial_di13"></a>    <a href="computeetot_p.html#computeetoti11" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
<a name="computeetot_spatial_di14"></a>      <a href="computeetot_p.html#computeetoti12" target="origFile">factk = ovgm1*(five*third-gammaconstant)</a>
<a name="computeetot_spatial_di15"></a>      <a href="computeetot_p.html#computeetoti13" target="origFile"><code class="keyword">DO </code>k=kstart,kend</a>
<a name="computeetot_spatial_di16"></a>        <a href="computeetot_p.html#computeetoti14" target="origFile"><code class="keyword">DO </code>j=jstart,jend</a>
          <a href="computeetot_p.html#computeetoti15" target="origFile"><code class="keyword">DO </code>i=istart,iend</a>
            <a href="computeetot_p.html#computeetoti16" target="origFile">wd(i, j, k, irhoe) = wd(i, j, k, irhoe) - factk*(wd(i, j, k<code class="label">&</code></a>
<a href="computeetot_p.html#computeetoti16" target="origFile"><code class="label">&              </code>, irho)*w(i, j, k, itu1)+w(i, j, k, irho)*wd(i, j, k, itu1<code class="label">&</code></a>
<a href="computeetot_p.html#computeetoti16" target="origFile"><code class="label">&              </code>))</a>
            <a href="computeetot_p.html#computeetoti16" target="origFile">w(i, j, k, irhoe) = w(i, j, k, irhoe) - factk*w(i, j, k, <code class="label">&</code></a>
<a href="computeetot_p.html#computeetoti16" target="origFile"><code class="label">&              </code>irho)*w(i, j, k, itu1)</a>
          <a href="computeetot_p.html#computeetoti15" target="origFile"><code class="keyword">END DO</code></a>
        <a href="computeetot_p.html#computeetoti14" target="origFile"><code class="keyword">END DO</code></a>
      <a href="computeetot_p.html#computeetoti13" target="origFile"><code class="keyword">END DO</code></a>
<a name="computeetot_spatial_di17"></a>    <a href="computeetot_p.html#computeetoti11" target="origFile"><code class="keyword">END IF</code></a>
  <a href="computeetot_p.html#computeetoti5" target="origFile"><code class="keyword">CASE </code>(cptempcurvefits) </a>
<a href="computeetot_p.html#computeetoti17" target="origFile"><code class="comment">!write(14,*),i,j,k,w(i,j,k,irhoE)</code></a>
<a href="computeetot_p.html#computeetoti17" target="origFile"><code class="comment">!        ================================================================</code></a>
<a href="computeetot_p.html#computeetoti17" target="origFile"><code class="comment">! Cp as function of the temperature is given via curve fits.</code></a>
<a href="computeetot_p.html#computeetoti17" target="origFile"><code class="comment">! Store a scale factor to compute the nonDimensional</code></a>
<a name="computeetot_spatial_di18"></a><a href="computeetot_p.html#computeetoti17" target="origFile"><code class="comment">! internal energy.</code></a>
    <a href="computeetot_p.html#computeetoti17" target="origFile">scale = rgas/tref</a>
<a name="computeetot_spatial_di19"></a><a href="computeetot_p.html#computeetoti18" target="origFile"><code class="comment">! Loop over the given range of the block.</code></a>
<a name="computeetot_spatial_di20"></a>    <a href="computeetot_p.html#computeetoti18" target="origFile"><code class="keyword">DO </code>k=kstart,kend</a>
<a name="computeetot_spatial_di21"></a>      <a href="computeetot_p.html#computeetoti19" target="origFile"><code class="keyword">DO </code>j=jstart,jend</a>
        <a href="computeetot_p.html#computeetoti20" target="origFile"><code class="keyword">DO </code>i=istart,iend</a>
          <a href="computeetot_p.html#computeetoti21" target="origFile"><code class="keyword">CALL </code><code class="funcname">COMPUTEETOTCELLCPFIT_SPATIAL_D</code>(i, j, k, scale, <code class="label">&</code></a>
<a href="computeetot_p.html#computeetoti21" target="origFile"><code class="label">&                                        </code>correctfork)</a>
        <a href="computeetot_p.html#computeetoti20" target="origFile"><code class="keyword">END DO</code></a>
      <a href="computeetot_p.html#computeetoti19" target="origFile"><code class="keyword">END DO</code></a>
    <a href="computeetot_p.html#computeetoti18" target="origFile"><code class="keyword">END DO</code></a>
  <a href="computeetot_p.html#computeetoti5" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
 <a href="computeetot_p.html#computeetot" target="origFile"><code class="label">40 </code><code class="keyword">FORMAT</code>(<code class="constant">1x,i4,i4,i4,e20.6</code>)</a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COMPUTEETOT_SPATIAL_D</code></a>
</pre>
</body>
