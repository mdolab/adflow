<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="computeetot_cd"></a><a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * File:          computeEtot.F90                                 *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide, Steve Repsher              *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * Starting date: 08-13-2003                                      *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * Last modified: 10-14-2005                                      *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">COMPUTEETOT_CD</code>(<code class="vardecl">istart</code>, <code class="vardecl">iend</code>, <code class="vardecl">jstart</code>, <code class="vardecl">jend</code>, <code class="vardecl">kstart</code>, <code class="vardecl">kend</code>, <code class="label">&</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="label">&  </code><code class="vardecl">correctfork</code>)</a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS_SPATIAL_D</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_SPATIAL_D</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * ComputeEtot computes the total energy from the given density,  *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * velocity and presssure. For a calorically and thermally        *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * perfect gas the well-known expression is used; for only a      *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * thermally perfect gas, cp is a function of temperature, curve  *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * fits are used and a more complex expression is obtained.       *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * It is assumed that the pointers in blockPointers already       *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * point to the correct block.                                    *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      Subroutine arguments.</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">istart</code>, <code class="vardecl">iend</code>, <code class="vardecl">jstart</code>, <code class="vardecl">jend</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">kstart</code>, <code class="vardecl">kend</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="typename">LOGICAL</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">correctfork</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      Local variables.</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">ovgm1</code>, <code class="vardecl">factk</code>, <code class="vardecl">scale</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! Determine the cp model used in the computation.</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">SELECT CASE </code> (cpmodel) </a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">CASE </code>(cpconstant) </a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! Constant cp and thus constant gamma.</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! Abbreviate 1/(gamma -1) a bit easier.</code></a>
    <a href="computeetot_p.html#computeetot" target="origFile">ovgm1 = one/(gammaconstant-one)</a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! Loop over the given range of the block and compute the first</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! step of the energy.</code></a>
    <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">DO </code>k=kstart,kend</a>
      <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">DO </code>j=jstart,jend</a>
        <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">DO </code>i=istart,iend</a>
          <a href="computeetot_p.html#computeetot" target="origFile">w(i, j, k, irhoe) = ovgm1*p(i, j, k) + half*w(i, j, k, irho)*(<code class="label">&</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="label">&            </code>w(i, j, k, ivx)**<code class="constant">2</code>+w(i, j, k, ivy)**<code class="constant">2</code>+w(i, j, k, ivz)**<code class="constant">2</code>)</a>
        <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END DO</code></a>
      <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END DO</code></a>
    <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END DO</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!write(14,40),i,j,k,w(i,j,k,irhoe)</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! Second step. Correct the energy in case a turbulent kinetic</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! energy is present.</code></a>
    <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">IF</code> (correctfork) <code class="keyword">THEN</code></a>
      <a href="computeetot_p.html#computeetot" target="origFile">factk = ovgm1*(five*third-gammaconstant)</a>
      <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">DO </code>k=kstart,kend</a>
        <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">DO </code>j=jstart,jend</a>
          <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">DO </code>i=istart,iend</a>
            <a href="computeetot_p.html#computeetot" target="origFile">w(i, j, k, irhoe) = w(i, j, k, irhoe) - factk*w(i, j, k, <code class="label">&</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="label">&              </code>irho)*w(i, j, k, itu1)</a>
          <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END DO</code></a>
        <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END DO</code></a>
      <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END DO</code></a>
    <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END IF</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">CASE </code>(cptempcurvefits) </a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!write(14,*),i,j,k,w(i,j,k,irhoE)</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!        ================================================================</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! Cp as function of the temperature is given via curve fits.</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! Store a scale factor to compute the nonDimensional</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! internal energy.</code></a>
    <a href="computeetot_p.html#computeetot" target="origFile">scale = rgas/tref</a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">! Loop over the given range of the block.</code></a>
    <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">DO </code>k=kstart,kend</a>
      <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">DO </code>j=jstart,jend</a>
        <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">DO </code>i=istart,iend</a>
          <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">CALL </code><code class="funcname">COMPUTEETOTCELLCPFIT_CD</code>(i, j, k, scale, correctfork)</a>
        <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END DO</code></a>
      <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END DO</code></a>
    <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END DO</code></a>
  <a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="comment">!</code></a>
 <a href="computeetot_p.html#computeetot" target="origFile"><code class="label">40 </code><code class="keyword">FORMAT</code>(<code class="constant">1x,i4,i4,i4,e20.6</code>)</a>
<a href="computeetot_p.html#computeetot" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">COMPUTEETOT_CD</code></a>
</pre>
</body>
