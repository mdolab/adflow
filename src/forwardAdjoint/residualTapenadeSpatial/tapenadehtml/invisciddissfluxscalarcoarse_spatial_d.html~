<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="invisciddissfluxscalarcoarse_spatial_d"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!  Differentiation of invisciddissfluxscalarcoarse in forward (tangent) mode:</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!   variations   of useful results: *w *fw</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!   with respect to varying inputs: *p *w *radi *radj *radk</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!      * File:          inviscidDissFluxScalarCoarse.f90                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!      * Author:        Edwin van der Weide                             *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!      * Starting date: 03-25-2003                                      *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!      * Last modified: 08-25-2005                                      *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">INVISCIDDISSFLUXSCALARCOARSE_SPATIAL_D</code>()</a>
  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="keyword">USE </code><code class="funcname">ITERATION_SPATIAL_D</code></a>
  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="keyword">USE </code><code class="funcname">INPUTDISCRETIZATION_SPATIAL_D</code></a>
  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_SPATIAL_D</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di0"></a>  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_SPATIAL_D</code></a>
  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      * inviscidDissFluxScalarCoarse computes the coarse grid, i.e.    *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      * 1st order, artificial dissipation flux for the scalar          *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      * dissipation scheme for a given block. Therefore it is assumed  *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      * that the pointers in blockPointers already point to the        *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      * correct block.                                                 *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di1"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="comment">!</code></a>
  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei0" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">k</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di2"></a>  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei1" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sfil</code>, <code class="vardecl">fis0</code>, <code class="vardecl">dis0</code>, <code class="vardecl">ppor</code>, <code class="vardecl">fs</code>, <code class="vardecl">rhoi</code></a>
  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">dis0d</code>, <code class="vardecl">fsd</code>, <code class="vardecl">rhoid</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="comment">!      * Begin execution                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="comment">!</code></a>
<a name="p13"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="comment">! Check if rFil == 0. If so, the dissipative flux needs not to</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="comment">! be computed.</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di3"></a>  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="keyword">IF</code> (</a><a href="msg.html#p13" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile">rfil .EQ. zero) <code class="keyword">THEN</code></a>
    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile">fwd = <code class="constant">0.0</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di4"></a>    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei3" target="origFile"><code class="keyword">RETURN</code></a>
  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="keyword">ELSE</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di5"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei4" target="origFile"><code class="comment">! Set a couple of constants for the scheme.</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di6"></a>    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei4" target="origFile">fis0 = rfil*vis2coarse</a>
    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei5" target="origFile">sfil = one - rfil</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei6" target="origFile"><code class="comment">! Replace the total energy by rho times the total enthalpy.</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei6" target="origFile"><code class="comment">! In this way the numerical solution is total enthalpy preserving</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei6" target="origFile"><code class="comment">! for the steady Euler equations. Also replace the velocities by</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei6" target="origFile"><code class="comment">! the momentum. As only first order halo's are needed, only include</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di7"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei6" target="origFile"><code class="comment">! the first order halo's.</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di8"></a>    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei6" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,ke</a>
<a name="invisciddissfluxscalarcoarse_spatial_di9"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei7" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,je</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei8" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,ie</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei9" target="origFile">wd(i, j, k, ivx) = wd(i, j, k, irho)*w(i, j, k, ivx) + w(i, j<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di10"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei9" target="origFile"><code class="label">&            </code>, k, irho)*wd(i, j, k, ivx)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei9" target="origFile">w(i, j, k, ivx) = w(i, j, k, irho)*w(i, j, k, ivx)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei10" target="origFile">wd(i, j, k, ivy) = wd(i, j, k, irho)*w(i, j, k, ivy) + w(i, j<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di11"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei10" target="origFile"><code class="label">&            </code>, k, irho)*wd(i, j, k, ivy)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei10" target="origFile">w(i, j, k, ivy) = w(i, j, k, irho)*w(i, j, k, ivy)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei11" target="origFile">wd(i, j, k, ivz) = wd(i, j, k, irho)*w(i, j, k, ivz) + w(i, j<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di12"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei11" target="origFile"><code class="label">&            </code>, k, irho)*wd(i, j, k, ivz)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei11" target="origFile">w(i, j, k, ivz) = w(i, j, k, irho)*w(i, j, k, ivz)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei12" target="origFile">wd(i, j, k, irhoe) = wd(i, j, k, irhoe) + pd(i, j, k)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei12" target="origFile">w(i, j, k, irhoe) = w(i, j, k, irhoe) + p(i, j, k)</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei8" target="origFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di13"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei7" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei6" target="origFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei13" target="origFile"><code class="comment">! Initialize the dissipative residual to a certain times,</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei13" target="origFile"><code class="comment">! possibly zero, the previously stored value. Owned cells</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di14"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei13" target="origFile"><code class="comment">! only, because the halo values do not matter.</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di15"></a>    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei13" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="invisciddissfluxscalarcoarse_spatial_di16"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei14" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei15" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="invisciddissfluxscalarcoarse_spatial_di17"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei16" target="origFile">fwd(i, j, k, irho) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei16" target="origFile">fw(i, j, k, irho) = sfil*fw(i, j, k, irho)</a>
<a name="invisciddissfluxscalarcoarse_spatial_di18"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei17" target="origFile">fwd(i, j, k, imx) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei17" target="origFile">fw(i, j, k, imx) = sfil*fw(i, j, k, imx)</a>
<a name="invisciddissfluxscalarcoarse_spatial_di19"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei18" target="origFile">fwd(i, j, k, imy) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei18" target="origFile">fw(i, j, k, imy) = sfil*fw(i, j, k, imy)</a>
<a name="invisciddissfluxscalarcoarse_spatial_di20"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei19" target="origFile">fwd(i, j, k, imz) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei19" target="origFile">fw(i, j, k, imz) = sfil*fw(i, j, k, imz)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei20" target="origFile">fwd(i, j, k, irhoe) = <code class="constant">0.0</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei20" target="origFile">fw(i, j, k, irhoe) = sfil*fw(i, j, k, irhoe)</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei15" target="origFile"><code class="keyword">END DO</code></a>
      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei14" target="origFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di21"></a>    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei13" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile">fwd = <code class="constant">0.0</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei21" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei21" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei21" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei21" target="origFile"><code class="comment">!      * Dissipative fluxes in the i-direction.                         *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei21" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei21" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di22"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei21" target="origFile"><code class="comment">!</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di23"></a>    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei21" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="invisciddissfluxscalarcoarse_spatial_di24"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei22" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei23" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,il</a>
<a name="invisciddissfluxscalarcoarse_spatial_di26"></a><a name="invisciddissfluxscalarcoarse_spatial_di25"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei24" target="origFile"><code class="comment">! Compute the dissipation coefficients for this face.</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di27"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei24" target="origFile">ppor = zero</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei25" target="origFile"><code class="keyword">IF</code> (pori(i, j, k) .EQ. normalflux) </a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei26" target="origFile">ppor = half</a>
<a name="invisciddissfluxscalarcoarse_spatial_di28"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei27" target="origFile">dis0d = fis0*ppor*(radid(i, j, k)+radid(i+<code class="constant">1</code>, j, k))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei27" target="origFile">dis0 = fis0*ppor*(radi(i, j, k)+radi(i+<code class="constant">1</code>, j, k))</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei28" target="origFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei28" target="origFile"><code class="comment">! Density.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei28" target="origFile">fsd = dis0d*(w(i+<code class="constant">1</code>, j, k, irho)-w(i, j, k, irho)) + dis0*(wd(i<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di29"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei28" target="origFile"><code class="label">&            </code>+<code class="constant">1</code>, j, k, irho)-wd(i, j, k, irho))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei28" target="origFile">fs = dis0*(w(i+<code class="constant">1</code>, j, k, irho)-w(i, j, k, irho))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di30"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei29" target="origFile">fwd(i+<code class="constant">1</code>, j, k, irho) = fwd(i+<code class="constant">1</code>, j, k, irho) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei29" target="origFile">fw(i+<code class="constant">1</code>, j, k, irho) = fw(i+<code class="constant">1</code>, j, k, irho) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di31"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei30" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei30" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei31" target="origFile"><code class="comment">! X-momentum.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei31" target="origFile">fsd = dis0d*(w(i+<code class="constant">1</code>, j, k, ivx)-w(i, j, k, ivx)) + dis0*(wd(i+<code class="constant">1</code><code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di32"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei31" target="origFile"><code class="label">&            </code>, j, k, ivx)-wd(i, j, k, ivx))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei31" target="origFile">fs = dis0*(w(i+<code class="constant">1</code>, j, k, ivx)-w(i, j, k, ivx))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di33"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei32" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imx) = fwd(i+<code class="constant">1</code>, j, k, imx) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei32" target="origFile">fw(i+<code class="constant">1</code>, j, k, imx) = fw(i+<code class="constant">1</code>, j, k, imx) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di34"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei33" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei33" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei34" target="origFile"><code class="comment">! Y-momentum.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei34" target="origFile">fsd = dis0d*(w(i+<code class="constant">1</code>, j, k, ivy)-w(i, j, k, ivy)) + dis0*(wd(i+<code class="constant">1</code><code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di35"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei34" target="origFile"><code class="label">&            </code>, j, k, ivy)-wd(i, j, k, ivy))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei34" target="origFile">fs = dis0*(w(i+<code class="constant">1</code>, j, k, ivy)-w(i, j, k, ivy))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di36"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei35" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imy) = fwd(i+<code class="constant">1</code>, j, k, imy) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei35" target="origFile">fw(i+<code class="constant">1</code>, j, k, imy) = fw(i+<code class="constant">1</code>, j, k, imy) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di37"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei36" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei36" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei37" target="origFile"><code class="comment">! Z-momentum.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei37" target="origFile">fsd = dis0d*(w(i+<code class="constant">1</code>, j, k, ivz)-w(i, j, k, ivz)) + dis0*(wd(i+<code class="constant">1</code><code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di38"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei37" target="origFile"><code class="label">&            </code>, j, k, ivz)-wd(i, j, k, ivz))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei37" target="origFile">fs = dis0*(w(i+<code class="constant">1</code>, j, k, ivz)-w(i, j, k, ivz))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di39"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei38" target="origFile">fwd(i+<code class="constant">1</code>, j, k, imz) = fwd(i+<code class="constant">1</code>, j, k, imz) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei38" target="origFile">fw(i+<code class="constant">1</code>, j, k, imz) = fw(i+<code class="constant">1</code>, j, k, imz) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di40"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei39" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei39" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei40" target="origFile"><code class="comment">! Energy.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei40" target="origFile">fsd = dis0d*(w(i+<code class="constant">1</code>, j, k, irhoe)-w(i, j, k, irhoe)) + dis0*(wd<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di41"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei40" target="origFile"><code class="label">&            </code>(i+<code class="constant">1</code>, j, k, irhoe)-wd(i, j, k, irhoe))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei40" target="origFile">fs = dis0*(w(i+<code class="constant">1</code>, j, k, irhoe)-w(i, j, k, irhoe))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di42"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei41" target="origFile">fwd(i+<code class="constant">1</code>, j, k, irhoe) = fwd(i+<code class="constant">1</code>, j, k, irhoe) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei41" target="origFile">fw(i+<code class="constant">1</code>, j, k, irhoe) = fw(i+<code class="constant">1</code>, j, k, irhoe) + fs</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei42" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei42" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei23" target="origFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di43"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei22" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei21" target="origFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei43" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei43" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei43" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei43" target="origFile"><code class="comment">!      * Dissipative fluxes in the j-direction.                         *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei43" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei43" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di44"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei43" target="origFile"><code class="comment">!</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di45"></a>    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei43" target="origFile"><code class="keyword">DO </code>k=<code class="constant">2</code>,kl</a>
<a name="invisciddissfluxscalarcoarse_spatial_di46"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei44" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,jl</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei45" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="invisciddissfluxscalarcoarse_spatial_di48"></a><a name="invisciddissfluxscalarcoarse_spatial_di47"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei46" target="origFile"><code class="comment">! Compute the dissipation coefficients for this face.</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di49"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei46" target="origFile">ppor = zero</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei47" target="origFile"><code class="keyword">IF</code> (porj(i, j, k) .EQ. normalflux) </a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei48" target="origFile">ppor = half</a>
<a name="invisciddissfluxscalarcoarse_spatial_di50"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei49" target="origFile">dis0d = fis0*ppor*(radjd(i, j, k)+radjd(i, j+<code class="constant">1</code>, k))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei49" target="origFile">dis0 = fis0*ppor*(radj(i, j, k)+radj(i, j+<code class="constant">1</code>, k))</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei50" target="origFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei50" target="origFile"><code class="comment">! Density.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei50" target="origFile">fsd = dis0d*(w(i, j+<code class="constant">1</code>, k, irho)-w(i, j, k, irho)) + dis0*(wd(i<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di51"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei50" target="origFile"><code class="label">&            </code>, j+<code class="constant">1</code>, k, irho)-wd(i, j, k, irho))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei50" target="origFile">fs = dis0*(w(i, j+<code class="constant">1</code>, k, irho)-w(i, j, k, irho))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di52"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei51" target="origFile">fwd(i, j+<code class="constant">1</code>, k, irho) = fwd(i, j+<code class="constant">1</code>, k, irho) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei51" target="origFile">fw(i, j+<code class="constant">1</code>, k, irho) = fw(i, j+<code class="constant">1</code>, k, irho) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di53"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei52" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei52" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei53" target="origFile"><code class="comment">! X-momentum.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei53" target="origFile">fsd = dis0d*(w(i, j+<code class="constant">1</code>, k, ivx)-w(i, j, k, ivx)) + dis0*(wd(i, <code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di54"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei53" target="origFile"><code class="label">&            </code>j+<code class="constant">1</code>, k, ivx)-wd(i, j, k, ivx))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei53" target="origFile">fs = dis0*(w(i, j+<code class="constant">1</code>, k, ivx)-w(i, j, k, ivx))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di55"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei54" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imx) = fwd(i, j+<code class="constant">1</code>, k, imx) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei54" target="origFile">fw(i, j+<code class="constant">1</code>, k, imx) = fw(i, j+<code class="constant">1</code>, k, imx) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di56"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei55" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei55" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei56" target="origFile"><code class="comment">! Y-momentum.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei56" target="origFile">fsd = dis0d*(w(i, j+<code class="constant">1</code>, k, ivy)-w(i, j, k, ivy)) + dis0*(wd(i, <code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di57"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei56" target="origFile"><code class="label">&            </code>j+<code class="constant">1</code>, k, ivy)-wd(i, j, k, ivy))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei56" target="origFile">fs = dis0*(w(i, j+<code class="constant">1</code>, k, ivy)-w(i, j, k, ivy))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di58"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei57" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imy) = fwd(i, j+<code class="constant">1</code>, k, imy) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei57" target="origFile">fw(i, j+<code class="constant">1</code>, k, imy) = fw(i, j+<code class="constant">1</code>, k, imy) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di59"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei58" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei58" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei59" target="origFile"><code class="comment">! Z-momentum.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei59" target="origFile">fsd = dis0d*(w(i, j+<code class="constant">1</code>, k, ivz)-w(i, j, k, ivz)) + dis0*(wd(i, <code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di60"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei59" target="origFile"><code class="label">&            </code>j+<code class="constant">1</code>, k, ivz)-wd(i, j, k, ivz))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei59" target="origFile">fs = dis0*(w(i, j+<code class="constant">1</code>, k, ivz)-w(i, j, k, ivz))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di61"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei60" target="origFile">fwd(i, j+<code class="constant">1</code>, k, imz) = fwd(i, j+<code class="constant">1</code>, k, imz) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei60" target="origFile">fw(i, j+<code class="constant">1</code>, k, imz) = fw(i, j+<code class="constant">1</code>, k, imz) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di62"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei61" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei61" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei62" target="origFile"><code class="comment">! Energy</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei62" target="origFile">fsd = dis0d*(w(i, j+<code class="constant">1</code>, k, irhoe)-w(i, j, k, irhoe)) + dis0*(wd<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di63"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei62" target="origFile"><code class="label">&            </code>(i, j+<code class="constant">1</code>, k, irhoe)-wd(i, j, k, irhoe))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei62" target="origFile">fs = dis0*(w(i, j+<code class="constant">1</code>, k, irhoe)-w(i, j, k, irhoe))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di64"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei63" target="origFile">fwd(i, j+<code class="constant">1</code>, k, irhoe) = fwd(i, j+<code class="constant">1</code>, k, irhoe) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei63" target="origFile">fw(i, j+<code class="constant">1</code>, k, irhoe) = fw(i, j+<code class="constant">1</code>, k, irhoe) + fs</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei64" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei64" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei45" target="origFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di65"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei44" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei43" target="origFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei65" target="origFile"><code class="comment">!</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei65" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei65" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei65" target="origFile"><code class="comment">!      * Dissipative fluxes in the k-direction.                         *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei65" target="origFile"><code class="comment">!      *                                                                *</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei65" target="origFile"><code class="comment">!      ******************************************************************</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di66"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei65" target="origFile"><code class="comment">!</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di67"></a>    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei65" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,kl</a>
<a name="invisciddissfluxscalarcoarse_spatial_di68"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei66" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,jl</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei67" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,il</a>
<a name="invisciddissfluxscalarcoarse_spatial_di70"></a><a name="invisciddissfluxscalarcoarse_spatial_di69"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei68" target="origFile"><code class="comment">! Compute the dissipation coefficients for this face.</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di71"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei68" target="origFile">ppor = zero</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei69" target="origFile"><code class="keyword">IF</code> (pork(i, j, k) .EQ. normalflux) </a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei70" target="origFile">ppor = half</a>
<a name="invisciddissfluxscalarcoarse_spatial_di72"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei71" target="origFile">dis0d = fis0*ppor*(radkd(i, j, k)+radkd(i, j, k+<code class="constant">1</code>))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei71" target="origFile">dis0 = fis0*ppor*(radk(i, j, k)+radk(i, j, k+<code class="constant">1</code>))</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei72" target="origFile"><code class="comment">! Compute and scatter the dissipative flux.</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei72" target="origFile"><code class="comment">! Density.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei72" target="origFile">fsd = dis0d*(w(i, j, k+<code class="constant">1</code>, irho)-w(i, j, k, irho)) + dis0*(wd(i<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di73"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei72" target="origFile"><code class="label">&            </code>, j, k+<code class="constant">1</code>, irho)-wd(i, j, k, irho))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei72" target="origFile">fs = dis0*(w(i, j, k+<code class="constant">1</code>, irho)-w(i, j, k, irho))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di74"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei73" target="origFile">fwd(i, j, k+<code class="constant">1</code>, irho) = fwd(i, j, k+<code class="constant">1</code>, irho) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei73" target="origFile">fw(i, j, k+<code class="constant">1</code>, irho) = fw(i, j, k+<code class="constant">1</code>, irho) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di75"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei74" target="origFile">fwd(i, j, k, irho) = fwd(i, j, k, irho) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei74" target="origFile">fw(i, j, k, irho) = fw(i, j, k, irho) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei75" target="origFile"><code class="comment">! X-momentum.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei75" target="origFile">fsd = dis0d*(w(i, j, k+<code class="constant">1</code>, ivx)-w(i, j, k, ivx)) + dis0*(wd(i, <code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di76"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei75" target="origFile"><code class="label">&            </code>j, k+<code class="constant">1</code>, ivx)-wd(i, j, k, ivx))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei75" target="origFile">fs = dis0*(w(i, j, k+<code class="constant">1</code>, ivx)-w(i, j, k, ivx))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di77"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei76" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imx) = fwd(i, j, k+<code class="constant">1</code>, imx) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei76" target="origFile">fw(i, j, k+<code class="constant">1</code>, imx) = fw(i, j, k+<code class="constant">1</code>, imx) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di78"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei77" target="origFile">fwd(i, j, k, imx) = fwd(i, j, k, imx) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei77" target="origFile">fw(i, j, k, imx) = fw(i, j, k, imx) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei78" target="origFile"><code class="comment">! Y-momentum.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei78" target="origFile">fsd = dis0d*(w(i, j, k+<code class="constant">1</code>, ivy)-w(i, j, k, ivy)) + dis0*(wd(i, <code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di79"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei78" target="origFile"><code class="label">&            </code>j, k+<code class="constant">1</code>, ivy)-wd(i, j, k, ivy))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei78" target="origFile">fs = dis0*(w(i, j, k+<code class="constant">1</code>, ivy)-w(i, j, k, ivy))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di80"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei79" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imy) = fwd(i, j, k+<code class="constant">1</code>, imy) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei79" target="origFile">fw(i, j, k+<code class="constant">1</code>, imy) = fw(i, j, k+<code class="constant">1</code>, imy) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di81"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei80" target="origFile">fwd(i, j, k, imy) = fwd(i, j, k, imy) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei80" target="origFile">fw(i, j, k, imy) = fw(i, j, k, imy) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei81" target="origFile"><code class="comment">! Z-momentum.</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei81" target="origFile">fsd = dis0d*(w(i, j, k+<code class="constant">1</code>, ivz)-w(i, j, k, ivz)) + dis0*(wd(i, <code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di82"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei81" target="origFile"><code class="label">&            </code>j, k+<code class="constant">1</code>, ivz)-wd(i, j, k, ivz))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei81" target="origFile">fs = dis0*(w(i, j, k+<code class="constant">1</code>, ivz)-w(i, j, k, ivz))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di83"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei82" target="origFile">fwd(i, j, k+<code class="constant">1</code>, imz) = fwd(i, j, k+<code class="constant">1</code>, imz) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei82" target="origFile">fw(i, j, k+<code class="constant">1</code>, imz) = fw(i, j, k+<code class="constant">1</code>, imz) + fs</a>
<a name="invisciddissfluxscalarcoarse_spatial_di84"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei83" target="origFile">fwd(i, j, k, imz) = fwd(i, j, k, imz) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei83" target="origFile">fw(i, j, k, imz) = fw(i, j, k, imz) - fs</a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei84" target="origFile"><code class="comment">! Energy</code></a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei84" target="origFile">fsd = dis0d*(w(i, j, k+<code class="constant">1</code>, irhoe)-w(i, j, k, irhoe)) + dis0*(wd<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di85"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei84" target="origFile"><code class="label">&            </code>(i, j, k+<code class="constant">1</code>, irhoe)-wd(i, j, k, irhoe))</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei84" target="origFile">fs = dis0*(w(i, j, k+<code class="constant">1</code>, irhoe)-w(i, j, k, irhoe))</a>
<a name="invisciddissfluxscalarcoarse_spatial_di86"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei85" target="origFile">fwd(i, j, k+<code class="constant">1</code>, irhoe) = fwd(i, j, k+<code class="constant">1</code>, irhoe) + fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei85" target="origFile">fw(i, j, k+<code class="constant">1</code>, irhoe) = fw(i, j, k+<code class="constant">1</code>, irhoe) + fs</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei86" target="origFile">fwd(i, j, k, irhoe) = fwd(i, j, k, irhoe) - fsd</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei86" target="origFile">fw(i, j, k, irhoe) = fw(i, j, k, irhoe) - fs</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei67" target="origFile"><code class="keyword">END DO</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di87"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei66" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei65" target="origFile"><code class="keyword">END DO</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei87" target="origFile"><code class="comment">! Replace rho times the total enthalpy by the total energy and</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei87" target="origFile"><code class="comment">! store the velocities again instead of the momentum. As only</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di88"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei87" target="origFile"><code class="comment">! the first halo cells are included, this must be done here again.</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di89"></a>    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei87" target="origFile"><code class="keyword">DO </code>k=<code class="constant">1</code>,ke</a>
<a name="invisciddissfluxscalarcoarse_spatial_di90"></a>      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei88" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,je</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei89" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,ie</a>
<a name="invisciddissfluxscalarcoarse_spatial_di91"></a>          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei90" target="origFile">rhoid = -(one*wd(i, j, k, irho)/w(i, j, k, irho)**<code class="constant">2</code>)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei90" target="origFile">rhoi = one/w(i, j, k, irho)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei91" target="origFile">wd(i, j, k, ivx) = wd(i, j, k, ivx)*rhoi + w(i, j, k, ivx)*<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di92"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei91" target="origFile"><code class="label">&            </code>rhoid</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei91" target="origFile">w(i, j, k, ivx) = w(i, j, k, ivx)*rhoi</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei92" target="origFile">wd(i, j, k, ivy) = wd(i, j, k, ivy)*rhoi + w(i, j, k, ivy)*<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di93"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei92" target="origFile"><code class="label">&            </code>rhoid</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei92" target="origFile">w(i, j, k, ivy) = w(i, j, k, ivy)*rhoi</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei93" target="origFile">wd(i, j, k, ivz) = wd(i, j, k, ivz)*rhoi + w(i, j, k, ivz)*<code class="label">&</code></a>
<a name="invisciddissfluxscalarcoarse_spatial_di94"></a><a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei93" target="origFile"><code class="label">&            </code>rhoid</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei93" target="origFile">w(i, j, k, ivz) = w(i, j, k, ivz)*rhoi</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei94" target="origFile">wd(i, j, k, irhoe) = wd(i, j, k, irhoe) - pd(i, j, k)</a>
          <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei94" target="origFile">w(i, j, k, irhoe) = w(i, j, k, irhoe) - p(i, j, k)</a>
        <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei89" target="origFile"><code class="keyword">END DO</code></a>
      <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei88" target="origFile"><code class="keyword">END DO</code></a>
    <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei87" target="origFile"><code class="keyword">END DO</code></a>
  <a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarsei2" target="origFile"><code class="keyword">END IF</code></a>
<a href="invisciddissfluxscalarcoarse_p.html#invisciddissfluxscalarcoarse" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">INVISCIDDISSFLUXSCALARCOARSE_SPATIAL_D</code></a>
</pre>
</body>
