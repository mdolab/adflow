!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!
!      ******************************************************************
!      *                                                                *
!      * File:          bcEddyWall.f90                                  *
!      * Author:        Georgi Kalitzin, Edwin van der Weide            *
!      * Starting date: 06-11-2003                                      *
!      * Last modified: 04-11-2005                                      *
!      *                                                                *
!      ******************************************************************
!
SUBROUTINE BCEDDYWALL_CD(nn)
  USE BCTYPES_SPATIAL_D
  USE BLOCKPOINTERS_SPATIAL_D
  IMPLICIT NONE
!
!      ******************************************************************
!      *                                                                *
!      * bcEddyWall sets the eddy viscosity in the halo cells of        *
!      * viscous subface nn of the block given in blockPointers.        *
!      * As the eddy viscosity is zero at the wall, the value in the    *
!      * halo is simply the negative value of the first interior cell.  *
!      *                                                                *
!      ******************************************************************
!
!
!      Subroutine arguments.
!
  INTEGER(kind=inttype), INTENT(IN) :: nn
!
!      Local variables.
!
  INTEGER(kind=inttype) :: i, j
  REAL(kind=realtype), DIMENSION(:, :), POINTER :: rev1, rev2
!
!      ******************************************************************
!      *                                                                *
!      * Begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! Determine the face id on which the subface is located and
! set the pointers rev1 and rev2 accordingly.
  SELECT CASE  (bcfaceid(nn)) 
  CASE (imin) 
    rev1 => rev(1, 1:, 1:)
    rev2 => rev(2, 1:, 1:)
  CASE (imax) 
    rev1 => rev(ie, 1:, 1:)
    rev2 => rev(il, 1:, 1:)
  CASE (jmin) 
    rev1 => rev(1:, 1, 1:)
    rev2 => rev(1:, 2, 1:)
  CASE (jmax) 
    rev1 => rev(1:, je, 1:)
    rev2 => rev(1:, jl, 1:)
  CASE (kmin) 
    rev1 => rev(1:, 1:, 1)
    rev2 => rev(1:, 1:, 2)
  CASE (kmax) 
    rev1 => rev(1:, 1:, ke)
    rev2 => rev(1:, 1:, kl)
  END SELECT
! Loop over the faces of the subface and set the eddy
! viscosity in the halo cells.
  DO j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
    DO i=bcdata(nn)%icbeg,bcdata(nn)%icend
      rev1(i, j) = -rev2(i, j)
    END DO
  END DO
END SUBROUTINE BCEDDYWALL_CD
