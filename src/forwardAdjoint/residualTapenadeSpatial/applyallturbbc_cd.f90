!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!
!      ******************************************************************
!      *                                                                *
!      * File:          applyAllTurbBC.f90                              *
!      * Author:        Edwin van der Weide, Georgi Kalitzin            *
!      * Starting date: 05-01-2003                                      *
!      * Last modified: 06-12-2005                                      *
!      *                                                                *
!      ******************************************************************
!
SUBROUTINE APPLYALLTURBBC_CD(secondhalo)
  USE ITERATION_SPATIAL_D
  USE INPUTTIMESPECTRAL_SPATIAL_D
  USE BLOCKPOINTERS_SPATIAL_D
  IMPLICIT NONE
!
!      ******************************************************************
!      *                                                                *
!      * applyAllTurbBC applies all boundary conditions to the          *
!      * turbulent transport equations for the all blocks on the grid   *
!      * level currentLevel.                                            *
!      *                                                                *
!      ******************************************************************
!
!
!      Subroutine arguments.
!
  LOGICAL, INTENT(IN) :: secondhalo
!
!      Local variables.
!
  INTEGER(kind=inttype) :: nn, sps
  EXTERNAL SETPOINTERS
  INTEGER(kind=inttype) :: min1
  INTRINSIC MIN
!
!      ******************************************************************
!      *                                                                *
!      * Begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! Loop over the number of spectral modes and local blocks.
  DO sps=1,ntimeintervalsspectral
    DO nn=1,ndom
      IF (currentlevel .GT. groundlevel) THEN
        min1 = groundlevel
      ELSE
        min1 = currentlevel
      END IF
! Set the pointers to this block. The min function is present
! because this routine can be called from movfin.
      CALL SETPOINTERS(nn, min1, sps)
! Set the arrays for the boundary condition treatment
! and set the turbulent halo values.
      CALL BCTURBTREATMENT_CD()
      CALL APPLYALLTURBBCTHISBLOCK_CD(secondhalo)
    END DO
  END DO
END SUBROUTINE APPLYALLTURBBC_CD
