!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!      ==================================================================
SUBROUTINE COMPUTEETOTBNDRYLIST_CD(correctfork)
  USE INPUTPHYSICS_SPATIAL_D
  USE BLOCKPOINTERS_SPATIAL_D
  USE FLOWVARREFSTATE_SPATIAL_D
  IMPLICIT NONE
!
!      ******************************************************************
!      *                                                                *
!      * ComputeEtotBndryList is identical to computeEtot except        *
!      * it computes total energy for the overset bndry index list.     *
!      *                                                                *
!      ******************************************************************
!
!
!      Subroutine arguments.
!
  LOGICAL, INTENT(IN) :: correctfork
!
!      Local variables.
!
  INTEGER(kind=inttype) :: i, j, k, mm
  REAL(kind=realtype) :: ovgm1, factk, scale
!
!      ******************************************************************
!      *                                                                *
!      * Begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! Determine the cp model used in the computation.
  SELECT CASE  (cpmodel) 
  CASE (cpconstant) 
! Constant cp and thus constant gamma.
! Abbreviate 1/(gamma -1) a bit easier.
    ovgm1 = one/(gammaconstant-one)
! Loop over the given indices of the block and compute the first
! step of the energy.
    DO mm=1,ncellsoversetall
      i = ibndry(1, mm)
      j = ibndry(2, mm)
      k = ibndry(3, mm)
      w(i, j, k, irhoe) = ovgm1*p(i, j, k) + half*w(i, j, k, irho)*(w(i&
&        , j, k, ivx)**2+w(i, j, k, ivy)**2+w(i, j, k, ivz)**2)
    END DO
! Second step. Correct the energy in case a turbulent kinetic
! energy is present.
    IF (correctfork) THEN
      factk = ovgm1*(five*third-gammaconstant)
      DO mm=1,ncellsoversetall
        i = ibndry(1, mm)
        j = ibndry(2, mm)
        k = ibndry(3, mm)
        w(i, j, k, irhoe) = w(i, j, k, irhoe) - factk*w(i, j, k, irho)*w&
&          (i, j, k, itu1)
      END DO
    END IF
  CASE (cptempcurvefits) 
!        ================================================================
! Cp as function of the temperature is given via curve fits.
! Store a scale factor to compute the nonDimensional
! internal energy.
    scale = rgas/tref
! Loop over the given range of the block.
    DO mm=1,ncellsoversetall
      i = ibndry(1, mm)
      j = ibndry(2, mm)
      k = ibndry(3, mm)
      CALL COMPUTEETOTCELLCPFIT_CD(i, j, k, scale, correctfork)
    END DO
  END SELECT
END SUBROUTINE COMPUTEETOTBNDRYLIST_CD
