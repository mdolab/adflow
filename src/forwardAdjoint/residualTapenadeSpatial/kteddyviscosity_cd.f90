!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!      ==================================================================
SUBROUTINE KTEDDYVISCOSITY_CD()
  USE CONSTANTS_SPATIAL_D
  USE BLOCKPOINTERS_SPATIAL_D
  IMPLICIT NONE
!
!      ******************************************************************
!      *                                                                *
!      * ktEddyViscosity computes the eddy viscosity according to the   *
!      * k-tau turbulence model for the block given in blockPointers.   *
!      *                                                                *
!      ******************************************************************
!
!
!      Local variables.
!
  INTEGER(kind=inttype) :: i, j, k
  INTRINSIC ABS
  REAL(kind=realtype) :: x1
!
!      ******************************************************************
!      *                                                                *
!      * Begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! Loop over the cells of this block and compute the eddy viscosity.
! Do not include halo's.
  DO k=2,kl
    DO j=2,jl
      DO i=2,il
        x1 = w(i, j, k, irho)*w(i, j, k, itu1)*w(i, j, k, itu2)
        IF (x1 .GE. 0.) THEN
          rev(i, j, k) = x1
        ELSE
          rev(i, j, k) = -x1
        END IF
      END DO
    END DO
  END DO
END SUBROUTINE KTEDDYVISCOSITY_CD
