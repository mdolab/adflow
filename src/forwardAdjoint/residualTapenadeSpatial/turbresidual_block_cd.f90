!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!
!      ******************************************************************
!      *                                                                *
!      * File:          turbResidual.f90                                *
!      * Author:        Edwin van der Weide                             *
!      * Starting date: 05-01-2003                                      *
!      * Last modified: 04-11-2005                                      *
!      *                                                                *
!      ******************************************************************
!
SUBROUTINE TURBRESIDUAL_BLOCK_CD()
  USE INPUTPHYSICS_SPATIAL_D
  USE ITERATION_SPATIAL_D
  USE INPUTDISCRETIZATION_SPATIAL_D
  USE TURBMOD_SPATIAL_D
  IMPLICIT NONE
!
!      ******************************************************************
!      *                                                                *
!      * turbResidual computes the residual of the residual of the      *
!      * turbulent transport equations on the current multigrid level.  *
!      *                                                                *
!      ******************************************************************
!
!
!      ******************************************************************
!      *                                                                *
!      * Begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! Determine whether or not a second order discretization for the
! advective terms must be used.
  secondord = .false.
  IF (currentlevel .EQ. 1_intType .AND. orderturb .EQ. secondorder) &
&    secondord = .true.
! Compute the quantities for certain turbulence models that
! need to be communicated between blocks.
!   select case (turbModel)
!   case (menterSST)
!      call f1SST
!   end select
! Determine the turbulence model we have to solve for.
  SELECT CASE  (turbmodel) 
  CASE (spalartallmaras) 
!  case (baldwinLomax)
!      call bl(.true.)
    CALL SA_BLOCK_CD(.true.)
  CASE DEFAULT
!   case (komegaWilcox, komegaModified)
!      call kw(.true.)
!   case (menterSST)
!      call SST(.true.)
!   case (ktau)
!      call kt(.true.)
!   case (v2f)
!      call vf(.true.)
    CALL TERMINATE_CD('turbResidual', &
&                'Turbulence model not implemented yet')
  END SELECT
END SUBROUTINE TURBRESIDUAL_BLOCK_CD
