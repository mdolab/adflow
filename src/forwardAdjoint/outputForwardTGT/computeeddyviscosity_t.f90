   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.7 (r4786) - 21 Feb 2013 15:53
   !
   !  Differentiation of computeeddyviscosity in forward (tangent) mode (with options debugTangent i4 dr8 r8):
   !   variations   of useful results: *rev
   !   with respect to varying inputs: *w *rlv
   !   Plus diff mem management of: rev:in w:in rlv:in
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          computeEddyViscosity.f90                        *
   !      * Author:        Georgi Kalitzin, Edwin van der Weide            *
   !      * Starting date: 03-10-2003                                      *
   !      * Last modified: 06-12-2005                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE COMPUTEEDDYVISCOSITY_T()
   USE ITERATION
   USE FLOWVARREFSTATE
   USE BLOCKPOINTERS_D
   USE INPUTPHYSICS
   USE DIFFSIZES
   !  Hint: ISIZE3OFDrfrlv should be the size of dimension 3 of array *rlv
   !  Hint: ISIZE2OFDrfrlv should be the size of dimension 2 of array *rlv
   !  Hint: ISIZE1OFDrfrlv should be the size of dimension 1 of array *rlv
   !  Hint: ISIZE4OFDrfw should be the size of dimension 4 of array *w
   !  Hint: ISIZE3OFDrfw should be the size of dimension 3 of array *w
   !  Hint: ISIZE2OFDrfw should be the size of dimension 2 of array *w
   !  Hint: ISIZE1OFDrfw should be the size of dimension 1 of array *w
   !  Hint: ISIZE3OFDrfrev should be the size of dimension 3 of array *rev
   !  Hint: ISIZE2OFDrfrev should be the size of dimension 2 of array *rev
   !  Hint: ISIZE1OFDrfrev should be the size of dimension 1 of array *rev
   IMPLICIT NONE
   !
   !      ******************************************************************
   !      *                                                                *
   !      * computeEddyViscosity computes the eddy viscosity in the        *
   !      * owned cell centers of the given block. It is assumed that the  *
   !      * pointes already point to the correct block before entering     *
   !      * this subroutine.                                               *
   !      *                                                                *
   !      ******************************************************************
   !
   !
   !      Local variables.
   !
   LOGICAL :: returnimmediately
   EXTERNAL DEBUG_TGT_HERE
   LOGICAL :: DEBUG_TGT_HERE
   IF (.TRUE. .AND. DEBUG_TGT_HERE('entry', .FALSE.)) THEN
   CALL DEBUG_TGT_REAL8ARRAY('w', w, wd, ISIZE1OFDrfw*ISIZE2OFDrfw*&
   &                        ISIZE3OFDrfw*ISIZE4OFDrfw)
   CALL DEBUG_TGT_REAL8ARRAY('rlv', rlv, rlvd, ISIZE1OFDrfrlv*&
   &                        ISIZE2OFDrfrlv*ISIZE3OFDrfrlv)
   CALL DEBUG_TGT_DISPLAY('entry')
   END IF
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Begin execution                                                *
   !      *                                                                *
   !      ******************************************************************
   !
   ! Check if an immediate return can be made.
   IF (eddymodel) THEN
   IF (currentlevel .LE. groundlevel .OR. turbcoupled) THEN
   returnimmediately = .false.
   ELSE
   returnimmediately = .true.
   END IF
   ELSE
   IF (.TRUE. .AND. DEBUG_TGT_HERE('middle', .FALSE.)) THEN
   CALL DEBUG_TGT_REAL8ARRAY('w', w, wd, ISIZE1OFDrfw*ISIZE2OFDrfw*&
   &                          ISIZE3OFDrfw*ISIZE4OFDrfw)
   CALL DEBUG_TGT_REAL8ARRAY('rlv', rlv, rlvd, ISIZE1OFDrfrlv*&
   &                          ISIZE2OFDrfrlv*ISIZE3OFDrfrlv)
   CALL DEBUG_TGT_DISPLAY('middle')
   END IF
   returnimmediately = .true.
   END IF
   IF (returnimmediately) THEN
   revd = 0.0_8
   IF (.TRUE. .AND. DEBUG_TGT_HERE('exit', .FALSE.)) THEN
   CALL DEBUG_TGT_REAL8ARRAY('rev', rev, revd, ISIZE1OFDrfrev*&
   &                          ISIZE2OFDrfrev*ISIZE3OFDrfrev)
   CALL DEBUG_TGT_DISPLAY('exit')
   END IF
   RETURN
   ELSE
   ! Determine the turbulence model and call the appropriate
   ! routine to compute the eddy viscosity.
   SELECT CASE  (turbmodel) 
   CASE (spalartallmaras, spalartallmarasedwards) 
   revd = 0.0_8
   CALL DEBUG_TGT_CALL('SAEDDYVISCOSITY', .TRUE., .FALSE.)
   CALL SAEDDYVISCOSITY_T()
   CALL DEBUG_TGT_EXIT()
   CASE DEFAULT
   revd = 0.0_8
   END SELECT
   END IF
   IF (.TRUE. .AND. DEBUG_TGT_HERE('exit', .FALSE.)) THEN
   CALL DEBUG_TGT_REAL8ARRAY('rev', rev, revd, ISIZE1OFDrfrev*&
   &                        ISIZE2OFDrfrev*ISIZE3OFDrfrev)
   CALL DEBUG_TGT_DISPLAY('exit')
   END IF
   END SUBROUTINE COMPUTEEDDYVISCOSITY_T
