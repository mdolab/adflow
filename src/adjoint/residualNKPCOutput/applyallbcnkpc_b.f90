   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
   !
   !  Differentiation of applyallbcnkpc in reverse (adjoint) mode:
   !   gradient     of useful results: padj wadj
   !   with respect to varying inputs: padj wadj
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          applyAllBCAdj.f90                               *
   !      * Author:        Edwin van der Weide, Seonghyeon Hahn            *
   !      *                C.A.(Sandy) Mader                               *
   !      * Starting date: 04-16-2008                                      *
   !      * Last modified: 04-17-2008                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE APPLYALLBCNKPC_B(winfadj, pinfcorradj, wadj, wadjb, padj, &
   &  padjb, sadj, siadj, sjadj, skadj, voladj, normadj, rfaceadj, icell, &
   &  jcell, kcell, secondhalo, nn, level, sps, sps2)
   USE BLOCKPOINTERS
   USE INPUTTIMESPECTRAL
   USE BCTYPES
   USE INPUTDISCRETIZATION
   USE FLOWVARREFSTATE
   IMPLICIT NONE
   !
   !      ******************************************************************
   !      *                                                                *
   !      * applyAllBCAdj applies the possible boundary conditions for the *
   !      * halo cells adjacent to the cell for which the residual needs   *
   !      * to be computed.                                                *
   !      *                                                                *
   !      ******************************************************************
   !
   !, only : ie, ib, je, jb, ke, kb, nBocos, &
   !         BCFaceID, BCType, BCData,p,w
   !precond,choimerkle, etc...
   !nIntervalTimespectral
   !
   !      Subroutine arguments.
   !
   LOGICAL :: secondhalo
   INTEGER(kind=inttype) :: icell, jcell, kcell
   INTEGER(kind=inttype) :: nn, level, sps, sps2
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
   &  ntimeintervalsspectral), INTENT(INOUT) :: wadj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
   &  ntimeintervalsspectral) :: wadjb
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
   &  ntimeintervalsspectral), INTENT(INOUT) :: padj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
   &  ntimeintervalsspectral) :: padjb
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, 3, &
   &  ntimeintervalsspectral), INTENT(IN) :: sadj
   REAL(kind=realtype), DIMENSION(-3:2, -3:2, -3:2, 3, &
   &  ntimeintervalsspectral), INTENT(IN) :: siadj, sjadj, skadj
   REAL(kind=realtype), DIMENSION(ntimeintervalsspectral), INTENT(IN) :: &
   &  voladj
   REAL(kind=realtype), INTENT(IN) :: pinfcorradj
   REAL(kind=realtype), DIMENSION(nbocos, -2:2, -2:2, 3, &
   &  ntimeintervalsspectral), INTENT(IN) :: normadj
   REAL(kind=realtype), DIMENSION(nbocos, -2:2, -2:2, &
   &  ntimeintervalsspectral), INTENT(IN) :: rfaceadj
   REAL(kind=realtype), DIMENSION(nw), INTENT(IN) :: winfadj
   !
   !      Local variables.
   !
   INTEGER(kind=inttype) :: i, j, k, ii, jj, kk, l
   INTEGER(kind=inttype) :: istart, iend, jstart, jend, kstart, kend
   LOGICAL :: correctfork
   INTEGER :: branch
   CALL PUSHBOOLEAN(secondhalo)
   CALL PUSHREAL8ARRAY(padj, realtype*5**3*ntimeintervalsspectral/8)
   CALL PUSHREAL8ARRAY(wadj, realtype*5**3*nw*ntimeintervalsspectral/8)
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Begin execution                                                *
   !      *                                                                *
   !      ******************************************************************
   !
   CALL BCSYMMNKPC(wadj, padj, normadj, icell, jcell, kcell, &
   &               secondhalo, nn, level, sps, sps2)
   SELECT CASE  (precond) 
   CASE (noprecond) 
   CALL PUSHREAL8ARRAY(padj, realtype*5**3*ntimeintervalsspectral/8)
   CALL PUSHREAL8ARRAY(wadj, realtype*5**3*nw*ntimeintervalsspectral/8)
   CALL PUSHBOOLEAN(secondhalo)
   CALL BCFARFIELDNKPC(secondhalo, winfadj, pinfcorradj, wadj, padj&
   &                     , siadj, sjadj, skadj, normadj, rfaceadj, icell, &
   &                     jcell, kcell, nn, level, sps, sps2)
   CALL PUSHINTEGER4(1)
   CASE (turkel) 
   CALL PUSHINTEGER4(0)
   CASE (choimerkle) 
   CALL PUSHINTEGER4(0)
   CASE DEFAULT
   CALL PUSHINTEGER4(0)
   END SELECT
   CALL BCEULERWALLNKPC_B(secondhalo, wadj, wadjb, padj, padjb, sadj, &
   &                   siadj, sjadj, skadj, normadj, rfaceadj, icell, jcell&
   &                   , kcell, nn, level, sps, sps2)
   CALL POPINTEGER4(branch)
   IF (.NOT.branch .LT. 1) THEN
   CALL POPBOOLEAN(secondhalo)
   CALL POPREAL8ARRAY(wadj, realtype*5**3*nw*ntimeintervalsspectral/8)
   CALL POPREAL8ARRAY(padj, realtype*5**3*ntimeintervalsspectral/8)
   CALL BCFARFIELDNKPC_B(secondhalo, winfadj, pinfcorradj, wadj, wadjb&
   &                    , padj, padjb, siadj, sjadj, skadj, normadj, &
   &                    rfaceadj, icell, jcell, kcell, nn, level, sps, sps2)
   END IF
   CALL POPREAL8ARRAY(wadj, realtype*5**3*nw*ntimeintervalsspectral/8)
   CALL POPREAL8ARRAY(padj, realtype*5**3*ntimeintervalsspectral/8)
   CALL POPBOOLEAN(secondhalo)
   CALL BCSYMMNKPC_B(wadj, wadjb, padj, padjb, normadj, icell, jcell, &
   &              kcell, secondhalo, nn, level, sps, sps2)
   END SUBROUTINE APPLYALLBCNKPC_B
