   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
   !
   !  Differentiation of replacebcstatesnkpc in forward (tangent) mode:
   !   variations   of useful results: padj wadj
   !   with respect to varying inputs: padj0 padj1 padj wadj wadj0
   !                wadj1
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          replaceBCStatesAdj.f90                          *
   !      * Author:        C.A.(Sandy) Mader                               *
   !      * Starting date: 04-17-2008                                      *
   !      * Last modified: 04-17-2008                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE REPLACEBCSTATESNKPC_D(nn, wadj0, wadj0d, wadj1, wadj1d, wadj2&
   &  , wadj3, padj0, padj0d, padj1, padj1d, padj2, padj3, rlvadj1, rlvadj2&
   &  , revadj1, revadj2, icell, jcell, kcell, wadj, wadjd, padj, padjd, &
   &  rlvadj, revadj, secondhalo, nnn, level, sps, sps2)
   USE FLOWVARREFSTATE
   USE BLOCKPOINTERS, ONLY : ie, ib, je, jb, ke, kb, nbocos, bcfaceid, &
   &  bctype, bcdata
   USE INPUTTIMESPECTRAL
   USE BCTYPES
   IMPLICIT NONE
   !      modules
   !nIntervalTimespectral
   INTEGER(kind=inttype), INTENT(IN) :: nn, nnn, level, sps, sps2
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, nw), INTENT(IN) :: wadj0, &
   &  wadj1
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, nw), INTENT(IN) :: wadj0d, &
   &  wadj1d
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, nw), INTENT(IN) :: wadj2, &
   &  wadj3
   REAL(kind=realtype), DIMENSION(-2:2, -2:2), INTENT(IN) :: padj0, padj1
   REAL(kind=realtype), DIMENSION(-2:2, -2:2), INTENT(IN) :: padj0d, &
   &  padj1d
   REAL(kind=realtype), DIMENSION(-2:2, -2:2), INTENT(IN) :: padj2, padj3
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
   &  ntimeintervalsspectral), INTENT(INOUT) :: wadj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
   &  ntimeintervalsspectral), INTENT(INOUT) :: wadjd
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
   &  ntimeintervalsspectral), INTENT(INOUT) :: padj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
   &  ntimeintervalsspectral), INTENT(INOUT) :: padjd
   INTEGER(kind=inttype) :: icell, jcell, kcell, i, j, k, l
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2) :: rlvadj, revadj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2) :: rlvadj1, rlvadj2
   REAL(kind=realtype), DIMENSION(-2:2, -2:2) :: revadj1, revadj2
   LOGICAL :: secondhalo
   ! Copy the information back to the original arrays wAdj and pAdj.
   SELECT CASE  (bcfaceid(nn)) 
   CASE (imin) 
   IF (secondhalo) THEN
   wadjd(-2, -2:2, -2:2, 1:nw, sps2) = wadj0d(-2:2, -2:2, 1:nw)
   wadj(-2, -2:2, -2:2, 1:nw, sps2) = wadj0(-2:2, -2:2, 1:nw)
   wadjd(-1, -2:2, -2:2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-1, -2:2, -2:2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2, -2:2, -2:2, sps2) = padj0d(-2:2, -2:2)
   padj(-2, -2:2, -2:2, sps2) = padj0(-2:2, -2:2)
   padjd(-1, -2:2, -2:2, sps2) = padj1d(-2:2, -2:2)
   padj(-1, -2:2, -2:2, sps2) = padj1(-2:2, -2:2)
   IF (viscous) THEN
   rlvadj(-1, -2:2, -2:2) = rlvadj1(-2:2, -2:2)
   rlvadj(0, -2:2, -2:2) = rlvadj2(-2:2, -2:2)
   END IF
   IF (eddymodel) THEN
   revadj(-1, -2:2, -2:2) = revadj1(-2:2, -2:2)
   revadj(0, -2:2, -2:2) = revadj2(-2:2, -2:2)
   END IF
   ELSE
   wadjd(-2, -2:2, -2:2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-2, -2:2, -2:2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2, -2:2, -2:2, sps2) = padj1d(-2:2, -2:2)
   padj(-2, -2:2, -2:2, sps2) = padj1(-2:2, -2:2)
   END IF
   CASE (imax) 
   !===========================================================
   IF (secondhalo) THEN
   wadjd(2, -2:2, -2:2, 1:nw, sps2) = wadj0d(-2:2, -2:2, 1:nw)
   wadj(2, -2:2, -2:2, 1:nw, sps2) = wadj0(-2:2, -2:2, 1:nw)
   wadjd(1, -2:2, -2:2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(1, -2:2, -2:2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(2, -2:2, -2:2, sps2) = padj0d(-2:2, -2:2)
   padj(2, -2:2, -2:2, sps2) = padj0(-2:2, -2:2)
   padjd(1, -2:2, -2:2, sps2) = padj1d(-2:2, -2:2)
   padj(1, -2:2, -2:2, sps2) = padj1(-2:2, -2:2)
   ELSE
   wadjd(2, -2:2, -2:2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(2, -2:2, -2:2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(2, -2:2, -2:2, sps2) = padj1d(-2:2, -2:2)
   padj(2, -2:2, -2:2, sps2) = padj1(-2:2, -2:2)
   END IF
   CASE (jmin) 
   !===========================================================
   IF (secondhalo) THEN
   wadjd(-2:2, -2, -2:2, 1:nw, sps2) = wadj0d(-2:2, -2:2, 1:nw)
   wadj(-2:2, -2, -2:2, 1:nw, sps2) = wadj0(-2:2, -2:2, 1:nw)
   wadjd(-2:2, -1, -2:2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-2:2, -1, -2:2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2:2, -2, -2:2, sps2) = padj0d(-2:2, -2:2)
   padj(-2:2, -2, -2:2, sps2) = padj0(-2:2, -2:2)
   padjd(-2:2, -1, -2:2, sps2) = padj1d(-2:2, -2:2)
   padj(-2:2, -1, -2:2, sps2) = padj1(-2:2, -2:2)
   ELSE
   wadjd(-2:2, -2, -2:2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-2:2, -2, -2:2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2:2, -2, -2:2, sps2) = padj1d(-2:2, -2:2)
   padj(-2:2, -2, -2:2, sps2) = padj1(-2:2, -2:2)
   END IF
   CASE (jmax) 
   !===========================================================
   IF (secondhalo) THEN
   wadjd(-2:2, 2, -2:2, 1:nw, sps2) = wadj0d(-2:2, -2:2, 1:nw)
   wadj(-2:2, 2, -2:2, 1:nw, sps2) = wadj0(-2:2, -2:2, 1:nw)
   wadjd(-2:2, 1, -2:2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-2:2, 1, -2:2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2:2, 2, -2:2, sps2) = padj0d(-2:2, -2:2)
   padj(-2:2, 2, -2:2, sps2) = padj0(-2:2, -2:2)
   padjd(-2:2, 1, -2:2, sps2) = padj1d(-2:2, -2:2)
   padj(-2:2, 1, -2:2, sps2) = padj1(-2:2, -2:2)
   ELSE
   wadjd(-2:2, 2, -2:2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-2:2, 2, -2:2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2:2, 2, -2:2, sps2) = padj1d(-2:2, -2:2)
   padj(-2:2, 2, -2:2, sps2) = padj1(-2:2, -2:2)
   END IF
   CASE (kmin) 
   !===========================================================
   IF (secondhalo) THEN
   wadjd(-2:2, -2:2, -2, 1:nw, sps2) = wadj0d(-2:2, -2:2, 1:nw)
   wadj(-2:2, -2:2, -2, 1:nw, sps2) = wadj0(-2:2, -2:2, 1:nw)
   wadjd(-2:2, -2:2, -1, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-2:2, -2:2, -1, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2:2, -2:2, -2, sps2) = padj0d(-2:2, -2:2)
   padj(-2:2, -2:2, -2, sps2) = padj0(-2:2, -2:2)
   padjd(-2:2, -2:2, -1, sps2) = padj1d(-2:2, -2:2)
   padj(-2:2, -2:2, -1, sps2) = padj1(-2:2, -2:2)
   ELSE
   wadjd(-2:2, -2:2, -2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-2:2, -2:2, -2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2:2, -2:2, -2, sps2) = padj1d(-2:2, -2:2)
   padj(-2:2, -2:2, -2, sps2) = padj1(-2:2, -2:2)
   END IF
   CASE (kmax) 
   !===========================================================
   IF (secondhalo) THEN
   wadjd(-2:2, -2:2, 2, 1:nw, sps2) = wadj0d(-2:2, -2:2, 1:nw)
   wadj(-2:2, -2:2, 2, 1:nw, sps2) = wadj0(-2:2, -2:2, 1:nw)
   wadjd(-2:2, -2:2, 1, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-2:2, -2:2, 1, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2:2, -2:2, 2, sps2) = padj0d(-2:2, -2:2)
   padj(-2:2, -2:2, 2, sps2) = padj0(-2:2, -2:2)
   padjd(-2:2, -2:2, 1, sps2) = padj1d(-2:2, -2:2)
   padj(-2:2, -2:2, 1, sps2) = padj1(-2:2, -2:2)
   ELSE
   wadjd(-2:2, -2:2, 2, 1:nw, sps2) = wadj1d(-2:2, -2:2, 1:nw)
   wadj(-2:2, -2:2, 2, 1:nw, sps2) = wadj1(-2:2, -2:2, 1:nw)
   padjd(-2:2, -2:2, 2, sps2) = padj1d(-2:2, -2:2)
   padj(-2:2, -2:2, 2, sps2) = padj1(-2:2, -2:2)
   END IF
   END SELECT
   END SUBROUTINE REPLACEBCSTATESNKPC_D
