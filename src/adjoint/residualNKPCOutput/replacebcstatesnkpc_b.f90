   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
   !
   !  Differentiation of replacebcstatesnkpc in reverse (adjoint) mode:
   !   gradient     of useful results: padj0 padj1 padj wadj wadj0
   !                wadj1
   !   with respect to varying inputs: padj0 padj1 padj wadj wadj0
   !                wadj1
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          replaceBCStatesAdj.f90                          *
   !      * Author:        C.A.(Sandy) Mader                               *
   !      * Starting date: 04-17-2008                                      *
   !      * Last modified: 04-17-2008                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE REPLACEBCSTATESNKPC_B(nn, wadj0, wadj0b, wadj1, wadj1b, wadj2&
   &  , wadj3, padj0, padj0b, padj1, padj1b, padj2, padj3, rlvadj1, rlvadj2&
   &  , revadj1, revadj2, icell, jcell, kcell, wadj, wadjb, padj, padjb, &
   &  rlvadj, revadj, secondhalo, nnn, level, sps, sps2)
   USE BLOCKPOINTERS, ONLY : ie, ib, je, jb, ke, kb, nbocos, bcfaceid, &
   &  bctype, bcdata
   USE INPUTTIMESPECTRAL
   USE BCTYPES
   USE FLOWVARREFSTATE
   IMPLICIT NONE
   !      modules
   !nIntervalTimespectral
   INTEGER(kind=inttype), INTENT(IN) :: nn, nnn, level, sps, sps2
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, nw), INTENT(IN) :: wadj0, &
   &  wadj1
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, nw) :: wadj0b, wadj1b
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, nw), INTENT(IN) :: wadj2, &
   &  wadj3
   REAL(kind=realtype), DIMENSION(-2:2, -2:2), INTENT(IN) :: padj0, padj1
   REAL(kind=realtype), DIMENSION(-2:2, -2:2) :: padj0b, padj1b
   REAL(kind=realtype), DIMENSION(-2:2, -2:2), INTENT(IN) :: padj2, padj3
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
   &  ntimeintervalsspectral), INTENT(INOUT) :: wadj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
   &  ntimeintervalsspectral) :: wadjb
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
   &  ntimeintervalsspectral), INTENT(INOUT) :: padj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
   &  ntimeintervalsspectral) :: padjb
   INTEGER(kind=inttype) :: icell, jcell, kcell, i, j, k, l
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2) :: rlvadj, revadj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2) :: rlvadj1, rlvadj2
   REAL(kind=realtype), DIMENSION(-2:2, -2:2) :: revadj1, revadj2
   LOGICAL :: secondhalo
   ! Copy the information back to the original arrays wAdj and pAdj.
   SELECT CASE  (bcfaceid(nn)) 
   CASE (imin) 
   IF (secondhalo) THEN
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-1, -2:2, -2:2, &
   &        sps2)
   padjb(-1, :, :, sps2) = 0.0
   padj0b(-2:2, -2:2) = padj0b(-2:2, -2:2) + padjb(-2, -2:2, -2:2, &
   &        sps2)
   padjb(-2, :, :, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-1, -2&
   &        :2, -2:2, 1:nw, sps2)
   wadjb(-1, :, :, :, sps2) = 0.0
   wadj0b(-2:2, -2:2, 1:nw) = wadj0b(-2:2, -2:2, 1:nw) + wadjb(-2, -2&
   &        :2, -2:2, 1:nw, sps2)
   wadjb(-2, :, :, :, sps2) = 0.0
   ELSE
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-2, -2:2, -2:2, &
   &        sps2)
   padjb(-2, :, :, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-2, -2&
   &        :2, -2:2, 1:nw, sps2)
   wadjb(-2, :, :, :, sps2) = 0.0
   END IF
   CASE (imax) 
   !===========================================================
   IF (secondhalo) THEN
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(1, -2:2, -2:2, &
   &        sps2)
   padjb(1, :, :, sps2) = 0.0
   padj0b(-2:2, -2:2) = padj0b(-2:2, -2:2) + padjb(2, -2:2, -2:2, &
   &        sps2)
   padjb(2, :, :, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(1, -2:&
   &        2, -2:2, 1:nw, sps2)
   wadjb(1, :, :, :, sps2) = 0.0
   wadj0b(-2:2, -2:2, 1:nw) = wadj0b(-2:2, -2:2, 1:nw) + wadjb(2, -2:&
   &        2, -2:2, 1:nw, sps2)
   wadjb(2, :, :, :, sps2) = 0.0
   ELSE
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(2, -2:2, -2:2, &
   &        sps2)
   padjb(2, :, :, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(2, -2:&
   &        2, -2:2, 1:nw, sps2)
   wadjb(2, :, :, :, sps2) = 0.0
   END IF
   CASE (jmin) 
   !===========================================================
   IF (secondhalo) THEN
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-2:2, -1, -2:2, &
   &        sps2)
   padjb(:, -1, :, sps2) = 0.0
   padj0b(-2:2, -2:2) = padj0b(-2:2, -2:2) + padjb(-2:2, -2, -2:2, &
   &        sps2)
   padjb(:, -2, :, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        -1, -2:2, 1:nw, sps2)
   wadjb(:, -1, :, :, sps2) = 0.0
   wadj0b(-2:2, -2:2, 1:nw) = wadj0b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        -2, -2:2, 1:nw, sps2)
   wadjb(:, -2, :, :, sps2) = 0.0
   ELSE
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-2:2, -2, -2:2, &
   &        sps2)
   padjb(:, -2, :, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        -2, -2:2, 1:nw, sps2)
   wadjb(:, -2, :, :, sps2) = 0.0
   END IF
   CASE (jmax) 
   !===========================================================
   IF (secondhalo) THEN
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-2:2, 1, -2:2, &
   &        sps2)
   padjb(:, 1, :, sps2) = 0.0
   padj0b(-2:2, -2:2) = padj0b(-2:2, -2:2) + padjb(-2:2, 2, -2:2, &
   &        sps2)
   padjb(:, 2, :, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        1, -2:2, 1:nw, sps2)
   wadjb(:, 1, :, :, sps2) = 0.0
   wadj0b(-2:2, -2:2, 1:nw) = wadj0b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        2, -2:2, 1:nw, sps2)
   wadjb(:, 2, :, :, sps2) = 0.0
   ELSE
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-2:2, 2, -2:2, &
   &        sps2)
   padjb(:, 2, :, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        2, -2:2, 1:nw, sps2)
   wadjb(:, 2, :, :, sps2) = 0.0
   END IF
   CASE (kmin) 
   !===========================================================
   IF (secondhalo) THEN
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-2:2, -2:2, -1, &
   &        sps2)
   padjb(:, :, -1, sps2) = 0.0
   padj0b(-2:2, -2:2) = padj0b(-2:2, -2:2) + padjb(-2:2, -2:2, -2, &
   &        sps2)
   padjb(:, :, -2, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        -2:2, -1, 1:nw, sps2)
   wadjb(:, :, -1, :, sps2) = 0.0
   wadj0b(-2:2, -2:2, 1:nw) = wadj0b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        -2:2, -2, 1:nw, sps2)
   wadjb(:, :, -2, :, sps2) = 0.0
   ELSE
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-2:2, -2:2, -2, &
   &        sps2)
   padjb(:, :, -2, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        -2:2, -2, 1:nw, sps2)
   wadjb(:, :, -2, :, sps2) = 0.0
   END IF
   CASE (kmax) 
   !===========================================================
   IF (secondhalo) THEN
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-2:2, -2:2, 1, &
   &        sps2)
   padjb(:, :, 1, sps2) = 0.0
   padj0b(-2:2, -2:2) = padj0b(-2:2, -2:2) + padjb(-2:2, -2:2, 2, &
   &        sps2)
   padjb(:, :, 2, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        -2:2, 1, 1:nw, sps2)
   wadjb(:, :, 1, :, sps2) = 0.0
   wadj0b(-2:2, -2:2, 1:nw) = wadj0b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        -2:2, 2, 1:nw, sps2)
   wadjb(:, :, 2, :, sps2) = 0.0
   ELSE
   padj1b(-2:2, -2:2) = padj1b(-2:2, -2:2) + padjb(-2:2, -2:2, 2, &
   &        sps2)
   padjb(:, :, 2, sps2) = 0.0
   wadj1b(-2:2, -2:2, 1:nw) = wadj1b(-2:2, -2:2, 1:nw) + wadjb(-2:2, &
   &        -2:2, 2, 1:nw, sps2)
   wadjb(:, :, 2, :, sps2) = 0.0
   END IF
   END SELECT
   END SUBROUTINE REPLACEBCSTATESNKPC_B
