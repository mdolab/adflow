   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
   !
   !  Differentiation of etotarraynkpc in reverse (adjoint) mode:
   !   gradient     of useful results: etot
   !   with respect to varying inputs: k p u v w rho
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          etotArrayAdj.f90                              *
   !      * Author:        Edwin van der Weide, C.A.(Sandy) Mader          *
   !      * Starting date: 04-25-2008                                      *
   !      * Last modified: 04-25-2008                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE ETOTARRAYNKPC_B(rho, rhob, u, ub, v, vb, w, wb, p, pb, k, kb&
   &  , etot, etotb, correctfork, kk)
   USE CONSTANTS
   IMPLICIT NONE
   INTEGER(kind=inttype), INTENT(IN) :: kk
   !
   !      ******************************************************************
   !      *                                                                *
   !      * EtotArray computes the total energy from the given density,    *
   !      * velocity and presssure for the given kk elements of the arrays.*
   !      * First the internal energy per unit mass is computed and after  *
   !      * that the kinetic energy is added as well the conversion to     *
   !      * energy per unit volume.                                        *
   !      *                                                                *
   !      ******************************************************************
   !
   !
   !      Subroutine arguments.
   !
   !!$       real(kind=realType), dimension(*), intent(in)  :: rho, p, k
   !!$       real(kind=realType), dimension(*), intent(in)  :: u, v, w
   !!$       real(kind=realType), dimension(*), intent(out) :: etot
   REAL(kind=realtype), DIMENSION(kk), INTENT(IN) :: rho, p, k
   REAL(kind=realtype), DIMENSION(kk) :: rhob, pb, kb
   REAL(kind=realtype), DIMENSION(kk), INTENT(IN) :: u, v, w
   REAL(kind=realtype), DIMENSION(kk) :: ub, vb, wb
   REAL(kind=realtype), DIMENSION(kk) :: etot
   REAL(kind=realtype), DIMENSION(kk) :: etotb
   LOGICAL, INTENT(IN) :: correctfork
   !
   !      Local variables.
   !
   INTEGER(kind=inttype) :: i
   REAL(kind=realtype) :: tempb
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Begin execution                                                *
   !      *                                                                *
   !      ******************************************************************
   !
   ! Compute the internal energy for unit mass.
   CALL EINTARRAYNKPC(rho, p, k, etot, correctfork, kk)
   ub = 0.0
   vb = 0.0
   wb = 0.0
   rhob = 0.0
   DO i=kk,1,-1
   tempb = rho(i)*half*etotb(i)
   rhob(i) = rhob(i) + (etot(i)+half*(u(i)**2+v(i)**2+w(i)**2))*etotb(i&
   &      )
   ub(i) = ub(i) + 2*u(i)*tempb
   vb(i) = vb(i) + 2*v(i)*tempb
   wb(i) = wb(i) + 2*w(i)*tempb
   etotb(i) = rho(i)*etotb(i)
   END DO
   CALL EINTARRAYNKPC_B(rho, rhob, p, pb, k, kb, etot, etotb, correctfork&
   &                 , kk)
   END SUBROUTINE ETOTARRAYNKPC_B
