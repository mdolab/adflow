   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
   !
   !  Differentiation of invisciddissfluxscalarnkpc in reverse (adjoint) mode:
   !   gradient     of useful results: dwadj
   !   with respect to varying inputs: sigma padj radkadj radjadj
   !                dwadj wadj radiadj
   !
   !      ******************************************************************
   !      *                                                                *
   !      * File:          inviscidDissFluxScalarAdj.f90                   *
   !      * Author:        Edwin van der Weide,C.A.(Sandy) Mader           *
   !      * Starting date: 06-10-2009                                      *
   !      * Last modified: 06-10-2009                                      *
   !      *                                                                *
   !      ******************************************************************
   !
   SUBROUTINE INVISCIDDISSFLUXSCALARNKPC_B(wadj, wadjb, padj, padjb, dwadj&
   &  , dwadjb, radiadj, radiadjb, radjadj, radjadjb, radkadj, radkadjb, &
   &  icell, jcell, kcell, nn, level, sps)
   USE CGNSGRID
   USE BLOCKPOINTERS
   USE INPUTADJOINT
   USE INPUTTIMESPECTRAL
   USE INPUTPHYSICS
   USE INPUTDISCRETIZATION
   USE CONSTANTS
   USE ITERATION
   USE FLOWVARREFSTATE
   IMPLICIT NONE
   !
   !      ******************************************************************
   !      *                                                                *
   !      * inviscidDissFluxScalar computes the scalar artificial          *
   !      * dissipation, see AIAA paper 81-1259, for a given block.        *
   !      * Therefore it is assumed that the pointers in  blockPointers    *
   !      * already point to the correct block.                            *
   !      *                                                                *
   !      ******************************************************************
   !
   !nTimeIntervalsSpectral
   !
   !      Subroutine arguments
   !
   INTEGER(kind=inttype) :: icell, jcell, kcell, nn, level, sps
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
   &  ntimeintervalsspectral), INTENT(INOUT) :: wadj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
   &  ntimeintervalsspectral) :: wadjb
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
   &  ntimeintervalsspectral), INTENT(IN) :: padj
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
   &  ntimeintervalsspectral) :: padjb
   REAL(kind=realtype), DIMENSION(-1:1, -1:1, -1:1, &
   &  ntimeintervalsspectral) :: radiadj, radjadj, radkadj
   REAL(kind=realtype), DIMENSION(-1:1, -1:1, -1:1, &
   &  ntimeintervalsspectral) :: radiadjb, radjadjb, radkadjb
   REAL(kind=realtype), DIMENSION(nw, ntimeintervalsspectral), INTENT(&
   &  INOUT) :: dwadj
   REAL(kind=realtype), DIMENSION(nw, ntimeintervalsspectral) :: dwadjb
   !
   !      Local parameter.
   !
   REAL(kind=realtype), PARAMETER :: dssmax=0.25_realType
   !
   !      Local variables.
   !
   INTEGER(kind=inttype) :: i, j, k, ind
   INTEGER(kind=inttype) :: ii, jj, kk
   REAL(kind=realtype) :: sslim, rhoi
   REAL(kind=realtype) :: sfil, fis2, fis4
   REAL(kind=realtype) :: ppor, rrad, dis2, dis4
   REAL(kind=realtype) :: rradb, dis2b, dis4b
   REAL(kind=realtype) :: dss1, dss2, ddw, fs
   REAL(kind=realtype) :: dss1b, dss2b, ddwb, fsb
   REAL(kind=realtype) :: fact
   !real(kind=realType), dimension(0:ib,0:jb,0:kb) :: ss
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2) :: ss
   REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2) :: ssb
   REAL(kind=realtype) :: tmp
   REAL(kind=realtype) :: tmp0
   REAL(kind=realtype) :: tmp1
   INTEGER :: branch
   REAL(kind=realtype) :: x3b
   REAL(kind=realtype) :: temp3
   REAL(kind=realtype) :: y1b
   REAL(kind=realtype) :: temp2
   REAL(kind=realtype) :: temp1
   REAL(kind=realtype) :: temp0
   REAL(kind=realtype) :: min5b
   REAL(kind=realtype) :: x6b
   REAL(kind=realtype) :: y4b
   REAL(kind=realtype) :: min6
   REAL(kind=realtype) :: min5
   REAL(kind=realtype) :: min4
   REAL(kind=realtype) :: temp4b0
   REAL(kind=realtype) :: min3
   REAL(kind=realtype) :: min2
   REAL(kind=realtype) :: min1
   REAL(kind=realtype) :: temp0b
   INTRINSIC MAX
   REAL(kind=realtype) :: tmpb
   REAL(kind=realtype) :: x6
   REAL(kind=realtype) :: x5
   REAL(kind=realtype) :: tmp0b
   REAL(kind=realtype) :: x4
   REAL(kind=realtype) :: x3
   REAL(kind=realtype) :: min1b
   REAL(kind=realtype) :: temp3b
   INTRINSIC ABS
   REAL(kind=realtype) :: x2
   REAL(kind=realtype) :: x1
   REAL(kind=realtype) :: x2b
   REAL(kind=realtype) :: temp2b0
   REAL(kind=realtype) :: min4b
   REAL(kind=realtype) :: x5b
   REAL(kind=realtype) :: y3b
   REAL(kind=realtype) :: y6b
   REAL(kind=realtype) :: temp5b4
   REAL(kind=realtype) :: temp5b3
   REAL(kind=realtype) :: temp5b2
   REAL(kind=realtype) :: temp5b1
   REAL(kind=realtype) :: temp5b0
   REAL(kind=realtype) :: tempb
   REAL(kind=realtype) :: temp0b0
   REAL(kind=realtype) :: temp2b
   REAL(kind=realtype) :: x1b
   REAL(kind=realtype) :: min3b
   REAL(kind=realtype) :: temp5b
   REAL(kind=realtype) :: x4b
   REAL(kind=realtype) :: temp3b5
   REAL(kind=realtype) :: y2b
   REAL(kind=realtype) :: temp3b4
   REAL(kind=realtype) :: temp3b3
   REAL(kind=realtype) :: temp3b2
   REAL(kind=realtype) :: temp3b1
   REAL(kind=realtype) :: min6b
   REAL(kind=realtype) :: temp3b0
   REAL(kind=realtype) :: y5b
   INTRINSIC MIN
   REAL(kind=realtype) :: temp1b
   REAL(kind=realtype) :: temp
   REAL(kind=realtype) :: temp1b5
   REAL(kind=realtype) :: temp1b4
   REAL(kind=realtype) :: temp1b3
   REAL(kind=realtype) :: y6
   REAL(kind=realtype) :: temp1b2
   REAL(kind=realtype) :: y5
   REAL(kind=realtype) :: tmp1b
   REAL(kind=realtype) :: temp1b1
   REAL(kind=realtype) :: y4
   REAL(kind=realtype) :: temp1b0
   REAL(kind=realtype) :: y3
   REAL(kind=realtype) :: min2b
   REAL(kind=realtype) :: temp4b
   REAL(kind=realtype) :: y2
   REAL(kind=realtype) :: y1
   REAL(kind=realtype) :: temp4
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Begin execution                                                *
   !      *                                                                *
   !      ******************************************************************
   !
   ! Check if rFil == 0. If so, the dissipative flux needs not to
   ! be computed.
   IF (rfil .EQ. zero) THEN
   padjb = 0.0
   radkadjb = 0.0
   radjadjb = 0.0
   wadjb = 0.0
   radiadjb = 0.0
   ELSE
   !!$           ! Viscous case. Pressure switch is based on the entropy.
   !!$           ! Also set the value of sslim. To be fully consistent this
   !!$           ! must have the dimension of entropy and it is therefore
   !!$           ! set to a fraction of the free stream value.
   !!$
   !!$           sslim = 0.001_realType*pInfCorr/(rhoInf**gammaInf)
   !!$
   !!$           ! Store the entropy in ss. Only fill the entries used in
   !!$           ! the discretization, i.e. ignore the corner halo's.
   !!$
   ! Determine the variables used to compute the switch.
   ! For the inviscid case this is the pressure; for the viscous
   ! case it is the entropy.
   SELECT CASE  (equations) 
   CASE (eulerequations) 
   ! Inviscid case. Pressure switch is based on the pressure.
   ! Also set the value of sslim. To be fully consistent this
   ! must have the dimension of pressure and it is therefore
   ! set to a fraction of the free stream value.
   sslim = 0.001_realType*pinfcorr
   ! Copy the pressure in ss. Only fill the entries used in
   ! the discretization, i.e. ignore the corner halo's.
   !do we need to ignore the corners in the ADjoint?... leave in for now...
   !0,kb
   DO k=-2,2
   !2,jl
   DO j=-2,2
   !2,il
   DO i=-2,2
   ss(i, j, k) = padj(i, j, k, sps)
   END DO
   END DO
   END DO
   CALL PUSHINTEGER4(1)
   CASE (nsequations, ransequations) 
   !===============================================================
   STOP
   CASE DEFAULT
   CALL PUSHINTEGER4(0)
   END SELECT
   ! Set a couple of constants for the scheme.
   fis2 = rfil*vis2
   fis4 = rfil*vis4
   ! Replace the total energy by rho times the total enthalpy.
   ! In this way the numerical solution is total enthalpy preserving
   ! for the steady Euler equations. Also replace the velocities by
   ! the momentum. Only done for the entries used in the
   ! discretization, i.e. ignore the corner halo's.
   !0,kb
   DO k=-2,2
   !2,jl
   DO j=-2,2
   !2,il
   DO i=-2,2
   tmp = wadj(i, j, k, irho, sps)*wadj(i, j, k, ivx, sps)
   CALL PUSHREAL8ARRAY(wadj(i, j, k, ivx, sps), realtype/8)
   wadj(i, j, k, ivx, sps) = tmp
   tmp0 = wadj(i, j, k, irho, sps)*wadj(i, j, k, ivy, sps)
   CALL PUSHREAL8ARRAY(wadj(i, j, k, ivy, sps), realtype/8)
   wadj(i, j, k, ivy, sps) = tmp0
   tmp1 = wadj(i, j, k, irho, sps)*wadj(i, j, k, ivz, sps)
   CALL PUSHREAL8ARRAY(wadj(i, j, k, ivz, sps), realtype/8)
   wadj(i, j, k, ivz, sps) = tmp1
   CALL PUSHREAL8ARRAY(wadj(i, j, k, irhoe, sps), realtype/8)
   wadj(i, j, k, irhoe, sps) = wadj(i, j, k, irhoe, sps) + padj(i&
   &            , j, k, sps)
   END DO
   END DO
   END DO
   !Following method in the upwind scheme, take the residual onto dwAdj instead 
   !of a separate fw. If it needs to be switched back, fw is dissiptive, dw is
   !inviscid...
   !!$       ! Initialize the dissipative residual to a certain times,
   !!$       ! possibly zero, the previously stored value. Owned cells
   !!$       ! only, because the halo values do not matter.
   !
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Dissipative fluxes in the i-direction.                         *
   !      *                                                                *
   !      ******************************************************************
   ! 
   !set some indices for use later
   i = icell - 1
   j = jcell
   k = kcell
   fact = one
   !do k=2,kl
   !  do j=2,jl
   ! Compute the pressure sensor in the first cell, which
   ! is a halo cell.
   !!dss1 = abs((ss(2,j,k) - two*ss(1,j,k) + ss(0,j,k)) &
   !!     /     (ss(2,j,k) + two*ss(1,j,k) + ss(0,j,k) + sslim))
   ! Loop in i-direction.
   DO ii=-1,0
   x1 = (ss(ii+1, 0, 0)-two*ss(ii, 0, 0)+ss(ii-1, 0, 0))/(ss(ii+1, 0&
   &        , 0)+two*ss(ii, 0, 0)+ss(ii-1, 0, 0)+sslim)
   IF (x1 .GE. 0.) THEN
   dss1 = x1
   CALL PUSHINTEGER4(1)
   ELSE
   dss1 = -x1
   CALL PUSHINTEGER4(0)
   END IF
   x2 = (ss(ii+2, 0, 0)-two*ss(ii+1, 0, 0)+ss(ii, 0, 0))/(ss(ii+2, 0&
   &        , 0)+two*ss(ii+1, 0, 0)+ss(ii, 0, 0)+sslim)
   IF (x2 .GE. 0.) THEN
   dss2 = x2
   CALL PUSHINTEGER4(1)
   ELSE
   dss2 = -x2
   CALL PUSHINTEGER4(0)
   END IF
   CALL PUSHREAL8ARRAY(ppor, realtype/8)
   !print *,'dss2',dss2
   ! Compute the dissipation coefficients for this face.
   ppor = zero
   IF (pori(i, j, k) .EQ. normalflux) ppor = half
   !rrad = ppor*(radI(i,j,k) + radI(i+1,j,k))
   rrad = ppor*(radiadj(ii, 0, 0, sps)+radiadj(ii+1, 0, 0, sps))
   !print *,'radI',radIAdj(ii,0,0),radI(icell+ii,jcell,kcell),icell,jcell,kcell,radIAdj(ii+1,0,0),radI(icell+ii+1,jcell,kcell)
   !lumped Dissipation for preconditioner
   IF (lumpeddiss) THEN
   IF (dss1 .LT. dss2) THEN
   y1 = dss2
   CALL PUSHINTEGER4(1)
   ELSE
   y1 = dss1
   CALL PUSHINTEGER4(0)
   END IF
   IF (dssmax .GT. y1) THEN
   CALL PUSHREAL8ARRAY(min1, realtype/8)
   min1 = y1
   CALL PUSHINTEGER4(0)
   ELSE
   CALL PUSHREAL8ARRAY(min1, realtype/8)
   min1 = dssmax
   CALL PUSHINTEGER4(1)
   END IF
   CALL PUSHREAL8ARRAY(dis2, realtype/8)
   dis2 = fis2*rrad*min1 + sigma*fis4*rrad
   CALL PUSHREAL8ARRAY(dis4, realtype/8)
   dis4 = 0.0
   CALL PUSHINTEGER4(0)
   ELSE
   IF (dss1 .LT. dss2) THEN
   y2 = dss2
   CALL PUSHINTEGER4(1)
   ELSE
   y2 = dss1
   CALL PUSHINTEGER4(0)
   END IF
   IF (dssmax .GT. y2) THEN
   CALL PUSHREAL8ARRAY(min2, realtype/8)
   min2 = y2
   CALL PUSHINTEGER4(0)
   ELSE
   CALL PUSHREAL8ARRAY(min2, realtype/8)
   min2 = dssmax
   CALL PUSHINTEGER4(1)
   END IF
   CALL PUSHREAL8ARRAY(dis2, realtype/8)
   dis2 = fis2*rrad*min2
   !dis4 = dim(fis4*rrad, dis2)
   IF (fis4*rrad - dis2 .GT. 0.0) THEN
   CALL PUSHREAL8ARRAY(dis4, realtype/8)
   dis4 = fis4*rrad - dis2
   CALL PUSHINTEGER4(2)
   ELSE
   CALL PUSHREAL8ARRAY(dis4, realtype/8)
   dis4 = 0.0
   CALL PUSHINTEGER4(1)
   END IF
   END IF
   !print *,'dis2,4',dis2,dis4
   ! Compute and scatter the dissipative flux.
   ! Density. Store it in the mass flow of the
   ! appropriate sliding mesh interface.
   !fw(i+1,j,k,irho) = fw(i+1,j,k,irho) + fs
   !fw(i,j,k,irho)   = fw(i,j,k,irho)   - fs
   ! X-momentum.
   !fw(i+1,j,k,imx) = fw(i+1,j,k,imx) + fs
   !fw(i,j,k,imx)   = fw(i,j,k,imx)   - fs
   ! Y-momentum.
   !fw(i+1,j,k,imy) = fw(i+1,j,k,imy) + fs
   !fw(i,j,k,imy)   = fw(i,j,k,imy)   - fs
   ! Z-momentum.
   !fw(i+1,j,k,imz) = fw(i+1,j,k,imz) + fs
   !fw(i,j,k,imz)   = fw(i,j,k,imz)   - fs
   ! Energy.
   !fw(i+1,j,k,irhoE) = fw(i+1,j,k,irhoE) + fs
   !fw(i,j,k,irhoE)   = fw(i,j,k,irhoE)   - fs
   ! Update i and set fact to 1 for the second face.
   i = i + 1
   CALL PUSHREAL8ARRAY(fact, realtype/8)
   fact = -one
   END DO
   !!! Set dss1 to dss2 for the next face.
   !!
   !!dss1 = dss2
   !         enddo
   !       enddo
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Dissipative fluxes in the j-direction.                         *
   !      *                                                                *
   !      ******************************************************************
   !
   ! do k=2,kl
   !   do i=2,il
   i = icell
   j = jcell - 1
   k = kcell
   fact = one
   ! Loop over the two faces which contribute to the residual of
   ! the cell considered.
   DO jj=-1,0
   x3 = (ss(0, jj+1, 0)-two*ss(0, jj, 0)+ss(0, jj-1, 0))/(ss(0, jj+1&
   &        , 0)+two*ss(0, jj, 0)+ss(0, jj-1, 0)+sslim)
   IF (x3 .GE. 0.) THEN
   dss1 = x3
   CALL PUSHINTEGER4(1)
   ELSE
   dss1 = -x3
   CALL PUSHINTEGER4(0)
   END IF
   x4 = (ss(0, jj+2, 0)-two*ss(0, jj+1, 0)+ss(0, jj, 0))/(ss(0, jj+2&
   &        , 0)+two*ss(0, jj+1, 0)+ss(0, jj, 0)+sslim)
   IF (x4 .GE. 0.) THEN
   dss2 = x4
   CALL PUSHINTEGER4(1)
   ELSE
   dss2 = -x4
   CALL PUSHINTEGER4(0)
   END IF
   CALL PUSHREAL8ARRAY(ppor, realtype/8)
   ! Compute the dissipation coefficients for this face.
   ppor = zero
   IF (porj(i, j, k) .EQ. normalflux) ppor = half
   !rrad = ppor*(radJ(i,j,k) + radJ(i,j+1,k))
   rrad = ppor*(radjadj(0, jj, 0, sps)+radjadj(0, jj+1, 0, sps))
   !lumped Dissipation for preconditioner
   IF (lumpeddiss) THEN
   IF (dss1 .LT. dss2) THEN
   y3 = dss2
   CALL PUSHINTEGER4(1)
   ELSE
   y3 = dss1
   CALL PUSHINTEGER4(0)
   END IF
   IF (dssmax .GT. y3) THEN
   CALL PUSHREAL8ARRAY(min3, realtype/8)
   min3 = y3
   CALL PUSHINTEGER4(0)
   ELSE
   CALL PUSHREAL8ARRAY(min3, realtype/8)
   min3 = dssmax
   CALL PUSHINTEGER4(1)
   END IF
   CALL PUSHREAL8ARRAY(dis2, realtype/8)
   dis2 = fis2*rrad*min3 + sigma*fis4*rrad
   CALL PUSHREAL8ARRAY(dis4, realtype/8)
   dis4 = 0.0
   CALL PUSHINTEGER4(0)
   ELSE
   IF (dss1 .LT. dss2) THEN
   y4 = dss2
   CALL PUSHINTEGER4(1)
   ELSE
   y4 = dss1
   CALL PUSHINTEGER4(0)
   END IF
   IF (dssmax .GT. y4) THEN
   CALL PUSHREAL8ARRAY(min4, realtype/8)
   min4 = y4
   CALL PUSHINTEGER4(0)
   ELSE
   CALL PUSHREAL8ARRAY(min4, realtype/8)
   min4 = dssmax
   CALL PUSHINTEGER4(1)
   END IF
   CALL PUSHREAL8ARRAY(dis2, realtype/8)
   dis2 = fis2*rrad*min4
   !dis4 = dim(fis4*rrad, dis2)
   IF (fis4*rrad - dis2 .GT. 0.0) THEN
   CALL PUSHREAL8ARRAY(dis4, realtype/8)
   dis4 = fis4*rrad - dis2
   CALL PUSHINTEGER4(2)
   ELSE
   CALL PUSHREAL8ARRAY(dis4, realtype/8)
   dis4 = 0.0
   CALL PUSHINTEGER4(1)
   END IF
   END IF
   ! Compute and scatter the dissipative flux.
   ! Density. Store it in the mass flow of the
   ! appropriate sliding mesh interface.
   !fw(i,j+1,k,irho) = fw(i,j+1,k,irho) + fs
   !fw(i,j,k,irho)   = fw(i,j,k,irho)   - fs
   ! X-momentum.
   !fw(i,j+1,k,imx) = fw(i,j+1,k,imx) + fs
   !fw(i,j,k,imx)   = fw(i,j,k,imx)   - fs
   ! Y-momentum.
   !fw(i,j+1,k,imy) = fw(i,j+1,k,imy) + fs
   !fw(i,j,k,imy)   = fw(i,j,k,imy)   - fs
   ! Z-momentum.
   !fw(i,j+1,k,imz) = fw(i,j+1,k,imz) + fs
   !fw(i,j,k,imz)   = fw(i,j,k,imz)   - fs
   ! Energy.
   !fw(i,j+1,k,irhoE) = fw(i,j+1,k,irhoE) + fs
   !fw(i,j,k,irhoE)   = fw(i,j,k,irhoE)   - fs
   ! Update j and set fact to 1 for the second face.
   j = j + 1
   CALL PUSHREAL8ARRAY(fact, realtype/8)
   fact = -one
   END DO
   !!! Set dss1 to dss2 for the next face.
   !!
   !!dss1 = dss2
   !enddo
   !enddo
   !
   !      ******************************************************************
   !      *                                                                *
   !      * Dissipative fluxes in the k-direction.                         *
   !      *                                                                *
   !      ******************************************************************
   !    
   ! Fluxes in k-direction.
   i = icell
   j = jcell
   k = kcell - 1
   fact = one
   !       do j=2,jl
   !         do i=2,il
   ! Loop over the two faces which contribute to the residual of
   ! the cell considered.
   DO kk=-1,0
   x5 = (ss(0, 0, kk+1)-two*ss(0, 0, kk)+ss(0, 0, kk-1))/(ss(0, 0, kk&
   &        +1)+two*ss(0, 0, kk)+ss(0, 0, kk-1)+sslim)
   IF (x5 .GE. 0.) THEN
   dss1 = x5
   CALL PUSHINTEGER4(1)
   ELSE
   dss1 = -x5
   CALL PUSHINTEGER4(0)
   END IF
   x6 = (ss(0, 0, kk+2)-two*ss(0, 0, kk+1)+ss(0, 0, kk))/(ss(0, 0, kk&
   &        +2)+two*ss(0, 0, kk+1)+ss(0, 0, kk)+sslim)
   IF (x6 .GE. 0.) THEN
   dss2 = x6
   CALL PUSHINTEGER4(1)
   ELSE
   dss2 = -x6
   CALL PUSHINTEGER4(0)
   END IF
   CALL PUSHREAL8ARRAY(ppor, realtype/8)
   ! Compute the dissipation coefficients for this face.
   ppor = zero
   IF (pork(i, j, k) .EQ. normalflux) ppor = half
   !rrad = ppor*(radK(i,j,k) + radK(i,j,k+1))
   rrad = ppor*(radkadj(0, 0, kk, sps)+radkadj(0, 0, kk+1, sps))
   !lumped Dissipation for preconditioner
   IF (lumpeddiss) THEN
   IF (dss1 .LT. dss2) THEN
   y5 = dss2
   CALL PUSHINTEGER4(1)
   ELSE
   y5 = dss1
   CALL PUSHINTEGER4(0)
   END IF
   IF (dssmax .GT. y5) THEN
   CALL PUSHREAL8ARRAY(min5, realtype/8)
   min5 = y5
   CALL PUSHINTEGER4(0)
   ELSE
   CALL PUSHREAL8ARRAY(min5, realtype/8)
   min5 = dssmax
   CALL PUSHINTEGER4(1)
   END IF
   CALL PUSHREAL8ARRAY(dis2, realtype/8)
   dis2 = fis2*rrad*min5 + sigma*fis4*rrad
   CALL PUSHREAL8ARRAY(dis4, realtype/8)
   dis4 = 0.0
   CALL PUSHINTEGER4(0)
   ELSE
   IF (dss1 .LT. dss2) THEN
   y6 = dss2
   CALL PUSHINTEGER4(1)
   ELSE
   y6 = dss1
   CALL PUSHINTEGER4(0)
   END IF
   IF (dssmax .GT. y6) THEN
   CALL PUSHREAL8ARRAY(min6, realtype/8)
   min6 = y6
   CALL PUSHINTEGER4(0)
   ELSE
   CALL PUSHREAL8ARRAY(min6, realtype/8)
   min6 = dssmax
   CALL PUSHINTEGER4(1)
   END IF
   CALL PUSHREAL8ARRAY(dis2, realtype/8)
   dis2 = fis2*rrad*min6
   !dis4 = dim(fis4*rrad, dis2)
   IF (fis4*rrad - dis2 .GT. 0.0) THEN
   CALL PUSHREAL8ARRAY(dis4, realtype/8)
   dis4 = fis4*rrad - dis2
   CALL PUSHINTEGER4(2)
   ELSE
   CALL PUSHREAL8ARRAY(dis4, realtype/8)
   dis4 = 0.0
   CALL PUSHINTEGER4(1)
   END IF
   END IF
   ! Compute and scatter the dissipative flux.
   ! Density. Store it in the mass flow of the
   ! appropriate sliding mesh interface.
   !fw(i,j,k+1,irho) = fw(i,j,k+1,irho) + fs
   !fw(i,j,k,irho)   = fw(i,j,k,irho)   - fs
   ! X-momentum.
   !fw(i,j,k+1,imx) = fw(i,j,k+1,imx) + fs
   !fw(i,j,k,imx)   = fw(i,j,k,imx)   - fs
   ! Y-momentum.
   !fw(i,j,k+1,imy) = fw(i,j,k+1,imy) + fs
   !fw(i,j,k,imy)   = fw(i,j,k,imy)   - fs
   ! Z-momentum.
   !fw(i,j,k+1,imz) = fw(i,j,k+1,imz) + fs
   !fw(i,j,k,imz)   = fw(i,j,k,imz)   - fs
   ! Energy.
   !fw(i,j,k+1,irhoE) = fw(i,j,k+1,irhoE) + fs
   !fw(i,j,k,irhoE)   = fw(i,j,k,irhoE)   - fs
   ! Update k and set fact to 1 for the second face.
   k = k + 1
   CALL PUSHREAL8ARRAY(fact, realtype/8)
   fact = -one
   END DO
   radkadjb = 0.0
   wadjb = 0.0
   ssb = 0.0
   DO kk=0,-1,-1
   CALL POPREAL8ARRAY(fact, realtype/8)
   fsb = fact*dwadjb(irhoe, sps)
   ddw = wadj(0, 0, kk+1, irhoe, sps) - wadj(0, 0, kk, irhoe, sps)
   temp5b0 = -(dis4*fsb)
   dis2b = ddw*fsb
   ddwb = dis2*fsb - three*temp5b0
   dis4b = -((wadj(0, 0, kk+2, irhoe, sps)-wadj(0, 0, kk-1, irhoe, &
   &        sps)-three*ddw)*fsb)
   wadjb(0, 0, kk+2, irhoe, sps) = wadjb(0, 0, kk+2, irhoe, sps) + &
   &        temp5b0
   wadjb(0, 0, kk-1, irhoe, sps) = wadjb(0, 0, kk-1, irhoe, sps) - &
   &        temp5b0
   wadjb(0, 0, kk+1, irhoe, sps) = wadjb(0, 0, kk+1, irhoe, sps) + &
   &        ddwb
   wadjb(0, 0, kk, irhoe, sps) = wadjb(0, 0, kk, irhoe, sps) - ddwb
   fsb = fact*dwadjb(imz, sps)
   ddw = wadj(0, 0, kk+1, ivz, sps) - wadj(0, 0, kk, ivz, sps)
   temp5b1 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp5b1
   dis4b = dis4b - (wadj(0, 0, kk+2, ivz, sps)-wadj(0, 0, kk-1, ivz, &
   &        sps)-three*ddw)*fsb
   wadjb(0, 0, kk+2, ivz, sps) = wadjb(0, 0, kk+2, ivz, sps) + &
   &        temp5b1
   wadjb(0, 0, kk-1, ivz, sps) = wadjb(0, 0, kk-1, ivz, sps) - &
   &        temp5b1
   wadjb(0, 0, kk+1, ivz, sps) = wadjb(0, 0, kk+1, ivz, sps) + ddwb
   wadjb(0, 0, kk, ivz, sps) = wadjb(0, 0, kk, ivz, sps) - ddwb
   fsb = fact*dwadjb(imy, sps)
   ddw = wadj(0, 0, kk+1, ivy, sps) - wadj(0, 0, kk, ivy, sps)
   temp5b2 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp5b2
   dis4b = dis4b - (wadj(0, 0, kk+2, ivy, sps)-wadj(0, 0, kk-1, ivy, &
   &        sps)-three*ddw)*fsb
   wadjb(0, 0, kk+2, ivy, sps) = wadjb(0, 0, kk+2, ivy, sps) + &
   &        temp5b2
   wadjb(0, 0, kk-1, ivy, sps) = wadjb(0, 0, kk-1, ivy, sps) - &
   &        temp5b2
   wadjb(0, 0, kk+1, ivy, sps) = wadjb(0, 0, kk+1, ivy, sps) + ddwb
   wadjb(0, 0, kk, ivy, sps) = wadjb(0, 0, kk, ivy, sps) - ddwb
   fsb = fact*dwadjb(imx, sps)
   ddw = wadj(0, 0, kk+1, ivx, sps) - wadj(0, 0, kk, ivx, sps)
   temp5b3 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp5b3
   dis4b = dis4b - (wadj(0, 0, kk+2, ivx, sps)-wadj(0, 0, kk-1, ivx, &
   &        sps)-three*ddw)*fsb
   wadjb(0, 0, kk+2, ivx, sps) = wadjb(0, 0, kk+2, ivx, sps) + &
   &        temp5b3
   wadjb(0, 0, kk-1, ivx, sps) = wadjb(0, 0, kk-1, ivx, sps) - &
   &        temp5b3
   wadjb(0, 0, kk+1, ivx, sps) = wadjb(0, 0, kk+1, ivx, sps) + ddwb
   wadjb(0, 0, kk, ivx, sps) = wadjb(0, 0, kk, ivx, sps) - ddwb
   fsb = fact*dwadjb(irho, sps)
   ddw = wadj(0, 0, kk+1, irho, sps) - wadj(0, 0, kk, irho, sps)
   temp5b4 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp5b4
   dis4b = dis4b - (wadj(0, 0, kk+2, irho, sps)-wadj(0, 0, kk-1, irho&
   &        , sps)-three*ddw)*fsb
   wadjb(0, 0, kk+2, irho, sps) = wadjb(0, 0, kk+2, irho, sps) + &
   &        temp5b4
   wadjb(0, 0, kk-1, irho, sps) = wadjb(0, 0, kk-1, irho, sps) - &
   &        temp5b4
   wadjb(0, 0, kk+1, irho, sps) = wadjb(0, 0, kk+1, irho, sps) + ddwb
   wadjb(0, 0, kk, irho, sps) = wadjb(0, 0, kk, irho, sps) - ddwb
   rrad = ppor*(radkadj(0, 0, kk, sps)+radkadj(0, 0, kk+1, sps))
   CALL POPINTEGER4(branch)
   IF (branch .LT. 2) THEN
   IF (branch .LT. 1) THEN
   CALL POPREAL8ARRAY(dis4, realtype/8)
   CALL POPREAL8ARRAY(dis2, realtype/8)
   rradb = (sigma*fis4+fis2*min5)*dis2b
   min5b = fis2*rrad*dis2b
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   CALL POPREAL8ARRAY(min5, realtype/8)
   y5b = min5b
   ELSE
   CALL POPREAL8ARRAY(min5, realtype/8)
   y5b = 0.0
   END IF
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   dss1b = y5b
   dss2b = 0.0
   ELSE
   dss2b = y5b
   dss1b = 0.0
   END IF
   GOTO 100
   ELSE
   CALL POPREAL8ARRAY(dis4, realtype/8)
   rradb = 0.0
   END IF
   ELSE
   CALL POPREAL8ARRAY(dis4, realtype/8)
   rradb = fis4*dis4b
   dis2b = dis2b - dis4b
   END IF
   CALL POPREAL8ARRAY(dis2, realtype/8)
   rradb = rradb + fis2*min6*dis2b
   min6b = fis2*rrad*dis2b
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   CALL POPREAL8ARRAY(min6, realtype/8)
   y6b = min6b
   ELSE
   CALL POPREAL8ARRAY(min6, realtype/8)
   y6b = 0.0
   END IF
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   dss1b = y6b
   dss2b = 0.0
   ELSE
   dss2b = y6b
   dss1b = 0.0
   END IF
   100  radkadjb(0, 0, kk, sps) = radkadjb(0, 0, kk, sps) + ppor*rradb
   radkadjb(0, 0, kk+1, sps) = radkadjb(0, 0, kk+1, sps) + ppor*rradb
   CALL POPREAL8ARRAY(ppor, realtype/8)
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   x6b = -dss2b
   ELSE
   x6b = dss2b
   END IF
   temp4 = sslim + ss(0, 0, kk+2) + two*ss(0, 0, kk+1) + ss(0, 0, kk)
   temp5b = x6b/temp4
   temp4b0 = -((ss(0, 0, kk+2)-two*ss(0, 0, kk+1)+ss(0, 0, kk))*&
   &        temp5b/temp4)
   ssb(0, 0, kk+2) = ssb(0, 0, kk+2) + temp4b0 + temp5b
   ssb(0, 0, kk+1) = ssb(0, 0, kk+1) + two*temp4b0 - two*temp5b
   ssb(0, 0, kk) = ssb(0, 0, kk) + temp4b0 + temp5b
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   x5b = -dss1b
   ELSE
   x5b = dss1b
   END IF
   temp3 = sslim + ss(0, 0, kk+1) + two*ss(0, 0, kk) + ss(0, 0, kk-1)
   temp4b = x5b/temp3
   temp3b5 = -((ss(0, 0, kk+1)-two*ss(0, 0, kk)+ss(0, 0, kk-1))*&
   &        temp4b/temp3)
   ssb(0, 0, kk+1) = ssb(0, 0, kk+1) + temp3b5 + temp4b
   ssb(0, 0, kk) = ssb(0, 0, kk) + two*temp3b5 - two*temp4b
   ssb(0, 0, kk-1) = ssb(0, 0, kk-1) + temp3b5 + temp4b
   END DO
   radjadjb = 0.0
   DO jj=0,-1,-1
   CALL POPREAL8ARRAY(fact, realtype/8)
   fsb = fact*dwadjb(irhoe, sps)
   ddw = wadj(0, jj+1, 0, irhoe, sps) - wadj(0, jj, 0, irhoe, sps)
   temp3b0 = -(dis4*fsb)
   dis2b = ddw*fsb
   ddwb = dis2*fsb - three*temp3b0
   dis4b = -((wadj(0, jj+2, 0, irhoe, sps)-wadj(0, jj-1, 0, irhoe, &
   &        sps)-three*ddw)*fsb)
   wadjb(0, jj+2, 0, irhoe, sps) = wadjb(0, jj+2, 0, irhoe, sps) + &
   &        temp3b0
   wadjb(0, jj-1, 0, irhoe, sps) = wadjb(0, jj-1, 0, irhoe, sps) - &
   &        temp3b0
   wadjb(0, jj+1, 0, irhoe, sps) = wadjb(0, jj+1, 0, irhoe, sps) + &
   &        ddwb
   wadjb(0, jj, 0, irhoe, sps) = wadjb(0, jj, 0, irhoe, sps) - ddwb
   fsb = fact*dwadjb(imz, sps)
   ddw = wadj(0, jj+1, 0, ivz, sps) - wadj(0, jj, 0, ivz, sps)
   temp3b1 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp3b1
   dis4b = dis4b - (wadj(0, jj+2, 0, ivz, sps)-wadj(0, jj-1, 0, ivz, &
   &        sps)-three*ddw)*fsb
   wadjb(0, jj+2, 0, ivz, sps) = wadjb(0, jj+2, 0, ivz, sps) + &
   &        temp3b1
   wadjb(0, jj-1, 0, ivz, sps) = wadjb(0, jj-1, 0, ivz, sps) - &
   &        temp3b1
   wadjb(0, jj+1, 0, ivz, sps) = wadjb(0, jj+1, 0, ivz, sps) + ddwb
   wadjb(0, jj, 0, ivz, sps) = wadjb(0, jj, 0, ivz, sps) - ddwb
   fsb = fact*dwadjb(imy, sps)
   ddw = wadj(0, jj+1, 0, ivy, sps) - wadj(0, jj, 0, ivy, sps)
   temp3b2 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp3b2
   dis4b = dis4b - (wadj(0, jj+2, 0, ivy, sps)-wadj(0, jj-1, 0, ivy, &
   &        sps)-three*ddw)*fsb
   wadjb(0, jj+2, 0, ivy, sps) = wadjb(0, jj+2, 0, ivy, sps) + &
   &        temp3b2
   wadjb(0, jj-1, 0, ivy, sps) = wadjb(0, jj-1, 0, ivy, sps) - &
   &        temp3b2
   wadjb(0, jj+1, 0, ivy, sps) = wadjb(0, jj+1, 0, ivy, sps) + ddwb
   wadjb(0, jj, 0, ivy, sps) = wadjb(0, jj, 0, ivy, sps) - ddwb
   fsb = fact*dwadjb(imx, sps)
   ddw = wadj(0, jj+1, 0, ivx, sps) - wadj(0, jj, 0, ivx, sps)
   temp3b3 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp3b3
   dis4b = dis4b - (wadj(0, jj+2, 0, ivx, sps)-wadj(0, jj-1, 0, ivx, &
   &        sps)-three*ddw)*fsb
   wadjb(0, jj+2, 0, ivx, sps) = wadjb(0, jj+2, 0, ivx, sps) + &
   &        temp3b3
   wadjb(0, jj-1, 0, ivx, sps) = wadjb(0, jj-1, 0, ivx, sps) - &
   &        temp3b3
   wadjb(0, jj+1, 0, ivx, sps) = wadjb(0, jj+1, 0, ivx, sps) + ddwb
   wadjb(0, jj, 0, ivx, sps) = wadjb(0, jj, 0, ivx, sps) - ddwb
   fsb = fact*dwadjb(irho, sps)
   ddw = wadj(0, jj+1, 0, irho, sps) - wadj(0, jj, 0, irho, sps)
   temp3b4 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp3b4
   dis4b = dis4b - (wadj(0, jj+2, 0, irho, sps)-wadj(0, jj-1, 0, irho&
   &        , sps)-three*ddw)*fsb
   wadjb(0, jj+2, 0, irho, sps) = wadjb(0, jj+2, 0, irho, sps) + &
   &        temp3b4
   wadjb(0, jj-1, 0, irho, sps) = wadjb(0, jj-1, 0, irho, sps) - &
   &        temp3b4
   wadjb(0, jj+1, 0, irho, sps) = wadjb(0, jj+1, 0, irho, sps) + ddwb
   wadjb(0, jj, 0, irho, sps) = wadjb(0, jj, 0, irho, sps) - ddwb
   rrad = ppor*(radjadj(0, jj, 0, sps)+radjadj(0, jj+1, 0, sps))
   CALL POPINTEGER4(branch)
   IF (branch .LT. 2) THEN
   IF (branch .LT. 1) THEN
   CALL POPREAL8ARRAY(dis4, realtype/8)
   CALL POPREAL8ARRAY(dis2, realtype/8)
   rradb = (sigma*fis4+fis2*min3)*dis2b
   min3b = fis2*rrad*dis2b
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   CALL POPREAL8ARRAY(min3, realtype/8)
   y3b = min3b
   ELSE
   CALL POPREAL8ARRAY(min3, realtype/8)
   y3b = 0.0
   END IF
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   dss1b = y3b
   dss2b = 0.0
   ELSE
   dss2b = y3b
   dss1b = 0.0
   END IF
   GOTO 110
   ELSE
   CALL POPREAL8ARRAY(dis4, realtype/8)
   rradb = 0.0
   END IF
   ELSE
   CALL POPREAL8ARRAY(dis4, realtype/8)
   rradb = fis4*dis4b
   dis2b = dis2b - dis4b
   END IF
   CALL POPREAL8ARRAY(dis2, realtype/8)
   rradb = rradb + fis2*min4*dis2b
   min4b = fis2*rrad*dis2b
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   CALL POPREAL8ARRAY(min4, realtype/8)
   y4b = min4b
   ELSE
   CALL POPREAL8ARRAY(min4, realtype/8)
   y4b = 0.0
   END IF
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   dss1b = y4b
   dss2b = 0.0
   ELSE
   dss2b = y4b
   dss1b = 0.0
   END IF
   110  radjadjb(0, jj, 0, sps) = radjadjb(0, jj, 0, sps) + ppor*rradb
   radjadjb(0, jj+1, 0, sps) = radjadjb(0, jj+1, 0, sps) + ppor*rradb
   CALL POPREAL8ARRAY(ppor, realtype/8)
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   x4b = -dss2b
   ELSE
   x4b = dss2b
   END IF
   temp2 = sslim + ss(0, jj+2, 0) + two*ss(0, jj+1, 0) + ss(0, jj, 0)
   temp3b = x4b/temp2
   temp2b0 = -((ss(0, jj+2, 0)-two*ss(0, jj+1, 0)+ss(0, jj, 0))*&
   &        temp3b/temp2)
   ssb(0, jj+2, 0) = ssb(0, jj+2, 0) + temp2b0 + temp3b
   ssb(0, jj+1, 0) = ssb(0, jj+1, 0) + two*temp2b0 - two*temp3b
   ssb(0, jj, 0) = ssb(0, jj, 0) + temp2b0 + temp3b
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   x3b = -dss1b
   ELSE
   x3b = dss1b
   END IF
   temp1 = sslim + ss(0, jj+1, 0) + two*ss(0, jj, 0) + ss(0, jj-1, 0)
   temp2b = x3b/temp1
   temp1b5 = -((ss(0, jj+1, 0)-two*ss(0, jj, 0)+ss(0, jj-1, 0))*&
   &        temp2b/temp1)
   ssb(0, jj+1, 0) = ssb(0, jj+1, 0) + temp1b5 + temp2b
   ssb(0, jj, 0) = ssb(0, jj, 0) + two*temp1b5 - two*temp2b
   ssb(0, jj-1, 0) = ssb(0, jj-1, 0) + temp1b5 + temp2b
   END DO
   radiadjb = 0.0
   DO ii=0,-1,-1
   CALL POPREAL8ARRAY(fact, realtype/8)
   fsb = fact*dwadjb(irhoe, sps)
   ddw = wadj(ii+1, 0, 0, irhoe, sps) - wadj(ii, 0, 0, irhoe, sps)
   temp1b0 = -(dis4*fsb)
   dis2b = ddw*fsb
   ddwb = dis2*fsb - three*temp1b0
   dis4b = -((wadj(ii+2, 0, 0, irhoe, sps)-wadj(ii-1, 0, 0, irhoe, &
   &        sps)-three*ddw)*fsb)
   wadjb(ii+2, 0, 0, irhoe, sps) = wadjb(ii+2, 0, 0, irhoe, sps) + &
   &        temp1b0
   wadjb(ii-1, 0, 0, irhoe, sps) = wadjb(ii-1, 0, 0, irhoe, sps) - &
   &        temp1b0
   wadjb(ii+1, 0, 0, irhoe, sps) = wadjb(ii+1, 0, 0, irhoe, sps) + &
   &        ddwb
   wadjb(ii, 0, 0, irhoe, sps) = wadjb(ii, 0, 0, irhoe, sps) - ddwb
   fsb = fact*dwadjb(imz, sps)
   ddw = wadj(ii+1, 0, 0, ivz, sps) - wadj(ii, 0, 0, ivz, sps)
   temp1b1 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp1b1
   dis4b = dis4b - (wadj(ii+2, 0, 0, ivz, sps)-wadj(ii-1, 0, 0, ivz, &
   &        sps)-three*ddw)*fsb
   wadjb(ii+2, 0, 0, ivz, sps) = wadjb(ii+2, 0, 0, ivz, sps) + &
   &        temp1b1
   wadjb(ii-1, 0, 0, ivz, sps) = wadjb(ii-1, 0, 0, ivz, sps) - &
   &        temp1b1
   wadjb(ii+1, 0, 0, ivz, sps) = wadjb(ii+1, 0, 0, ivz, sps) + ddwb
   wadjb(ii, 0, 0, ivz, sps) = wadjb(ii, 0, 0, ivz, sps) - ddwb
   fsb = fact*dwadjb(imy, sps)
   ddw = wadj(ii+1, 0, 0, ivy, sps) - wadj(ii, 0, 0, ivy, sps)
   temp1b2 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp1b2
   dis4b = dis4b - (wadj(ii+2, 0, 0, ivy, sps)-wadj(ii-1, 0, 0, ivy, &
   &        sps)-three*ddw)*fsb
   wadjb(ii+2, 0, 0, ivy, sps) = wadjb(ii+2, 0, 0, ivy, sps) + &
   &        temp1b2
   wadjb(ii-1, 0, 0, ivy, sps) = wadjb(ii-1, 0, 0, ivy, sps) - &
   &        temp1b2
   wadjb(ii+1, 0, 0, ivy, sps) = wadjb(ii+1, 0, 0, ivy, sps) + ddwb
   wadjb(ii, 0, 0, ivy, sps) = wadjb(ii, 0, 0, ivy, sps) - ddwb
   fsb = fact*dwadjb(imx, sps)
   ddw = wadj(ii+1, 0, 0, ivx, sps) - wadj(ii, 0, 0, ivx, sps)
   temp1b3 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp1b3
   dis4b = dis4b - (wadj(ii+2, 0, 0, ivx, sps)-wadj(ii-1, 0, 0, ivx, &
   &        sps)-three*ddw)*fsb
   wadjb(ii+2, 0, 0, ivx, sps) = wadjb(ii+2, 0, 0, ivx, sps) + &
   &        temp1b3
   wadjb(ii-1, 0, 0, ivx, sps) = wadjb(ii-1, 0, 0, ivx, sps) - &
   &        temp1b3
   wadjb(ii+1, 0, 0, ivx, sps) = wadjb(ii+1, 0, 0, ivx, sps) + ddwb
   wadjb(ii, 0, 0, ivx, sps) = wadjb(ii, 0, 0, ivx, sps) - ddwb
   fsb = fact*dwadjb(irho, sps)
   ddw = wadj(ii+1, 0, 0, irho, sps) - wadj(ii, 0, 0, irho, sps)
   temp1b4 = -(dis4*fsb)
   dis2b = dis2b + ddw*fsb
   ddwb = dis2*fsb - three*temp1b4
   dis4b = dis4b - (wadj(ii+2, 0, 0, irho, sps)-wadj(ii-1, 0, 0, irho&
   &        , sps)-three*ddw)*fsb
   wadjb(ii+2, 0, 0, irho, sps) = wadjb(ii+2, 0, 0, irho, sps) + &
   &        temp1b4
   wadjb(ii-1, 0, 0, irho, sps) = wadjb(ii-1, 0, 0, irho, sps) - &
   &        temp1b4
   wadjb(ii+1, 0, 0, irho, sps) = wadjb(ii+1, 0, 0, irho, sps) + ddwb
   wadjb(ii, 0, 0, irho, sps) = wadjb(ii, 0, 0, irho, sps) - ddwb
   rrad = ppor*(radiadj(ii, 0, 0, sps)+radiadj(ii+1, 0, 0, sps))
   CALL POPINTEGER4(branch)
   IF (branch .LT. 2) THEN
   IF (branch .LT. 1) THEN
   CALL POPREAL8ARRAY(dis4, realtype/8)
   CALL POPREAL8ARRAY(dis2, realtype/8)
   rradb = (sigma*fis4+fis2*min1)*dis2b
   min1b = fis2*rrad*dis2b
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   CALL POPREAL8ARRAY(min1, realtype/8)
   y1b = min1b
   ELSE
   CALL POPREAL8ARRAY(min1, realtype/8)
   y1b = 0.0
   END IF
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   dss1b = y1b
   dss2b = 0.0
   ELSE
   dss2b = y1b
   dss1b = 0.0
   END IF
   GOTO 120
   ELSE
   CALL POPREAL8ARRAY(dis4, realtype/8)
   rradb = 0.0
   END IF
   ELSE
   CALL POPREAL8ARRAY(dis4, realtype/8)
   rradb = fis4*dis4b
   dis2b = dis2b - dis4b
   END IF
   CALL POPREAL8ARRAY(dis2, realtype/8)
   rradb = rradb + fis2*min2*dis2b
   min2b = fis2*rrad*dis2b
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   CALL POPREAL8ARRAY(min2, realtype/8)
   y2b = min2b
   ELSE
   CALL POPREAL8ARRAY(min2, realtype/8)
   y2b = 0.0
   END IF
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   dss1b = y2b
   dss2b = 0.0
   ELSE
   dss2b = y2b
   dss1b = 0.0
   END IF
   120  radiadjb(ii, 0, 0, sps) = radiadjb(ii, 0, 0, sps) + ppor*rradb
   radiadjb(ii+1, 0, 0, sps) = radiadjb(ii+1, 0, 0, sps) + ppor*rradb
   CALL POPREAL8ARRAY(ppor, realtype/8)
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   x2b = -dss2b
   ELSE
   x2b = dss2b
   END IF
   temp0 = sslim + ss(ii+2, 0, 0) + two*ss(ii+1, 0, 0) + ss(ii, 0, 0)
   temp1b = x2b/temp0
   temp0b0 = -((ss(ii+2, 0, 0)-two*ss(ii+1, 0, 0)+ss(ii, 0, 0))*&
   &        temp1b/temp0)
   ssb(ii+2, 0, 0) = ssb(ii+2, 0, 0) + temp0b0 + temp1b
   ssb(ii+1, 0, 0) = ssb(ii+1, 0, 0) + two*temp0b0 - two*temp1b
   ssb(ii, 0, 0) = ssb(ii, 0, 0) + temp0b0 + temp1b
   CALL POPINTEGER4(branch)
   IF (branch .LT. 1) THEN
   x1b = -dss1b
   ELSE
   x1b = dss1b
   END IF
   temp = sslim + ss(ii+1, 0, 0) + two*ss(ii, 0, 0) + ss(ii-1, 0, 0)
   temp0b = x1b/temp
   tempb = -((ss(ii+1, 0, 0)-two*ss(ii, 0, 0)+ss(ii-1, 0, 0))*temp0b/&
   &        temp)
   ssb(ii+1, 0, 0) = ssb(ii+1, 0, 0) + tempb + temp0b
   ssb(ii, 0, 0) = ssb(ii, 0, 0) + two*tempb - two*temp0b
   ssb(ii-1, 0, 0) = ssb(ii-1, 0, 0) + tempb + temp0b
   END DO
   padjb = 0.0
   DO k=2,-2,-1
   DO j=2,-2,-1
   DO i=2,-2,-1
   CALL POPREAL8ARRAY(wadj(i, j, k, irhoe, sps), realtype/8)
   padjb(i, j, k, sps) = padjb(i, j, k, sps) + wadjb(i, j, k, &
   &            irhoe, sps)
   CALL POPREAL8ARRAY(wadj(i, j, k, ivz, sps), realtype/8)
   tmp1b = wadjb(i, j, k, ivz, sps)
   wadjb(i, j, k, ivz, sps) = 0.0
   wadjb(i, j, k, irho, sps) = wadjb(i, j, k, irho, sps) + wadj(i&
   &            , j, k, ivz, sps)*tmp1b
   wadjb(i, j, k, ivz, sps) = wadjb(i, j, k, ivz, sps) + wadj(i, &
   &            j, k, irho, sps)*tmp1b
   CALL POPREAL8ARRAY(wadj(i, j, k, ivy, sps), realtype/8)
   tmp0b = wadjb(i, j, k, ivy, sps)
   wadjb(i, j, k, ivy, sps) = 0.0
   wadjb(i, j, k, irho, sps) = wadjb(i, j, k, irho, sps) + wadj(i&
   &            , j, k, ivy, sps)*tmp0b
   wadjb(i, j, k, ivy, sps) = wadjb(i, j, k, ivy, sps) + wadj(i, &
   &            j, k, irho, sps)*tmp0b
   CALL POPREAL8ARRAY(wadj(i, j, k, ivx, sps), realtype/8)
   tmpb = wadjb(i, j, k, ivx, sps)
   wadjb(i, j, k, ivx, sps) = 0.0
   wadjb(i, j, k, irho, sps) = wadjb(i, j, k, irho, sps) + wadj(i&
   &            , j, k, ivx, sps)*tmpb
   wadjb(i, j, k, ivx, sps) = wadjb(i, j, k, ivx, sps) + wadj(i, &
   &            j, k, irho, sps)*tmpb
   END DO
   END DO
   END DO
   CALL POPINTEGER4(branch)
   IF (.NOT.branch .LT. 1) THEN
   DO k=2,-2,-1
   DO j=2,-2,-1
   DO i=2,-2,-1
   padjb(i, j, k, sps) = padjb(i, j, k, sps) + ssb(i, j, k)
   ssb(i, j, k) = 0.0
   END DO
   END DO
   END DO
   END IF
   END IF

   END SUBROUTINE INVISCIDDISSFLUXSCALARNKPC_B
