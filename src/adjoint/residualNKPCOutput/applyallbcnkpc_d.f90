!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade 3.4 (r3375) - 10 Feb 2010 15:08
!
!  Differentiation of applyallbcnkpc in forward (tangent) mode:
!   variations   of useful results: padj wadj
!   with respect to varying inputs: padj wadj
!
!      ******************************************************************
!      *                                                                *
!      * File:          applyAllBCAdj.f90                               *
!      * Author:        Edwin van der Weide, Seonghyeon Hahn            *
!      *                C.A.(Sandy) Mader                               *
!      * Starting date: 04-16-2008                                      *
!      * Last modified: 04-17-2008                                      *
!      *                                                                *
!      ******************************************************************
!
SUBROUTINE APPLYALLBCNKPC_D(winfadj, pinfcorradj, wadj, wadjd, padj, &
     &  padjd, sadj, siadj, sjadj, skadj, voladj, normadj, rfaceadj, icell, &
     &  jcell, kcell, secondhalo, nn, level, sps, sps2)
  USE FLOWVARREFSTATE
  USE BLOCKPOINTERS
  USE INPUTTIMESPECTRAL
  USE BCTYPES
  USE INPUTDISCRETIZATION
  IMPLICIT NONE
  !
  !      ******************************************************************
  !      *                                                                *
  !      * applyAllBCAdj applies the possible boundary conditions for the *
  !      * halo cells adjacent to the cell for which the residual needs   *
  !      * to be computed.                                                *
  !      *                                                                *
  !      ******************************************************************
  !
  !, only : ie, ib, je, jb, ke, kb, nBocos, &
  !         BCFaceID, BCType, BCData,p,w
  !precond,choimerkle, etc...
  !nIntervalTimespectral
  !
  !      Subroutine arguments.
  !
  LOGICAL :: secondhalo
  INTEGER(kind=inttype) :: icell, jcell, kcell
  INTEGER(kind=inttype) :: nn, level, sps, sps2
  REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
       &  ntimeintervalsspectral), INTENT(INOUT) :: wadj
  REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, nw, &
       &  ntimeintervalsspectral), INTENT(INOUT) :: wadjd
  REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
       &  ntimeintervalsspectral), INTENT(INOUT) :: padj
  REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, &
       &  ntimeintervalsspectral), INTENT(INOUT) :: padjd
  REAL(kind=realtype), DIMENSION(-2:2, -2:2, -2:2, 3, &
       &  ntimeintervalsspectral), INTENT(IN) :: sadj
  REAL(kind=realtype), DIMENSION(-3:2, -3:2, -3:2, 3, &
       &  ntimeintervalsspectral), INTENT(IN) :: siadj, sjadj, skadj
  REAL(kind=realtype), DIMENSION(ntimeintervalsspectral), INTENT(IN) :: &
       &  voladj
  REAL(kind=realtype), INTENT(IN) :: pinfcorradj
  REAL(kind=realtype), DIMENSION(nbocos, -2:2, -2:2, 3, &
       &  ntimeintervalsspectral), INTENT(IN) :: normadj
  REAL(kind=realtype), DIMENSION(nbocos, -2:2, -2:2, &
       &  ntimeintervalsspectral), INTENT(IN) :: rfaceadj
  REAL(kind=realtype), DIMENSION(nw), INTENT(IN) :: winfadj
  !
  !      Local variables.
  !
  INTEGER(kind=inttype) :: i, j, k, ii, jj, kk, l
  INTEGER(kind=inttype) :: istart, iend, jstart, jend, kstart, kend
  LOGICAL :: correctfork
  !
  !      ******************************************************************
  !      *                                                                *
  !      * Begin execution                                                *
  !      *                                                                *
  !      ******************************************************************
  !
  CALL BCSYMMNKPC_D(wadj, wadjd, padj, padjd, normadj, icell, jcell, &
       &              kcell, secondhalo, nn, level, sps, sps2)
  SELECT CASE  (precond) 
  CASE (noprecond) 
     CALL BCFARFIELDNKPC_D(secondhalo, winfadj, pinfcorradj, wadj, wadjd&
          &                    , padj, padjd, siadj, sjadj, skadj, normadj, &
          &                    rfaceadj, icell, jcell, kcell, nn, level, sps, sps2)
  CASE (turkel) 
     CALL TERMINATE('applyAllBC', &
          &'Farfield boundary conditions for Turkel preconditioner not implemented'&
          &               )
  CASE (choimerkle) 
     CALL TERMINATE('applyAllBC', 'Farfield boundary conditions for Ch&
          &                oi and Merkle preconditioner not implemented')
  END SELECT
  CALL BCEULERWALLNKPC_D(secondhalo, wadj, wadjd, padj, padjd, sadj, &
       &                   siadj, sjadj, skadj, normadj, rfaceadj, icell, jcell&
       &                   , kcell, nn, level, sps, sps2)
END SUBROUTINE APPLYALLBCNKPC_D
