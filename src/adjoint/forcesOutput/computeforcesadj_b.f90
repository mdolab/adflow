   !        Generated by TAPENADE     (INRIA, Tropics team)
   !  Tapenade - Version 2.2 (r1239) - Wed 28 Jun 2006 04:59:55 PM CEST
   !  
   !  Differentiation of computeforcesadj in reverse (adjoint) mode:
   !   gradient, with respect to input variables: moment refpoint
   !                pts wadj force
   !   of linear combination of output variables: moment refpoint
   !                pts wadj force
   !
   !     ******************************************************************
   !     *                                                                *
   !     * File:          computeForcesAdj.f90                            *
   !     * Author:        Gaetan Kenway                                   *
   !     * Starting date: 09-27-2010                                      *
   !     * Last modified: 09-27-2010                                      *
   !     *                                                                *
   !     ******************************************************************
   SUBROUTINE COMPUTEFORCESADJ_B(force, forceb, moment, momentb, pts, ptsb&
   &  , wadj, wadjb, refpoint, refpointb, fact, ibeg, iend, jbeg, jend, &
   &  inode, jnode, righthanded)
   USE constants_b
   USE flowvarrefstate_b
   IMPLICIT NONE
   REAL(KIND=REALTYPE), INTENT(IN) :: fact
   REAL(KIND=REALTYPE) :: force(3), forceb(3)
   INTEGER(KIND=INTTYPE), INTENT(IN) :: ibeg
   INTEGER(KIND=INTTYPE), INTENT(IN) :: iend
   INTEGER(KIND=INTTYPE), INTENT(IN) :: inode
   INTEGER(KIND=INTTYPE), INTENT(IN) :: jbeg
   INTEGER(KIND=INTTYPE), INTENT(IN) :: jend
   INTEGER(KIND=INTTYPE), INTENT(IN) :: jnode
   REAL(KIND=REALTYPE) :: moment(3), momentb(3)
   REAL(KIND=REALTYPE), DIMENSION(3, 3, 3), INTENT(IN) :: pts
   REAL(KIND=REALTYPE) :: ptsb(3, 3, 3)
   REAL(KIND=REALTYPE), DIMENSION(3), INTENT(IN) :: refpoint
   REAL(KIND=REALTYPE) :: refpointb(3)
   LOGICAL, INTENT(IN) :: righthanded
   REAL(KIND=REALTYPE), DIMENSION(2, 2, 2, nw), INTENT(IN) :: wadj
   REAL(KIND=REALTYPE) :: wadjb(2, 2, 2, nw)
   INTEGER(KIND=INTTYPE) :: i, j, k, kk, l
   REAL(KIND=REALTYPE) :: normadj(3, 2, 2), normadjb(3, 2, 2)
   REAL(KIND=REALTYPE) :: padj(3, 2, 2), padjb(3, 2, 2)
   !nw
   !     Subroutine arguments.
   ! Local Variables
   ! Compute the pressure in the 2x2x2 block
   padj = 0.0
   CALL COMPUTEPRESSUREFORCESADJ(wadj, padj(2:3, :, :))
   CALL GETSURFACENORMALSFORCESADJ(pts, normadj, righthanded)
   CALL PUSHREAL8ARRAY(padj, 3*2**2)
   ! Only BC Euler wall boundary conditions are implemented. 
   CALL BCEULERWALLFORCESADJ(wadj, padj)
   ! For NS probably will need to call 
   ! call bcNSWallAdiabaticForcesAdj(wAdj,pAdj)
   ! Also for NS calculation, will need to compute the tau on the
   ! subfaces, with 
   ! call viscousFluxAdj(     )
   CALL FORCESADJ_B(padj, padjb, pts, ptsb, normadj, normadjb, refpoint, &
   &             refpointb, force, forceb, moment, momentb, fact, ibeg, &
   &             iend, jbeg, jend, inode, jnode)
   CALL POPREAL8ARRAY(padj, 3*2**2)
   CALL BCEULERWALLFORCESADJ_B(wadj, padj, padjb)
   CALL GETSURFACENORMALSFORCESADJ_B(pts, ptsb, normadj, normadjb, &
   &                              righthanded)
   CALL COMPUTEPRESSUREFORCESADJ_B(wadj, wadjb, padj(2:3, :, :), padjb(2:&
   &                            3, :, :))
   END SUBROUTINE COMPUTEFORCESADJ_B
