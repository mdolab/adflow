!        Generated by TAPENADE     (INRIA, Tropics team)
!  Tapenade - Version 2.2 (r1239) - Wed 28 Jun 2006 04:59:55 PM CEST
!  
!  Differentiation of computeleastsquaresregression in reverse (adjoint) mode:
!   gradient, with respect to input variables: y
!   of linear combination of output variables: m b
!
!      ******************************************************************
!      *                                                                *
!      * File:          computeLeastSquaresRegression.f90               *
!      * Author:        C.A.(Sandy) Mader                               *
!      * Starting date: 10-14-2009                                      *
!      * Last modified: 10-14-2009                                      *
!      *                                                                *
!      ******************************************************************
!
SUBROUTINE COMPUTELEASTSQUARESREGRESSION_B(y, yb, x, npts, m, mb, b, bb)
  USE precision
  IMPLICIT NONE
  REAL(KIND=REALTYPE) :: b, bb, m, mb
  INTEGER(KIND=INTTYPE) :: npts
  REAL(KIND=REALTYPE) :: x(npts), y(npts), yb(npts)
  INTEGER(KIND=INTTYPE) :: i
  REAL(KIND=REALTYPE) :: sumx, sumx2, sumxy, sumxyb, sumy, sumyb
  REAL(KIND=REALTYPE) :: tempb, tempb0
!
!      ******************************************************************
!      *                                                                *
!      * Computes the slope of best fit for a set of x,y data of length *
!      * npts                                                           *
!      *                                                                *
!      ******************************************************************
!
!Subroutine arguments 
!local variables
!begin execution
  sumx = 0.0
  sumx2 = 0.0
  DO i=1,npts
    sumx = sumx + x(i)
    sumx2 = sumx2 + x(i)*x(i)
  END DO
  tempb = bb/(npts*sumx2-sumx**2)
  tempb0 = mb/(npts*sumx2-sumx**2)
  sumyb = sumx2*tempb - sumx*tempb0
  sumxyb = npts*tempb0 - sumx*tempb
  yb(1:npts) = 0.0
  DO i=npts,1,-1
    yb(i) = yb(i) + sumyb + x(i)*sumxyb
  END DO
END SUBROUTINE COMPUTELEASTSQUARESREGRESSION_B
