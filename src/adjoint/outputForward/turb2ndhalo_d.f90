!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of turb2ndhalo in forward (tangent) mode (with options i4 dr8 r8):
!   variations   of useful results: *rev *w
!   with respect to varying inputs: *rev *w
!   plus diff mem management of: rev:in w:in bcdata:in
!
!      ******************************************************************
!      *                                                                *
!      * file:          turb2ndhalo.f90                                 *
!      * author:        edwin van der weide                             *
!      * starting date: 06-16-2003                                      *
!      * last modified: 06-12-2005                                      *
!      *                                                                *
!      ******************************************************************
!
subroutine turb2ndhalo_d(nn)
!
!      ******************************************************************
!      *                                                                *
!      * turb2ndhalo sets the turbulent variables in the second halo    *
!      * cell for the given subface. simple constant extrapolation is   *
!      * used to avoid problems.                                        *
!      *                                                                *
!      ******************************************************************
!
  use blockpointers
  use flowvarrefstate
  implicit none
!
!      subroutine arguments.
!
  integer(kind=inttype), intent(in) :: nn
!
!      local variables.
!
  integer(kind=inttype) :: i, j, l
!
!      ******************************************************************
!      *                                                                *
!      * begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! determine the face on which this subface is located and set
! some pointers accordingly.
! loop over the turbulent variables and set the second halo
! value. if this is an eddy model, also set the eddy viscosity.
  select case  (bcfaceid(nn)) 
  case (imin) 
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        do l=nt1,nt2
          wd(0, i, j, l) = wd(1, i, j, l)
          w(0, i, j, l) = w(1, i, j, l)
        end do
        if (eddymodel) then
          revd(0, i, j) = revd(1, i, j)
          rev(0, i, j) = rev(1, i, j)
        end if
      end do
    end do
  case (imax) 
!===============================================================
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        do l=nt1,nt2
          wd(ib, i, j, l) = wd(ie, i, j, l)
          w(ib, i, j, l) = w(ie, i, j, l)
        end do
        if (eddymodel) then
          revd(ib, i, j) = revd(ie, i, j)
          rev(ib, i, j) = rev(ie, i, j)
        end if
      end do
    end do
  case (jmin) 
!===============================================================
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        do l=nt1,nt2
          wd(i, 0, j, l) = wd(i, 1, j, l)
          w(i, 0, j, l) = w(i, 1, j, l)
        end do
        if (eddymodel) then
          revd(i, 0, j) = revd(i, 1, j)
          rev(i, 0, j) = rev(i, 1, j)
        end if
      end do
    end do
  case (jmax) 
!===============================================================
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        do l=nt1,nt2
          wd(i, jb, j, l) = wd(i, je, j, l)
          w(i, jb, j, l) = w(i, je, j, l)
        end do
        if (eddymodel) then
          revd(i, jb, j) = revd(i, je, j)
          rev(i, jb, j) = rev(i, je, j)
        end if
      end do
    end do
  case (kmin) 
!===============================================================
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        do l=nt1,nt2
          wd(i, j, 0, l) = wd(i, j, 1, l)
          w(i, j, 0, l) = w(i, j, 1, l)
        end do
        if (eddymodel) then
          revd(i, j, 0) = revd(i, j, 1)
          rev(i, j, 0) = rev(i, j, 1)
        end if
      end do
    end do
  case (kmax) 
!===============================================================
    do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
      do i=bcdata(nn)%icbeg,bcdata(nn)%icend
        do l=nt1,nt2
          wd(i, j, kb, l) = wd(i, j, ke, l)
          w(i, j, kb, l) = w(i, j, ke, l)
        end do
        if (eddymodel) then
          revd(i, j, kb) = revd(i, j, ke)
          rev(i, j, kb) = rev(i, j, ke)
        end if
      end do
    end do
  end select
end subroutine turb2ndhalo_d
