!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of bcturbinterface in forward (tangent) mode (with options i4 dr8 r8):
!   variations   of useful results: *bvtj1 *bvtj2 *bvtk1 *bvtk2
!                *bvti1 *bvti2
!   with respect to varying inputs: *bvtj1 *bvtj2 *w *bvtk1 *bvtk2
!                *bvti1 *bvti2
!   plus diff mem management of: bvtj1:in bvtj2:in w:in bvtk1:in
!                bvtk2:in bvti1:in bvti2:in bcdata:in
!
!      ******************************************************************
!      *                                                                *
!      * file:          bcturbinterface.f90                             *
!      * author:        georgi kalitzin, edwin van der weide            *
!      * starting date: 01-09-2004                                      *
!      * last modified: 06-12-2005                                      *
!      *                                                                *
!      ******************************************************************
!
subroutine bcturbinterface_d(nn)
!
!      ******************************************************************
!      *                                                                *
!      * bcturbinterface applies the halo treatment for interface halo  *
!      * cells, sliding mesh interface and domain interface. as these   *
!      * are not really boundary conditions, the variable bvt is simply *
!      * set to keep the current value.                                 *
!      *                                                                *
!      ******************************************************************
!
  use constants
  use blockpointers
  use flowvarrefstate
  implicit none
! note that the original code had an error in the pointers...they
! were pointing to {il,jl,kl} and not {ie, je, ke}.
!
!      subroutine arguments.
!
  integer(kind=inttype), intent(in) :: nn
!
!      local variables.
!
  integer(kind=inttype) :: i, j, l
!
!      ******************************************************************
!      *                                                                *
!      * begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! loop over the faces of the subfaces and set the values of
! bvt to keep the current value.
  do j=bcdata(nn)%jcbeg,bcdata(nn)%jcend
    do i=bcdata(nn)%icbeg,bcdata(nn)%icend
      do l=nt1,nt2
        select case  (bcfaceid(nn)) 
        case (imin) 
          bvti1d(i, j, l) = wd(1, i, j, l)
          bvti1(i, j, l) = w(1, i, j, l)
        case (imax) 
          bvti2d(i, j, l) = wd(ie, i, j, l)
          bvti2(i, j, l) = w(ie, i, j, l)
        case (jmin) 
          bvtj1d(i, j, l) = wd(i, 1, j, l)
          bvtj1(i, j, l) = w(i, 1, j, l)
        case (jmax) 
          bvtj2d(i, j, l) = wd(i, je, j, l)
          bvtj2(i, j, l) = w(i, je, j, l)
        case (kmin) 
          bvtk1d(i, j, l) = wd(i, j, 1, l)
          bvtk1(i, j, l) = w(i, j, 1, l)
        case (kmax) 
          bvtk2d(i, j, l) = wd(i, j, ke, l)
          bvtk2(i, j, l) = w(i, j, ke, l)
        end select
      end do
    end do
  end do
end subroutine bcturbinterface_d
