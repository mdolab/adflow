!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of computeeddyviscosity in forward (tangent) mode (with options i4 dr8 r8):
!   variations   of useful results: *rev
!   with respect to varying inputs: *w *rlv
!   plus diff mem management of: rev:in w:in rlv:in
!
!      ******************************************************************
!      *                                                                *
!      * file:          computeeddyviscosity.f90                        *
!      * author:        georgi kalitzin, edwin van der weide            *
!      * starting date: 03-10-2003                                      *
!      * last modified: 06-12-2005                                      *
!      *                                                                *
!      ******************************************************************
!
subroutine computeeddyviscosity_d()
!
!      ******************************************************************
!      *                                                                *
!      * computeeddyviscosity computes the eddy viscosity in the        *
!      * owned cell centers of the given block. it is assumed that the  *
!      * pointes already point to the correct block before entering     *
!      * this subroutine.                                               *
!      *                                                                *
!      ******************************************************************
!
  use constants
  use flowvarrefstate
  use inputphysics
  use iteration
  use blockpointers
  implicit none
!
!      local variables.
!
  logical :: returnimmediately
!
!      ******************************************************************
!      *                                                                *
!      * begin execution                                                *
!      *                                                                *
!      ******************************************************************
!
! check if an immediate return can be made.
  if (eddymodel) then
    if (currentlevel .le. groundlevel) then
      returnimmediately = .false.
    else
      returnimmediately = .true.
    end if
  else
    returnimmediately = .true.
  end if
  if (returnimmediately) then
    revd = 0.0_8
    return
  else
! determine the turbulence model and call the appropriate
! routine to compute the eddy viscosity.
    select case  (turbmodel) 
    case (spalartallmaras, spalartallmarasedwards) 
      call saeddyviscosity_d()
    case default
      revd = 0.0_8
    end select
  end if
end subroutine computeeddyviscosity_d
