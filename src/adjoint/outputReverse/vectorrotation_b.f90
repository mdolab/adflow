!        generated by tapenade     (inria, tropics team)
!  tapenade 3.10 (r5363) -  9 sep 2014 09:53
!
!  differentiation of vectorrotation in reverse (adjoint) mode (with options i4 dr8 r8 noisize):
!   gradient     of useful results: xp yp angle zp
!   with respect to varying inputs: x y z angle
subroutine vectorrotation_b(xp, xpd, yp, ypd, zp, zpd, iaxis, angle, &
& angled, x, xd, y, yd, z, zd)
!
!      vectorrotation rotates a given vector with respect to a      
!      specified axis by a given angle.                             
!         input arguments:                                          
!            iaxis      = rotation axis (1-x, 2-y, 3-z)             
!            angle      = rotation angle (measured ccw in radians)  
!            x, y, z    = coordinates in original system            
!         output arguments:                                         
!            xp, yp, zp = coordinates in rotated system             
!
  use precision
  implicit none
!
!     subroutine arguments.
!
  integer(kind=inttype), intent(in) :: iaxis
  real(kind=realtype), intent(in) :: angle, x, y, z
  real(kind=realtype) :: angled, xd, yd, zd
  real(kind=realtype) :: xp, yp, zp
  real(kind=realtype) :: xpd, ypd, zpd
  intrinsic cos
  intrinsic sin
! rotation about specified axis by specified angle
  select case  (iaxis) 
  case (1) 
    xd = xpd
    angled = angled + (z*cos(angle)-y*sin(angle))*ypd + (-(z*sin(angle))&
&     -y*cos(angle))*zpd
    yd = cos(angle)*ypd - sin(angle)*zpd
    zd = sin(angle)*ypd + cos(angle)*zpd
  case (2) 
    angled = angled + (-(z*cos(angle))-x*sin(angle))*xpd + (x*cos(angle)&
&     -z*sin(angle))*zpd
    xd = cos(angle)*xpd + sin(angle)*zpd
    yd = ypd
    zd = cos(angle)*zpd - sin(angle)*xpd
  case (3) 
    xd = cos(angle)*xpd - sin(angle)*ypd
    yd = cos(angle)*ypd + sin(angle)*xpd
    zd = zpd
    angled = angled + (y*cos(angle)-x*sin(angle))*xpd + (-(x*cos(angle))&
&     -y*sin(angle))*ypd
  case default
    stop
  end select
end subroutine vectorrotation_b
